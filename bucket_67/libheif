# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		libheif
VERSION=		1.14.0
KEYWORDS=		graphics
VARIANTS=		standard
SDESC[standard]=	HEIF file format decoder and encoder
HOMEPAGE=		https://github.com/strukturag/libheif
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		GITHUB/strukturag:libheif:v1.14.0
DISTFILE[1]=		generated:main
DF_INDEX=		1
SPKGS[standard]=	single

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILDRUN_DEPENDS=	x265:single:standard
			libde265:single:standard

USES=			autoreconf libtool pkgconfig shebangfix cpe jpeg png
			mime-info:single

LICENSE=		LGPL3+:single
LICENSE_TERMS=		single:{{WRKDIR}}/TERMS
LICENSE_FILE=		LGPL3+:{{WRKSRC}}/COPYING
LICENSE_AWK=		TERMS:"LIBHEIF_HEIF_H"
LICENSE_SOURCE=		TERMS:{{WRKSRC}}/libheif/heif.h
LICENSE_SCHEME=		solo

CPE_VENDOR=		struktur
FPC_EQUIVALENT=		graphics/libheif
SHEBANG_GLOB=		*.sh

MUST_CONFIGURE=		gnu

INSTALL_TARGET=		install-strip
SOVERSION=		1.14.0

VAR_OPSYS[sunos]=	CONFIGURE_ARGS=--disable-examples

[FILE:353:descriptions/desc.single]
libheif is an ISO/IEC 23008-12:2017 HEIF file format decoder and encoder.

HEIF is a new image file format employing HEVC (h.265) image coding for the 
best compression ratios currently possible.

libheif makes use of libde265 for the actual image decoding and x265 for 
encoding. Alternative codecs for, e.g., AVC and JPEG can be provided as 
plugins.


[FILE:111:distinfo]
9901cb0743caa80c316fabcf785c39466f41dda5c42152f2b7992be43db8d047      1293315 strukturag-libheif-1.14.0.tar.gz


[FILE:395:manifests/plist.single]
bin/
 heif-convert
 heif-enc
 heif-info
 heif-thumbnailer
include/libheif/
 heif.h
 heif_cxx.h
 heif_plugin.h
 heif_version.h
lib/
 libheif.a
 libheif.so
 libheif.so.%%SOMAJOR%%
 libheif.so.%%SOVERSION%%
lib/pkgconfig/libheif.pc
share/man/man1/
 heif-convert.1.gz
 heif-enc.1.gz
 heif-info.1.gz
 heif-thumbnailer.1.gz
share/mime/packages/
 avif.xml
 heif.xml
share/thumbnailers/heif.thumbnailer


[FILE:584:patches/patch-libheif_heif__hevc.cc]
--- libheif/heif_hevc.cc.orig	2022-11-15 14:08:00 UTC
+++ libheif/heif_hevc.cc
@@ -45,10 +45,10 @@ static double read_depth_rep_info_elemen
   //printf("sign:%d exponent:%d mantissa_len:%d mantissa:%d\n",sign_flag,exponent,mantissa_len,mantissa);
 
   if (exponent > 0) {
-    value = pow(2, exponent - 31) * (1.0 + mantissa / pow(2, mantissa_len));
+    value = pow(2.0, exponent - 31) * (1.0 + mantissa / pow(2.0, mantissa_len));
   }
   else {
-    value = pow(2, -(30 + mantissa_len)) * mantissa;
+    value = pow(2.0, -(30 + mantissa_len)) * mantissa;
   }
 
   if (sign_flag) {

