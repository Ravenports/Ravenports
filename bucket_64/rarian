# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		rarian
VERSION=		0.8.2
KEYWORDS=		textproc
VARIANTS=		standard
SDESC[standard]=	Documentation metadata library
HOMEPAGE=		https://rarian.freedesktop.org/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		https://gitlab.freedesktop.org/rarian/rarian/-/releases/0.8.2/downloads/assets/
DISTFILE[1]=		rarian-0.8.2.tar.bz2:main
DF_INDEX=		1
SPKGS[standard]=	single

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILDRUN_DEPENDS=	bash:primary:standard
			docbook-xsl:primary:standard
			docbook-xml:single:standard
RUN_DEPENDS=		getopt:single:standard

USES=			gmake libtool python c++:single fbsd10fix
GNOME_COMPONENTS=	libxslt

FPC_EQUIVALENT=		textproc/rarian

MUST_CONFIGURE=		gnu
CONFIGURE_ARGS=		--with-convert-dir={{LOCALBASE}}/share/omf
			--localstatedir=/var

INSTALL_TARGET=		install-strip
PLIST_SUB=		PREFIX={{PREFIX}}

post-patch:
	${REINPLACE_CMD} -e 's|/lib/rarian|/db/rarian|' \
		${WRKSRC}/util/Makefile.in
	${REINPLACE_CMD} -e 's|@localstatedir@/lib/rarian|@localstatedir@/db/rarian|g ; \
		s|getopt|${LOCALBASE}/bin/getopt|' \
		${WRKSRC}/util/rarian-sk-config.in \
		${WRKSRC}/util/rarian-sk-extract.in \
		${WRKSRC}/util/rarian-sk-rebuild.in \
		${WRKSRC}/util/rarian-sk-update.in
	${REINPLACE_CMD} -e 's|/usr/local|${LOCALBASE}|' \
		${WRKSRC}/librarian/rarian-main.c \
		${WRKSRC}/librarian/rarian-man.c \
		${WRKSRC}/librarian/rarian-info.c

post-install:
	${RM} -r ${STAGEDIR}${PREFIX}/share/help

[FILE:522:descriptions/desc.single]
Rarian is designed to be a replacement for scrollkeeper.  It is
currently undergoing heavy development.  As of writing, rarian can be
installed in place of scrollkeeper and everything will work okay.

Rarian manages documentation metadata (as specified by the Open Source
Metadata Framework (OMF) and provides a simple API to allow help browsers
to find, sort, and search the document catalog.  It will also be able to
communicate with catalog servers on the Net to search for documents which
are not on the local system.


[FILE:99:distinfo]
bb296ebfc7116bb3bf6b4852a22a57d991f27a952b57833f5d6c479edddcd8d1       437211 rarian-0.8.2.tar.bz2


[FILE:1155:manifests/plist.single]
bin/
 rarian-example
 rarian-sk-config
 rarian-sk-extract
 rarian-sk-gen-uuid
 rarian-sk-get-cl
 rarian-sk-get-content-list
 rarian-sk-get-extended-content-list
 rarian-sk-get-scripts
 rarian-sk-install
 rarian-sk-migrate
 rarian-sk-preinstall
 rarian-sk-rebuild
 rarian-sk-update
 scrollkeeper-config
 scrollkeeper-extract
 scrollkeeper-gen-seriesid
 scrollkeeper-get-cl
 scrollkeeper-get-content-list
 scrollkeeper-get-extended-content-list
 scrollkeeper-get-index-from-docpath
 scrollkeeper-get-toc-from-docpath
 scrollkeeper-get-toc-from-id
 scrollkeeper-install
 scrollkeeper-preinstall
 scrollkeeper-rebuilddb
 scrollkeeper-uninstall
 scrollkeeper-update
include/rarian/
 rarian-info.h
 rarian-main.h
 rarian-man.h
 rarian-reg-utils.h
 rarian.h
lib/
 librarian.a
 librarian.so
 librarian.so.0
 librarian.so.0.0.0
lib/pkgconfig/rarian.pc
share/librarian/rarian-sk-cl.xml
share/librarian/Templates/C/scrollkeeper_cl.xml
share/librarian/manual/
 help-spec-0.2.xml
 index.xhtml
 rar-lib.xhtml
 rar-mdf.xhtml
 rar-skcompat.xhtml
@dir /var/db/rarian
@postexec %%PREFIX%%/bin/rarian-sk-update || true
@postunexec rmdir /var/db/rarian/* 2>/dev/null || true


[FILE:609:patches/patch-librarian_Makefile.in]
$NetBSD: patch-librarian_Makefile.in,v 1.1 2013/02/23 22:17:02 jperkin Exp $

Don't use -export-symbols-regex, it breaks non-GNU linkers.

--- librarian/Makefile.in.orig	2023-02-22 02:43:51 UTC
+++ librarian/Makefile.in
@@ -404,7 +404,7 @@ librarian_la_SOURCES = rarian.h rarian-h
 	rarian-utils.h rarian-utils.c rarian-info.h rarian-info.c \
 	rarian-man.c rarian-man.h $(am__append_1)
 librarian_la_CFLAGS = -DDATADIR=\""$(datadir)"\" -DSYSCONFDIR=\""$(sysconfdir)"\" -DI_KNOW_RARIAN_0_8_IS_UNSTABLE
-librarian_la_LDFLAGS = -export-symbols-regex "^rrn_.*"
+librarian_la_LDFLAGS =
 all: all-am
 
 .SUFFIXES:


[FILE:327:patches/patch-librarian_rarian-main.c]
--- librarian/rarian-main.c.orig	2023-02-22 02:43:03 UTC
+++ librarian/rarian-main.c
@@ -207,7 +207,7 @@ past:
     path = getenv("XDG_DATA_DIRS");
 
     if (!path || !strcmp(path, "")) {
-        path = "/usr/local/share/:/usr/share/";
+        path = "/usr/local/share/";
     }
     scan_dirs = rrn_str_split(path, ':');
 


[FILE:284:patches/patch-util_rarian-sk-config.in]
--- util/rarian-sk-config.in.orig	2023-02-22 02:43:03 UTC
+++ util/rarian-sk-config.in
@@ -47,7 +47,7 @@ case "$1" in
 		print_help
 		;;
 	--version )
-		echo $package_version \(Rarian replacement for scrollkeeper-config\)
+		echo $package_version
 		;;
 	--prefix )
 		echo $prefix

