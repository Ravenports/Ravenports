# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		smpeg
VERSION=		0.4.5
REVISION=		2
KEYWORDS=		multimedia
VARIANTS=		std
SDESC[std]=		SDL MPEG video/audio player and library
HOMEPAGE=		https://icculus.org/smpeg
CONTACT=		Michael_Reim[kraileth@elderlinux.org]

DOWNLOAD_GROUPS=	main
SITES[main]=		http://ravenports.elderlinux.org/distcache/
			https://leaf.dragonflybsd.org/~marino/orphaned-distfiles/
DISTFILE[1]=		smpeg-0.4.5.tar.xz:main
DF_INDEX=		1
SPKGS[std]=		set
			primary
			dev
			tools
			man

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

EXRUN[tools]=		primary

USES=			autoreconf gmake libtool pkgconfig c++:primary
SDL_COMPONENTS=		sdl1

LICENSE=		LGPL20+:primary
LICENSE_TERMS=		primary:{{WRKDIR}}/TERMS
LICENSE_FILE=		LGPL20+:{{WRKSRC}}/COPYING
LICENSE_AWK=		TERMS:"This is the C interface"
LICENSE_SOURCE=		TERMS:{{WRKSRC}}/smpeg.h
LICENSE_SCHEME=		solo

FPC_EQUIVALENT=		multimedia/smpeg

MUST_CONFIGURE=		gnu
CONFIGURE_ARGS=		--disable-gtk-player
			--disable-opengl-player
			--enable-mmx

SOVERSION=		0.1.4
PLIST_SUB=		PKGVER=0.4

CFLAGS=			-Wno-error=narrowing
VAR_OPSYS[sunos]=	LDFLAGS=-lsocket
			LDFLAGS=-lnsl

post-install:
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/lib/libsmpeg-0.4.so.0.1.4

pre-configure:
	${MV} ${WRKSRC}/configure.in ${WRKSRC}/configure.ac

[FILE:172:descriptions/desc.primary]
Smpeg is an mpeg decoding library, which runs on just about any platform. 
It comes with two sample decoders, plaympeg (console, no UI), and gtv, a 
simple GTK+ interface.


[FILE:44:descriptions/desc.tools]
This package contains the plaympeg program.


[FILE:97:distinfo]
d492e4963c99dc518e65fced1a3f077a45a8532bd066393f7901b1c46cd8b3ff       289708 smpeg-0.4.5.tar.xz


[FILE:79:manifests/plist.primary]
lib/
 libsmpeg-%%PKGVER%%.so.%%SOMAJOR%%
 libsmpeg-%%PKGVER%%.so.%%SOVERSION%%


[FILE:221:manifests/plist.dev]
bin/smpeg-config
include/smpeg/
 MPEG.h
 MPEGaction.h
 MPEGaudio.h
 MPEGerror.h
 MPEGfilter.h
 MPEGlist.h
 MPEGring.h
 MPEGstream.h
 MPEGsystem.h
 MPEGvideo.h
 smpeg.h
lib/
 libsmpeg.a
 libsmpeg.so
share/aclocal/smpeg.m4


[FILE:13:manifests/plist.tools]
bin/plaympeg


[FILE:35:manifests/plist.man]
share/man/man1/
 gtv.1
 plaympeg.1


[FILE:850:patches/patch-configure.in]
--- configure.in.orig	2018-04-22 21:49:56 UTC
+++ configure.in
@@ -58,8 +58,28 @@ AC_LIBTOOL_WIN32_DLL
 AM_PROG_LIBTOOL
 AC_PROG_INSTALL
 
+# Stub for AM_PATH_GTK_2_0 if it's not found in the system library
+m4_ifndef([AM_PATH_GTK_2_0], [
+  AC_DEFUN([AM_PATH_GTK_2_0], [
+    echo "GTK 2.0 macro not found; skipping GTK checks."
+  ])
+])
+
 dnl Work around the lack of certain typedefs.
-AC_TYPE_SOCKLEN_T
+AC_DEFUN(AC_TYPE_SOCKLEN_T,
+[AC_CACHE_CHECK([for socklen_t], ac_cv_type_socklen_t,
+[
+  AC_TRY_COMPILE(
+  [#include <sys/types.h>
+   #include <sys/socket.h>],
+  [socklen_t len = 42; return len;],
+  ac_cv_type_socklen_t=yes,
+  ac_cv_type_socklen_t=no)
+])
+  if test $ac_cv_type_socklen_t != yes; then
+    AC_DEFINE(socklen_t, int)
+  fi
+])
 
 dnl The alpha architecture needs special flags for binary portability
 case "$target" in

