# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		openssh
VERSION=		10.1p1
KEYWORDS=		security
VARIANTS=		std
SDESC[std]=		Portable version of OpenBSD's OpenSSH
HOMEPAGE=		https://www.openssh.com/portable.html
CONTACT=		Michael_Reim[kraileth@elderlinux.org]

DOWNLOAD_GROUPS=	main
SITES[main]=		http://ftp.openbsd.org/pub/OpenBSD/OpenSSH/portable/
DISTFILE[1]=		openssh-10.1p1.tar.gz:main
DF_INDEX=		1
SPKGS[std]=		set
			primary
			man

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILD_DEPENDS=		openpam:dev:std
			libedit:dev:std
BUILDRUN_DEPENDS=	libedit:primary:std
			openpam:primary:std

USES=			cpe autoreconf ncurses ssl zlib

DISTNAME=		openssh-10.1p1

LICENSE=		CUSTOM1:primary
LICENSE_NAME=		CUSTOM1:"OpenSSH BSD-style license"
LICENSE_FILE=		CUSTOM1:{{WRKSRC}}/LICENCE
LICENSE_SCHEME=		solo

CPE_UPDATE=		p1
CPE_VENDOR=		openbsd
CPE_VERSION=		10.1
FPC_EQUIVALENT=		security/openssh-portable

MUST_CONFIGURE=		gnu
CONFIGURE_ARGS=		--with-md5-passwords
			--with-libedit
			--with-pam
			--with-privsep-user=nobody
			--with-xauth={{LOCALBASE}}/bin/xauth
			--with-pid-dir=/var/run
			--with-mantype=man
			--with-ssl-engine
			--disable-utmp
			--disable-wtmp
			--without-stackprotect

VAR_OPSYS[dragonfly]=	CONFIGURE_ARGS=--disable-libutil

post-install:
	${MV} ${STAGEDIR}${PREFIX}/etc/ssh_config \
		${STAGEDIR}${PREFIX}/etc/ssh_config.sample
	${MV} ${STAGEDIR}${PREFIX}/etc/sshd_config \
		${STAGEDIR}${PREFIX}/etc/sshd_config.sample
	${RM} -r ${STAGEDIR}/var

post-patch-sunos:
	${FIND} ${WRKSRC} -name "*.[ch]" | ${XARGS} \
		${GREP} -l u_int64_t | ${XARGS} \
		${REINPLACE_CMD} -e 's|u_int64_t|uint64_t|g'

[FILE:750:descriptions/desc.primary]
Portable version of OpenBSD's OpenSSH utility.

Normal OpenSSH development produces a very small, secure, and easy to 
maintain version for the OpenBSD project. The OpenSSH Portability Team 
takes that pure version and adds portability code so that OpenSSH can run 
on many other operating systems (Unfortunately, in particular since 
OpenSSH does authentication, it runs into a *lot* of differences between 
Unix operating systems).

The portable OpenSSH follows development of the official version, but 
releases are not synchronized. Portable releases are marked with a 'p' 
(e.g. 3.1p1). The official OpenBSD source will never use the 'p' suffix, 
but will instead increment the version number when they hit 'stable spots' 
in their development.


[FILE:100:distinfo]
b9fc7a2b82579467a6f2f43e4a81c8e1dfda614ddb4f9b255aafd7020bbf0758      1972831 openssh-10.1p1.tar.gz


[FILE:242:manifests/plist.primary]
@sample etc/ssh_config.sample
@sample etc/sshd_config.sample
bin/
 scp
 sftp
 ssh
 ssh-add
 ssh-agent
 ssh-keygen
 ssh-keyscan
etc/moduli
libexec/
 sftp-server
 ssh-keysign
 ssh-pkcs11-helper
 ssh-sk-helper
 sshd-auth
 sshd-session
sbin/sshd


[FILE:238:manifests/plist.man]
share/man/man1/
 scp.1
 sftp.1
 ssh-add.1
 ssh-agent.1
 ssh-keygen.1
 ssh-keyscan.1
 ssh.1
share/man/man5/
 moduli.5
 ssh_config.5
 sshd_config.5
share/man/man8/
 sftp-server.8
 ssh-keysign.8
 ssh-pkcs11-helper.8
 ssh-sk-helper.8
 sshd.8


[FILE:361:patches/patch-configure.ac]
--- configure.ac.orig	2025-10-06 02:25:16 UTC
+++ configure.ac
@@ -1846,7 +1846,7 @@ AC_ARG_WITH([libedit],
 			LIBEDIT=`$PKGCONFIG --libs libedit`
 			CPPFLAGS="$CPPFLAGS `$PKGCONFIG --cflags libedit`"
 		else
-			LIBEDIT="-ledit -lcurses"
+			LIBEDIT="-ledit -lncurses"
 		fi
 		OTHERLIBS=`echo $LIBEDIT | sed 's/-ledit//'`
 		AC_CHECK_LIB([edit], [el_init],

