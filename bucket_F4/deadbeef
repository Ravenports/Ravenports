# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		deadbeef
VERSION=		1.8.4
REVISION=		2
KEYWORDS=		audio
VARIANTS=		standard
SDESC[standard]=	Ultimate music player for Unix-like systems
HOMEPAGE=		http://deadbeef.sourceforge.net/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		GITHUB/DeaDBeeF-Player:deadbeef:1.8.4
DISTFILE[1]=		generated:main
DF_INDEX=		1
SPKGS[standard]=	complete
			primary
			nls
			docs

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILD_DEPENDS=		yasm:single:standard
BUILDRUN_DEPENDS=	libmad:single:standard
			jansson:single:standard
			curl:primary:standard
			imlib2:single:standard
			libvorbis:primary:standard
			flac:primary:standard
			libsndfile:primary:standard
			wavpack:primary:standard
			faad2:single:standard
			libsamplerate:primary:standard
			libzip:primary:standard
			ffmpeg4:primary:standard
RUN_DEPENDS=		freepats:single:standard

USES=			autoreconf gmake iconv libtool pkgconfig jpeg
			shebangfix gnome-icons:primary desktop-utils:primary
			gettext-runtime gettext-tools solaris-funcs
GNOME_COMPONENTS=	intltool gtk3

LICENSE=		GPLv2+:primary ZLIB:primary CUSTOM1:primary
			CUSTOM2:primary
LICENSE_TERMS=		primary:{{WRKSRC}}/plugins/notify/COPYING
LICENSE_NAME=		CUSTOM1:"Various BSD licenses and copyrights"
			CUSTOM2:"All plugin licenses and copyrights"
LICENSE_FILE=		GPLv2+:{{WRKSRC}}/COPYING.GPLv2
			CUSTOM1:{{WRKSRC}}/COPYING
			CUSTOM2:{{WRKDIR}}/LICENSE_PLUGINS
			ZLIB:{{WRKDIR}}/LICENSE_ZLIB
LICENSE_AWK=		ZLIB:"__DEADBEEF_H"
LICENSE_SOURCE=		ZLIB:{{WRKSRC}}/deadbeef.h
LICENSE_SCHEME=		multi

FPC_EQUIVALENT=		audio/deadbeef
SHEBANG_FILES=		yasmwrapper.sh
SOL_FUNCTIONS=		strcasestr:plugins/artwork/artwork.c
			strcasestr:plugins/artwork-legacy/artwork.c
			strcasestr:junklib.c

MUST_CONFIGURE=		gnu
CONFIGURE_ARGS=		--disable-alsa
			--disable-nullout
			--disable-static
			--disable-cdda
			--disable-gtk2
			--enable-gtk3

INSTALL_TARGET=		install-strip

CPPFLAGS=		-I../dumb/dumb-kode54/include
			-I../../plugins/libmp4ff
			-I../../plugins/gme/game-music-emu-0.6pre
			-I./sidplay-libs/libsidplay/include/sidplay

post-patch:
	# Do not link to libsupc++ which may be PIC-unsafe (breaks 64-bit arches)
	# ${REINPLACE_CMD} -e 's, -lsupc++,,' \
	#	${WRKSRC}/plugins/adplug/Makefile.in \
	#	${WRKSRC}/plugins/gme/Makefile.in \
	#	${WRKSRC}/plugins/sid/Makefile.in \
	#	${WRKSRC}/plugins/supereq/Makefile.in
	${REINPLACE_CMD} -e 's,/etc/timidity++/timidity-freepats.cfg:/etc/timidity/freepats.cfg:/etc/timidity/,${LOCALBASE}/share/,' \
		${WRKSRC}/plugins/wildmidi/wildmidiplug.c
	# ${REINPLACE_CMD} \
	#	-e '/HAVE_OGG" = "yes"/ {n; n; /HAVE_VORBISPLUGIN=yes/d;}' \
	#	${WRKSRC}/configure
	# Fix build with libzip-1.0
	${REINPLACE_CMD} 's,zip_file_t,zip_file_DB,g' \
		${WRKSRC}/plugins/vfs_zip/vfs_zip.c

post-install:
	# remove duplicate licenses
	${RM} ${STAGEDIR}${STD_DOCDIR}/COPYING*

pre-configure:
	(cd ${WRKSRC} && ${SH} ${WRKSRC}/autogen.sh)

post-extract:
	(cd ${WRKSRC} && ${HEAD} -n 100 plugins/*/COPYING \
		> ${WRKDIR}/LICENSE_PLUGINS)
	# Fix libintl linking
	${REINPLACE_CMD} -e 's/INTL_LIBS/INTLLIBS/' ${WRKSRC}/Makefile.am
	# Another intl fix for autoconf 2.70
	${REINPLACE_CMD} -e 's|@USE_INCLUDED_LIBINTL@|no|g' \
		-e 's|@BUILD_INCLUDED_LIBINTL@|no|g' \
		${WRKSRC}/intl/Makefile.in

[FILE:1728:descriptions/desc.primary]
DeaDBeeF (as in 0xDEADBEEF) is an audio player.

Main features:
 * mp3, ogg vorbis, flac, ape, wv/iso.wv, wav, m4a/mp3 (aac and alac),
   mpc, tta, cd audio, and many more
 * nsf, ay, vtx, vgm/vgz, spc and many other popular chiptune formats
 * SID with HVSC song length database support for sid
 * tracker modules - mod, s3m, it, xm, etc
 * ID3v1, ID3v2.2, ID3v2.3, ID3v2.4, APEv2, Xing/Info, VorbisComments tag
   reading and writing, as well as reading many other tag/metadata formats
   in most supported formats
 * automatic character set detection for non-unicode id3 tags - supports
   cp1251, iso8859-1, and now chinese cp936 (optional), as well as
   SHIFT-JIS and MS-DOS CP866 for selected formats
 * unicode tags are fully supported as well (both utf8 and ucs2)
 * cuesheet (.cue files) support, including charset detection/conversion
 * clean fast GUI using GTK2 and GTK3, you pick what you like more!
 * no GNOME or KDE dependencies
 * minimization to system tray, with scrollwheel volume control, etc
   drag and drop, both in playlist, and from other apps
 * control playback from command line
 * global hotkeys
 * multiple playlists using tabbed interface
 * album cover display
 * OSD notifications about current playing songs
 * 18-band graphical equalizer and other DSP plugins
 * built-in high quality tag editor, with custom fields support
 * customizable groups in playlists
 * customizable columns with flexible title formatting
 * streaming radio support for ogg vorbis, mp3 and aac streams
 * gapless playback for correctly encoded files
 * lots of plugin, such as global hotkeys, last.fm scrobbler, converter
 * comes with advanced Converter plugin, which allows to transcode files
   to other formats


[FILE:116:distinfo]
f5329f13ee259d4a48b3410a336e0c45a5dc51eb948a4103884436d31ba565ca     13049446 DeaDBeeF-Player-deadbeef-1.8.4.tar.gz


[FILE:3163:manifests/plist.primary]
%%ONLY-DRAGONFLY%%lib/deadbeef/oss.so
%%ONLY-FREEBSD%%lib/deadbeef/oss.so
%%ONLY-LINUX%%lib/deadbeef/oss.so
%%ONLY-NETBSD%%lib/deadbeef/oss.so
bin/deadbeef
include/deadbeef/
 artwork.h
 deadbeef.h
 gtkui_api.h
lib/deadbeef/
 aac.so
 adplug.so
 alac.so
 artwork.so
 converter.so
 converter_gtk3.so
 dca.so
 ddb_dumb.so
 ddb_gui_GTK3.so
 ddb_mono2stereo.so
 ddb_shn.so
 ddb_soundtouch.so
 dsp_libsrc.so
 ffap.so
 ffmpeg.so
 flac.so
 gme.so
 hotkeys.so
 in_sc68.so
 lastfm.so
 m3u.so
 mms.so
 mp3.so
 musepack.so
 notify.so
 pltbrowser_gtk3.so
 psf.so
 rg_scanner.so
 shellexec.so
 shellexecui_gtk3.so
 sid.so
 sndfile.so
 supereq.so
 tta.so
 vfs_curl.so
 vfs_zip.so
 vorbis.so
 vtx.so
 wavpack.so
 wildmidi.so
 wma.so
lib/deadbeef/convpresets/
 AAC_VBR_192Kbps_(Nero_FAAC).txt
 AAC_VBR_256Kbps_(Nero_FAAC).txt
 AAC_VBR_320Kbps_(Nero_FAAC).txt
 ALAC.txt
 FLAC_(compression_level_5).txt
 File_Copy.txt
 File_Move.txt
 MP3_CBR_320_Kbps_(Lame).txt
 MP3_VBR_192Kbps_(Lame).txt
 MS_RIFF_WAV.txt
 MusePack.txt
 Ogg_FLAC.txt
 Ogg_VBR_192Kbps.txt
 Ogg_VBR_256Kbps.txt
 Ogg_VBR_320Kbps.txt
 Opus.txt
 TTA.txt
 WavPack.txt
lib/deadbeef/data68/Replay/
 aenigmatica.bin
 alteredbeast.bin
 armalyte.bin
 asidifier.bin
 azidifier.bin
 bendaglish.deli.bin
 big.bin
 blipblop.bin
 blipp079.bin
 bs22.bin
 cabal.bin
 chipmon2.bin
 cosotfmx.bin
 crapman1.bin
 crapman2.bin
 deltamusic1.bin
 deltamusic2.bin
 digitfmx.bin
 dmu.bin
 dwaga.bin
 dyter07.bin
 elf.bin
 fc13_14.bin
 fireice.bin
 fred.bin
 gemx.bin
 harlequin.bin
 hippel-coso_note.deli.bin
 hpn-jam.bin
 huelsbeck.bin
 huntforredoct.bin
 ivanhoe.bin
 jamcracker10.bin
 jamcrackerpro.bin
 lastninja3.bin
 lastninjaiii.bin
 lcd.bin
 lx_mmme.bin
 mcoder.bin
 megatizer.bin
 metrocross.bin
 midi.bin
 mmme.bin
 mmmesid.bin
 mon.bin
 mon_old.deli.bin
 musmon1.bin
 musmon2.bin
 ninjaremix.bin
 ninjatfmx.bin
 nobuddiesland.bin
 none.bin
 note.bin
 note2.bin
 page.bin
 protracker.bin
 psg1.bin
 psgtrackerv2.bin
 puma.bin
 puma2.bin
 quartet.bin
 quartet_mindbomb.bin
 realms.bin
 robhubbard.deli.bin
 rollingronny.bin
 shadowdancer.bin
 sidmon1.bin
 sidmon2.bin
 sidsound.bin
 sndh_ice.bin
 soundfx.bin
 spacecrusade.bin
 spacegun.bin
 ssd1.bin
 stos.bin
 synthiv.bin
 tao_digi.bin
 tao_hubbard.bin
 tao_ms211.bin
 tao_ms25.bin
 tao_ms27.bin
 tao_tsd.bin
 tcbtracker.bin
 test.bin
 tfmx.bin
 tfmx_aga.bin
 tfmx_old.bin
 tfmx_st.bin
 timerc.bin
 toki.bin
 tsd1.bin
 utopia.bin
 vikingchild.bin
 xbiossound.bin
 zonewarrior.bin
share/applications/deadbeef.desktop
share/deadbeef/pixmaps/
 buffering_16.png
 noartwork.png
 pause_16.png
 play_16.png
share/icons/hicolor/128x128/apps/deadbeef.png
share/icons/hicolor/16x16/apps/deadbeef.png
share/icons/hicolor/192x192/apps/deadbeef.png
share/icons/hicolor/22x22/apps/deadbeef.png
share/icons/hicolor/24x24/apps/deadbeef.png
share/icons/hicolor/256x256/apps/deadbeef.png
share/icons/hicolor/32x32/apps/deadbeef.png
share/icons/hicolor/36x36/apps/deadbeef.png
share/icons/hicolor/48x48/apps/deadbeef.png
share/icons/hicolor/64x64/apps/deadbeef.png
share/icons/hicolor/72x72/apps/deadbeef.png
share/icons/hicolor/96x96/apps/deadbeef.png
share/icons/hicolor/scalable/apps/deadbeef.svg


[FILE:1901:manifests/plist.nls]
share/locale/be/LC_MESSAGES/deadbeef.mo
share/locale/bg/LC_MESSAGES/deadbeef.mo
share/locale/bn/LC_MESSAGES/deadbeef.mo
share/locale/ca/LC_MESSAGES/deadbeef.mo
share/locale/cs/LC_MESSAGES/deadbeef.mo
share/locale/da/LC_MESSAGES/deadbeef.mo
share/locale/de/LC_MESSAGES/deadbeef.mo
share/locale/el/LC_MESSAGES/deadbeef.mo
share/locale/en_GB/LC_MESSAGES/deadbeef.mo
share/locale/es/LC_MESSAGES/deadbeef.mo
share/locale/et/LC_MESSAGES/deadbeef.mo
share/locale/eu/LC_MESSAGES/deadbeef.mo
share/locale/fa/LC_MESSAGES/deadbeef.mo
share/locale/fi/LC_MESSAGES/deadbeef.mo
share/locale/fr/LC_MESSAGES/deadbeef.mo
share/locale/gl/LC_MESSAGES/deadbeef.mo
share/locale/he/LC_MESSAGES/deadbeef.mo
share/locale/hr/LC_MESSAGES/deadbeef.mo
share/locale/hu/LC_MESSAGES/deadbeef.mo
share/locale/id/LC_MESSAGES/deadbeef.mo
share/locale/it/LC_MESSAGES/deadbeef.mo
share/locale/ja/LC_MESSAGES/deadbeef.mo
share/locale/kk/LC_MESSAGES/deadbeef.mo
share/locale/km/LC_MESSAGES/deadbeef.mo
share/locale/lg/LC_MESSAGES/deadbeef.mo
share/locale/lt/LC_MESSAGES/deadbeef.mo
share/locale/lv/LC_MESSAGES/deadbeef.mo
share/locale/nb/LC_MESSAGES/deadbeef.mo
share/locale/nl/LC_MESSAGES/deadbeef.mo
share/locale/pl/LC_MESSAGES/deadbeef.mo
share/locale/pt/LC_MESSAGES/deadbeef.mo
share/locale/pt_BR/LC_MESSAGES/deadbeef.mo
share/locale/ro/LC_MESSAGES/deadbeef.mo
share/locale/ru/LC_MESSAGES/deadbeef.mo
share/locale/si_LK/LC_MESSAGES/deadbeef.mo
share/locale/sk/LC_MESSAGES/deadbeef.mo
share/locale/sl/LC_MESSAGES/deadbeef.mo
share/locale/sr/LC_MESSAGES/deadbeef.mo
share/locale/sr@latin/LC_MESSAGES/deadbeef.mo
share/locale/sv/LC_MESSAGES/deadbeef.mo
share/locale/te/LC_MESSAGES/deadbeef.mo
share/locale/tr/LC_MESSAGES/deadbeef.mo
share/locale/ug/LC_MESSAGES/deadbeef.mo
share/locale/uk/LC_MESSAGES/deadbeef.mo
share/locale/vi/LC_MESSAGES/deadbeef.mo
share/locale/zh_CN/LC_MESSAGES/deadbeef.mo
share/locale/zh_TW/LC_MESSAGES/deadbeef.mo


[FILE:90:manifests/plist.docs]
share/doc/deadbeef/
 ChangeLog
 README
 about.txt
 help.ru.txt
 help.txt
 translators.txt


[FILE:286:patches/patch-configure.ac]
--- configure.ac.orig	2020-06-28 13:41:28 UTC
+++ configure.ac
@@ -16,7 +16,8 @@ AC_PROG_INSTALL
 dnl AC_PROG_LIBTOOL
 AC_CONFIG_MACRO_DIR([m4])
 AC_C_BIGENDIAN
-AM_GNU_GETTEXT
+AM_GNU_GETTEXT_VERSION([0.18.3])
+AM_GNU_GETTEXT([external])
 PKG_PROG_PKG_CONFIG
 AM_PROG_CC_C_O
 AM_ICONV


[FILE:208:patches/patch-junklib.c]
--- junklib.c.orig	2020-06-28 13:41:28 UTC
+++ junklib.c
@@ -33,7 +33,6 @@
 #include <string.h>
 #if HAVE_ICONV
   #ifndef __MINGW32__
-  #define LIBICONV_PLUG
   #endif
   #include <iconv.h>
 #elif HAVE_ICU


[FILE:322:patches/patch-plugins_artwork-legacy_artwork.c]
--- plugins/artwork-legacy/artwork.c.orig	2020-06-28 13:41:28 UTC
+++ plugins/artwork-legacy/artwork.c
@@ -65,6 +65,10 @@
 //#define trace(...) { fprintf (stderr, __VA_ARGS__); }
 #define trace(...)
 
+#ifndef NAME_MAX
+# define NAME_MAX PATH_MAX
+#endif
+
 DB_functions_t *deadbeef;
 static DB_artwork_plugin_t plugin;
 


[FILE:322:patches/patch-plugins_artwork_artwork.c]
--- plugins/artwork/artwork.c.orig	2020-06-28 13:41:28 UTC
+++ plugins/artwork/artwork.c
@@ -72,6 +72,10 @@
 
 #define trace(...) { deadbeef->log_detailed (&plugin.plugin.plugin, 0, __VA_ARGS__); }
 
+#ifndef NAME_MAX
+# define NAME_MAX PATH_MAX
+#endif
+
 DB_functions_t *deadbeef;
 static ddb_artwork_plugin_t plugin;
 


[FILE:1056:patches/patch-plugins_gme_game-music-emu-0.6pre_gme_blargg__endian.h]
--- plugins/gme/game-music-emu-0.6pre/gme/blargg_endian.h.orig	2020-06-28 13:41:28 UTC
+++ plugins/gme/game-music-emu-0.6pre/gme/blargg_endian.h
@@ -23,7 +23,11 @@
 #if !defined (BLARGG_BIG_ENDIAN) && !defined (BLARGG_LITTLE_ENDIAN)
 #if defined(__BYTE_ORDER) && defined(__LITTLE_ENDIAN) && defined(__BIG_ENDIAN)
 	// GCC handles this for us
+#if defined (__DragonFly__)
+	#include <sys/endian.h>
+#else
 	#include <endian.h>
+#endif
 	#if __BYTE_ORDER == __LITTLE_ENDIAN
 		#define BLARGG_LITTLE_ENDIAN 1
 	#elif __BYTE_ORDER == __BIG_ENDIAN
@@ -34,9 +38,7 @@
 #if defined (LSB_FIRST) || defined (__LITTLE_ENDIAN__) || BLARGG_CPU_X86 || \
 		(defined (LITTLE_ENDIAN) && LITTLE_ENDIAN+0 != 1234)
 	#define BLARGG_LITTLE_ENDIAN 1
-#endif
-
-#if defined (MSB_FIRST)     || defined (__BIG_ENDIAN__) || defined (WORDS_BIGENDIAN) || \
+#elif defined (MSB_FIRST)     || defined (__BIG_ENDIAN__) || defined (WORDS_BIGENDIAN) || \
 	defined (__sparc__)     ||  BLARGG_CPU_POWERPC || \
 	(defined (BIG_ENDIAN) && BIG_ENDIAN+0 != 4321)
 	#define BLARGG_BIG_ENDIAN 1


[FILE:744:patches/patch-plugins_sc68_libsc68_dial68_dial__conf.c]
--- plugins/sc68/libsc68/dial68/dial_conf.c.orig	2020-06-28 13:41:28 UTC
+++ plugins/sc68/libsc68/dial68/dial_conf.c
@@ -70,7 +70,7 @@ static inline void del_dial(dial_t * dia
  * @retval  1  on unkown/unset key
  * @retval -1  on error
  */
-static int getopt(const char * key, int op, sc68_dialval_t * val)
+static int dead_getopt(const char * key, int op, sc68_dialval_t * val)
 {
   option68_t * opt = option68_get(key, opt68_ALWAYS);
   const int org = opt68_CFG;
@@ -260,7 +260,7 @@ static int conf(void * data, const char
     if (op == SC68_DIAL_SETI && keyis("sampling-rate")
         && val->i > 0 && val->i < sprmax)
       val->i = i_spr[val->i];
-    res = getopt(key, op, val);
+    res = dead_getopt(key, op, val);
   }
 
 exit:


[FILE:380:patches/patch-strdupa.h]
--- strdupa.h.orig	2020-06-28 13:41:28 UTC
+++ strdupa.h
@@ -31,7 +31,7 @@
     ({									      \
       const char *old = (s);					      \
       size_t len = strlen (old) + 1;				      \
-      char *newstr = (char *) alloca (len);			      \
+      char *newstr = (char *) __builtin_alloca (len);			      \
       (char *) memcpy (newstr, old, len);				      \
     })
 #endif

