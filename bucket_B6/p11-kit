# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		p11-kit
VERSION=		0.23.8
KEYWORDS=		security devel
VARIANTS=		standard
SDESC[standard]=	Library for loading and sharing PKCS#11 modules
HOMEPAGE=		https://p11-glue.freedesktop.org/p11-kit.html
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		https://github.com/p11-glue/p11-kit/releases/download/0.23.8/
DISTFILE[1]=		p11-kit-0.23.8.tar.gz:main
DF_INDEX=		1
SPKGS[standard]=	complete
			primary
			docs
			examples

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILDRUN_DEPENDS=	nss:caroot:standard
			libtasn1:primary:standard
			libffi:single:standard

USES=			gmake libtool pkgconfig

LICENSE=		BSD3CLAUSE:primary
LICENSE_SCHEME=		solo
LICENSE_FILE=		BSD3CLAUSE:{{WRKSRC}}/COPYING

FPC_EQUIVALENT=		security/p11-kit

MUST_CONFIGURE=		gnu
CONFIGURE_ARGS=		--disable-nls
			--enable-debug=no
			--with-trust-paths={{LOCALBASE}}/share/certs/ca-root-nss.crt

INSTALL_TARGET=		install-strip

post-install:
	@${MKDIR} ${STAGEDIR}${PREFIX}/share/doc
	${MV} ${STAGEDIR}${PREFIX}/share/gtk-doc/html/p11-kit \
		${STAGEDIR}${STD_DOCDIR}
	${RM} -r ${STAGEDIR}${PREFIX}/share/gtk-doc

pre-configure:
	@${REINPLACE_CMD} -e \
	's|exampledir = $$(p11_system_config)|exampledir = ${STD_EXAMPLESDIR}|' \
	${WRKSRC}/Makefile.in

[FILE:290:descriptions/desc.primary]
Provides a way to load and enumerate PKCS#11 modules. Provides a
standard configuration setup for installing PKCS#11 modules in
such a way that they're discoverable.

Also solves problems with coordinating the use of PKCS#11 by
different components or libraries living in the same process.


[FILE:100:distinfo]
4ba134e5fe4b62bcaf7a2d66841767d9d23e875b977bba6939367a9f400b133f      1090814 p11-kit-0.23.8.tar.gz


[FILE:392:manifests/plist.primary]
bin/
 p11-kit
 trust
include/p11-kit-1/p11-kit/
 deprecated.h
 iter.h
 p11-kit.h
 pin.h
 pkcs11.h
 pkcs11x.h
 remote.h
 uri.h
lib/
 libp11-kit.so
 libp11-kit.so.0
 libp11-kit.so.0.3.0
 p11-kit-proxy.so
lib/pkcs11/
 p11-kit-client.so
 p11-kit-trust.so
lib/pkgconfig/p11-kit-1.pc
libexec/p11-kit/
 p11-kit-remote
 p11-kit-server
 trust-extract-compat
share/p11-kit/modules/p11-kit-trust.module


[FILE:701:manifests/plist.docs]
share/doc/p11-kit/
 config-example.html
 config-files.html
 config.html
 devel-building-style.html
 devel-building.html
 devel-commands.html
 devel-debugging.html
 devel-paths.html
 devel-testing.html
 devel.html
 gtk-doc.css
 home.png
 index.html
 left-insensitive.png
 left.png
 p11-kit-Deprecated.html
 p11-kit-Future.html
 p11-kit-Modules.html
 p11-kit-PIN-Callbacks.html
 p11-kit-URIs.html
 p11-kit-Utilities.html
 p11-kit.devhelp2
 p11-kit.html
 pkcs11-conf.html
 reference.html
 right-insensitive.png
 right.png
 sharing-managed.html
 sharing.html
 style.css
 tools.html
 trust-disable.html
 trust-glib-networking.html
 trust-module.html
 trust-nss.html
 trust.html
 up-insensitive.png
 up.png


[FILE:43:manifests/plist.examples]
share/examples/p11-kit/pkcs11.conf.example


[FILE:198:patches/patch-common_compat.c]
--- common/compat.c.orig	2017-08-26 16:30:23 UTC
+++ common/compat.c
@@ -51,6 +51,7 @@
 #include <dirent.h>
 #include <errno.h>
 #include <stdlib.h>
+#include <stdint.h>
 #include <string.h>
 
 /*-


[FILE:348:patches/patch-common_debug.h]
--- common/debug.h.orig	2017-06-16 14:55:26 UTC
+++ common/debug.h
@@ -144,6 +144,10 @@ void              p11_debug_precond             (const
 
 #else /* !defined (WITH_DEBUG) */
 
+#undef p11_debug
+#define p11_debug(format, ...) \
+	do {} while (false)
+
 #undef p11_debug_err
 #define p11_debug_err(errnum, format, ...) \
 	do {} while (false)

