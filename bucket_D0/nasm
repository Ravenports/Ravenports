# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		nasm
VERSION=		3.01
REVISION=		1
KEYWORDS=		devel lang
VARIANTS=		std
SDESC[std]=		General-purpose x86 and amd64 assembler
HOMEPAGE=		https://www.nasm.us/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		https://www.nasm.us/pub/nasm/releasebuilds/3.01/
			https://mirror.sobukus.de/files/src/nasm/
DISTFILE[1]=		nasm-3.01.tar.xz:main
DISTFILE[2]=		nasm-3.01-xdoc.tar.xz:main
DF_INDEX=		1 2
SPKGS[std]=		set
			primary
			man
			docs

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILD_DEPENDS=		perl-Font-TTF:single:perl_used
			perl-IO-String:single:perl_used

USES=			cpe gmake perl:build

LICENSE=		BSD2CLAUSE:primary
LICENSE_FILE=		BSD2CLAUSE:{{WRKSRC}}/LICENSE
LICENSE_SCHEME=		solo

CPE_PRODUCT=		netwide_assembler
CPE_VENDOR=		nasm
FPC_EQUIVALENT=		devel/nasm

MUST_CONFIGURE=		gnu
CONFIGURE_ARGS=		--docdir="{{STD_DOCDIR}}"
CONFIGURE_ENV=		pa_cv_CFLAGS__std_c23=no

MAKE_ARGS=		INSTALLROOT={{STAGEDIR}}

INSTALL_TARGET=		install install_doc

post-patch:
	# fix gmake on macos
	${REINPLACE_CMD} -e 's|[$$][(]A[)]|a|g' ${WRKSRC}/Makefile.in

post-install:
	${MKDIR} ${STAGEDIR}${STD_DOCDIR}
	(cd ${WRKSRC}/doc && ${COPYTREE_SHARE} html ${STAGEDIR}${STD_DOCDIR})
	${INSTALL_DATA} ${WRKSRC}/doc/nasmdoc.txt ${STAGEDIR}${STD_DOCDIR}

[FILE:691:descriptions/desc.primary]
The Netwide Assembler (NASM) is an x86 and amd64 (x86-64) assembler
designed for portability and modularity.  It will output flat-form binary
files, a.out (Linux and *BSD), COFF, ELF32, ELF64, Mach-O, Microsoft OMF
(OBJ), Win32, Win64, as86 (Minix/Linux bin86 v0.3), LADsoft IEEE-695,
Intel hex, Motorola S-record, and a home-grown format called RDOFF.  NASM
syntax is similar to Intel's, but is less complex.  It supports Pentium,
P6, MMX, 3DNow!, SSE, SSE2, SSE3, SSE4.1, SSE4.2, XOP/FMA4/CVT16
(rev 3.03), and x64 opcodes, among others.  It has strong support for
macro conventions.

The port also includes NDISASM, a binary file disassembler which uses the
same instruction set as NASM.


[FILE:195:distinfo]
b7324cbe86e767b65f26f467ed8b12ad80e124e3ccb89076855c98e43a9eddd4      1499136 nasm-3.01.tar.xz
47762f066c032306cd0723b438ffd9862aad2729225433cc9fcd5e21cf10f114       957556 nasm-3.01-xdoc.tar.xz


[FILE:20:manifests/plist.primary]
bin/
 nasm
 ndisasm


[FILE:35:manifests/plist.man]
share/man/man1/
 nasm.1
 ndisasm.1


[FILE:387:manifests/plist.docs]
share/doc/nasm/
 nasmdoc.pdf
 nasmdoc.txt
share/doc/nasm/html/
 local.css
 nasm00.html
 nasm01.html
 nasm02.html
 nasm03.html
 nasm04.html
 nasm05.html
 nasm06.html
 nasm07.html
 nasm08.html
 nasm09.html
 nasm10.html
 nasm11.html
 nasm12.html
 nasm13.html
 nasm14.html
 nasmaa.html
 nasmab.html
 nasmac.html
 nasmad.html
 nasmae.html
 nasmaf.html
 nasmdoc.css
 nasmix.html
 nasmlogw.png


[FILE:494:patches/patch-doc_Makefile.in]
--- doc/Makefile.in.orig	2025-10-11 06:44:05 UTC
+++ doc/Makefile.in
@@ -42,7 +42,7 @@ MKDIR_P		= @MKDIR_P@
 RM_F		= rm -f
 RM_RF		= rm -rf
 CP_F		= cp -f
-CP_UF		= cp -uf
+CP_UF		= cp -f
 
 # Optional tools
 XZ		= @XZ@
@@ -62,7 +62,7 @@ SRCS		= nasmdoc.src
 # All input files (except auto-dependencies)
 ALLSRCS		= $(SRCS) $(GENSRC)
 
-OUT		= html nasmdoc.txt nasmdoc.pdf $(XZFILES)
+OUT		= html nasmdoc.txt
 XZOUT           = nasmdoc.pdf.xz
 
 # Use "make install PDFZ=.xz" to install pdf.xz


[FILE:754:patches/patch-include_compiler.h]
--- include/compiler.h.orig	2025-10-11 06:44:05 UTC
+++ include/compiler.h
@@ -93,6 +93,14 @@
 #define PRIzx PRIz "x"
 #define PRIzX PRIz "X"
 
+# ifdef HAVE_ENDIAN_H
+#  include <endian.h>
+# elif defined(HAVE_SYS_ENDIAN_H)
+#  include <sys/endian.h>
+# elif defined(HAVE_MACHINE_ENDIAN_H)
+#  include <machine/endian.h>
+# endif
+
 #ifdef HAVE_STDBIT_H
 
 # include <stdbit.h>
@@ -107,14 +115,6 @@
 
 #else  /* No <stdbit.h> */
 
-# ifdef HAVE_ENDIAN_H
-#  include <endian.h>
-# elif defined(HAVE_SYS_ENDIAN_H)
-#  include <sys/endian.h>
-# elif defined(HAVE_MACHINE_ENDIAN_H)
-#  include <machine/endian.h>
-# endif
-
 /*
  * If we have BYTE_ORDER defined, or the compiler provides
  * __BIG_ENDIAN__ or __LITTLE_ENDIAN__, trust it over what autoconf

