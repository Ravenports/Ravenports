# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		xmlsec
VERSION=		1.2.27
KEYWORDS=		security
VARIANTS=		standard
SDESC[standard]=	XML Security Library
HOMEPAGE=		https://www.aleksey.com/xmlsec/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		https://www.aleksey.com/xmlsec/download/
DISTFILE[1]=		xmlsec1-1.2.27.tar.gz:main
DF_INDEX=		1
SPKGS[standard]=	complete
			primary
			docs

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILDRUN_DEPENDS=	libgcrypt:single:standard
			libgpg-error:single:standard
			libltdl:single:standard
			gnutls:single:standard
			nspr:single:standard
			nss:primary:standard

USES=			gmake libtool pkgconfig ssl
GNOME_COMPONENTS=	libxslt

DISTNAME=		xmlsec1-1.2.27

LICENSE=		MIT:primary
LICENSE_FILE=		MIT:{{WRKSRC}}/Copyright
LICENSE_SCHEME=		solo

FPC_EQUIVALENT=		security/xmlsec1

MUST_CONFIGURE=		gnu
CONFIGURE_ARGS=		--with-openssl="{{OPENSSLBASE}}"
			--with-gcrypt="{{LOCALBASE}}"
			--with-gnutls="{{LOCALBASE}}"
			--with-nspr="{{LOCALBASE}}"
			--with-nss="{{LOCALBASE}}"
			--enable-soap
			--disable-docs-build
CONFIGURE_ENV=		NSS_CFLAGS="-I{{LOCALBASE}}/include/nss/nss"

MAKE_ARGS=		confexecdir="{{LOCALBASE}}/etc"
MAKE_ENV=		ABS_BUILDDIR="{{WRKSRC}}"
			TMPFOLDER="{{WRKDIR}}"

INSTALL_TARGET=		install-strip
INSTALL_REQ_TOOLCHAIN=	yes
SOVERSION=		1.2.27

LDFLAGS=		-L{{LOCALBASE}}/lib/nss
			-Wl,-rpath,{{LOCALBASE}}/lib/nss

post-patch:
	${REINPLACE_CMD} \
		-e 's/mozilla-nss/nss/' \
		-e 's/mozilla-nspr/nspr/' \
		-e '/^GNUTLS_FOUND/s/no/yes/' \
		-e '/^GNUTLS_LIBS=/s,"","-L${LOCALBASE}/lib -lgnutls",' \
		${WRKSRC}/configure
	${REINPLACE_CMD} -e 's/(CP) -ru/(CP) -r/' -e 's/(CP) -u/(CP)/' \
		${WRKSRC}/docs/Makefile.am ${WRKSRC}/docs/Makefile.in \
		${WRKSRC}/docs/api/Makefile.am ${WRKSRC}/docs/api/Makefile.in \
		${WRKSRC}/man/Makefile.am ${WRKSRC}/man/Makefile.in
	# Making the xmlsec1 executable multi-threaded to let load -lnss when needed
	${REINPLACE_CMD} -e 's,^\(xmlsec1_LDADD = \)\\$$,\1 -L${LOCALBASE}/lib -lpthread\\,' \
		${WRKSRC}/apps/Makefile.in

[FILE:303:descriptions/desc.primary]
XML Security Library is the latest stable of a C library based on
LibXML2 and OpenSSL. The library was created with a goal to support
major XML security standards:
   - XML Signature
   - XML Encryption
   - Canonical XML (was included in libxml2)
   - Exclusive Canonical XML (was included in libxml2)


[FILE:100:distinfo]
97d756bad8e92588e6997d2227797eaa900d05e34a426829b149f65d87118eb6      2013651 xmlsec1-1.2.27.tar.gz


[FILE:1403:manifests/plist.primary]
bin/
 xmlsec1
 xmlsec1-config
etc/xmlsec1Conf.sh
include/xmlsec1/xmlsec/
 app.h
 base64.h
 bn.h
 buffer.h
 crypto.h
 dl.h
 errors.h
 exports.h
 io.h
 keyinfo.h
 keys.h
 keysdata.h
 keysmngr.h
 list.h
 membuf.h
 nodeset.h
 parser.h
 private.h
 soap.h
 strings.h
 templates.h
 transforms.h
 version.h
 x509.h
 xmldsig.h
 xmlenc.h
 xmlsec.h
 xmltree.h
include/xmlsec1/xmlsec/gcrypt/
 app.h
 crypto.h
 symbols.h
include/xmlsec1/xmlsec/gnutls/
 app.h
 crypto.h
 symbols.h
 x509.h
include/xmlsec1/xmlsec/nss/
 app.h
 bignum.h
 crypto.h
 keysstore.h
 pkikeys.h
 symbols.h
 x509.h
include/xmlsec1/xmlsec/openssl/
 app.h
 bn.h
 crypto.h
 evp.h
 symbols.h
 x509.h
include/xmlsec1/xmlsec/private/xslt.h
lib/
 libxmlsec1-gcrypt.a
 libxmlsec1-gcrypt.so
 libxmlsec1-gcrypt.so.%%SOMAJOR%%
 libxmlsec1-gcrypt.so.%%SOVERSION%%
 libxmlsec1-gnutls.a
 libxmlsec1-gnutls.so
 libxmlsec1-gnutls.so.%%SOMAJOR%%
 libxmlsec1-gnutls.so.%%SOVERSION%%
 libxmlsec1-nss.a
 libxmlsec1-nss.so
 libxmlsec1-nss.so.%%SOMAJOR%%
 libxmlsec1-nss.so.%%SOVERSION%%
 libxmlsec1-openssl.a
 libxmlsec1-openssl.so
 libxmlsec1-openssl.so.%%SOMAJOR%%
 libxmlsec1-openssl.so.%%SOVERSION%%
 libxmlsec1.a
 libxmlsec1.so
 libxmlsec1.so.%%SOMAJOR%%
 libxmlsec1.so.%%SOVERSION%%
lib/pkgconfig/
 xmlsec1-gcrypt.pc
 xmlsec1-gnutls.pc
 xmlsec1-nss.pc
 xmlsec1-openssl.pc
 xmlsec1.pc
share/aclocal/xmlsec1.m4
share/man/man1/
 xmlsec1-config.1.gz
 xmlsec1.1.gz


[FILE:400:patches/patch-configure]
--- configure.orig	2018-06-09 02:03:23 UTC
+++ configure
@@ -14962,8 +14962,8 @@ NSS_PACKAGE=nss
 NSPR_INCLUDE_MARKER="nspr/nspr.h"
 NSPR_LIB_MARKER="libnspr4$shrext"
 NSPR_LIBS_LIST="-lnspr4 -lplds4 -lplc4"
-NSS_INCLUDE_MARKER="nss/nss.h"
-NSS_LIB_MARKER="libnss3$shrext"
+NSS_INCLUDE_MARKER="nss/nss/nss.h"
+NSS_LIB_MARKER="nss/libnss3$shrext"
 NSS_LIBS_LIST="-lnss3 -lsmime3"
 
 XMLSEC_NO_NSS="1"

