# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		xmlsec
VERSION=		1.3.4
KEYWORDS=		security
VARIANTS=		standard
SDESC[standard]=	XML Security Library
HOMEPAGE=		https://www.aleksey.com/xmlsec/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		https://www.aleksey.com/xmlsec/download/
DISTFILE[1]=		xmlsec1-1.3.4.tar.gz:main
DF_INDEX=		1
SPKGS[standard]=	complete
			primary
			tools
			dev
			man
			docs

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILD_DEPENDS=		libgcrypt:dev:standard
			gnutls:dev:standard
			nss:dev:standard
BUILDRUN_DEPENDS=	libgcrypt:primary:standard
			libltdl:single:standard
			gnutls:primary:standard
			nss:primary:standard
EXRUN[tools]=		xmlsec:primary:standard

USES=			cpe gmake libtool pkgconfig ssl:openssl30
GNOME_COMPONENTS=	libxslt

DISTNAME=		xmlsec1-1.3.4

LICENSE=		MIT:primary
LICENSE_FILE=		MIT:{{WRKSRC}}/Copyright
LICENSE_SCHEME=		solo

CPE_VENDOR=		xmlsec_project
FPC_EQUIVALENT=		security/xmlsec1

MUST_CONFIGURE=		gnu
CONFIGURE_ARGS=		--with-openssl="{{OPENSSLBASE}}"
			--with-gcrypt="{{LOCALBASE}}"
			--with-gnutls="{{LOCALBASE}}"
			--with-nspr="{{LOCALBASE}}"
			--with-nss="{{LOCALBASE}}"
			--enable-soap
			--disable-docs-build
CONFIGURE_ENV=		NSS_CFLAGS="-I{{LOCALBASE}}/include/nss/nss"

MAKE_ARGS=		confexecdir="{{LOCALBASE}}/etc"
MAKE_ENV=		ABS_BUILDDIR="{{WRKSRC}}"
			TMPFOLDER="{{WRKDIR}}"

INSTALL_TARGET=		install-strip
INSTALL_REQ_TOOLCHAIN=	yes
SOVERSION=		1.3.4

LDFLAGS=		-L{{LOCALBASE}}/lib/nss
			-Wl,-rpath,{{LOCALBASE}}/lib/nss

post-install:
	${RMDIR} ${STAGEDIR}${PREFIX}/share/doc/xmlsec1/css

pre-configure:
	${REINPLACE_CMD} \
		-e 's/mozilla-nss/nss/' \
		-e 's/mozilla-nspr/nspr/' \
		-e '/^GNUTLS_FOUND/s/no/yes/' \
		-e '/^GNUTLS_LIBS=/s,"","-L${LOCALBASE}/lib -lgnutls",' \
		${WRKSRC}/configure
	${REINPLACE_CMD} -e 's/(CP) -ru/(CP) -r/' -e 's/(CP) -u/(CP)/' \
		${WRKSRC}/docs/Makefile.am ${WRKSRC}/docs/Makefile.in \
		${WRKSRC}/docs/api/Makefile.am ${WRKSRC}/docs/api/Makefile.in \
		${WRKSRC}/man/Makefile.am ${WRKSRC}/man/Makefile.in
	# Making the xmlsec1 executable multi-threaded to let load -lnss when needed
	${REINPLACE_CMD} -e 's,^\(xmlsec1_LDADD = \)\\$$,\1 -L${LOCALBASE}/lib -lpthread\\,' \
		${WRKSRC}/apps/Makefile.in

[FILE:303:descriptions/desc.primary]
XML Security Library is the latest stable of a C library based on
LibXML2 and OpenSSL. The library was created with a goal to support
major XML security standards:
   - XML Signature
   - XML Encryption
   - Canonical XML (was included in libxml2)
   - Exclusive Canonical XML (was included in libxml2)


[FILE:706:descriptions/desc.tools]
On branch master
Your branch is ahead of 'origin/master' by 3 commits.
  (use "git push" to publish your local commits)

Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git restore <file>..." to discard changes in working directory)
	modified:   ../distinfo
	modified:   ../manifests/plist.primary
	modified:   ../patches/patch-configure
	modified:   ../patches/patch-src_cast__helpers.h
	modified:   ../specification

Untracked files:
  (use "git add <file>..." to include in what will be committed)
	desc.tools
	../manifests/plist.dev
	../manifests/plist.man
	../manifests/plist.tools

no changes added to commit (use "git add" and/or "git commit -a")


[FILE:99:distinfo]
45ad9078d41ae76844ad2f8651600ffeec0fdd128ead988a8d69e907c57aee75      2435656 xmlsec1-1.3.4.tar.gz


[FILE:337:manifests/plist.primary]
lib/
 libxmlsec1-gcrypt.so.%%SOMAJOR%%
 libxmlsec1-gcrypt.so.%%SOVERSION%%
 libxmlsec1-gnutls.so.%%SOMAJOR%%
 libxmlsec1-gnutls.so.%%SOVERSION%%
 libxmlsec1-nss.so.%%SOMAJOR%%
 libxmlsec1-nss.so.%%SOVERSION%%
 libxmlsec1-openssl.so.%%SOMAJOR%%
 libxmlsec1-openssl.so.%%SOVERSION%%
 libxmlsec1.so.%%SOMAJOR%%
 libxmlsec1.so.%%SOVERSION%%


[FILE:31:manifests/plist.tools]
bin/xmlsec1
etc/xmlsec1Conf.sh


[FILE:954:manifests/plist.dev]
bin/xmlsec1-config
include/xmlsec1/xmlsec/
 app.h
 base64.h
 bn.h
 buffer.h
 crypto.h
 dl.h
 errors.h
 exports.h
 io.h
 keyinfo.h
 keys.h
 keysdata.h
 keysmngr.h
 list.h
 membuf.h
 nodeset.h
 parser.h
 private.h
 strings.h
 templates.h
 transforms.h
 version.h
 x509.h
 xmldsig.h
 xmlenc.h
 xmlsec.h
 xmltree.h
include/xmlsec1/xmlsec/gcrypt/
 app.h
 crypto.h
 symbols.h
include/xmlsec1/xmlsec/gnutls/
 app.h
 crypto.h
 keysstore.h
 symbols.h
 x509.h
include/xmlsec1/xmlsec/nss/
 app.h
 crypto.h
 keysstore.h
 pkikeys.h
 symbols.h
 x509.h
include/xmlsec1/xmlsec/openssl/
 app.h
 crypto.h
 evp.h
 keysstore.h
 symbols.h
 x509.h
lib/
 libxmlsec1-gcrypt.a
 libxmlsec1-gcrypt.so
 libxmlsec1-gnutls.a
 libxmlsec1-gnutls.so
 libxmlsec1-nss.a
 libxmlsec1-nss.so
 libxmlsec1-openssl.a
 libxmlsec1-openssl.so
 libxmlsec1.a
 libxmlsec1.so
lib/pkgconfig/
 xmlsec1-gcrypt.pc
 xmlsec1-gnutls.pc
 xmlsec1-nss.pc
 xmlsec1-openssl.pc
 xmlsec1.pc
share/aclocal/xmlsec1.m4


[FILE:51:manifests/plist.man]
share/man/man1/
 xmlsec1-config.1.gz
 xmlsec1.1.gz


[FILE:3797:manifests/plist.docs]
share/doc/xmlsec1/
 authors.html
 bugs.html
 c14n.html
 documentation.html
 download.html
 faq.html
 favicon.ico
 index.html
 mailing-list.html
 news.html
 related.html
 xmldsig-verifier.html
 xmldsig.html
 xmlenc.html
 xmlsec-man.html
share/doc/xmlsec1/api/
 home.png
 index.html
 left-insensitive.png
 left.png
 right-insensitive.png
 right.png
 up-insensitive.png
 up.png
 xmlsec-app.html
 xmlsec-base64.html
 xmlsec-bn.html
 xmlsec-buffer.html
 xmlsec-custom-keys-manager.html
 xmlsec-decrypt-with-keys-mngr.html
 xmlsec-decrypt-with-signle-key.html
 xmlsec-dl.html
 xmlsec-encrypt-dynamic-template.html
 xmlsec-encrypt-template-file.html
 xmlsec-encrypt-with-session-key.html
 xmlsec-encryption-klasses.html
 xmlsec-errors.html
 xmlsec-examples-sign-dynamimc-template.html
 xmlsec-examples-sign-template-file.html
 xmlsec-examples-sign-x509.html
 xmlsec-examples.html
 xmlsec-gcrypt-app.html
 xmlsec-gcrypt-crypto.html
 xmlsec-gcrypt-ref.html
 xmlsec-gnutls-app.html
 xmlsec-gnutls-crypto.html
 xmlsec-gnutls-ref.html
 xmlsec-gnutls-x509.html
 xmlsec-index.html
 xmlsec-io.html
 xmlsec-keyinfo.html
 xmlsec-keys.html
 xmlsec-keysdata.html
 xmlsec-keysmngr.html
 xmlsec-list.html
 xmlsec-membuf.html
 xmlsec-msccng-ref.html
 xmlsec-mscng-app.html
 xmlsec-mscng-certkeys.html
 xmlsec-mscng-crypto.html
 xmlsec-mscng-keysstore.html
 xmlsec-mscng-x509.html
 xmlsec-mscrypto-app.html
 xmlsec-mscrypto-certkeys.html
 xmlsec-mscrypto-crypto.html
 xmlsec-mscrypto-keysstore.html
 xmlsec-mscrypto-ref.html
 xmlsec-mscrypto-x509.html
 xmlsec-nodeset.html
 xmlsec-notes-compiling-others.html
 xmlsec-notes-compiling-unix.html
 xmlsec-notes-compiling-windows.html
 xmlsec-notes-compiling.html
 xmlsec-notes-contexts.html
 xmlsec-notes-custom-keys-store.html
 xmlsec-notes-decrypt.html
 xmlsec-notes-dynamic-encryption-templates.html
 xmlsec-notes-dynamic-signature-templates.html
 xmlsec-notes-encrypt.html
 xmlsec-notes-include-files.html
 xmlsec-notes-init-shutdown.html
 xmlsec-notes-keys-manager-sign-enc.html
 xmlsec-notes-keys-mngr-verify-decrypt.html
 xmlsec-notes-keys.html
 xmlsec-notes-keysmngr.html
 xmlsec-notes-new-crypto-functions.html
 xmlsec-notes-new-crypto-key-stores.html
 xmlsec-notes-new-crypto-keys.html
 xmlsec-notes-new-crypto-klasses.html
 xmlsec-notes-new-crypto-sharing-results.html
 xmlsec-notes-new-crypto-simple-keys-mngr.html
 xmlsec-notes-new-crypto-transforms.html
 xmlsec-notes-new-crypto.html
 xmlsec-notes-overview.html
 xmlsec-notes-sign-encrypt.html
 xmlsec-notes-sign-x509.html
 xmlsec-notes-sign.html
 xmlsec-notes-simple-keys-store.html
 xmlsec-notes-structure.html
 xmlsec-notes-templates.html
 xmlsec-notes-transforms.html
 xmlsec-notes-verify-decrypt.html
 xmlsec-notes-verify-x509.html
 xmlsec-notes-verify.html
 xmlsec-notes-x509.html
 xmlsec-notes.html
 xmlsec-nss-app.html
 xmlsec-nss-bignum.html
 xmlsec-nss-crypto.html
 xmlsec-nss-keysstore.html
 xmlsec-nss-pkikeys.html
 xmlsec-nss-ref.html
 xmlsec-nss-x509.html
 xmlsec-openssl-app.html
 xmlsec-openssl-bn.html
 xmlsec-openssl-crypto.html
 xmlsec-openssl-evp.html
 xmlsec-openssl-ref.html
 xmlsec-openssl-x509.html
 xmlsec-parser.html
 xmlsec-ref.html
 xmlsec-reference.html
 xmlsec-signature-klasses.html
 xmlsec-templates.html
 xmlsec-transforms.html
 xmlsec-verify-with-key.html
 xmlsec-verify-with-keys-mngr.html
 xmlsec-verify-with-restrictions.html
 xmlsec-verify-with-x509.html
 xmlsec-version.html
 xmlsec-xmldsig.html
 xmlsec-xmlenc.html
 xmlsec-xmlsec.html
 xmlsec-xmltree.html
share/doc/xmlsec1/api/images/
 encryption-structure.png
 key.png
 keysmngr.png
 sign-enc-model.png
 signature-structure.png
 structure.png
 transform.png
 transforms-chain.png
 verif-dec-model.png
share/doc/xmlsec1/images/
 bart.gif
 libxml2-logo.png
 libxslt-logo.png
 logo.gif
 openssl-logo.png
 xmlsec-logo.gif


[FILE:419:patches/patch-configure]
--- configure.orig	2024-04-09 14:46:46 UTC
+++ configure
@@ -15675,8 +15675,8 @@ NSS_PACKAGE=mozilla-nss
 NSPR_INCLUDE_MARKER="nspr/nspr.h"
 NSPR_LIB_MARKER="libnspr4$shrext"
 NSPR_LIBS_LIST="-lnspr4 -lplds4 -lplc4"
-NSS_INCLUDE_MARKER="nss/nss.h"
-NSS_LIB_MARKER="libnss3$shrext"
+NSS_INCLUDE_MARKER="nss/nss/nss.h"
+NSS_LIB_MARKER="nss/libnss3$shrext"
 NSS_LIBS_LIST="-lnss3 -lsmime3 -lnssutil3"
 
 XMLSEC_NO_NSS="1"


[FILE:348:patches/patch-src_cast__helpers.h]
--- src/cast_helpers.h.orig	2024-04-09 14:46:44 UTC
+++ src/cast_helpers.h
@@ -16,6 +16,7 @@
 #error "cast_helpers.h file contains private xmlsec definitions and should not be used outside xmlsec or xmlsec-$crypto libraries"
 #endif /* XMLSEC_PRIVATE */
 
+#include <stdint.h>
 #include <limits.h>
 #include <stdint.h>
 #include "errors_helpers.h"

