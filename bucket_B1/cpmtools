# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		cpmtools
VERSION=		2.24
KEYWORDS=		emulators
VARIANTS=		std
SDESC[std]=		Tools to access CP/M disks and disk images
HOMEPAGE=		https://www.moria.de/~michael/cpmtools/
CONTACT=		Michael_Reim[kraileth@elderlinux.org]

DOWNLOAD_GROUPS=	main
SITES[main]=		http://distcache.freebsd.org/ports-distfiles/
DISTFILE[1]=		cpmtools-2.24.tar.gz:main
DF_INDEX=		1
SPKGS[std]=		set
			primary
			man

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILD_DEPENDS=		libdsk:dev:std
BUILDRUN_DEPENDS=	libdsk:primary:std

LICENSE=		GPLv3+:primary
LICENSE_TERMS=		primary:{{WRKDIR}}/TERMS
LICENSE_FILE=		GPLv3+:{{WRKSRC}}/COPYING
LICENSE_SCHEME=		solo

FPC_EQUIVALENT=		emulators/cpmtools

MUST_CONFIGURE=		gnu
CONFIGURE_ARGS=		--with-libdsk={{LOCALBASE}}

post-patch:
	${REINPLACE_CMD} -e 's|getopt$$(OBJEXT)||g; s|getopt1$$(OBJEXT)||g' \
		-e 's|\($$(CC).*fsed.cpm$$(OBJEXT).*$$(DEVICEOBJ)\)|\1 -lncurses|' \
		-e '/^CFLAGS=/s|@CFLAGS@|@CFLAGS@ -DDISKDEFS=\\"@datarootdir@/diskdefs\\" -DFORMAT=\\"$$(DEFFORMAT)\\"|' \
		-e 's|diskdefs @datarootdir@/diskdefs|diskdefs $$(DESTDIR)@datarootdir@/diskdefs|' \
		${WRKSRC}/Makefile.in
	${REINPLACE_CMD} -e 's|\(FSED_CPM=fsed.cpm\) LIBS=\"-lcurses $$LIBS\"|\1|' \
		${WRKSRC}/configure

post-install:
	${RM} ${STAGEDIR}${PREFIX}/share/man/man1/fsed.cpm.1

post-extract:
	(cd ${WRKSRC} && tail -n 13 README > ../TERMS)

[FILE:1085:descriptions/desc.primary]
This package allows to access CP/M file systems similar to the well-known 
mtools package, which accesses MSDOS file systems. Currently it contains:

* cpmls - list sorted directory with output similar to ls, DIR, P2DOS DIR 
and CP/M3 DIR[FULL]
* cpmcp - copy files from and to CP/M file systems
* cpmrm - erase files from CP/M file systems
* cpmchmod - change file permissions
* cpmchattr - change file attributes
* mkfs.cpm - make a CP/M file system
* fsck.cpm - check and repair a CP/M file system (only simple errors can 
be repaired so far). Some images of broken file systems are provided for 
testing.
* fsed.cpm - view CP/M file system
* manual pages for everything including the CP/M file system format

All CP/M file system features are supported. Password protection is 
ignored, because passwords are easy to decrypt, but a pseudo file [passwd] 
contains them, if you are curious what your old password has been. The 
disk label is read as special file [label]. User numbers are specified as 
user:file. 

NOTE: This package does not currently ship the 'fsed.cpm' program.


[FILE:99:distinfo]
051ab170d1dee69f1474bc2fd66d17288d6ba132b916612b9667cf852aa884d6       181215 cpmtools-2.24.tar.gz


[FILE:82:manifests/plist.primary]
bin/
 cpmchattr
 cpmchmod
 cpmcp
 cpmls
 cpmrm
 fsck.cpm
 mkfs.cpm
share/diskdefs


[FILE:127:manifests/plist.man]
share/man/man1/
 cpmchattr.1
 cpmchmod.1
 cpmcp.1
 cpmls.1
 cpmrm.1
 fsck.cpm.1
 mkfs.cpm.1
share/man/man5/
 cpm.5
 diskdefs.5

