# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		xmlto
VERSION=		0.0.28
KEYWORDS=		textproc
VARIANTS=		standard
SDESC[standard]=	Front-end to an XSL toolchain
HOMEPAGE=		https://pagure.io/xmlto/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main xsl
SITES[main]=		https://releases.pagure.org/xmlto/
SITES[xsl]=		http://www.antennahouse.com/XSLsample/sample-xsl-xhtml2fo/
DISTFILE[1]=		xmlto-0.0.28.tar.bz2:main
DISTFILE[2]=		xhtml2fo.xsl:xsl
DIST_SUBDIR=		xmlto
DF_INDEX=		1 2
SPKGS[standard]=	single

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILDRUN_DEPENDS=	bash:primary:standard
			getopt:single:standard
			libpaper:single:standard
			w3m:primary:standard
			docbook-xsl:primary:standard
			docbook-xml:single:standard

GNOME_COMPONENTS=	libxslt

EXTRACT_ONLY=		1

FPC_EQUIVALENT=		textproc/xmlto

MUST_CONFIGURE=		gnu
CONFIGURE_ARGS=		BASH={{LOCALBASE}}/bin/bash
			GETOPT={{LOCALBASE}}/bin/getopt
			PDFXMLTEX={{LOCALBASE}}/bin/pdftex

MAKE_ENV=		HOME=/dev/null

SUB_FILES=		pkg-message
SUB_LIST=		DATADIR={{LOCALBASE}}/share/xmlto

post-patch:
	@# get rid of nonstandard "type" option -t:
	${SED} -i'' -e 's/type -t/which/;' \
		${WRKSRC}/format/docbook/epub \
		${WRKSRC}/format/docbook/txt \
		${WRKSRC}/format/fo/dvi \
		${WRKSRC}/format/fo/pdf \
		${WRKSRC}/format/xhtml1/txt
	@# get rid of GNU-make-ism (BSD make defines $< only in suffix rules)
	${REINPLACE_CMD} -e '/^GEN_MANPAGE/{s/\$$</$$>/;}' ${WRKSRC}/Makefile.in

post-install:
	${MKDIR} ${STAGEDIR}${PREFIX}/share/xmlto
	${INSTALL_DATA} ${DISTDIR}/${DIST_SUBDIR}/xhtml2fo.xsl \
		${STAGEDIR}${PREFIX}/share/xmlto

[FILE:458:descriptions/desc.single]
xmlto is a front-end to an XSL toolchain. It chooses an appropriate
stylesheet for the conversion you want and applies it using an external
XSL-T processor.  It also performs any necessary post-processing.

Supported conversions from DocBook XML: dvi, fo, html, html-nochunks,
htmlhelp, javahelp, man, pdf, ps, txt, xhtml, xhtml-nochunks.

Currently the only XSL-T processor supported is xsltproc.
For DVI, PDF and PostScript output, PassiveTeX is required.


[FILE:202:distinfo]
1130df3a7957eb9f6f0d29e4aa1c75732a7dfb6d639be013859b5c7ec5421276       127921 xmlto/xmlto-0.0.28.tar.bz2
51984c86eda98fc70c2c0fa887626f44311634c5e3d1053cd2ada8cd2543ebd6        63786 xmlto/xhtml2fo.xsl


[FILE:375:manifests/plist.single]
bin/
 xmlif
 xmlto
share/man/man1/
 xmlif.1.gz
 xmlto.1.gz
share/xmlto/format/docbook/
 awt
 dvi
 epub
 fo
 html
 html-nochunks
 htmlhelp
 javahelp
 man
 mif
 pcl
 pdf
 ps
 svg
 txt
 xhtml
 xhtml-nochunks
share/xmlto/format/fo/
 awt
 dvi
 mif
 pcl
 pdf
 ps
 svg
 txt
share/xmlto/format/xhtml1/
 awt
 dvi
 fo
 mif
 pcl
 pdf
 ps
 svg
 txt
share/xmlto/
 xhtml2fo.xsl
 xmlto.mak


[FILE:334:patches/patch-xmlto.in]
This patch makes sure that w3m or others will not pollute $HOME/

--- ./xmlto.in.orig	2011-11-29 12:49:57.000000000 +0100
+++ ./xmlto.in	2013-10-07 23:52:57.000000000 +0200
@@ -611,4 +611,6 @@
   # Extremely verbose
   BASH="${BASH} -x"
 fi
+make_temp -d temphome HOME || exit 1
+export HOME
 ${BASH} "$FORMAT" post-process || exit 1


[FILE:361:files/pkg-message.in]
For benefits of conversions away from XHTML1 through XSL-FO,
a stylesheet xhtml2fo.xsl has been installed
into %%DATADIR%%. Example use:

  xmlto pdf -x %%DATADIR%%/xhtml2fo.xsl myXHTML1file.xml

More style sheets for XHTML1 conversions can be found at
<http://www.antennahouse.com/XSLsample/XSLsample.htm>
under "Stylesheet for XHTML to XSL-FO transformation"

