# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		nfdump
VERSION=		1.7.3
KEYWORDS=		net_mgmt
VARIANTS=		standard
SDESC[standard]=	Tools to collect and process netflow data
HOMEPAGE=		https://github.com/phaag/nfdump
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		GITHUB/phaag:nfdump:v1.7.3
DISTFILE[1]=		generated:main
DF_INDEX=		1
SPKGS[standard]=	single

OPTIONS_AVAILABLE=	PCAP
OPTIONS_STANDARD=	PCAP
OPT_ON[freebsd]=	PCAP
OPT_ON[netbsd]=		PCAP
OPT_ON[dragonfly]=	PCAP
OPT_ON[midnightbsd]=	PCAP

BUILDRUN_DEPENDS=	flex:primary:standard
			rrdtool:primary:standard

USES=			cpe autoreconf libtool pkgconfig bz2:build

LICENSE=		BSD3CLAUSE:single
LICENSE_FILE=		BSD3CLAUSE:{{WRKSRC}}/BSD-license.txt
LICENSE_SCHEME=		solo

CPE_VENDOR=		nfdump_project
FPC_EQUIVALENT=		net-mgmt/nfdump

MUST_CONFIGURE=		gnu
CONFIGURE_ARGS=		--with-rrdpath={{LOCALBASE}}
			--enable-nftrack
			--enable-sflow
			--enable-nfprofile
			--enable-fixtimebug
			--enable-nsel
			--disable-influxdb

SINGLE_JOB=		yes

INSTALL_TARGET=		install-strip
INSTALL_REQ_TOOLCHAIN=	yes
PLIST_SUB=		VERSION=1.7.3

[PCAP].DESCRIPTION=			Include Package Capture capability
[PCAP].BUILDRUN_DEPENDS_ON=		libpcap:primary:standard
[PCAP].BUILD_DEPENDS_ON=		libpcap:dev:standard
[PCAP].CONFIGURE_ARGS_ON=		--enable-readpcap
					--enable-nfpcapd

post-install:
	${MV} ${STAGEDIR}${PREFIX}/etc/nfdump.conf.dist \
		${STAGEDIR}${PREFIX}/etc/nfdump.conf.sample

[FILE:735:descriptions/desc.single]
NFDUMP tools support netflow v5, v7 and v9 capturing and processing.

nfcapd - netflow capture daemon.
Reads the netflow data from the network and stores the data into files.

nfdump - netflow dump.
Reads the netflow data from the files stored by nfcapd. It's syntax is
similar to tcpdump. If you like tcpdump you will like nfdump.

nfprofile - netflow profiler.
Reads the netflow data from the files stored by nfcapd. Filters the netflow
data according to the specified filter sets (profiles) and stores the
filtered data into files for later use.

nfreplay - netflow replay.
Reads the netflow data from the files stored by nfcapd and sends it over
the network to another host.

ft2nfdump - flow-tools to nfdump - optional component.


[FILE:104:distinfo]
9ea7e1ded34a81839b73e66cb62c9bc11a8070210584f9a508798d7bd6058c89       725364 phaag-nfdump-1.7.3.tar.gz


[FILE:342:manifests/plist.single]
@sample etc/nfdump.conf.sample
%%PCAP-ON%%bin/nfpcapd
%%PCAP-ON%%share/man/man1/nfpcapd.1.gz
bin/
 nfanon
 nfcapd
 nfdump
 nfexpire
 nfprofile
 nfreplay
 nftrack
 sfcapd
lib/
 libnfdump-%%VERSION%%.so
 libnfdump.a
 libnfdump.so
share/man/man1/
 nfanon.1.gz
 nfcapd.1.gz
 nfdump.1.gz
 nfexpire.1.gz
 nfprofile.1.gz
 nfreplay.1.gz
 sfcapd.1.gz


[FILE:397:patches/patch-src_nfpcapd_packet__bpf.c]
--- src/nfpcapd/packet_bpf.c.orig	2023-04-23 12:29:32 UTC
+++ src/nfpcapd/packet_bpf.c
@@ -37,6 +37,7 @@
 #endif
 #include <errno.h>
 #include <fcntl.h>
+#include <sys/types.h>
 #include <net/bpf.h>
 #include <net/if.h>
 #include <pthread.h>
@@ -49,7 +50,6 @@
 #include <sys/ioctl.h>
 #include <sys/param.h>
 #include <sys/time.h>
-#include <sys/types.h>
 #include <time.h>
 #include <unistd.h>
 


[FILE:252:patches/patch-src_nfpcapd_pcapdump.c]
--- src/nfpcapd/pcapdump.c.orig	2023-04-23 12:29:32 UTC
+++ src/nfpcapd/pcapdump.c
@@ -41,6 +41,7 @@
 #include <sys/param.h>
 #include <sys/stat.h>
 #include <sys/types.h>
+#include <sys/stat.h> // for S_IFREG
 #include <time.h>
 #include <unistd.h>
 


[FILE:217:patches/patch-src_nfpcapd_pcaproc.h]
--- src/nfpcapd/pcaproc.h.orig	2023-04-23 12:29:32 UTC
+++ src/nfpcapd/pcaproc.h
@@ -40,6 +40,7 @@
 #endif
 #include <stdint.h>
 
+#include <sys/types.h>
 #ifdef HAVE_NET_ETHERNET_H
 #include <net/ethernet.h>
 #endif

