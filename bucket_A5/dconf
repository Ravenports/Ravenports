# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		dconf
VERSION=		0.34.0
KEYWORDS=		devel
VARIANTS=		standard
SDESC[standard]=	Configuration database system for GNOME
HOMEPAGE=		https://wiki.gnome.org/Projects/dconf
CONTACT=		Michael_Reim[kraileth@elderlinux.org]

DOWNLOAD_GROUPS=	main
SITES[main]=		http://ftp.gnome.org/pub/GNOME/sources/dconf/0.34/
DISTFILE[1]=		dconf-0.34.0.tar.xz:main
DF_INDEX=		1
SPKGS[standard]=	complete
			primary
			docs

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILD_DEPENDS=		docbook-xsl:primary:standard
			gtk-doc:single:standard
			vala:single:standard
BUILDRUN_DEPENDS=	dbus:single:standard

USES=			gettext-runtime gmake meson pkgconfig python:build
			shebangfix
GNOME_COMPONENTS=	glib libxslt

LICENSE=		LGPL20+:primary
LICENSE_TERMS=		primary:{{WRKDIR}}/TERMS
LICENSE_FILE=		LGPL20+:{{WRKSRC}}/COPYING
LICENSE_AWK=		TERMS:"^$$"
LICENSE_SOURCE=		TERMS:{{WRKSRC}}/client/dconf.h
LICENSE_SCHEME=		solo

FPC_EQUIVALENT=		devel/dconf
MESON_ARGS=		-Dgtk_doc=true
			-Dbash_completion=false
SHEBANG_FILES=		meson_post_install.py

INSTALL_REQ_TOOLCHAIN=	yes
SOVERSION=		1.0.0

post-patch:
	${REINPLACE_CMD} -e \
		's|__DBPATH__|${PREFIX}/share/xsl/docbook/manpages|' \
		${WRKSRC}/docs/meson.build

post-install:
	${MV} ${STAGEDIR}${PREFIX}/share/gtk-doc/html/dconf \
		${STAGEDIR}${PREFIX}/share/doc/dconf
	${RM} -r ${STAGEDIR}${PREFIX}/share/gtk-doc
	${MKDIR} ${STAGEDIR}${PREFIX}/etc/dconf/db
	${MKDIR} ${STAGEDIR}${PREFIX}/etc/dconf/profile

[FILE:339:descriptions/desc.primary]
Dconf is a simple key-based low-level configuration system. Its main 
purpose is to provide a backend to GSettings on platforms that don't 
already have configuration storage systems. Keys exist in an unstructured 
database. Dconf supports features like change notification, stacking of 
multiple configuration sources and mandatory keys.


[FILE:98:distinfo]
943a94ab16121de5580ceaed2605b87444d1bca1c6cd8beefb778bcb0aa2da52       112876 dconf-0.34.0.tar.xz


[FILE:491:manifests/plist.primary]
bin/dconf
include/dconf/dconf.h
include/dconf/client/dconf-client.h
include/dconf/common/
 dconf-changeset.h
 dconf-enums.h
 dconf-paths.h
lib/
 libdconf.so
 libdconf.so.%%SOMAJOR%%
 libdconf.so.%%SOVERSION%%
lib/gio/modules/libdconfsettings.so
lib/pkgconfig/dconf.pc
libexec/dconf-service
share/dbus-1/services/ca.desrt.dconf.service
share/man/man1/
 dconf-service.1.gz
 dconf.1.gz
share/man/man7/dconf.7.gz
share/vala/vapi/
 dconf.deps
 dconf.vapi
@dir etc/dconf/db
@dir etc/dconf/profile


[FILE:469:manifests/plist.docs]
share/doc/dconf/
 DConfClient.html
 annotation-glossary.html
 api-index-0.16.html
 api-index-0.18.html
 api-index-0.20.html
 api-index-0.26.html
 api-index-full.html
 ch01.html
 dconf-DConfChangeset.html
 dconf-DConfError.html
 dconf-dconf-Paths.html
 dconf-overview.html
 dconf-service.html
 dconf-tool.html
 home.png
 index.html
 left-insensitive.png
 left.png
 object-tree.html
 programs.html
 right-insensitive.png
 right.png
 style.css
 up-insensitive.png
 up.png


[FILE:353:patches/patch-docs_meson.build]
--- docs/meson.build.orig	2019-09-09 22:56:47 UTC
+++ docs/meson.build
@@ -22,6 +22,7 @@ if get_option('man')
     xsltproc,
     '--output', '@OUTPUT@',
     '--nonet',
+    '--path', '__DBPATH__',
     '--stringparam', 'man.output.quietly', '1',
     '--stringparam', 'funcsynopsis.style', 'ansi',
     '--stringparam', 'man.th.extra1.suppress', '1',


[FILE:1364:patches/patch-tests_meson.build]
Work around duplicate symbols exposed by meson 0.52

--- tests/meson.build.orig	2019-09-09 22:56:47 UTC
+++ tests/meson.build
@@ -28,10 +28,10 @@ unit_tests = [
   ['gvdb', 'gvdb.c', '-DSRCDIR="@0@"'.format(test_dir), libgvdb_dep, []],
   ['gdbus-thread', 'dbus.c', '-DDBUS_BACKEND="/gdbus/thread"', libdconf_gdbus_thread_dep, []],
   ['gdbus-filter', 'dbus.c', '-DDBUS_BACKEND="/gdbus/filter"', libdconf_gdbus_filter_dep, []],
-  ['gdbus-thread-leak', 'dbus-leak.c', '-DDBUS_BACKEND="/gdbus/thread"', [libdconf_client_dep, libdconf_gdbus_thread_dep], []],
-  ['gdbus-filter-leak', 'dbus-leak.c', '-DDBUS_BACKEND="/gdbus/filter"', [libdconf_client_dep, libdconf_gdbus_filter_dep], []],
+  ['gdbus-thread-leak', 'dbus-leak.c', '-DDBUS_BACKEND="/gdbus/thread"', [libdconf_client_dep], []],
+  ['gdbus-filter-leak', 'dbus-leak.c', '-DDBUS_BACKEND="/gdbus/filter"', [libdconf_client_dep], []],
   ['engine', 'engine.c', '-DSRCDIR="@0@"'.format(test_dir), [dl_dep, libdconf_engine_test_dep, m_dep], libdconf_mock],
-  ['client', 'client.c', '-DSRCDIR="@0@"'.format(test_dir), [libdconf_client_dep, libdconf_engine_dep], libdconf_mock],
+  ['client', 'client.c', '-DSRCDIR="@0@"'.format(test_dir), [libdconf_client_dep], libdconf_mock],
   ['writer', 'writer.c', '-DSRCDIR="@0@"'.format(test_dir), [glib_dep, dl_dep, m_dep, libdconf_service_dep], [libdconf_mock]],
 ]
 

