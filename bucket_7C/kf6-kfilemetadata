# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		kf6-kfilemetadata
VERSION=		6.21.0
KEYWORDS=		devel
VARIANTS=		std
SDESC[std]=		KF6 library for extracting metadata from files
HOMEPAGE=		https://api.kde.org/kfilemetadata-index.html
CONTACT=		Michael_Reim[kraileth@elderlinux.org]

DOWNLOAD_GROUPS=	main
SITES[main]=		https://download.kde.org/stable/frameworks/6.21/
DISTFILE[1]=		kfilemetadata-6.21.0.tar.xz:main
DIST_SUBDIR=		kde6
DF_INDEX=		1
SPKGS[std]=		set
			primary
			dev
			nls
			tools

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILD_DEPENDS=		exiv2:dev:std
			ffmpeg:dev:std
			kf6-karchive:dev:std
			kf6-kcodecs:dev:std
			kf6-kconfig:dev:std
			kf6-kcoreaddons:dev:std
			kf6-extra-cmake-modules:primary:std
			kf6-ki18n:dev:std
			qt6-qtbase:dev:std
			qt6-qtdeclarative:dev:std
			taglib:dev:std
			qt6-qttools:set:std
BUILDRUN_DEPENDS=	exiv2:primary:std
			ffmpeg:primary:std
			kf6-karchive:primary:std
			kf6-kcodecs:primary:std
			kf6-kconfig:primary:std
			kf6-kcoreaddons:primary:std
			kf6-ki18n:primary:std
			qt6-qtbase:primary:std
			qt6-qtdeclarative:primary:std
			taglib:primary:std
RUN_DEPENDS=		catdoc:primary:std
EXRUN[tools]=		primary

USES=			cmake gettext pkgconfig

DISTNAME=		kfilemetadata-6.21.0

LICENSE=		LGPL21:primary LGPL21+:primary LGPL3:primary
LICENSE_TERMS=		primary:{{WRKDIR}}/TERMS
LICENSE_FILE=		LGPL21:{{WRKSRC}}/LICENSES/LGPL-2.1-only.txt
			LGPL21+:{{WRKSRC}}/LICENSES/LGPL-2.1-or-later.txt
			LGPL3:{{WRKSRC}}/LICENSES/LGPL-3.0-only.txt
LICENSE_SCHEME=		multi

FPC_EQUIVALENT=		devel/kf6-kfilemetadata

SOVERSION=		6.21.0

CMAKE_ARGS=		-DCMAKE_PREFIX_PATH:PATH={{PREFIX}}/lib/qt6/cmake

post-stage:
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/lib/libKF6FileMetaData.so
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/lib/qt6/plugins/kf6/kfilemetadata/kfilemetadata_krita.so
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/lib/qt6/plugins/kf6/kfilemetadata/writers/kfilemetadata_taglibwriter.so
.for p in exiv2 fb2 ffmpeg odf office2007 office plaintext png po postscriptdsc taglib xml
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/lib/qt6/plugins/kf6/kfilemetadata/kfilemetadata_${p}extractor.so
.endfor
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/kfilemetadata_dump6

post-extract:
	${ECHO} "Terms extracted from 'src/writedata.h':" > ${WRKDIR}/TERMS
	${SED} -n '/ifndef/!p;//q' ${WRKSRC}/src/writedata.h >> ${WRKDIR}/TERMS
	${ECHO} "Terms extracted from 'src/mimeutils.cpp':" >> ${WRKDIR}/TERMS
	${SED} -n '/include/!p;//q' ${WRKSRC}/src/mimeutils.cpp >> ${WRKDIR}/TERMS

[FILE:253:descriptions/desc.primary]
KFileMetaData provides a simple library for extracting the text and 
metadata from a number of different files. This library is typically used 
by file indexers to retrieve the metadata. This library can also be used 
by applications to write metadata.


[FILE:61:descriptions/desc.tools]
This subpackage contains the dump utility for kfilemetadata.


[FILE:111:distinfo]
d8fdfcc5434200b26ca2e46e13c422d415b77ad86213d561526da816f653f0a4       704288 kde6/kfilemetadata-6.21.0.tar.xz


[FILE:689:manifests/plist.primary]
lib/
 libKF6FileMetaData.so.%%SOVERSION%%
 libKF6FileMetaData.so.3
lib/qt6/plugins/kf6/kfilemetadata/
 kfilemetadata_exiv2extractor.so
 kfilemetadata_fb2extractor.so
 kfilemetadata_ffmpegextractor.so
 kfilemetadata_krita.so
 kfilemetadata_odfextractor.so
 kfilemetadata_office2007extractor.so
 kfilemetadata_officeextractor.so
 kfilemetadata_plaintextextractor.so
 kfilemetadata_pngextractor.so
 kfilemetadata_poextractor.so
 kfilemetadata_postscriptdscextractor.so
 kfilemetadata_taglibextractor.so
 kfilemetadata_xmlextractor.so
lib/qt6/plugins/kf6/kfilemetadata/writers/kfilemetadata_taglibwriter.so
share/qlogging-categories6/
 kfilemetadata.categories
 kfilemetadata.renamecategories


[FILE:832:manifests/plist.dev]
include/KF6/KFileMetaData/kfilemetadata_version.h
include/KF6/KFileMetaData/KFileMetaData/
 EmbeddedImageData
 ExtractionResult
 Extractor
 ExtractorCollection
 ExtractorPlugin
 MimeUtils
 Properties
 PropertyInfo
 SimpleExtractionResult
 TypeInfo
 Types
 UserMetaData
 WriteData
 Writer
 WriterCollection
 WriterPlugin
include/KF6/KFileMetaData/kfilemetadata/
 embeddedimagedata.h
 extractionresult.h
 extractor.h
 extractorcollection.h
 extractorplugin.h
 kfilemetadata_export.h
 mimeutils.h
 properties.h
 propertyinfo.h
 simpleextractionresult.h
 typeinfo.h
 types.h
 usermetadata.h
 writedata.h
 writer.h
 writercollection.h
 writerplugin.h
lib/libKF6FileMetaData.so
lib/cmake/KF6FileMetaData/
 KF6FileMetaDataConfig.cmake
 KF6FileMetaDataConfigVersion.cmake
 KF6FileMetaDataTargets-release.cmake
 KF6FileMetaDataTargets.cmake


[FILE:2722:manifests/plist.nls]
share/locale/ar/LC_MESSAGES/kfilemetadata6.mo
share/locale/ast/LC_MESSAGES/kfilemetadata6.mo
share/locale/az/LC_MESSAGES/kfilemetadata6.mo
share/locale/bg/LC_MESSAGES/kfilemetadata6.mo
share/locale/bs/LC_MESSAGES/kfilemetadata6.mo
share/locale/ca/LC_MESSAGES/kfilemetadata6.mo
share/locale/ca@valencia/LC_MESSAGES/kfilemetadata6.mo
share/locale/cs/LC_MESSAGES/kfilemetadata6.mo
share/locale/da/LC_MESSAGES/kfilemetadata6.mo
share/locale/de/LC_MESSAGES/kfilemetadata6.mo
share/locale/el/LC_MESSAGES/kfilemetadata6.mo
share/locale/en_GB/LC_MESSAGES/kfilemetadata6.mo
share/locale/eo/LC_MESSAGES/kfilemetadata6.mo
share/locale/es/LC_MESSAGES/kfilemetadata6.mo
share/locale/et/LC_MESSAGES/kfilemetadata6.mo
share/locale/eu/LC_MESSAGES/kfilemetadata6.mo
share/locale/fi/LC_MESSAGES/kfilemetadata6.mo
share/locale/fr/LC_MESSAGES/kfilemetadata6.mo
share/locale/gd/LC_MESSAGES/kfilemetadata6.mo
share/locale/gl/LC_MESSAGES/kfilemetadata6.mo
share/locale/he/LC_MESSAGES/kfilemetadata6.mo
share/locale/hi/LC_MESSAGES/kfilemetadata6.mo
share/locale/hu/LC_MESSAGES/kfilemetadata6.mo
share/locale/ia/LC_MESSAGES/kfilemetadata6.mo
share/locale/id/LC_MESSAGES/kfilemetadata6.mo
share/locale/ie/LC_MESSAGES/kfilemetadata6.mo
share/locale/is/LC_MESSAGES/kfilemetadata6.mo
share/locale/it/LC_MESSAGES/kfilemetadata6.mo
share/locale/ja/LC_MESSAGES/kfilemetadata6.mo
share/locale/ka/LC_MESSAGES/kfilemetadata6.mo
share/locale/ko/LC_MESSAGES/kfilemetadata6.mo
share/locale/lt/LC_MESSAGES/kfilemetadata6.mo
share/locale/lv/LC_MESSAGES/kfilemetadata6.mo
share/locale/ml/LC_MESSAGES/kfilemetadata6.mo
share/locale/nb/LC_MESSAGES/kfilemetadata6.mo
share/locale/nds/LC_MESSAGES/kfilemetadata6.mo
share/locale/nl/LC_MESSAGES/kfilemetadata6.mo
share/locale/nn/LC_MESSAGES/kfilemetadata6.mo
share/locale/pa/LC_MESSAGES/kfilemetadata6.mo
share/locale/pl/LC_MESSAGES/kfilemetadata6.mo
share/locale/pt/LC_MESSAGES/kfilemetadata6.mo
share/locale/pt_BR/LC_MESSAGES/kfilemetadata6.mo
share/locale/ro/LC_MESSAGES/kfilemetadata6.mo
share/locale/ru/LC_MESSAGES/kfilemetadata6.mo
share/locale/sa/LC_MESSAGES/kfilemetadata6.mo
share/locale/sk/LC_MESSAGES/kfilemetadata6.mo
share/locale/sl/LC_MESSAGES/kfilemetadata6.mo
share/locale/sr/LC_MESSAGES/kfilemetadata6.mo
share/locale/sr@ijekavian/LC_MESSAGES/kfilemetadata6.mo
share/locale/sr@ijekavianlatin/LC_MESSAGES/kfilemetadata6.mo
share/locale/sr@latin/LC_MESSAGES/kfilemetadata6.mo
share/locale/sv/LC_MESSAGES/kfilemetadata6.mo
share/locale/ta/LC_MESSAGES/kfilemetadata6.mo
share/locale/tg/LC_MESSAGES/kfilemetadata6.mo
share/locale/tr/LC_MESSAGES/kfilemetadata6.mo
share/locale/uk/LC_MESSAGES/kfilemetadata6.mo
share/locale/zh_CN/LC_MESSAGES/kfilemetadata6.mo
share/locale/zh_TW/LC_MESSAGES/kfilemetadata6.mo


[FILE:24:manifests/plist.tools]
bin/kfilemetadata_dump6


[FILE:278:patches/patch-metainfo.yaml]
--- metainfo.yaml.orig	2025-01-03 15:26:16 UTC
+++ metainfo.yaml
@@ -4,6 +4,9 @@ type: integration
 platforms:
     - name: Linux
     - name: FreeBSD
+    - name: DragonFly
+    - name: NetBSD
+    - name: MidnightBSD
     - name: Windows
     - name: macOS
 portingAid: false


[FILE:507:patches/patch-src_xattr__p.h]
--- src/xattr_p.h.orig	2025-01-03 15:26:16 UTC
+++ src/xattr_p.h
@@ -240,6 +240,8 @@ KFileMetaData::UserMetaData::Attributes
     const ssize_t size = listxattr(encodedPath, nullptr, 0);
     #elif defined(Q_OS_MAC)
     const ssize_t size = listxattr(encodedPath, nullptr, 0, 0);
+    #elif defined(__DragonFly__)
+    const ssize_t size = 0;
     #elif defined(Q_OS_FREEBSD) || defined(Q_OS_NETBSD)
     const ssize_t size = extattr_list_file(encodedPath, EXTATTR_NAMESPACE_USER, nullptr, 0);
     #endif

