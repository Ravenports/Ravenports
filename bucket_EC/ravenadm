# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		ravenadm
VERSION=		0.60
REVISION=		1
KEYWORDS=		raven
VARIANTS=		standard
SDESC[standard]=	Ravenports administration utility
HOMEPAGE=		https://github.com/jrmarino/ravenadm
CONTACT=		John_Marino[draco@marino.st]

DOWNLOAD_GROUPS=	main
SITES[main]=		GITHUB/jrmarino:ravenadm:02e0762
DISTFILE[1]=		generated:main
DF_INDEX=		1
SPKGS[standard]=	single

OPTIONS_AVAILABLE=	WATCHDOG
OPTIONS_STANDARD=	WATCHDOG
OPT_ON[freebsd]=	WATCHDOG
OPT_ON[dragonfly]=	WATCHDOG

BUILD_DEPENDS=		adacurses:primary:standard

USES=			gprbuild ncurses

LICENSE=		ISCL:single
LICENSE_SCHEME=		solo
LICENSE_FILE=		ISCL:{{WRKSRC}}/License.txt

[WATCHDOG].DESCRIPTION=			Use "watchdog" monitor to abort stalled builds

post-patch-WATCHDOG-OFF:
	@${ECHO_MSG} "Disabling watchdog monitor ..."
	@${REINPLACE_CMD} -e "/hangmonitor :/ s|True|False|" \
		${WRKSRC}/src/portscan-buildcycle.adb

do-build:
	(cd ${WRKSRC} && ${SETENV} ${MAKE_ENV} \
		gprbuild -p -P ravenadm)
	(cd ${WRKSRC}/ravenexec && ${SETENV} ${MAKE_ENV} \
		${CC} ravenexec.c -o ../build/ravenexec)

post-extract:
	@${REINPLACE_CMD} -e "s|/raven|${LOCALBASE}|" \
		-e "s|:= dragonfly|:= ${OPSYS:tl}|" \
		${WRKSRC}/src/definitions.ads
	# ensure Tampering_Check is active
	@${REINPLACE_CMD} -e '/pragma Suppress/ s|--  ||' \
		${WRKSRC}/src/portscan.ads \
		${WRKSRC}/src/port_specification.ads

do-install:
	${MKDIR} ${STAGEDIR}${PREFIX}/share/ravenadm \
		${STAGEDIR}/var/ravenports/primary \
		${STAGEDIR}/var/ravenports/distfiles \
		${STAGEDIR}/var/ravenports/conspiracy
	${INSTALL_PROGRAM} ${WRKSRC}/build/ravenadm \
		${STAGEDIR}${PREFIX}/bin
	${INSTALL_PROGRAM} ${WRKSRC}/build/ravenexec \
		${STAGEDIR}${PREFIX}/libexec
	${INSTALL_DATA} ${WRKSRC}/www/* ${STAGEDIR}${PREFIX}/share/ravenadm
	${INSTALL_DATA} ${WRKSRC}/manpages/*.8 ${STAGEDIR}${MANPREFIX}/man/man8/

[FILE:48:descriptions/desc.single]
This is ravenadm.  

Description to be written.


[FILE:111:distinfo]
900634652b092bf56a53f7a2c02dbdde552e5eab1dca1b19a5b50bb09daee765       261396 jrmarino-ravenadm-02e0762.tar.gz


[FILE:657:manifests/plist.single]
bin/ravenadm
libexec/ravenexec
share/man/man8/
 ravenadm-build-everything.8.gz
 ravenadm-build.8.gz
 ravenadm-check-ports.8.gz
 ravenadm-configure.8.gz
 ravenadm-dev.8.gz
 ravenadm-force.8.gz
 ravenadm-generate-repository.8.gz
 ravenadm-locate.8.gz
 ravenadm-purge-distfiles.8.gz
 ravenadm-set-options.8.gz
 ravenadm-status-everything.8.gz
 ravenadm-status.8.gz
 ravenadm-subpackages.8.gz
 ravenadm-test-everything.8.gz
 ravenadm-test.8.gz
 ravenadm-update-ports.8.gz
 ravenadm.8.gz
share/ravenadm/
 favicon.png
 progress.css
 progress.html
 progress.js
 raven.png
@dir /var/ravenports/primary
@dir /var/ravenports/distfiles
@dir /var/ravenports/conspiracy

