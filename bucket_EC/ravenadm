# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		ravenadm
VERSION=		0.63
REVISION=		2
KEYWORDS=		raven
VARIANTS=		standard
SDESC[standard]=	Ravenports administration utility
HOMEPAGE=		https://github.com/jrmarino/ravenadm
CONTACT=		John_Marino[draco@marino.st]

DOWNLOAD_GROUPS=	main
SITES[main]=		GITHUB/jrmarino:ravenadm:7022175
DISTFILE[1]=		generated:main
DF_INDEX=		1
SPKGS[standard]=	single

OPTIONS_AVAILABLE=	WATCHDOG
OPTIONS_STANDARD=	WATCHDOG
OPT_ON[freebsd]=	WATCHDOG
OPT_ON[dragonfly]=	WATCHDOG

BUILD_DEPENDS=		adacurses:primary:standard

USES=			gprbuild ncurses

LICENSE=		ISCL:single
LICENSE_SCHEME=		solo
LICENSE_FILE=		ISCL:{{WRKSRC}}/License.txt

[WATCHDOG].DESCRIPTION=			Use "watchdog" monitor to abort stalled builds

post-patch-WATCHDOG-OFF:
	@${ECHO_MSG} "Disabling watchdog monitor ..."
	@${REINPLACE_CMD} -e "/hangmonitor :/ s|True|False|" \
		${WRKSRC}/src/portscan-buildcycle.adb

do-build:
	(cd ${WRKSRC} && ${SETENV} ${MAKE_ENV} \
		gprbuild -p -P ravenadm)
	(cd ${WRKSRC}/ravenexec && ${SETENV} ${MAKE_ENV} \
		${CC} ravenexec.c -o ../build/ravenexec)

post-extract:
	@${REINPLACE_CMD} -e "s|/raven|${LOCALBASE}|" \
		-e "s|:= dragonfly|:= ${OPSYS:tl}|" \
		${WRKSRC}/src/definitions.ads
	# ensure Tampering_Check is active
	@${REINPLACE_CMD} -e '/pragma Suppress/ s|--  ||' \
		${WRKSRC}/src/portscan.ads \
		${WRKSRC}/src/port_specification.ads

do-install:
	${MKDIR} ${STAGEDIR}${PREFIX}/share/ravenadm \
		${STAGEDIR}/var/ravenports/primary \
		${STAGEDIR}/var/ravenports/distfiles \
		${STAGEDIR}/var/ravenports/conspiracy
	${INSTALL_PROGRAM} ${WRKSRC}/build/ravenadm \
		${STAGEDIR}${PREFIX}/bin
	${INSTALL_PROGRAM} ${WRKSRC}/build/ravenexec \
		${STAGEDIR}${PREFIX}/libexec
	${INSTALL_DATA} ${WRKSRC}/www/* ${STAGEDIR}${PREFIX}/share/ravenadm
	${INSTALL_DATA} ${WRKSRC}/manpages/*.8 ${STAGEDIR}${MANPREFIX}/man/man8/

[FILE:888:descriptions/desc.single]
Ravenports is a new approach to building and packaging software on
Unix-like platforms. The significant benefits over other package systems
are present for binary package users, binary package builders, and ports
developers. The detailed description of each benefit (which would be
exhausting to list) are out of scope of this document. The intended
audience consist of people that have already decided to try to use
Ravenports.

There are three basic components to the Ravenports system: The ravenadm
administration tool, the conspiracy collection of buildsheets (also
referred to as "Ravenports"), and the ravensource repository. The latter
is only of interest to ports developers, and it is used to generate
Ravenports.

Once installed, the ravenadm tool can quickly install the latest
conspiracy collection of buildsheets, so this program is the main point
of interest for new users.


[FILE:111:distinfo]
2f6a001bb78dd175dc5f96770a572ce78ac38a62047cecc80f3de26a85bd27fe       317281 jrmarino-ravenadm-7022175.tar.gz


[FILE:701:manifests/plist.single]
bin/ravenadm
libexec/ravenexec
share/man/man8/
 ravenadm-build-everything.8.gz
 ravenadm-build.8.gz
 ravenadm-check-ports.8.gz
 ravenadm-configure.8.gz
 ravenadm-dev.8.gz
 ravenadm-force.8.gz
 ravenadm-generate-repository.8.gz
 ravenadm-locate.8.gz
 ravenadm-purge-distfiles.8.gz
 ravenadm-set-options.8.gz
 ravenadm-status-everything.8.gz
 ravenadm-status.8.gz
 ravenadm-subpackages.8.gz
 ravenadm-test-everything.8.gz
 ravenadm-test.8.gz
 ravenadm-update-ports.8.gz
 ravenadm.8.gz
share/ravenadm/
 favicon.png
 progress.css
 progress.html
 progress.js
 raven-project.png
 ravenports-200.png
 ravenports.css
@dir /var/ravenports/conspiracy
@dir /var/ravenports/distfiles
@dir /var/ravenports/primary

