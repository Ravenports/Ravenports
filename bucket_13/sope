# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		sope
VERSION=		5.12.0
KEYWORDS=		devel www
VARIANTS=		std
SDESC[std]=		Set of GNUstep web application frameworks
HOMEPAGE=		https://www.sogo.nu/
CONTACT=		Michael_Reim[kraileth@elderlinux.org]

DOWNLOAD_GROUPS=	main
SITES[main]=		https://packages.sogo.nu/sources/
DISTFILE[1]=		SOPE-5.12.0.tar.gz:main
DIST_SUBDIR=		gnustep
DF_INDEX=		1
SPKGS[std]=		set
			primary
			dev
			tools
			pgsql
			ldap

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILD_DEPENDS=		gnustep-base:dev:std
			gnustep-base:tools:std
			gnustep-make:primary:std
			gnutls:dev:std
			libobjc2:dev:std
			openldap:dev:std
			postgresql17:dev:std
			postgresql17:client:std
BUILDRUN_DEPENDS=	gnustep-base:primary:std
			gnutls:primary:std
			openldap:client:std
RUN_DEPENDS=		memcached:primary:std
EXRUN[pgsql]=		primary
			postgresql17:client:std
EXRUN[tools]=		primary

USES=			clang gmake iconv zlib
GNOME_COMPONENTS=	libxml2

DISTNAME=		SOPE

LICENSE=		LGPL21+:primary
LICENSE_TERMS=		primary:{{WRKDIR}}/TERMS
LICENSE_FILE=		LGPL21+:{{WRKSRC}}/sope-core/COPYING
LICENSE_AWK=		TERMS:"ifndef __EOCoreData_H__"
LICENSE_SOURCE=		TERMS:{{WRKSRC}}/sope-core/EOCoreData/EOCoreData.h
LICENSE_SCHEME=		solo

FPC_EQUIVALENT=		devel/sope

MUST_CONFIGURE=		yes
CONFIGURE_ARGS=		--with-gnustep

MAKEFILE=		GNUmakefile

PLIST_SUB=		SO_LDAP=4.9.35
			SO_LDAP_MAJMIN=4.9

do-configure:
	cd ${WRKSRC} ; . ${GNUSTEP_MAKEFILES}/GNUstep.sh ; ./configure ${CONFIGURE_ARGS}

[FILE:298:descriptions/desc.primary]
SOPE stands for "SKYRiX Object Publishing Environment" and is a
framework for mapping dynamic objects into the HTTP infrastructure,
that is, the web. A lot of ideas in SOPE are actually inspired by
ZOPE (the Z Object Publishing Environment), but the implementation
and details are quite different.


[FILE:37:descriptions/desc.tools]
This package contains SOPE programs.


[FILE:63:descriptions/desc.pgsql]
This subpackage contains the PostgreSQL functionality of SOPE.


[FILE:57:descriptions/desc.ldap]
This subpackage contains the LDAP functionality of SOPE.


[FILE:105:distinfo]
acabd014d1107de93fd7aa2604203c6fef50a38e04e6252a2ff4c2571ec081dd      2305547 gnustep/SOPE-5.12.0.tar.gz


[FILE:813:manifests/plist.primary]
lib/
 libDOM.so.4.9
 libDOM.so.4.9.24
 libEOControl.so.4.9
 libEOControl.so.4.9.74
 libGDLAccess.so.4.9
 libGDLAccess.so.4.9.63
 libNGExtensions.so.4.9
 libNGExtensions.so.4.9.203
 libNGMime.so.4.9
 libNGMime.so.4.9.3
 libNGObjWeb.so.4.9
 libNGObjWeb.so.4.9.37
 libNGStreams.so.4.9
 libNGStreams.so.4.9.57
 libSBJson.so.2
 libSBJson.so.2.3.1
 libSaxObjC.so.4.9
 libSaxObjC.so.4.9.66
 libWEExtensions.so.4.9
 libWEExtensions.so.4.9.94
 libWOExtensions.so.4.9
 libWOExtensions.so.4.9.31
 libXmlRpc.so.4.9
 libXmlRpc.so.4.9.31
lib/GNUstep/SaxDrivers-4.9/STXSaxDriver.sax/STXSaxDriver
lib/GNUstep/SaxDrivers-4.9/libxmlSAXDriver.sax/libxmlSAXDriver
lib/GNUstep/SoProducts-4.9/SoCore.sxp/SoCore
lib/GNUstep/WOxElemBuilders-4.9/WEExtensions.wox/WEExtensions
lib/GNUstep/WOxElemBuilders-4.9/WOExtensions.wox/WOExtensions


[FILE:8914:manifests/plist.dev]
include/DOM/
 DOM.h
 DOMAttribute.h
 DOMBuilder.h
 DOMBuilderFactory.h
 DOMCDATASection.h
 DOMCharacterData.h
 DOMComment.h
 DOMDocument.h
 DOMDocumentFragment.h
 DOMDocumentType.h
 DOMElement.h
 DOMEntity.h
 DOMEntityReference.h
 DOMImplementation.h
 DOMNamedNodeMap.h
 DOMNode+Enum.h
 DOMNode+QueryPath.h
 DOMNode.h
 DOMNodeWalker.h
 DOMNotation.h
 DOMPYXOutputter.h
 DOMProcessingInstruction.h
 DOMProtocols.h
 DOMQueryPathExpression.h
 DOMSaxBuilder.h
 DOMSaxHandler.h
 DOMText.h
 DOMXMLOutputter.h
 EDOM.h
include/EOControl/
 EOArrayDataSource.h
 EOClassDescription.h
 EOControl.h
 EOControlDecls.h
 EODataSource.h
 EODetailDataSource.h
 EOFetchSpecification.h
 EOGenericRecord.h
 EOGlobalID.h
 EOKeyGlobalID.h
 EOKeyValueArchiver.h
 EOKeyValueCoding.h
 EONull.h
 EOObserver.h
 EOQualifier.h
 EOSQLParser.h
 EOSortOrdering.h
include/GDLAccess/
 EOAdaptor.h
 EOAdaptorChannel+Attributes.h
 EOAdaptorChannel.h
 EOAdaptorContext.h
 EOAdaptorDataSource.h
 EOAdaptorGlobalID.h
 EOAdaptorOperation.h
 EOArrayProxy.h
 EOAttribute.h
 EOAttributeOrdering.h
 EOCustomValues.h
 EODatabase.h
 EODatabaseChannel.h
 EODatabaseContext.h
 EODatabaseFault.h
 EODatabaseFaultResolver.h
 EODelegateResponse.h
 EOEntity+Factory.h
 EOEntity.h
 EOExpressionArray.h
 EOFExceptions.h
 EOFault.h
 EOFaultHandler.h
 EOGenericRecord.h
 EOJoinTypes.h
 EOKeySortOrdering.h
 EOModel.h
 EOModelGroup.h
 EONull.h
 EOObjectUniquer.h
 EOPrimaryKeyDictionary.h
 EOQuotedExpression.h
 EORecordDictionary.h
 EORelationship.h
 EOSQLExpression.h
 EOSQLQualifier.h
 GDLAccess.h
 NSObject+EONullInit.h
include/NGExtensions/
 AutoDefines.h
 DOMNode+EOQualifier.h
 EOCacheDataSource.h
 EOCompoundDataSource.h
 EODataSource+NGExtensions.h
 EOFetchSpecification+plist.h
 EOFilterDataSource.h
 EOGrouping.h
 EOGroupingSet.h
 EOKeyGrouping.h
 EOKeyMapDataSource.h
 EOQualifier+CtxEval.h
 EOQualifier+plist.h
 EOQualifierGrouping.h
 EOSortOrdering+plist.h
 EOTrueQualifier.h
 IndexFunc.h
 NGBase64Coding.h
 NGBaseTypes.h
 NGBitSet.h
 NGBundleManager.h
 NGCalendarDateRange.h
 NGCharBuffers.h
 NGCustomFileManager.h
 NGDirectoryEnumerator.h
 NGExtensions.h
 NGExtensionsDecls.h
 NGFileFolderInfoDataSource.h
 NGFileManager.h
 NGFileManagerURL.h
 NGHashMap.h
 NGLogAppender.h
 NGLogEvent.h
 NGLogEventFormatter.h
 NGLogFileHandleAppender.h
 NGLogLevel.h
 NGLogSyslogAppender.h
 NGLogger.h
 NGLoggerManager.h
 NGLogging.h
 NGMemoryAllocation.h
 NGMerging.h
 NGObjectMacros.h
 NGPropertyListParser.h
 NGQuotedPrintableCoding.h
 NGResourceLocator.h
 NGRule.h
 NGRuleAssignment.h
 NGRuleContext.h
 NGRuleEngine.h
 NGRuleModel.h
 NGStack.h
 NSArray+enumerator.h
 NSAutoreleasePool+misc.h
 NSBundle+misc.h
 NSCalendarDate+misc.h
 NSData+gzip.h
 NSData+misc.h
 NSDictionary+misc.h
 NSEnumerator+misc.h
 NSException+misc.h
 NSFileManager+Extensions.h
 NSNull+misc.h
 NSObject+Logs.h
 NSObject+Values.h
 NSProcessInfo+misc.h
 NSRunLoop+FileObjects.h
 NSSet+enumerator.h
 NSString+Encoding.h
 NSString+Escaping.h
 NSString+Ext.h
 NSString+Formatting.h
 NSString+misc.h
 NSURL+misc.h
include/NGHttp/
 NGHttp.h
 NGHttpBodyParser.h
 NGHttpCookie.h
 NGHttpDecls.h
 NGHttpHeaderFieldParser.h
 NGHttpHeaderFields.h
 NGHttpMessage.h
 NGHttpMessageParser.h
 NGHttpRequest.h
 NGHttpResponse.h
 NGUrlFormCoder.h
include/NGImap4/
 NGImap4.h
 NGImap4Client.h
 NGImap4Connection.h
 NGImap4ConnectionManager.h
 NGImap4Context.h
 NGImap4DataSource.h
 NGImap4Envelope.h
 NGImap4EnvelopeAddress.h
 NGImap4FileManager.h
 NGImap4Folder.h
 NGImap4MailboxInfo.h
 NGImap4Message.h
 NGImap4ResponseParser.h
 NGImap4ServerRoot.h
 NGImap4Support.h
 NGSieveClient.h
 NSString+Imap4.h
include/NGMail/
 NGMBoxReader.h
 NGMail.h
 NGMailAddress.h
 NGMailAddressList.h
 NGMailAddressParser.h
 NGMailDecls.h
 NGMimeMessage.h
 NGMimeMessageGenerator.h
 NGMimeMessageParser.h
 NGPop3Client.h
 NGPop3Support.h
 NGSendMail.h
 NGSmtpClient.h
 NGSmtpSupport.h
include/NGMime/
 NGConcreteMimeType.h
 NGMime.h
 NGMimeBodyGenerator.h
 NGMimeBodyParser.h
 NGMimeBodyPart.h
 NGMimeBodyPartParser.h
 NGMimeDecls.h
 NGMimeExceptions.h
 NGMimeFileData.h
 NGMimeGeneratorProtocols.h
 NGMimeHeaderFieldGenerator.h
 NGMimeHeaderFieldParser.h
 NGMimeHeaderFields.h
 NGMimeJoinedData.h
 NGMimeMultipartBody.h
 NGMimePartGenerator.h
 NGMimePartParser.h
 NGMimeType.h
 NGMimeUtilities.h
 NGPart.h
 NSData+RFC822.h
include/NGObjWeb/
 EOFetchSpecification+SoDAV.h
 NGObjWeb.h
 NGObjWebDecls.h
 NSException+HTTP.h
 NSString+JavaScriptEscaping.h
 OWResourceManager.h
 OWResponder.h
 OWViewRequestHandler.h
 SaxDAVHandler.h
 SoActionInvocation.h
 SoApplication.h
 SoClass.h
 SoClassRegistry.h
 SoClassSecurityInfo.h
 SoComponent.h
 SoControlPanel.h
 SoCookieAuthenticator.h
 SoDAV.h
 SoDAVLockManager.h
 SoDAVSQLParser.h
 SoDefaultRenderer.h
 SoHTTPAuthenticator.h
 SoLookupAssociation.h
 SoObjCClass.h
 SoObject+SoDAV.h
 SoObject.h
 SoObjectDataSource.h
 SoObjectMethodDispatcher.h
 SoObjectRequestHandler.h
 SoObjectResultEntry.h
 SoObjectWebDAVDispatcher.h
 SoObjects.h
 SoPageInvocation.h
 SoPermissions.h
 SoProduct.h
 SoProductClassInfo.h
 SoProductLoader.h
 SoProductRegistry.h
 SoProductResourceManager.h
 SoSecurityException.h
 SoSecurityManager.h
 SoSelectorInvocation.h
 SoSubContext.h
 SoSubscription.h
 SoSubscriptionManager.h
 SoTemplateRenderer.h
 SoUser.h
 SoWebDAVRenderer.h
 SoWebDAVValue.h
 WEClientCapabilities.h
 WOActionResults.h
 WOActionURL.h
 WOAdaptor.h
 WOApplication.h
 WOAssociation.h
 WOComponent.h
 WOComponentDefinition.h
 WOComponentScript.h
 WOContext+SoObjects.h
 WOContext.h
 WOCookie.h
 WOCoreApplication.h
 WODirectAction.h
 WODisplayGroup.h
 WODynamicElement.h
 WOElement.h
 WOElementTrackingContext.h
 WOHTMLDynamicElement.h
 WOHTTPConnection.h
 WOMailDelivery.h
 WOMessage.h
 WOPageGenerationContext.h
 WOProxyRequestHandler.h
 WORequest+So.h
 WORequest.h
 WORequestHandler.h
 WOResourceManager.h
 WOResponse.h
 WOSession.h
 WOSessionStore.h
 WOStatisticsStore.h
 WOTemplate.h
 WOTemplateBuilder.h
 WOxElemBuilder.h
include/NGStreams/
 NGActiveSocket.h
 NGBase64Stream.h
 NGBufferedStream.h
 NGByteBuffer.h
 NGByteCountStream.h
 NGCTextStream.h
 NGCharBuffer.h
 NGConcreteStreamFileHandle.h
 NGDataStream.h
 NGDatagramPacket.h
 NGDatagramSocket.h
 NGDescriptorFunctions.h
 NGFileStream.h
 NGFilterStream.h
 NGFilterTextStream.h
 NGGZipStream.h
 NGInternetSocketAddress.h
 NGInternetSocketDomain.h
 NGLocalSocketAddress.h
 NGLocalSocketDomain.h
 NGLockingStream.h
 NGNet.h
 NGNetDecls.h
 NGNetUtilities.h
 NGPassiveSocket.h
 NGSocket.h
 NGSocketExceptions.h
 NGSocketProtocols.h
 NGStream.h
 NGStreamExceptions.h
 NGStreamPipe.h
 NGStreamProtocols.h
 NGStreams.h
 NGStreamsDecls.h
 NGStringTextStream.h
 NGTerminalSupport.h
 NGTextStream.h
 NGTextStreamProtocols.h
include/SBJson/
 NSObject+SBJSON.h
 NSString+SBJSON.h
 SBJson.h
 SBJsonBase.h
 SBJsonParser.h
 SBJsonWriter.h
include/SaxObjC/
 SaxAttributeList.h
 SaxAttributes.h
 SaxContentHandler.h
 SaxDTDHandler.h
 SaxDeclHandler.h
 SaxDefaultHandler.h
 SaxDocumentHandler.h
 SaxEntityResolver.h
 SaxErrorHandler.h
 SaxException.h
 SaxHandlerBase.h
 SaxLexicalHandler.h
 SaxLocator.h
 SaxMethodCallHandler.h
 SaxNamespaceSupport.h
 SaxObjC.h
 SaxObjectDecoder.h
 SaxObjectModel.h
 SaxXMLFilter.h
 SaxXMLReader.h
 SaxXMLReaderFactory.h
 XMLNamespaces.h
include/WEExtensions/
 WEContextConditional.h
 WEResourceManager.h
include/WOExtensions/
 WOExtensions.h
 WORedirect.h
include/XmlRpc/
 NSObject+XmlRpc.h
 XmlRpc.h
 XmlRpcCoder.h
 XmlRpcMethodCall.h
 XmlRpcMethodResponse.h
lib/
 libDOM.so
 libEOControl.so
 libGDLAccess.so
 libNGExtensions.so
 libNGMime.so
 libNGObjWeb.so
 libNGStreams.so
 libSBJson.so
 libSaxObjC.so
 libWEExtensions.so
 libWOExtensions.so
 libXmlRpc.so
lib/GNUstep/Libraries/Resources/NGObjWeb/
 DAVPropMap.plist
 Defaults.plist
 Languages.plist
lib/GNUstep/SaxDrivers-4.9/STXSaxDriver.sax/
 bundle-info.plist
 stamp.make
lib/GNUstep/SaxDrivers-4.9/STXSaxDriver.sax/Resources/
 Info-gnustep.plist
 Version
lib/GNUstep/SaxDrivers-4.9/libxmlSAXDriver.sax/
 bundle-info.plist
 stamp.make
lib/GNUstep/SaxDrivers-4.9/libxmlSAXDriver.sax/Resources/
 Info-gnustep.plist
 Version
 bundle-info.plist
lib/GNUstep/SoProducts-4.9/SoCore.sxp/stamp.make
lib/GNUstep/SoProducts-4.9/SoCore.sxp/Resources/
 Info-gnustep.plist
 Version
 product.plist
lib/GNUstep/WOxElemBuilders-4.9/WEExtensions.wox/
 bundle-info.plist
 stamp.make
lib/GNUstep/WOxElemBuilders-4.9/WEExtensions.wox/Resources/Info-gnustep.plist
lib/GNUstep/WOxElemBuilders-4.9/WOExtensions.wox/
 bundle-info.plist
 stamp.make
lib/GNUstep/WOxElemBuilders-4.9/WOExtensions.wox/Resources/Info-gnustep.plist
share/GNUstep/Makefiles/
 woapp.make
 wobundle.make
share/GNUstep/Makefiles/Additional/ngobjweb.make
include/NGLdap/
 EOQualifier+LDAP.h
 NGLdapGlobalID.h
 NGLdapConnection.h
 NGLdapSearchResultEnumerator.h
 NGLdapFileManager.h
 NGLdap.h
 NGLdapAttribute.h
 NGLdapModification.h
 NGLdapDataSource.h
 NSString+DN.h
 NGLdapURL.h
 NGLdapEntry.h
lib/
 libNGLdap.so


[FILE:45:manifests/plist.tools]
bin/
 connect-EOAdaptor
 load-EOAdaptor
 wod


[FILE:165:manifests/plist.pgsql]
lib/GNUstep/GDLAdaptors-4.9/PostgreSQL.gdladaptor/Resources/
 Info-gnustep.plist
 Version
lib/GNUstep/GDLAdaptors-4.9/PostgreSQL.gdladaptor/
 PostgreSQL
 stamp.make


[FILE:64:manifests/plist.ldap]
lib/
 libNGLdap.so.%%SO_LDAP%%
 libNGLdap.so.%%SO_LDAP_MAJMIN%%


[FILE:527:patches/patch-sope-core_NGStreams_NGDescriptorFunctions.m]
$NetBSD: patch-sope-core_NGStreams_NGDescriptorFunctions.m,v 1.1 2021/06/14 16:51:39 gdt Exp $

ttyname_r comes from <unistd.h> which is already included

--- sope-core/NGStreams/NGDescriptorFunctions.m.orig	2025-03-24 09:41:38 UTC
+++ sope-core/NGStreams/NGDescriptorFunctions.m
@@ -387,9 +387,6 @@ NSString *NGDescriptorGetTtyName(int _fd
 #endif
   {
 #if HAVE_TTYNAME_R
-#  ifndef sparc
-   extern int ttyname_r(int, char*, size_t);
-#  endif
 #  ifdef _POSIX_PATH_MAX
     char namebuffer[_POSIX_PATH_MAX + 128];
 #  else


[FILE:467:patches/patch-sope-core_NGStreams_NGLocalSocketAddress.m]
$NetBSD: patch-sope-core_NGStreams_NGLocalSocketAddress.m,v 1.1 2021/06/14 16:51:39 gdt Exp $

Add support for DragonFly.

--- sope-core/NGStreams/NGLocalSocketAddress.m.orig	2025-03-24 09:41:38 UTC
+++ sope-core/NGStreams/NGLocalSocketAddress.m
@@ -28,7 +28,7 @@
 
 #include "config.h"
 
-#if defined(__APPLE__) || defined(__FreeBSD__)
+#if defined(__APPLE__) || defined(__FreeBSD__) || defined(__DragonFly__)
 #  include <sys/types.h>
 #else
 #  include <sys/un.h>


[FILE:503:patches/patch-sope-core_NGStreams_NGLocalSocketDomain.m]
$NetBSD: patch-sope-core_NGStreams_NGLocalSocketDomain.m,v 1.1 2021/06/14 16:51:39 gdt Exp $

Add support for DragonFly.

--- sope-core/NGStreams/NGLocalSocketDomain.m.orig	2025-03-24 09:41:38 UTC
+++ sope-core/NGStreams/NGLocalSocketDomain.m
@@ -25,7 +25,7 @@
 #include "NGLocalSocketAddress.h"
 #include "NGSocket.h"
 
-#if defined(__APPLE__) || defined(__FreeBSD__)
+#if defined(__APPLE__) || defined(__FreeBSD__) || defined(__DragonFly__)
 #  include <sys/types.h>
 #  include <sys/socket.h>
 #else


[FILE:375:patches/patch-sope-gdl1_GDLAccess_GNUmakefile.preamble]
--- sope-gdl1/GDLAccess/GNUmakefile.preamble.orig	2025-03-24 09:41:38 UTC
+++ sope-gdl1/GDLAccess/GNUmakefile.preamble
@@ -21,6 +21,7 @@ ADDITIONAL_INCLUDE_DIRS += \
 	-I$(SOPE_ROOT)/sope-core/NGExtensions/
 
 
+ADDITIONAL_OBJCFLAGS += -Wno-incompatible-function-pointer-types
 
 ifneq ($(CGS_LIBDIR_NAME),)
 ADDITIONAL_CPPFLAGS += -DCGS_LIBDIR_NAME=\@\"$(CGS_LIBDIR_NAME)\"


[FILE:298:patches/patch-sope-ldap_NGLdap_GNUmakefile.preamble]
--- sope-ldap/NGLdap/GNUmakefile.preamble.orig	2025-03-24 09:41:38 UTC
+++ sope-ldap/NGLdap/GNUmakefile.preamble
@@ -9,6 +9,7 @@ ADDITIONAL_INCLUDE_DIRS += \
 	-I/usr/local/include
 
 ADDITIONAL_CPPFLAGS += -Wall -Wno-protocol
+ADDITIONAL_OBJCFLAGS += -Wno-error=int-conversion
 
 
 # dependencies


[FILE:722:files/special.mk]
CPP=	clang-cpp
# pulled from FreeBSD's gnustep extension

#GNUSTEP_PREFIX?=		${LOCALBASE}/GNUstep
#GNUSTEP_SYSTEM_ROOT=		${GNUSTEP_PREFIX}/System
#GNUSTEP_MAKEFILES=		${GNUSTEP_SYSTEM_ROOT}/Library/Makefiles
#GNUSTEP_SYSTEM_LIBRARIES=	${GNUSTEP_SYSTEM_ROOT}/Library/Libraries
#GNUSTEP_SYSTEM_TOOLS=		${GNUSTEP_SYSTEM_ROOT}/Tools
#GNUSTEP_LOCAL_ROOT=		${GNUSTEP_PREFIX}/Local
#GNUSTEP_LOCAL_LIBRARIES=	${GNUSTEP_LOCAL_ROOT}/Library/Libraries
#GNUSTEP_LOCAL_TOOLS=		${GNUSTEP_LOCAL_ROOT}/Tools
#PREPEND_PATH=	${GNUSTEP_SYSTEM_TOOLS}:${GNUSTEP_LOCAL_TOOLS}

GNUSTEP_MAKEFILES=		${LOCALBASE}/share/GNUstep/Makefiles

MAKE_ENV+=	GNUSTEP_MAKEFILES="${GNUSTEP_MAKEFILES}"
CONFIGURE_ENV+=	GNUSTEP_MAKEFILES="${GNUSTEP_MAKEFILES}"

