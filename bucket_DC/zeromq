# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		zeromq
VERSION=		4.3.4
KEYWORDS=		net
VARIANTS=		standard
SDESC[standard]=	High-performance, asynchronous messaging library
HOMEPAGE=		https://zeromq.org/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		https://github.com/zeromq/libzmq/releases/download/v4.3.4/
DISTFILE[1]=		zeromq-4.3.4.tar.gz:main
DF_INDEX=		1
SPKGS[standard]=	single

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILD_DEPENDS=		xmlto:single:standard
			asciidoc:single:standard
BUILDRUN_DEPENDS=	libsodium:single:standard
			norm:single:standard

USES=			cpe gmake libtool pkgconfig

LICENSE=		LGPL3+:single
LICENSE_TERMS=		single:{{WRKDIR}}/TERMS
LICENSE_FILE=		LGPL3+:{{WRKSRC}}/COPYING.LESSER
LICENSE_AWK=		TERMS:"\#include"
LICENSE_SOURCE=		TERMS:{{WRKSRC}}/src/zmq.cpp
LICENSE_SCHEME=		solo

FPC_EQUIVALENT=		net/libzmq4

MUST_CONFIGURE=		gnu
CONFIGURE_ARGS=		--with-libsodium
			--with-pkgconfigdir={{LOCALBASE}}/lib/pkgconfig
			--with-norm={{LOCALBASE}}
			--without-pgm

MAKE_ENV=		V=1

INSTALL_TARGET=		install-strip
SOVERSION=		5.2.4

[FILE:433:descriptions/desc.single]
ZeroMQ - Distributed Computing Made Simple

 * The socket library that acts as a concurrency framework.
 * Carries messages across inproc, IPC, TCP, and multicast.
 * Connect N-to-N via fanout, pubsub, pipeline, request-reply.
 * Asynch I/O for scalable multicore message-passing apps.

Version 4 Features:

 * New wire level protocol, ZMTP/3.0
 * New security framework with PLAIN and CURVE mechanisms
 * New ZMQ_STREAM socket type


[FILE:98:distinfo]
c593001a89f5a85dd2ddf564805deb860e02471171b3f204944857336295c3e5      2486520 zeromq-4.3.4.tar.gz


[FILE:1547:manifests/plist.single]
bin/curve_keygen
include/
 zmq.h
 zmq_utils.h
lib/
 libzmq.a
 libzmq.so
 libzmq.so.%%SOMAJOR%%
 libzmq.so.%%SOVERSION%%
lib/pkgconfig/libzmq.pc
share/man/man3/
 zmq_atomic_counter_dec.3.gz
 zmq_atomic_counter_destroy.3.gz
 zmq_atomic_counter_inc.3.gz
 zmq_atomic_counter_new.3.gz
 zmq_atomic_counter_set.3.gz
 zmq_atomic_counter_value.3.gz
 zmq_bind.3.gz
 zmq_close.3.gz
 zmq_connect.3.gz
 zmq_connect_peer.3.gz
 zmq_ctx_get.3.gz
 zmq_ctx_new.3.gz
 zmq_ctx_set.3.gz
 zmq_ctx_shutdown.3.gz
 zmq_ctx_term.3.gz
 zmq_curve_keypair.3.gz
 zmq_curve_public.3.gz
 zmq_disconnect.3.gz
 zmq_errno.3.gz
 zmq_getsockopt.3.gz
 zmq_has.3.gz
 zmq_msg_close.3.gz
 zmq_msg_copy.3.gz
 zmq_msg_data.3.gz
 zmq_msg_get.3.gz
 zmq_msg_gets.3.gz
 zmq_msg_init.3.gz
 zmq_msg_init_buffer.3.gz
 zmq_msg_init_data.3.gz
 zmq_msg_init_size.3.gz
 zmq_msg_more.3.gz
 zmq_msg_move.3.gz
 zmq_msg_recv.3.gz
 zmq_msg_routing_id.3.gz
 zmq_msg_send.3.gz
 zmq_msg_set.3.gz
 zmq_msg_set_routing_id.3.gz
 zmq_msg_size.3.gz
 zmq_poll.3.gz
 zmq_poller.3.gz
 zmq_proxy.3.gz
 zmq_proxy_steerable.3.gz
 zmq_recv.3.gz
 zmq_recvmsg.3.gz
 zmq_send.3.gz
 zmq_send_const.3.gz
 zmq_sendmsg.3.gz
 zmq_setsockopt.3.gz
 zmq_socket.3.gz
 zmq_socket_monitor.3.gz
 zmq_socket_monitor_versioned.3.gz
 zmq_strerror.3.gz
 zmq_timers.3.gz
 zmq_unbind.3.gz
 zmq_version.3.gz
 zmq_z85_decode.3.gz
 zmq_z85_encode.3.gz
share/man/man7/
 zmq.7.gz
 zmq_curve.7.gz
 zmq_gssapi.7.gz
 zmq_inproc.7.gz
 zmq_ipc.7.gz
 zmq_null.7.gz
 zmq_pgm.7.gz
 zmq_plain.7.gz
 zmq_tcp.7.gz
 zmq_tipc.7.gz
 zmq_udp.7.gz
 zmq_vmci.7.gz


[FILE:519:patches/patch-configure]
--- configure.orig	2021-01-17 13:18:46 UTC
+++ configure
@@ -20517,6 +20517,14 @@ $as_echo "#define ZMQ_FORCE_MUTEXES 1" >
 
         fi
         ;;
+    *dragonfly*)
+        # Define on DragonFly to enable all library features
+        CPPFLAGS="-D__BSD_VISIBLE $CPPFLAGS"
+
+$as_echo "#define ZMQ_HAVE_FREEBSD 1" >>confdefs.h
+$as_echo "#define ZMQ_HAVE_DRAGONFLY 1" >>confdefs.h
+
+        ;;
     *freebsd*)
         # Define on FreeBSD to enable all library features
         CPPFLAGS="-D__BSD_VISIBLE $CPPFLAGS"


[FILE:398:patches/patch-src_platform.hpp.in]
--- src/platform.hpp.in.orig	2021-01-17 13:18:46 UTC
+++ src/platform.hpp.in
@@ -240,9 +240,12 @@
 /* Whether EFD_CLOEXEC is defined and functioning. */
 #undef ZMQ_HAVE_EVENTFD_CLOEXEC
 
-/* Have DragonFly OS */
+/* Have FreeBSD or DragonFly OS */
 #undef ZMQ_HAVE_FREEBSD
 
+/* Have DragonFly OS */
+#undef ZMQ_HAVE_DRAGONFLY
+
 /* Whether getrandom is supported. */
 #undef ZMQ_HAVE_GETRANDOM
 


[FILE:387:patches/patch-tests_testutil.hpp]
--- tests/testutil.hpp.orig	2021-01-03 21:46:02 UTC
+++ tests/testutil.hpp
@@ -46,6 +46,10 @@
 #include <unistd.h>
 #include <stdlib.h>
 #endif
+#if defined __DragonFly__ || defined __FreeBSD__
+#include <netinet/in.h>
+#include <sys/socket.h>
+#endif
 
 //  This defines the settle time used in tests; raise this if we
 //  get test failures on slower systems due to binds/connects not

