# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		libepoll-shim
VERSION=		0.0.20161220
KEYWORDS=		devel
VARIANTS=		standard
SDESC[standard]=	Event poll shim implemented using kevent
HOMEPAGE=		https://github.com/FreeBSDDesktop/epoll-shim
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		GITHUB/FreeBSDDesktop:epoll-shim:c04b26b
DISTFILE[1]=		generated:main
DF_INDEX=		1
SPKGS[standard]=	single

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

post-extract:
	${MKDIR} ${WRKSRC}
	cp ${FILESDIR}/* ${WRKSRC}/

[FILE:37:descriptions/desc.single]
epoll shim implemented using kevent.


[FILE:119:distinfo]
ae644d6b21567e9bb5e3a145e6e8ce233de16dc6c93ca4a1facb24f1375f442a         7634 FreeBSDDesktop-epoll-shim-c04b26b.tar.gz


[FILE:119:manifests/plist.single]
include/libepoll-shim/sys/
 epoll.h
 signalfd.h
 timerfd.h
lib/
 libepoll-shim.a
 libepoll-shim.so
 libepoll-shim.so.0


[FILE:1270:files/Makefile]
SONAME=		libepoll-shim.so
LIB_STATIC=	libepoll-shim.a
LIB_DYNAMIC=	${SONAME}.0

SRCS=		epoll.c timerfd.c signalfd.c common.c
INCS=		include/sys/epoll.h include/sys/timerfd.h include/sys/signalfd.h

all:  ${LIB_STATIC} ${LIB_DYNAMIC}

CFLAGS+=	-I${.CURDIR}/include -Wall -Wno-missing-prototypes -Wno-padded

.if "${OPSYS}" == "DragonFly"
CFLAGS+=	-DSIGRTMIN=50
.endif

PICFLAG=	-fpic
STATIC_OBJS=	${SRCS:.c=.o}
DYNAMIC_OBJS=	${SRCS:.c=.So}

.SUFFIXES:
.SUFFIXES: .c .o .So
.PATH: src

install:
	mkdir -p ${DESTDIR}${PREFIX}/lib
	mkdir -p ${DESTDIR}${PREFIX}/include/libepoll-shim/sys
	${BSD_INSTALL_DATA} ${LIB_STATIC} ${DESTDIR}${PREFIX}/lib
	${BSD_INSTALL_DATA} ${INCS} ${DESTDIR}${PREFIX}/include/libepoll-shim/sys

.c.o:
	${CC} ${CFLAGS} -c ${.IMPSRC} -o ${.TARGET}

.c.So:
	${CC} ${PICFLAG} -DPIC ${SHARED_CFLAGS} ${CFLAGS} -c ${.IMPSRC} -o ${.TARGET}	

clean:
	rm -f ${LIB_STATIC} ${LIB_DYNAMIC} ${STATIC_OBJS} ${DYNAMIC_OBJS}

${LIB_STATIC}: ${STATIC_OBJS}
	@${ECHO} building static ${LIB_STATIC} library
	ar cq ${.TARGET} `lorder ${.ALLSRC} | tsort -q`
	ranlib ${.TARGET}

${LIB_DYNAMIC}: ${DYNAMIC_OBJS}
	@${ECHO} building shared ${LIB_DYNAMIC} library
	${CC} ${LDFLAGS} -shared -Wl,-x \
		-o ${.TARGET} -Wl,-soname,${SONAME} \
		 `lorder ${.ALLSRC} | tsort -q`

