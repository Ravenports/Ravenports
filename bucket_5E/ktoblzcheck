# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		ktoblzcheck
VERSION=		1.59
KEYWORDS=		finance
VARIANTS=		std
SDESC[std]=		Check bank codes of German banks
HOMEPAGE=		https://sourceforge.net/projects/ktoblzcheck/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main bankdata
SITES[main]=		SF/ktoblzcheck
DISTFILE[1]=		ktoblzcheck-1.59.tar.gz:main
DF_INDEX=		1
SPKGS[std]=		set
			primary
			dev
			tools
			man

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILD_DEPENDS=		curl:dev:std
BUILDRUN_DEPENDS=	curl:primary:std
RUN_DEPENDS=		ktoblzcheck-data:single:std
EXRUN[tools]=		primary

USES=			cmake sqlite c++:primary

LICENSE=		LGPL21+:primary
LICENSE_TERMS=		primary:{{WRKDIR}}/TERMS
LICENSE_FILE=		LGPL21+:{{WRKSRC}}/COPYING
LICENSE_AWK=		TERMS:"HAVE_CONFIG_H"
LICENSE_SOURCE=		TERMS:{{WRKSRC}}/src/bin/ktoblzcheck.cc
LICENSE_SCHEME=		solo

FPC_EQUIVALENT=		finance/ktoblzcheck

SOVERSION=		1.5.26
SUB_FILES=		messages-primary.ucl
			scripts-primary.ucl
SUB_LIST=		DATADIR={{PREFIX}}/share/ktoblzcheck

CMAKE_ARGS=		-DCMAKE_DISABLE_FIND_PACKAGE_Python3:BOOL=ON

post-install:
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/ktoblzcheck
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/ktoblzupdate
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/ibanchk
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/lib/libktoblzcheck.so

[FILE:111:descriptions/desc.primary]
KtoBlzCheck is a library to check bank account numbers and bank codes (BLZ)
of various financial institutions.


[FILE:45:descriptions/desc.tools]
This package contains the KtoBlzCheck tools.


[FILE:102:distinfo]
3cd33880d2425e8fa3be9918c85485514f53e04b0b986bcf7bd003fc53071fa7        89603 ktoblzcheck-1.59.tar.gz


[FILE:69:manifests/plist.primary]
lib/
 libktoblzcheck.so.%%SOMAJOR%%
 libktoblzcheck.so.%%SOVERSION%%


[FILE:245:manifests/plist.dev]
include/
 iban.h
 ktoblzcheck.h
 ktoblzcheck_export.h
lib/libktoblzcheck.so
lib/cmake/KtoBlzCheck/
 KtoBlzCheckConfig.cmake
 KtoBlzCheckConfigVersion.cmake
 KtoBlzCheckTargets-release.cmake
 KtoBlzCheckTargets.cmake
lib/pkgconfig/ktoblzcheck.pc


[FILE:41:manifests/plist.tools]
bin/
 ibanchk
 ktoblzcheck
 ktoblzupdate


[FILE:42:manifests/plist.man]
share/man/man1/
 ibanchk.1
 ktoblzcheck.1


[FILE:876:patches/patch-cmake_Macros.cmake]
--- cmake/Macros.cmake.orig	2025-05-20 08:49:45 UTC
+++ cmake/Macros.cmake
@@ -16,10 +16,10 @@ macro(setup_filenames)
         set(DATA_FILEPATH ${CMAKE_CURRENT_SOURCE_DIR}/${DATA_FILE})
         message(STATUS "Using data file ${DATA_FILEPATH} for key ${__KEY}")
     else()
-        file(GLOB DATA_FILEPATHS "${CMAKE_CURRENT_SOURCE_DIR}/${__PREFIX}_2*.txt")
+        file(GLOB DATA_FILEPATHS "${CMAKE_CURRENT_SOURCE_DIR}/${__PREFIX}_*.txt")
         list(SORT DATA_FILEPATHS COMPARE FILE_BASENAME)
         list(POP_BACK DATA_FILEPATHS DATA_FILEPATH)
-        get_filename_component(DATA_FILE ${DATA_FILEPATH} NAME)
+        get_filename_component(DATA_FILE "${DATA_FILEPATH}" NAME)
         message(STATUS "Using present data file '${DATA_FILEPATH}' for key ${__KEY}")
     endif()
     set(DATA_FILEPATH_${__KEY} ${DATA_FILEPATH}  CACHE STRING "raw data file path" FORCE)


[FILE:488:files/messages-primary.ucl.in]
primary: {
  type: "install"
  message: <<EOM
The bankdata included with the ktoblzcheck distribution is outdated.
You should update this bankdata upon installation and periodically
afterwards. New bankdata is typically available every three months.

To update the bankdata, run (as root):

# %%DATADIR%%/online_update.pl

The script is interactive and will present you with the bankdata
available for download. Follow the prompts and it will write the
new bankdata to %%DATADIR%%.
EOM
}


[FILE:251:files/scripts-primary.ucl.in]
post-deinstall: [{
     args: ""
     code: <<EOS
if [ -d %%DATADIR%% ]; then
   echo "To completely remove the port, you may need to remove"
   echo "the following directories and the content manually:"
   echo ""
   echo "    %%DATADIR%%"
fi
EOS
}]

