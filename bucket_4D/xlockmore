# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		xlockmore
VERSION=		5.81
KEYWORDS=		x11
VARIANTS=		std
SDESC[std]=		X Window System Lock Screen
HOMEPAGE=		http://www.sillycycle.com/xlockmore.html
CONTACT=		Michael_Reim[kraileth@elderlinux.org]

DOWNLOAD_GROUPS=	main
SITES[main]=		http://sillycycle.com/xlock/
DISTFILE[1]=		xlockmore-5.81.tar.xz:main
DF_INDEX=		1
SPKGS[std]=		set
			primary
			man

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

USES=			cpe freetype c++:primary
XORG_COMPONENTS=	x11 xaw ice sm xpm xext xinerama

LICENSE=		ISCL:primary
LICENSE_FILE=		ISCL:{{WRKDIR}}/LICENSE
LICENSE_AWK=		ISCL:"^\#include"
LICENSE_SOURCE=		ISCL:{{WRKSRC}}/xlock/xlock.c
LICENSE_SCHEME=		solo

CPE_VENDOR=		david_bagley
FPC_EQUIVALENT=		x11/xlockmore

MUST_CONFIGURE=		gnu
CONFIGURE_ARGS=		--disable-bomb
			--enable-blank-only
			--enable-customization
			--without-dtsaver
			--without-editres
			--without-esound
			--without-ftgl
			--without-gtk
			--without-gtk2
			--without-magick
			--without-mesa
			--without-motif
			--without-nas
			--without-opengl
			--without-rplay
			--disable-setuid
			--without-ttf

post-configure:
	${REINPLACE_CMD} -e 's/-lXdpms//g' ${WRKSRC}/modes/Makefile

post-extract:
	${REINPLACE_CMD} -e 's|/usr/lib|${PREFIX}/lib|g' ${WRKSRC}/configure
	${REINPLACE_CMD} -e 's| $$(SOUNDPATH)| $$(DESTDIR)$$(SOUNDPATH)|' \
	${WRKSRC}/modes/Makefile.in
	${REINPLACE_CMD} -e \
	'/$$(ETCDIR)play.sh/ s|$$(INSTALL_PROGRAM)|$$(INSTALL_PROGRAM:N-s)|' \
	${WRKSRC}/modes/Makefile.in

post-extract-freebsd:
	${REINPLACE_CMD} -e 's|/usr/games/fortune|/usr/bin/fortune|' \
	${WRKSRC}/modes/Makefile.in

[FILE:662:descriptions/desc.primary]
xlock locks the X server till the user enters their password
at the keyboard.  While xlock is running, all new server
connections are refused. The screen saver is disabled. The
mouse cursor is turned off.  The screen is blanked and a
changing pattern is put on the screen.  If a key or a mouse
button is pressed then the user is prompted for the password
of the user who started xlock.

If the correct password is typed, then the screen is
unlocked and the X server is restored.  When typing the
password Control-U and Control-H are active as kill and
erase respectively.  To return to the locked screen, click
in the small icon version of the changing pattern.


[FILE:100:distinfo]
0530181328a7c668b6d7b24c0cfa32aa93b4bbae23c0c4f09f1d3b347ec98a97      2060904 xlockmore-5.81.tar.xz


[FILE:186:manifests/plist.primary]
@(,,4111) bin/play.sh
@(,,4111) bin/xlock
@(,,4111) bin/xmlock
lib/X11/app-defaults/
 XLock
 XmLock
share/xlock/sounds/
 complete.au
 identify-please.au
 not-programmed.au
 thank-you.au


[FILE:23:manifests/plist.man]
share/man/man1/xlock.1


[FILE:337:patches/patch-xmlock_xmlock.c]
--- xmlock/xmlock.c.orig	2023-07-12 21:33:07 UTC
+++ xmlock/xmlock.c
@@ -42,7 +42,7 @@ static const char sccsid[] = "@(#)xmlock
 #include <stdio.h>
 #include <stdlib.h>
 #include <time.h>
-#ifdef __FreeBSD__
+#if defined(__FreeBSD__) || defined(__DragonFly__) || defined(__NetBSD__)
 #include <signal.h>
 #endif
 #include <sys/signal.h>

