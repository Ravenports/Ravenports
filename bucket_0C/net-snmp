# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		net-snmp
VERSION=		5.9.3
REVISION=		1
KEYWORDS=		net_mgmt
VARIANTS=		standard
SDESC[standard]=	Extensible SNMP implementation
HOMEPAGE=		https://sourceforge.net/projects/net-snmp/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		SF/net-snmp/net-snmp/5.9.3
DISTFILE[1]=		net-snmp-5.9.3.tar.gz:main
DF_INDEX=		1
SPKGS[standard]=	complete
			primary
			dev
			man

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

USES=			cpe libtool perl ssl ncurses mbsdfix

LICENSE=		BSD3CLAUSE:primary
LICENSE_FILE=		BSD3CLAUSE:{{WRKSRC}}/COPYING
LICENSE_SCHEME=		solo

CPE_PRODUCT=		net-snmp
FPC_EQUIVALENT=		net-mgmt/net-snmp

MUST_CONFIGURE=		gnu
CONFIGURE_ARGS=		--enable-shared
			--enable-internal-md5
			--enable-embedded-perl
			--with-perl-modules
			--with-dummy-values
			--without-libwrap
			--without-kmem-usage
			--with-openssl="{{OPENSSLBASE}}"
			--with-default-snmp-version="3"
			--with-logfile="/var/log/snmpd.log"
			--with-persistent-directory="/var/net-snmp"
			--with-mib-modules="smux disman/event-mib mibII/mta_sendmail ucd-snmp/diskio{{OPSYS_MODS:S/,/ /}}"
			--with-out-mib-modules="ucd_snmp host ucd-snmp/memory sctp-mib{{OPSYS_NOMODS:S/,/ /}}"
			--with-sys-contact="default_user@contact.domain"
			--with-sys-location="defaultlocation"
CONFIGURE_ENV=		PERLPROG="{{PERL}}"
			SED="{{SED}}"

INSTALL_REQ_TOOLCHAIN=	yes
SOVERSION=		40.2.0
RC_SUBR=		snmpd:primary
			snmptrapd:primary
SUB_FILES=		pkg-message-primary

VAR_OPSYS[freebsd]=	MAKEFILE_LINE=OPSYS_MODS=,mibII/tcpTable,mibII/ipv6
VAR_OPSYS[netbsd]=	MAKEFILE_LINE=OPSYS_MODS=,mibII/kernel_netbsd
			MAKEFILE_LINE=OPSYS_NOMODS=,mibII/ipv6,mibII/tcpTable,mibII/udpTable
VAR_OPSYS[dragonfly]=	MAKE_ENV=MIB_SYSTEM_LIBS=-lkinfo
			MAKE_ENV=OPSYS=DragonFly
			CONFIGURE_ARGS=ac_cv_IFNET_NEEDS_KERNEL=no
			MAKEFILE_LINE=OPSYS_MODS=,mibII/tcpTable,mibII/ipv6
VAR_OPSYS[midnightbsd]=	MAKEFILE_LINE=OPSYS_MODS=,mibII/tcpTable,mibII/ipv6

post-extract-linux:
	for XX in 7 8 9 10 11 12 13 14 15 16 17; do \
	  ${CP} ${WRKSRC}/include/net-snmp/system/darwin.h \
	  ${WRKSRC}/include/net-snmp/system/darwin$${XX}.h ;\
	done

post-install:
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/lib/lib*.so
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/sbin/*
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/[ae]*
	${STRIP_CMD} ${STAGEDIR}${SITE_ARCH}/auto/SNMP/SNMP.so
	${STRIP_CMD} ${STAGEDIR}${SITE_ARCH}/auto/NetSNMP/*/*.so
	${STRIP_CMD} ${STAGEDIR}${SITE_ARCH}/auto/NetSNMP/agent/default_store/default_store.so
	for last in bulkget bulkwalk delta df get getnext netstat ping ps set status \
	    table test translate trap usm vacm walk; do \
		${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/snmp$${last}; \
	done

pre-configure:
	# ${REINPLACE_CMD} -e 's/-fstack-protector*//g' ${WRKSRC}/ltmain.sh
	${REINPLACE_CMD} -E -e 's|return pci_lookup_name|disabled broken|g' \
		${WRKSRC}/configure
	# support midnight
	${CP} ${WRKSRC}/include/net-snmp/system/freebsd12.h \
	${WRKSRC}/include/net-snmp/system/midnightbsd3.h \

pre-configure-dragonfly:
	${CP} ${FILESDIR}/cpu_dragonfly.c \
		${WRKSRC}/agent/mibgroup/hardware/cpu/cpu_nlist.c

[FILE:238:descriptions/desc.primary]
Net-SNMP provides tools and libraries relating to the Simple Network
Management Protocol including: An extensible agent, an SNMP library,
tools to request or set information from SNMP agents, tools to generate
and handle SNMP traps, etc.


[FILE:100:distinfo]
2097f29b7e1bf3f1300b4bae52fa2308d0bb8d5d3998dbe02f9462a413a2ef0a      6646950 net-snmp-5.9.3.tar.gz


[FILE:5416:manifests/plist.primary]
%%SITE_ARCH%%/SNMP.pm
%%SITE_ARCH%%/Bundle/MakefileSubs.pm
%%SITE_ARCH%%/NetSNMP/
 ASN.pm
 OID.pm
 TrapReceiver.pm
 agent.pm
 default_store.pm
%%SITE_ARCH%%/NetSNMP/agent/
 Support.pm
 default_store.pm
 netsnmp_request_infoPtr.pm
%%SITE_ARCH%%/auto/Bundle/NetSNMP/.packlist
%%SITE_ARCH%%/auto/NetSNMP/ASN/
 ASN.so
 autosplit.ix
%%SITE_ARCH%%/auto/NetSNMP/OID/
 OID.so
 autosplit.ix
%%SITE_ARCH%%/auto/NetSNMP/TrapReceiver/
 TrapReceiver.so
 autosplit.ix
%%SITE_ARCH%%/auto/NetSNMP/agent/
 agent.so
 autosplit.ix
%%SITE_ARCH%%/auto/NetSNMP/agent/default_store/
 autosplit.ix
 default_store.so
%%SITE_ARCH%%/auto/NetSNMP/default_store/
 autosplit.ix
 default_store.so
%%SITE_ARCH%%/auto/SNMP/
 SNMP.so
 autosplit.ix
bin/
 agentxtrap
 checkbandwidth
 encode_keychange
 fixproc
 ipf-mod.pl
 mib2c
 mib2c-update
 net-snmp-cert
 net-snmp-config
 net-snmp-create-v3-user
 snmp-bridge-mib
 snmpbulkget
 snmpbulkwalk
 snmpcheck
 snmpconf
 snmpdelta
 snmpdf
 snmpget
 snmpgetnext
 snmpinform
 snmpnetstat
 snmpping
 snmpps
 snmpset
 snmpstatus
 snmptable
 snmptest
 snmptop
 snmptranslate
 snmptrap
 snmpusm
 snmpvacm
 snmpwalk
 tkmib
 traptoemail
lib/
 libnetsnmp.so.%%SOMAJOR%%
 libnetsnmp.so.%%SOVERSION%%
 libnetsnmpagent.so.%%SOMAJOR%%
 libnetsnmpagent.so.%%SOVERSION%%
 libnetsnmphelpers.so.%%SOMAJOR%%
 libnetsnmphelpers.so.%%SOVERSION%%
 libnetsnmpmibs.so.%%SOMAJOR%%
 libnetsnmpmibs.so.%%SOVERSION%%
 libnetsnmptrapd.so.%%SOMAJOR%%
 libnetsnmptrapd.so.%%SOVERSION%%
sbin/
 snmpd
 snmptrapd
share/snmp/
 mib2c.access_functions.conf
 mib2c.array-user.conf
 mib2c.check_values.conf
 mib2c.check_values_local.conf
 mib2c.column_defines.conf
 mib2c.column_enums.conf
 mib2c.column_storage.conf
 mib2c.conf
 mib2c.container.conf
 mib2c.create-dataset.conf
 mib2c.genhtml.conf
 mib2c.int_watch.conf
 mib2c.iterate.conf
 mib2c.iterate_access.conf
 mib2c.mfd.conf
 mib2c.notify.conf
 mib2c.old-api.conf
 mib2c.org-mode.conf
 mib2c.perl.conf
 mib2c.raw-table.conf
 mib2c.scalar.conf
 mib2c.table_data.conf
 snmp_perl.pl
 snmp_perl_trapd.pl
share/snmp/mib2c-data/
 default-mfd-top.m2c
 details-enums.m2i
 details-node.m2i
 details-table.m2i
 generic-ctx-copy.m2i
 generic-ctx-get.m2i
 generic-ctx-set.m2i
 generic-data-allocate.m2i
 generic-data-context.m2i
 generic-get-U64.m2i
 generic-get-char.m2i
 generic-get-decl-bot.m2i
 generic-get-decl.m2i
 generic-get-long.m2i
 generic-get-oid.m2i
 generic-header-bottom.m2i
 generic-header-top.m2i
 generic-source-includes.m2i
 generic-table-constants.m2c
 generic-table-enums.m2c
 generic-table-indexes-from-oid.m2i
 generic-table-indexes-set.m2i
 generic-table-indexes-to-oid.m2i
 generic-table-indexes-varbind-setup.m2i
 generic-table-indexes.m2i
 generic-table-oids.m2c
 generic-value-map-func.m2i
 generic-value-map-reverse.m2i
 generic-value-map.m2i
 m2c-internal-warning.m2i
 m2c_setup_enum.m2i
 m2c_setup_node.m2i
 m2c_setup_table.m2i
 m2c_table_save_defaults.m2i
 mfd-access-container-cached-defines.m2i
 mfd-access-unsorted-external-defines.m2i
 mfd-data-access.m2c
 mfd-data-get.m2c
 mfd-data-set.m2c
 mfd-doxygen.m2c
 mfd-interactive-setup.m2c
 mfd-interface.m2c
 mfd-makefile.m2m
 mfd-persistence.m2i
 mfd-readme.m2c
 mfd-top.m2c
 node-get.m2i
 node-set.m2i
 node-storage.m2i
 node-validate.m2i
 node-varbind-validate.m2i
 parent-dependencies.m2i
 parent-set.m2i
 subagent.m2c
 syntax-COUNTER64-get.m2i
 syntax-DateAndTime-get.m2d
 syntax-DateAndTime-get.m2i
 syntax-DateAndTime-readme.m2i
 syntax-InetAddress-get.m2i
 syntax-InetAddress-set.m2i
 syntax-InetAddressType-get.m2i
 syntax-InetAddressType-set.m2i
 syntax-RowStatus-dependencies.m2i
 syntax-RowStatus-get.m2i
 syntax-RowStatus-varbind-validate.m2i
 syntax-StorageType-dependencies.m2i
 syntax-TestAndIncr-get.m2i
share/snmp/mibs/
 AGENTX-MIB.txt
 BRIDGE-MIB.txt
 DISMAN-EVENT-MIB.txt
 DISMAN-SCHEDULE-MIB.txt
 DISMAN-SCRIPT-MIB.txt
 EtherLike-MIB.txt
 HCNUM-TC.txt
 HOST-RESOURCES-MIB.txt
 HOST-RESOURCES-TYPES.txt
 IANA-ADDRESS-FAMILY-NUMBERS-MIB.txt
 IANA-LANGUAGE-MIB.txt
 IANA-RTPROTO-MIB.txt
 IANAifType-MIB.txt
 IF-INVERTED-STACK-MIB.txt
 IF-MIB.txt
 INET-ADDRESS-MIB.txt
 IP-FORWARD-MIB.txt
 IP-MIB.txt
 IPV6-FLOW-LABEL-MIB.txt
 IPV6-ICMP-MIB.txt
 IPV6-MIB.txt
 IPV6-TC.txt
 IPV6-TCP-MIB.txt
 IPV6-UDP-MIB.txt
 MTA-MIB.txt
 NET-SNMP-AGENT-MIB.txt
 NET-SNMP-EXAMPLES-MIB.txt
 NET-SNMP-EXTEND-MIB.txt
 NET-SNMP-MIB.txt
 NET-SNMP-PASS-MIB.txt
 NET-SNMP-TC.txt
 NET-SNMP-VACM-MIB.txt
 NETWORK-SERVICES-MIB.txt
 NOTIFICATION-LOG-MIB.txt
 RFC-1215.txt
 RFC1155-SMI.txt
 RFC1213-MIB.txt
 RMON-MIB.txt
 SCTP-MIB.txt
 SMUX-MIB.txt
 SNMP-COMMUNITY-MIB.txt
 SNMP-FRAMEWORK-MIB.txt
 SNMP-MPD-MIB.txt
 SNMP-NOTIFICATION-MIB.txt
 SNMP-PROXY-MIB.txt
 SNMP-TARGET-MIB.txt
 SNMP-TLS-TM-MIB.txt
 SNMP-TSM-MIB.txt
 SNMP-USER-BASED-SM-MIB.txt
 SNMP-USM-AES-MIB.txt
 SNMP-USM-DH-OBJECTS-MIB.txt
 SNMP-USM-HMAC-SHA2-MIB.txt
 SNMP-VIEW-BASED-ACM-MIB.txt
 SNMPv2-CONF.txt
 SNMPv2-MIB.txt
 SNMPv2-SMI.txt
 SNMPv2-TC.txt
 SNMPv2-TM.txt
 TCP-MIB.txt
 TRANSPORT-ADDRESS-MIB.txt
 TUNNEL-MIB.txt
 UCD-DEMO-MIB.txt
 UCD-DISKIO-MIB.txt
 UCD-DLMOD-MIB.txt
 UCD-IPFWACC-MIB.txt
 UCD-SNMP-MIB.txt
 UDP-MIB.txt
share/snmp/snmpconf-data/snmp-data/
 authopts
 debugging
 mibs
 output
 snmpconf-config
share/snmp/snmpconf-data/snmpd-data/
 acl
 basic_setup
 extending
 monitor
 operation
 snmpconf-config
 system
 trapsinks
share/snmp/snmpconf-data/snmptrapd-data/
 authentication
 formatting
 logging
 runtime
 snmpconf-config
 traphandle


[FILE:3012:manifests/plist.dev]
include/net-snmp/
 config_api.h
 definitions.h
 mib_api.h
 net-snmp-config.h
 net-snmp-features.h
 net-snmp-includes.h
 output_api.h
 pdu_api.h
 session_api.h
 snmpv3_api.h
 types.h
 utilities.h
 varbind_api.h
 version.h
include/net-snmp/agent/
 agent_callbacks.h
 agent_handler.h
 agent_index.h
 agent_module_config.h
 agent_read_config.h
 agent_registry.h
 agent_sysORTable.h
 agent_trap.h
 all_helpers.h
 auto_nlist.h
 baby_steps.h
 bulk_to_next.h
 cache_handler.h
 debug_handler.h
 ds_agent.h
 instance.h
 mfd.h
 mib_module_config.h
 mib_module_includes.h
 mib_modules.h
 mode_end_call.h
 multiplexer.h
 net-snmp-agent-includes.h
 netsnmp_close_fds.h
 null.h
 old_api.h
 read_only.h
 row_merge.h
 scalar.h
 scalar_group.h
 serialize.h
 set_helper.h
 snmp_agent.h
 snmp_get_statistic.h
 snmp_vars.h
 stash_cache.h
 stash_to_next.h
 struct.h
 sysORTable.h
 table.h
 table_array.h
 table_container.h
 table_data.h
 table_dataset.h
 table_iterator.h
 table_tdata.h
 util_funcs.h
 var_struct.h
 watcher.h
include/net-snmp/agent/util_funcs/
 MIB_STATS_CACHE_TIMEOUT.h
 header_generic.h
 header_simple_table.h
include/net-snmp/library/
 README
 asn1.h
 callback.h
 cert_util.h
 check_varbind.h
 container.h
 container_binary_array.h
 container_iterator.h
 container_list_ssll.h
 container_null.h
 data_list.h
 default_store.h
 dir_utils.h
 fd_event_manager.h
 file_utils.h
 getopt.h
 int64.h
 keytools.h
 large_fd_set.h
 lcd_time.h
 md5.h
 mib.h
 mt_support.h
 netsnmp-attribute-format.h
 oid.h
 oid_stash.h
 parse.h
 read_config.h
 scapi.h
 snmp-tc.h
 snmp.h
 snmpAliasDomain.h
 snmpCallbackDomain.h
 snmpIPBaseDomain.h
 snmpIPv4BaseDomain.h
 snmpIPv6BaseDomain.h
 snmpSocketBaseDomain.h
 snmpTCPBaseDomain.h
 snmpTCPDomain.h
 snmpTCPIPv6Domain.h
 snmpUDPBaseDomain.h
 snmpUDPDomain.h
 snmpUDPIPv4BaseDomain.h
 snmpUDPIPv6Domain.h
 snmpUnixDomain.h
 snmp_alarm.h
 snmp_api.h
 snmp_assert.h
 snmp_client.h
 snmp_debug.h
 snmp_enum.h
 snmp_impl.h
 snmp_logging.h
 snmp_parse_args.h
 snmp_secmod.h
 snmp_service.h
 snmp_transport.h
 snmpusm.h
 snmpv3-security-includes.h
 snmpv3.h
 system.h
 text_utils.h
 tools.h
 transform_oids.h
 types.h
 ucd_compat.h
 vacm.h
 winpipe.h
 winservice.h
include/net-snmp/machine/generic.h
include/net-snmp/system/
 aix.h
 bsd.h
 bsdi.h
 bsdi3.h
 bsdi4.h
 cygwin.h
 darwin.h
 dragonfly.h
 dynix.h
 freebsd.h
 freebsd10.h
 freebsd11.h
 freebsd12.h
 freebsd13.h
 freebsd14.h
 freebsd2.h
 freebsd3.h
 freebsd4.h
 freebsd5.h
 freebsd6.h
 freebsd7.h
 freebsd8.h
 freebsd9.h
 generic.h
 hpux.h
 irix.h
 kfreebsd.h
 linux.h
 midnightbsd3.h
 mingw32.h
 mingw32msvc.h
 mips.h
 netbsd.h
 nto-qnx6.h
 openbsd.h
 openbsd4.h
 openbsd5.h
 openbsd6.h
 osf5.h
 solaris.h
 solaris2.3.h
 solaris2.4.h
 solaris2.5.h
 solaris2.6.h
 sunos.h
 svr5.h
 sysv.h
 ultrix4.h
lib/
 libnetsnmp.a
 libnetsnmp.so
 libnetsnmpagent.a
 libnetsnmpagent.so
 libnetsnmphelpers.a
 libnetsnmphelpers.so
 libnetsnmpmibs.a
 libnetsnmpmibs.so
 libnetsnmptrapd.a
 libnetsnmptrapd.so
lib/pkgconfig/
 netsnmp-agent.pc
 netsnmp.pc


[FILE:3204:manifests/plist.man]
lib/perl5/site_perl/man/man3/
 NetSNMP::ASN.3.gz
 NetSNMP::OID.3.gz
 NetSNMP::TrapReceiver.3.gz
 NetSNMP::agent.3.gz
 NetSNMP::agent::default_store.3.gz
 NetSNMP::default_store.3.gz
 NetSNMP::netsnmp_request_infoPtr.3.gz
 SNMP.3.gz
share/man/man1/
 agentxtrap.1.gz
 encode_keychange.1.gz
 fixproc.1.gz
 mib2c-update.1.gz
 mib2c.1.gz
 net-snmp-config.1.gz
 net-snmp-create-v3-user.1.gz
 snmp-bridge-mib.1.gz
 snmpbulkget.1.gz
 snmpbulkwalk.1.gz
 snmpcmd.1.gz
 snmpconf.1.gz
 snmpdelta.1.gz
 snmpdf.1.gz
 snmpget.1.gz
 snmpgetnext.1.gz
 snmpinform.1.gz
 snmpnetstat.1.gz
 snmpps.1.gz
 snmpset.1.gz
 snmpstatus.1.gz
 snmptable.1.gz
 snmptest.1.gz
 snmptop.1.gz
 snmptranslate.1.gz
 snmptrap.1.gz
 snmpusm.1.gz
 snmpvacm.1.gz
 snmpwalk.1.gz
 tkmib.1.gz
 traptoemail.1.gz
share/man/man3/
 add_mibdir.3.gz
 add_module_replacement.3.gz
 config_perror.3.gz
 config_pwarn.3.gz
 default_store.3.gz
 fprint_description.3.gz
 fprint_objid.3.gz
 fprint_value.3.gz
 fprint_variable.3.gz
 get_module_node.3.gz
 netsnmp_agent_api.3.gz
 netsnmp_config_api.3.gz
 netsnmp_init_mib.3.gz
 netsnmp_mib_api.3.gz
 netsnmp_pdu_api.3.gz
 netsnmp_read_module.3.gz
 netsnmp_sess_api.3.gz
 netsnmp_session_api.3.gz
 netsnmp_trap_api.3.gz
 netsnmp_varbind_api.3.gz
 print_description.3.gz
 print_mib.3.gz
 print_objid.3.gz
 print_value.3.gz
 print_variable.3.gz
 read_all_mibs.3.gz
 read_config_print_usage.3.gz
 read_configs.3.gz
 read_mib.3.gz
 read_objid.3.gz
 read_premib_configs.3.gz
 register_app_config_handler.3.gz
 register_app_prenetsnmp_mib_handler.3.gz
 register_config_handler.3.gz
 register_const_config_handler.3.gz
 register_mib_handlers.3.gz
 register_prenetsnmp_mib_handler.3.gz
 send_easy_trap.3.gz
 send_trap_vars.3.gz
 send_v2trap.3.gz
 shutdown_mib.3.gz
 snmp_add_null_var.3.gz
 snmp_alarm.3.gz
 snmp_alarm_register.3.gz
 snmp_alarm_register_hr.3.gz
 snmp_alarm_unregister.3.gz
 snmp_api_errstring.3.gz
 snmp_async_send.3.gz
 snmp_clone_pdu.3.gz
 snmp_clone_varbind.3.gz
 snmp_close.3.gz
 snmp_error.3.gz
 snmp_fix_pdu.3.gz
 snmp_free_pdu.3.gz
 snmp_free_var.3.gz
 snmp_free_varbind.3.gz
 snmp_open.3.gz
 snmp_parse_oid.3.gz
 snmp_pdu_add_variable.3.gz
 snmp_pdu_create.3.gz
 snmp_perror.3.gz
 snmp_read.3.gz
 snmp_select_info.3.gz
 snmp_send.3.gz
 snmp_sess_async_send.3.gz
 snmp_sess_close.3.gz
 snmp_sess_error.3.gz
 snmp_sess_init.3.gz
 snmp_sess_open.3.gz
 snmp_sess_perror.3.gz
 snmp_sess_read.3.gz
 snmp_sess_select_info.3.gz
 snmp_sess_send.3.gz
 snmp_sess_session.3.gz
 snmp_sess_synch_response.3.gz
 snmp_sess_timeout.3.gz
 snmp_set_mib_errors.3.gz
 snmp_set_mib_warnings.3.gz
 snmp_set_save_descriptions.3.gz
 snmp_set_var_objid.3.gz
 snmp_set_var_typed_integer.3.gz
 snmp_set_var_typed_value.3.gz
 snmp_set_var_value.3.gz
 snmp_synch_response.3.gz
 snmp_timeout.3.gz
 snmp_varlist_add_variable.3.gz
 snprint_description.3.gz
 snprint_objid.3.gz
 snprint_value.3.gz
 snprint_variable.3.gz
 unregister_all_config_handlers.3.gz
 unregister_app_config_handler.3.gz
 unregister_config_handler.3.gz
share/man/man5/
 mib2c.conf.5.gz
 snmp.conf.5.gz
 snmp_config.5.gz
 snmpd.conf.5.gz
 snmpd.examples.5.gz
 snmpd.internal.5.gz
 snmptrapd.conf.5.gz
 variables.5.gz
share/man/man8/
 snmpd.8.gz
 snmptrapd.8.gz


[FILE:422:patches/patch-Makefile.in]
--- Makefile.in.orig	2022-07-13 21:14:14 UTC
+++ Makefile.in
@@ -22,6 +22,7 @@ INCLUDESUBDIRHEADERS= aix.h bsd.h bsdi3.
 	freebsd2.h freebsd3.h freebsd4.h freebsd5.h freebsd6.h \
 	freebsd7.h freebsd8.h freebsd9.h freebsd10.h freebsd11.h \
 	freebsd12.h freebsd13.h freebsd14.h freebsd.h \
+	midnightbsd3.h \
 	generic.h \
 	hpux.h irix.h kfreebsd.h linux.h mingw32.h mingw32msvc.h mips.h \
 	netbsd.h nto-qnx6.h osf5.h \


[FILE:422:patches/patch-agent_mibgroup_hardware_memory_memory__freebsd.c]
--- agent/mibgroup/hardware/memory/memory_freebsd.c.orig	2022-07-13 21:14:14 UTC
+++ agent/mibgroup/hardware/memory/memory_freebsd.c
@@ -164,7 +164,7 @@ int netsnmp_mem_arch_load( netsnmp_cache
         if (!mem->descr)
              mem->descr = strdup("Cached memory");
         mem->units = pagesize;
-        mem->size  = cache_count;
+        mem->size  = cache_count + inact_count;
         mem->free  = 0;
     }
 


[FILE:871:patches/patch-agent_mibgroup_ip-mib_data__access_scalars__sysctl.c]
--- agent/mibgroup/ip-mib/data_access/scalars_sysctl.c.orig	2022-07-13 21:14:14 UTC
+++ agent/mibgroup/ip-mib/data_access/scalars_sysctl.c
@@ -9,6 +9,7 @@
 #include <net-snmp/agent/net-snmp-agent-includes.h>
 #include <net-snmp/data_access/ip_scalars.h>
 
+#include <sys/param.h>
 #include <sys/types.h>
 #include <sys/protosw.h>
 #include <sys/sysctl.h>
@@ -17,6 +18,12 @@
 #include <errno.h>
 #include <stdlib.h>
 
+#if defined(__MidnightBSD__) || (defined(__FreeBSD_version) && __FreeBSD_version > 1400066)
+#define IPFRAGTTL	60	/* time to live for frags, slowhz */
+#define PR_SLOWHZ	2	/* 2 slow timeouts per second */
+#define PR_FASTHZ	5	/* 5 fast timeouts per second */
+#endif
+
 /* XXX: the values passed to netsnmp_arch_ip_scalars(..) may or may not be
  * portable to the other BSDs -- it seems to be portable back to FreeBSD 4.x
  * (Darwin 10.8.0) at least.


[FILE:523:patches/patch-agent_mibgroup_mibII_ip.c]
--- agent/mibgroup/mibII/ip.c.orig	2022-07-13 21:14:14 UTC
+++ agent/mibgroup/mibII/ip.c
@@ -5,6 +5,13 @@
 
 #include <net-snmp/net-snmp-config.h>
 #include "mibII_common.h"
+#include <sys/param.h>
+
+#if defined(__MidnightBSD__) || (defined(__FreeBSD_version) && __FreeBSD_version > 1400066)
+#define IPFRAGTTL	60	/* time to live for frags, slowhz */
+#define PR_SLOWHZ	2	/* 2 slow timeouts per second */
+#define PR_FASTHZ	5	/* 5 fast timeouts per second */
+#endif
 
 #ifdef HAVE_SYS_HASHING_H
 #include <sys/hashing.h>


[FILE:522:patches/patch-agent_mibgroup_mibII_tcp.c]
--- agent/mibgroup/mibII/tcp.c.orig	2022-07-13 21:14:14 UTC
+++ agent/mibgroup/mibII/tcp.c
@@ -8,6 +8,14 @@
 #include <net-snmp/net-snmp-features.h>
 #include "mibII_common.h"
 
+#include <sys/param.h>
+
+#if defined(__MidnightBSD__) || (defined(__FreeBSD_version) && __FreeBSD_version > 1400066)
+#define IPFRAGTTL	60	/* time to live for frags, slowhz */
+#define PR_SLOWHZ	2	/* 2 slow timeouts per second */
+#define PR_FASTHZ	5	/* 5 fast timeouts per second */
+#endif
+
 #if HAVE_STDLIB_H
 #include <stdlib.h>
 #endif


[FILE:625:patches/patch-agent_mibgroup_mibII_udpTable.c]
--- agent/mibgroup/mibII/udpTable.c.orig	2022-07-13 21:14:14 UTC
+++ agent/mibgroup/mibII/udpTable.c
@@ -94,10 +94,10 @@ struct netsnmp_udpEntry_s {
 #define INP_NEXT_SYMBOL		inp_queue.cqe_next	/* or set via <net-snmp/system/openbsd.h> */
 #endif
 
-#if defined(freebsd4) || defined(darwin) || defined(osf5)
+#if defined(freebsd4) || defined(darwin) || defined(osf5) || defined(__MidnightBSD__)
 typedef struct netsnmp_inpcb_s netsnmp_inpcb;
 struct netsnmp_inpcb_s {
-#if __FreeBSD_version >= 1200026
+#if defined(__MidnightBSD__) || (__FreeBSD_version >= 1200026)
     struct xinpcb   pcb;
 #else
     struct inpcb    pcb;


[FILE:1914:files/cpu_dragonfly.c]
/*
 *   DragonFly kinfo interface
 */
#include <net-snmp/net-snmp-config.h>
#include <net-snmp/net-snmp-includes.h>
#include <net-snmp/agent/net-snmp-agent-includes.h>
#include <net-snmp/agent/hardware/cpu.h>

#include <sys/param.h>
#include <sys/vmmeter.h>
#include <kinfo.h>
#include <stdlib.h>
#include <unistd.h>

void _cpu_copy_stats( netsnmp_cpu_info *cpu );

    /*
     * Initialise the list of CPUs on the system
     *   (including descriptions)
     */
void init_cpu_nlist( void ) {
    netsnmp_cpu_info *cpu;
    int i;
    size_t len;
    char           descr[ SNMP_MAXBUF ];

    cpu = netsnmp_cpu_get_byIdx( -1, 1 );
    strcpy(cpu->name, "Overall CPU statistics");

    kinfo_get_cpus(&cpu_num);
    len = sizeof(descr);
    sysctlbyname("hw.model", descr, &len, NULL, 0);
    for ( i = 0; i < cpu_num; i++ ) {
        cpu = netsnmp_cpu_get_byIdx( i, 1 );
        cpu->status = 2;  /* running */
        sprintf(cpu->name, "cpu%d", i);
        sprintf(cpu->descr, "%s", descr);
    }
}


    /*
     * Load the latest CPU usage statistics
     */
int netsnmp_cpu_arch_load( netsnmp_cache *cache, void *magic ) {
    struct vmmeter vmm;
    size_t len;
    struct kinfo_cputime cp_time;
    netsnmp_cpu_info *cpu = netsnmp_cpu_get_byIdx( -1, 0 );
    
    kinfo_get_sched_cputime(&cp_time);
    len = sizeof(vmm);
    sysctlbyname("vm.vmmeter", &vmm, &len, NULL, 0);

    cpu->user_ticks = cp_time.cp_user;
    cpu->nice_ticks = cp_time.cp_nice;
    cpu->sys2_ticks = cp_time.cp_sys + cp_time.cp_intr;
    cpu->idle_ticks = cp_time.cp_idle;
    cpu->kern_ticks = cp_time.cp_sys;
    cpu->intrpt_ticks = cp_time.cp_intr;

    cpu->swapIn = vmm.v_swappgsin + vmm.v_vnodepgsin;
    cpu->swapOut =  vmm.v_swappgsout + vmm.v_vnodepgsout;
    cpu->nInterrupts  = vmm.v_intr;
    cpu->nCtxSwitches = vmm.v_swtch;

    /* Copy "overall" figures to cpu0 entry */
    _cpu_copy_stats( cpu );

    return 0;
}


[FILE:366:files/pkg-message-primary.in]
This port installs snmpd, header files and libraries but does not
     start snmpd by default.
     If you want to auto-start snmpd and snmptrapd:, add the following to
     /etc/rc.conf:

	snmpd_enable="YES"
	snmpd_flags="-a"
	snmpd_conffile="%%PREFIX%%/share/snmp/snmpd.conf /etc/snmpd.conf"
	snmptrapd_enable="YES"
	snmptrapd_flags="-a -p /var/run/snmptrapd.pid"


[FILE:1361:files/snmpd.in]
#!/bin/sh

# PROVIDE: snmpd
# REQUIRE: DAEMON
#
# Add the following line to /etc/rc.conf to enable snmpd:
#
# snmpd_enable="YES"
# snmpd_flags="<set as needed>"
# snmpd_conffile="<set as needed>"

. /etc/rc.subr

name=snmpd
rcvar=snmpd_enable

load_rc_config snmpd

snmpd_enable=${snmpd_enable:-"NO"}
snmpd_flush_cache=${snmpd_flush_cache-"NO"}

pidfile=${snmpd_pidfile:-"/var/run/net_snmpd.pid"}

command=%%PREFIX%%/sbin/${name}

start_precmd=net_snmpd_precmd

net_snmpd_precmd () {
	local flag conffile snmpd_conffile_set

	if checkyesno snmpd_flush_cache; then
		rm -vf /var/net-snmp/.snmp-exec-cache
	fi

	for flag in ${snmpd_flags}; do
		case "${flag}" in
		-p*)
			err 1 "\$snmpd_flags includes -p option." \
				"Please use \$snmpd_pidfile instead."
			;;
		-c*)
			err 1 "\$snmpd_flags includes -c option." \
				"Please use \$snmpd_conffile instead."
			;;
		esac
	done

	for conffile in ${snmpd_conffile}; do
		if [ -f "${conffile}" -a -s "${conffile}" ]; then
		       snmpd_conffile_set="${snmpd_conffile_set},${conffile}"
		else
		       err 1 "snmpd configuration file $conffile not found."
		fi
	done

	# snmpd syntax requires that the listening address (if defined) be the last argument
	if [ -n "${snmpd_conffile_set}" ]; then
		rc_flags="-c ${snmpd_conffile_set#,} ${rc_flags}"
	fi
	rc_flags="-p ${pidfile} ${rc_flags}"
}

run_rc_command "$1"


[FILE:718:files/snmptrapd.in]
#!/bin/sh

# PROVIDE: snmptrapd
# REQUIRE: DAEMON
#
# Add the following line to /etc/rc.conf to enable snmptrapd:
#
# snmptrapd_enable="YES"
#

snmptrapd_enable=${snmptrapd_enable-"NO"}
snmptrapd_flags=${snmptrapd_flags-"-p /var/run/snmptrapd.pid"}

. /etc/rc.subr

load_rc_config net_snmptrapd

if [ ! -z "$net_snmptrapd_enable" ]; then
    echo "Warning: \$net_snmptrapd_enable is obsoleted."
    echo "         Use \$snmptrapd_enable instead."
    snmptrapd_enable="$net_snmptrapd_enable"
    [ ! -z "$net_snmptrapd_flags" ] && snmptrapd_flags="$net_snmptrapd_flags"
fi

name=snmptrapd
rcvar=snmptrapd_enable

command=%%PREFIX%%/sbin/${name}
pidfile=/var/run/${name}.pid

load_rc_config ${name}
run_rc_command "$1"

