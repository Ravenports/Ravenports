# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		pinentry
VERSION=		1.2.1
KEYWORDS=		security
VARIANTS=		standard ncurses qt5 gtk2 fltk gnome3
SDESC[qt5]=		Assuan passphrase entry dialog (Qt5)
SDESC[ncurses]=		Assuan passphrase entry dialog (ncurses)
SDESC[fltk]=		Assuan passphrase entry dialog (FLTK)
SDESC[gnome3]=		Assuan passphrase entry dialog (GNOME3)
SDESC[standard]=	Assuan passphrase entry dialog (console)
SDESC[gtk2]=		Assuan passphrase entry dialog (GTK2)
HOMEPAGE=		https://www.gnupg.org/aegypten2/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		GNUPG/pinentry
DISTFILE[1]=		pinentry-1.2.1.tar.bz2:main
DF_INDEX=		1
SPKGS[qt5]=		single
SPKGS[ncurses]=		single
SPKGS[fltk]=		single
SPKGS[gnome3]=		single
SPKGS[standard]=	single
SPKGS[gtk2]=		single

OPTIONS_AVAILABLE=	NCURSES QT5 GTK2 FLTK NOTSTD GNOME3
OPTIONS_STANDARD=	none
VOPTS[qt5]=		NCURSES=OFF QT5=ON GTK2=OFF FLTK=OFF NOTSTD=ON
			GNOME3=OFF
VOPTS[ncurses]=		NCURSES=ON QT5=OFF GTK2=OFF FLTK=OFF NOTSTD=ON
			GNOME3=OFF
VOPTS[fltk]=		NCURSES=OFF QT5=OFF GTK2=OFF FLTK=ON NOTSTD=ON
			GNOME3=OFF
VOPTS[gnome3]=		NCURSES=OFF QT5=OFF GTK2=OFF FLTK=OFF NOTSTD=ON
			GNOME3=ON
VOPTS[gtk2]=		NCURSES=OFF QT5=OFF GTK2=ON FLTK=OFF NOTSTD=ON
			GNOME3=OFF

BUILDRUN_DEPENDS=	libsecret:primary:standard
			libassuan:single:standard

USES=			gmake pkgconfig
GNOME_COMPONENTS=	glib

LICENSE=		GPLv2+:single
LICENSE_TERMS=		single:{{WRKDIR}}/TERMS
LICENSE_FILE=		GPLv2+:{{WRKSRC}}/COPYING
LICENSE_AWK=		TERMS:"^$$"
LICENSE_SOURCE=		TERMS:{{WRKSRC}}/pinentry/pinentry.h
LICENSE_SCHEME=		solo

FPC_EQUIVALENT=		security/pinentry
INFO_SUBDIR=		.

MUST_CONFIGURE=		gnu
CONFIGURE_ARGS=		--enable-libsecret
			--disable-pinentry-emacs

[NOTSTD].DESCRIPTION=			Indicates non-console variant
[NOTSTD].CONFIGURE_ARGS_OFF=		--enable-pinentry-tty
[NOTSTD].CONFIGURE_ARGS_ON=		--disable-pinentry-tty
					--disable-pinentry-emacs
					--disable-inside-emacs
[NOTSTD].INFO_OFF=			single:pinentry

[GNOME3].DESCRIPTION=			Build GNOME3 variant
[GNOME3].BUILDRUN_DEPENDS_ON=		gcr:primary:standard
[GNOME3].CONFIGURE_ENABLE_BOTH=		pinentry-gnome3

[FLTK].DESCRIPTION=			Build FLTK variant
[FLTK].BUILDRUN_DEPENDS_ON=		fltk:primary:standard
[FLTK].CONFIGURE_ENABLE_BOTH=		pinentry-fltk

[GTK2].DESCRIPTION=			Build GTK2 variant
[GTK2].CONFIGURE_ENABLE_BOTH=		pinentry-gtk2
[GTK2].GNOME_COMPONENTS_ON=		gtk2

[QT5].DESCRIPTION=			Build Qt5 variant
[QT5].BUILDRUN_DEPENDS_ON=		qt5-qtbase:primary:standard
[QT5].BUILD_DEPENDS_ON=			qt5-qttools:single:standard
[QT5].CONFIGURE_ARGS_OFF=		--disable-pinentry-qt
[QT5].CONFIGURE_ARGS_ON=		--program-suffix=5
[QT5].CONFIGURE_ENABLE_BOTH=		pinentry-qt5
[QT5].CONFIGURE_ENV_ON=			PKG_CONFIG_PATH={{LOCALBASE}}/lib/qt5/pkgconfig
[QT5].MAKEFILE_ON=			PREPEND_PATH={{LOCALBASE}}/lib/qt5/bin

[NCURSES].DESCRIPTION=			Build ncurses variant
[NCURSES].CFLAGS_ON=			-DWITH_UTF8_CONVERSION
[NCURSES].CONFIGURE_ARGS_OFF=		--disable-fallback-curses
[NCURSES].CONFIGURE_ENABLE_BOTH=	pinentry-curses
[NCURSES].USES_ON=			ncurses

post-install-NOTSTD-ON:
	${RM} ${STAGEDIR}${PREFIX}/bin/pinentry
	${RM} ${STAGEDIR}${PREFIX}/share/info/pinentry.info

[FILE:135:descriptions/desc.single]
This is a collection of simple PIN or passphrase entry dialogs which
utilize the Assuan protocol as described by the aegypten project.


[FILE:101:distinfo]
457a185e5a85238fb945a955dc6352ab962dc8b48720b62fc9fa48c7540a4067       547698 pinentry-1.2.1.tar.bz2


[FILE:29:manifests/plist.single.standard]
bin/
 pinentry
 pinentry-tty


[FILE:20:manifests/plist.single.ncurses]
bin/pinentry-curses


[FILE:17:manifests/plist.single.qt5]
bin/pinentry-qt5


[FILE:19:manifests/plist.single.gtk2]
bin/pinentry-gtk-2


[FILE:18:manifests/plist.single.fltk]
bin/pinentry-fltk


[FILE:20:manifests/plist.single.gnome3]
bin/pinentry-gnome3


[FILE:776:patches/patch-fltk_pinwindow.cxx]
Rename encrypt to encrypt_pixmap to avoid namespace conflict with
unistd.h encrypt() on FreeBSD 10.4

--- fltk/pinwindow.cxx.orig	2017-12-03 16:13:05 UTC
+++ fltk/pinwindow.cxx
@@ -46,7 +46,7 @@ const char *PinWindow::PROMPT		= "Passph
 
 static const char *timeout_format = "%s(%d)";
 
-static Fl_Pixmap encrypt(encrypt_xpm);
+static Fl_Pixmap encrypt_pixmap(encrypt_xpm);
 static Fl_Pixmap icon(icon_xpm);
 
 PinWindow::PinWindow() : window_(NULL)
@@ -147,7 +147,7 @@ int PinWindow::init(const int cx, const
 	window_->icon(&app);
 
 	icon_ = new Fl_Box(10, 10, 64, 64);
-	icon_->image(encrypt);
+	icon_->image(encrypt_pixmap);
 
     message_ = new Fl_Box(79, 5, cx-99, 44, PROMPT);
 	message_->align(Fl_Align(FL_ALIGN_LEFT_TOP | FL_ALIGN_WRAP | FL_ALIGN_INSIDE)); // left


[FILE:298:patches/patch-secmem_secmem.c]
--- secmem/secmem.c.orig	2022-08-24 10:31:59 UTC
+++ secmem/secmem.c
@@ -85,7 +85,7 @@ log_fatal(char *template, ...)
 #  define MAP_ANONYMOUS MAP_ANON
 #endif
 
-#define DEFAULT_POOLSIZE 16384
+#define DEFAULT_POOLSIZE 16384*4
 
 typedef struct memblock_struct MEMBLOCK;
 struct memblock_struct {

