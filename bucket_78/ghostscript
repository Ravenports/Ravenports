# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		ghostscript
VERSION=		10.02.0
KEYWORDS=		print
VARIANTS=		standard
SDESC[standard]=	Postscript and PDF Rendering Engine
HOMEPAGE=		https://www.ghostscript.com/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		https://github.com/ArtifexSoftware/ghostpdl-downloads/releases/download/gs10020/
DISTFILE[1]=		ghostscript-10.02.0.tar.xz:main
DF_INDEX=		1
SPKGS[standard]=	complete
			primary
			x11
			man
			docs

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILD_DEPENDS=		xorg-sm:dev:standard
			xorg-sm:primary:standard
			xorg-xt:dev:standard
			xorg-xt:primary:standard
			xorg-ice:dev:standard
			xorg-ice:primary:standard
			xorg-x11:dev:standard
			xorg-x11:primary:standard
			xorg-xext:dev:standard
			xorg-xext:primary:standard
			libpaper:dev:standard
			poppler-data:dev:standard
			openjpeg:dev:standard
			cups:dev:standard
BUILDRUN_DEPENDS=	jbig2dec:single:standard
			openjpeg:primary:standard
			libpaper:primary:standard
			cups:tools:standard
			libidn:primary:standard
RUN_DEPENDS=		poppler-data:primary:standard
EXRUN[x11]=		xorg-sm:primary:standard
			xorg-xt:primary:standard
			xorg-ice:primary:standard
			xorg-x11:primary:standard
			xorg-xext:primary:standard

USES=			cpe gmake png jpeg tiff iconv fontconfig pkgconfig
			zlib

DISTNAME=		ghostscript-10.02.0

LICENSE=		AGPLv3+:primary
LICENSE_TERMS=		primary:{{WRKSRC}}/LICENSE
LICENSE_FILE=		AGPLv3+:{{WRKSRC}}/doc/COPYING
LICENSE_SCHEME=		solo

CPE_PRODUCT=		ghostscript
CPE_VENDOR=		artifex
FPC_EQUIVALENT=		print/ghostscript9-agpl-base

MUST_CONFIGURE=		gnu
CONFIGURE_ARGS=		--disable-compile-inits
			--disable-dbus
			--disable-gtk
			--enable-contrib
			--enable-dynamic
			--enable-fontconfig
			--enable-freetype
			--enable-openjpeg
			--enable-cups
			--with-drivers=ALL
			--with-fontpath={{LOCALBASE}}/share/fonts
			--with-jbig2dec
			--with-libiconv=yes
			--with-libidn
			--with-ijs=no
			--with-libpaper
			--with-system-libtiff
			--with-x
			--disable-hidden-visibility
CONFIGURE_ENV=		LIBS=-Wl,-rpath,{{PREFIX}}/lib

BUILD_TARGET=		so ./obj/X11.so

INSTALL_TARGET=		soinstall install-shared
INSTALL_REQ_TOOLCHAIN=	yes
SOVERSION=		10.02
PLIST_SUB=		GV=10.02.0

VAR_OPSYS[sunos]=	CPPFLAGS=-D_XOPEN_SOURCE=600
			CPPFLAGS=-D__EXTENSIONS__

post-patch:
	${RM} -r ${WRKSRC}/freetype \
		${WRKSRC}/ijs \
		${WRKSRC}/jbig2dec \
		${WRKSRC}/jpeg \
		${WRKSRC}/libpng \
		${WRKSRC}/openjpeg \
		${WRKSRC}/zlib
	${FIND} ${WRKSRC}/Resource/Init -name "*.orig" -delete

post-install:
	${MV} ${STAGEDIR}${PREFIX}/bin/gsc ${STAGEDIR}${PREFIX}/bin/gs
	${RM} ${STAGEDIR}${PREFIX}/bin/gsx
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/gs
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/lib/libgs.so
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/lib/ghostscript/10.02.0/X11.so
	${MKDIR} ${STAGEDIR}${PREFIX}/share/color/icc \
		${STAGEDIR}${PREFIX}/share/cmap
	${MV} ${STAGEDIR}${PREFIX}/share/ghostscript/10.02.0/iccprofiles \
		${STAGEDIR}${PREFIX}/share/color/icc/ghostscript
	${LN} -s ../../color/icc/ghostscript \
		${STAGEDIR}${PREFIX}/share/ghostscript/10.02.0/iccprofiles
	${MV} ${STAGEDIR}${PREFIX}/share/ghostscript/10.02.0/Resource/CMap/Identity* \
		${STAGEDIR}${PREFIX}/share/cmap
	${RM} -r ${STAGEDIR}${PREFIX}/share/ghostscript/10.02.0/Resource/CMap
	${LN} -s ../../../cmap \
		${STAGEDIR}${PREFIX}/share/ghostscript/10.02.0/Resource/CMap
	${RM} ${STAGEDIR}${STD_DOCDIR}/10.02.0/COPYING

[FILE:609:descriptions/desc.primary]
Ghostscript is a high-performance Postscript and PDF interpreter and
rendering engine with the most comprehensive set of page description
languages (PDL's) on the market today and technology conversion
capabilities covering PDF, PostScript, PCL and XPS languages.

Ghostscript has been under active development for over 20 years, and
offers an extremely versatile feature set and can be deployed across
a wide range of platforms, modules, end uses (embedding in hardware,
as an engine in document management systems, providing cloud solution
integration and as an engine in leading PDF generators and tools).


[FILE:62:descriptions/desc.x11]
This package contains the x11 support library of ghostscript.


[FILE:105:distinfo]
fa08ce016b30d26293dc322c6353691aced94fd3667a68ede7ff5395d71fcd0b     67955320 ghostscript-10.02.0.tar.xz


[FILE:4754:manifests/plist.primary]
bin/
 dvipdf
 eps2eps
 gs
 gsbj
 gsdj
 gsdj500
 gslj
 gslp
 gsnd
 lprsetup.sh
 pdf2dsc
 pdf2ps
 pf2afm
 pfbtopfa
 pphs
 printafm
 ps2ascii
 ps2epsi
 ps2pdf
 ps2pdf12
 ps2pdf13
 ps2pdf14
 ps2pdfwr
 ps2ps
 ps2ps2
 unix-lpr.sh
include/ghostscript/
 gdevdsp.h
 gserrors.h
 iapi.h
 ierrors.h
lib/
 libgs.so
 libgs.so.%%SOMAJOR%%
 libgs.so.%%SOVERSION%%
share/cmap/
 Identity-H
 Identity-UTF16-H
 Identity-V
share/color/icc/ghostscript/
 a98.icc
 default_cmyk.icc
 default_gray.icc
 default_rgb.icc
 esrgb.icc
 gray_to_k.icc
 lab.icc
 ps_cmyk.icc
 ps_gray.icc
 ps_rgb.icc
 rommrgb.icc
 scrgb.icc
 sgray.icc
 srgb.icc
share/ghostscript/%%GV%%/iccprofiles
share/ghostscript/%%GV%%/Resource/CMap
share/ghostscript/%%GV%%/Resource/CIDFSubst/DroidSansFallback.ttf
share/ghostscript/%%GV%%/Resource/CIDFont/ArtifexBullet
share/ghostscript/%%GV%%/Resource/ColorSpace/
 DefaultCMYK
 DefaultGray
 DefaultRGB
 TrivialCMYK
 sGray
 sRGB
share/ghostscript/%%GV%%/Resource/Decoding/
 FCO_Dingbats
 FCO_Symbol
 FCO_Unicode
 FCO_Wingdings
 Latin1
 StandardEncoding
 Unicode
share/ghostscript/%%GV%%/Resource/Encoding/
 CEEncoding
 ExpertEncoding
 ExpertSubsetEncoding
 NotDefEncoding
 Wingdings
share/ghostscript/%%GV%%/Resource/Font/
 C059-BdIta
 C059-Bold
 C059-Italic
 C059-Roman
 D050000L
 NimbusMonoPS-Bold
 NimbusMonoPS-BoldItalic
 NimbusMonoPS-Italic
 NimbusMonoPS-Regular
 NimbusRoman-Bold
 NimbusRoman-BoldItalic
 NimbusRoman-Italic
 NimbusRoman-Regular
 NimbusSans-Bold
 NimbusSans-BoldItalic
 NimbusSans-Italic
 NimbusSans-Regular
 NimbusSansNarrow-Bold
 NimbusSansNarrow-BoldOblique
 NimbusSansNarrow-Oblique
 NimbusSansNarrow-Regular
 P052-Bold
 P052-BoldItalic
 P052-Italic
 P052-Roman
 StandardSymbolsPS
 URWBookman-Demi
 URWBookman-DemiItalic
 URWBookman-Light
 URWBookman-LightItalic
 URWGothic-Book
 URWGothic-BookOblique
 URWGothic-Demi
 URWGothic-DemiOblique
 Z003-MediumItalic
share/ghostscript/%%GV%%/Resource/IdiomSet/
 PPI_CUtils
 Pscript5Idiom
share/ghostscript/%%GV%%/Resource/Init/
 FAPIcidfmap
 FAPIconfig
 FAPIfontmap
 FCOfontmap-PCLPS2
 Fontmap
 Fontmap.GS
 cidfmap
 gs_agl.ps
 gs_btokn.ps
 gs_cet.ps
 gs_cff.ps
 gs_cidcm.ps
 gs_ciddc.ps
 gs_cidfm.ps
 gs_cidfn.ps
 gs_cidtt.ps
 gs_cmap.ps
 gs_cspace.ps
 gs_dbt_e.ps
 gs_diskn.ps
 gs_dps1.ps
 gs_dps2.ps
 gs_dscp.ps
 gs_epsf.ps
 gs_fapi.ps
 gs_fntem.ps
 gs_fonts.ps
 gs_frsd.ps
 gs_icc.ps
 gs_il1_e.ps
 gs_img.ps
 gs_init.ps
 gs_lev2.ps
 gs_ll3.ps
 gs_mex_e.ps
 gs_mgl_e.ps
 gs_mro_e.ps
 gs_pdf_e.ps
 gs_pdfwr.ps
 gs_res.ps
 gs_resmp.ps
 gs_setpd.ps
 gs_statd.ps
 gs_std_e.ps
 gs_sym_e.ps
 gs_trap.ps
 gs_ttf.ps
 gs_typ32.ps
 gs_typ42.ps
 gs_type1.ps
 gs_wan_e.ps
 pdf_main.ps
 xlatmap
share/ghostscript/%%GV%%/Resource/SubstCID/
 CNS1-WMode
 GB1-WMode
 Japan1-WMode
 Korea1-WMode
share/ghostscript/%%GV%%/lib/
 PDFA_def.ps
 PDFX_def.ps
 PM760p.upp
 PM760pl.upp
 PM820p.upp
 PM820pl.upp
 Stc670p.upp
 Stc670pl.upp
 Stc680p.upp
 Stc680pl.upp
 Stc740p.upp
 Stc740pl.upp
 Stc760p.upp
 Stc760pl.upp
 Stc777p.upp
 Stc777pl.upp
 Stp720p.upp
 Stp720pl.upp
 Stp870p.upp
 Stp870pl.upp
 acctest.ps
 align.ps
 bj8.rpd
 bj8gc12f.upp
 bj8hg12f.upp
 bj8oh06n.upp
 bj8pa06n.upp
 bj8pp12f.upp
 bj8ts06n.upp
 bjc6000a1.upp
 bjc6000b1.upp
 bjc610a0.upp
 bjc610a1.upp
 bjc610a2.upp
 bjc610a3.upp
 bjc610a4.upp
 bjc610a5.upp
 bjc610a6.upp
 bjc610a7.upp
 bjc610a8.upp
 bjc610b1.upp
 bjc610b2.upp
 bjc610b3.upp
 bjc610b4.upp
 bjc610b6.upp
 bjc610b7.upp
 bjc610b8.upp
 caption.ps
 cbjc600.ppd
 cbjc800.ppd
 cdj550.upp
 cdj690.upp
 cdj690ec.upp
 cid2code.ps
 dnj750c.upp
 dnj750m.upp
 docie.ps
 font2pcl.ps
 ghostpdf.ppd
 gs_ce_e.ps
 gs_css_e.ps
 gs_il2_e.ps
 gs_kanji.ps
 gs_ksb_e.ps
 gs_l.xbm
 gs_l.xpm
 gs_l_m.xbm
 gs_lgo_e.ps
 gs_lgx_e.ps
 gs_m.xbm
 gs_m.xpm
 gs_m_m.xbm
 gs_s.xbm
 gs_s.xpm
 gs_s_m.xbm
 gs_t.xbm
 gs_t.xpm
 gs_t_m.xbm
 gs_wl1_e.ps
 gs_wl2_e.ps
 gs_wl5_e.ps
 gslp.ps
 gsnup.ps
 ht_ccsto.ps
 image-qa.ps
 jispaper.ps
 landscap.ps
 lines.ps
 mkcidfm.ps
 necp2x.upp
 necp2x6.upp
 pdf2dsc.ps
 pdf_info.ps
 pf2afm.ps
 pfbtopfa.ps
 ppath.ps
 pphs.ps
 prfont.ps
 printafm.ps
 ps2ai.ps
 ps2epsi.ps
 ras1.upp
 ras24.upp
 ras3.upp
 ras32.upp
 ras4.upp
 ras8m.upp
 rollconv.ps
 s400a1.upp
 s400b1.upp
 sharp.upp
 sipixa6.upp
 st640ih.upp
 st640ihg.upp
 st640p.upp
 st640pg.upp
 st640pl.upp
 st640plg.upp
 stc.upp
 stc1520h.upp
 stc2.upp
 stc200_h.upp
 stc2_h.upp
 stc2s_h.upp
 stc300.upp
 stc300bl.upp
 stc300bm.upp
 stc500p.upp
 stc500ph.upp
 stc600ih.upp
 stc600p.upp
 stc600pl.upp
 stc640p.upp
 stc740ih.upp
 stc800ih.upp
 stc800p.upp
 stc800pl.upp
 stc_h.upp
 stc_l.upp
 stcany.upp
 stcany_h.upp
 stcinfo.ps
 stcolor.ps
 stocht.ps
 traceimg.ps
 traceop.ps
 uninfo.ps
 viewcmyk.ps
 viewgif.ps
 viewjpeg.ps
 viewmiff.ps
 viewpbm.ps
 viewpcx.ps
 viewps2a.ps
 winmaps.ps
 zeroline.ps
@dir lib/ghostscript/%%GV%%


[FILE:30:manifests/plist.x11]
lib/ghostscript/%%GV%%/X11.so


[FILE:305:manifests/plist.man]
share/man/man1/
 dvipdf.1.gz
 eps2eps.1.gz
 gs.1.gz
 gsbj.1.gz
 gsdj.1.gz
 gsdj500.1.gz
 gslj.1.gz
 gslp.1.gz
 gsnd.1.gz
 pdf2dsc.1.gz
 pdf2ps.1.gz
 pf2afm.1.gz
 pfbtopfa.1.gz
 printafm.1.gz
 ps2ascii.1.gz
 ps2epsi.1.gz
 ps2pdf.1.gz
 ps2pdf12.1.gz
 ps2pdf13.1.gz
 ps2pdf14.1.gz
 ps2pdfwr.1.gz
 ps2ps.1.gz


[FILE:84:manifests/plist.docs]
share/doc/ghostscript/%%GV%%/
 GS9_Color_Management.pdf
 Ghostscript.pdf
 News.html


[FILE:2634:patches/patch-Resource_Init_cidfmap]
--- Resource/Init/cidfmap.orig	2023-09-13 06:45:01 UTC
+++ Resource/Init/cidfmap
@@ -37,6 +37,67 @@
 %   /ShinGo-Bold   /HeiseiKakuGo-W5 ;
 %   /Ryumin-Medium << /FileType /TrueType /Path (H:/AuxFiles/Fonts/BATANG.TTC) /SubfontID 3 /CSI [(Japan1) 2] >> ;
 %   /Ryumin-Medium << /FileType /TrueType /Path (c:/windows/Fonts/BATANG.TTC) /SubfontID 3 /CSI [(Japan1) 2] >> ;
+/Ryumin-Light << /FileType /TrueType /Path (Ryumin-Light) /SubfontID 0 /CSI [(Japan1) 6] >> ;
+/GothicBBB-Medium << /FileType /TrueType /Path (GothicBBB-Medium) /SubfontID 0 /CSI [(Japan1) 6] >> ;
+
+/Ryumin-Medium		/Ryumin-Light ;
+/Ryumin-Regular		/Ryumin-Light ;
+/RyuminPro-Light	/Ryumin-Light ;
+
+/GothicBBBPro-Medium	/GothicBBB-Medium ;
+
+/KozGoPro-Bold		/GothicBBB-Medium ;
+/KozGoPro-Heavy		/GothicBBB-Medium ;
+/KozGoPro-Medium	/GothicBBB-Medium ;
+/KozGoPro-Regular	/GothicBBB-Medium ;
+
+/KozMinPro-Bold		/Ryumin-Light ;
+/KozMinPro-Light	/Ryumin-Light ;
+/KozMinPro-Medium	/Ryumin-Light ;
+/KozMinPro-Regular	/Ryumin-Light ;
+
+/HiraKakuPro-W3		/GothicBBB-Medium ;
+/HiraKakuPro-W6		/GothicBBB-Medium ;
+/HiraKakuStd-W8		/GothicBBB-Medium ;
+
+/HiraMaruPro-W4		/GothicBBB-Medium ;
+
+/HiraMinPro-W3		/Ryumin-Light ;
+
+/HeiseiMin-W3		/Ryumin-Light ;
+/HeiseiKakuGo-W5	/GothicBBB-Medium ;
+
+/FutoMinA101-Bold	/Ryumin-Light ;
+/FutoMinA101Pro-Bold	/Ryumin-Light ;
+/FutoGoB101-Bold	/GothicBBB-Medium ;
+/FutoGoB101Pro-Bold	/GothicBBB-Medium ;
+
+/Jun101-Light		/Ryumin-Light ;
+/Jun101Pro-Light	/Ryumin-Light ;
+
+/MidashiGo-MB31		/GothicBBB-Medium ;
+/MidashiGoPro-MB31	/GothicBBB-Medium ;
+
+/MidashiMinPro-MA31	/Ryumin-Light ;
+
+/MS-Mincho		/Ryumin-Light ;
+/MS-PMincho		/Ryumin-Light ;
+/MS-Gothic		/GothicBBB-Medium ;
+/MS-PGothic		/GothicBBB-Medium ;
+
+%/Munhwa-Regular	/Munhwa-Regular ;
+%/MunhwaGothic-Regular	/MunhwaGothic-Regular ;
+%/Munhwa-Bold		/Munhwa-Bold ;
+%/MunhwaGothic-Bold	/MunhwaGothic-Bold ;
+
+/HYGoThic-Medium	/MunhwaGothic-Regular ;
+/HYSMyeongJo-Medium	/Munhwa-Regular ;
+/HYRGoThic-Medium	/MunhwaGothic-Bold ;
+
+/STHeiti-Regular << /FileType /TrueType /Path (STHeiti-Regular) /SubfontID 0 /CSI [(CNS1) 5] >> ;
+/STSong-Light << /FileType /TrueType /Path (STSong-Light) /SubfontID 0 /CSI [(GB1) 5] >> ;
+/MSung-Light << /FileType /TrueType /Path (MSung-Light) /SubfontID 0 /CSI [(CNS1) 5] >> ;
+/MHei-Medium << /FileType /TrueType /Path (MHei-Medium) /SubfontID 0 /CSI [(GB1) 5] >> ;
 %
 %   NOTE: (as of 9.56.0) The use of Postscript operators in the cidfmap file is now deprecated, for compatibility
 %         with (and security of) the PDF interpreter implemented in C (rather than Postscript). Thus operations such


[FILE:387:patches/patch-base_fapi__ft.c]
--- base/fapi_ft.c.orig	2023-09-13 06:45:01 UTC
+++ base/fapi_ft.c
@@ -60,6 +60,10 @@
 #include FT_MULTIPLE_MASTERS_H
 #include FT_TYPE1_TABLES_H
 
+#ifndef FT_CALLBACK_DEF
+#define FT_CALLBACK_DEF( x )  static x
+#endif
+
 /* Note: structure definitions here start with FF_, which stands for 'FAPI FreeType". */
 
 #define ft_emprintf(m,s) { outflush(m); emprintf(m, s); outflush(m); }


[FILE:244:patches/patch-base_ttobjs.h]
Avoid GS conflict on older SunOS.

--- base/ttobjs.h.orig	2023-09-13 06:45:01 UTC
+++ base/ttobjs.h
@@ -43,6 +43,10 @@
 #include "setjmp_.h"
 #include "ttfoutl.h"
 
+#ifdef __sun
+#undef GS
+#endif
+
 #ifdef __cplusplus
   extern "C" {
 #endif


[FILE:1603:patches/patch-configure]
--- configure.orig	2023-09-13 06:45:01 UTC
+++ configure
@@ -5565,7 +5565,7 @@ case $host in
             CC_VISIBILITY_FLAGS_TO_TRY="-fvisibility=hidden"
         fi
         ;;
-        *bsd*)
+        *bsd*|*dragonfly*)
         if test x"$GCC" = x"yes"; then
             CC_OPT_FLAGS_TO_TRY="-O2 -DNDEBUG"
             CC_DBG_FLAGS_TO_TRY="-gdwarf-2 -g3 -O0"
@@ -6925,7 +6925,6 @@ then :
   printf %s "(cached) " >&6
 else $as_nop
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-ldl  $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
@@ -6958,7 +6957,7 @@ then :
   ac_fn_c_check_header_compile "$LINENO" "dlfcn.h" "ac_cv_header_dlfcn_h" "$ac_includes_default"
 if test "x$ac_cv_header_dlfcn_h" = xyes
 then :
-  GCFLAGS="$GCFLAGS -DHAVE_LIBDL=1";LIBS="-ldl $LIBS"
+  GCFLAGS="$GCFLAGS -DHAVE_LIBDL=1"
 fi
 
 
@@ -13260,7 +13259,7 @@ case $host in
       GPDL_SONAME_MAJOR="lib\$(GPDL${libname3}"
       GPDL_SONAME_MAJOR_MINOR="cyg\$(GPDL${libname2}"
     ;;
-    *bsd*)
+    *bsd*|*dragonfly*)
       DYNAMIC_CFLAGS="-fPIC $DYNAMIC_CFLAGS"
       GS_DYNAMIC_LDFLAGS="-shared -Wl,\$(LD_SET_DT_SONAME)\$(LDFLAGS_SO_PREFIX)\$(GS_SONAME_MAJOR)"
       PCL_DYNAMIC_LDFLAGS="-shared -Wl,\$(LD_SET_DT_SONAME)\$(LDFLAGS_SO_PREFIX)\$(PCL_SONAME_MAJOR)"
@@ -13379,7 +13378,7 @@ then :
         OPT_CFLAGS="$DYNAMIC_CFLAGS $OPT_CFLAGS"
         DBG_CFLAGS="$DYNAMIC_CFLAGS $DBG_CFLAGS"
       ;;
-      *bsd*)
+      *bsd*|*dragonfly*)
         DYNAMIC_DEVS="\$(GLOBJDIR)/X11.so"
         DYNAMIC_FLAGS="-DGS_DEVS_SHARED -DGS_DEVS_SHARED_DIR=\\\"\$(gssharedir)\\\""
         X11_DEVS=""


[FILE:505:patches/patch-leptonica_src_environ.h]
--- leptonica/src/environ.h.orig	2023-09-13 06:45:02 UTC
+++ leptonica/src/environ.h
@@ -172,7 +172,7 @@ typedef uintptr_t l_uintptr_t;
  * To use them on MacOS, which does not support these functions, set it to 0.
  *-------------------------------------------------------------------------*/
 #if !defined(HAVE_CONFIG_H) && !defined(ANDROID_BUILD) && !defined(OS_IOS) && \
-    !defined(_WIN32)
+    !defined(_WIN32) && !defined(__sun)
 #define  HAVE_FMEMOPEN    1
 #endif  /* ! HAVE_CONFIG_H etc. */
 


[FILE:396:patches/patch-leptonica_src_sarray1.c]
--- leptonica/src/sarray1.c.orig	2023-09-13 06:45:02 UTC
+++ leptonica/src/sarray1.c
@@ -149,6 +149,13 @@
 #endif  /* ! _WIN32 */
 #include "allheaders.h"
 
+#ifdef __sun
+static int
+dirfd(DIR *dirp) {
+        return (dirp->d_fd);
+}
+#endif
+
 static const l_uint32  MaxPtrArraySize = 25000000;  /* 25 million */
 static const l_int32   InitialPtrArraySize = 50;      /*!< n'importe quoi */
 

