# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		gdb
VERSION=		15.2
KEYWORDS=		devel
VARIANTS=		std
SDESC[std]=		GNU debugger
HOMEPAGE=		http://www.gnu.org/software/gdb/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main patchsite
SITES[main]=		GNU/gdb
SITES[patchsite]=	https://raw.githubusercontent.com/jrmarino/gnu_debugger_difference/gdb_15.2-rev1/generated/patches-15.2/
DISTFILE[1]=		gdb-15.2.tar.xz:main
DISTFILE[2]=		patch-diff-gdb:patchsite
DISTFILE[3]=		patch-diff-rest:patchsite
DIST_SUBDIR=		gdb_15.2-rev1
DF_INDEX=		1
SPKGS[std]=		set
			primary
			man

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

NOT_FOR_ARCH=		aarch64

BUILD_DEPENDS=		gmp:dev:std
			mpfr:dev:std
BUILDRUN_DEPENDS=	gmp:primary:std
			mpfr:primary:std
			source-highlight:primary:std

USES=			cpe iconv gmake libtool readline pkgconfig makeinfo
			python expat ncurses gettext zstd

EXTRACT_HEAD[1]=	{{TAR}} -xf
EXTRACT_TAIL[1]=	--exclude dejagnu --exclude expect --exclude texinfo --exclude intl --exclude readline

LICENSE=		GPLv3+:primary
LICENSE_TERMS=		primary:{{WRKDIR}}/TERMS
LICENSE_FILE=		GPLv3+:{{WRKSRC}}/COPYING
LICENSE_AWK=		TERMS:"^\#include"
LICENSE_SOURCE=		TERMS:{{WRKSRC}}/gdb/gdb.c
LICENSE_SCHEME=		solo

CPE_VENDOR=		gnu
FPC_EQUIVALENT=		devel/gdb

PATCHFILES=		2 3

MUST_CONFIGURE=		gnu
CONFIGURE_OUTSOURCE=	yes
CONFIGURE_ARGS=		--program-suffix=152
			--enable-targets=all
			--enable-64-bit-bfd
			--enable-tui
			--disable-build-with-cxx
			--disable-sim
			--with-gdb-datadir={{PREFIX}}/share/gdb152
			{{ICONV_CONFIGURE_ARG}}
			--with-system-readline
			--with-expat=yes
			--with-libexpat-prefix={{LOCALBASE}}
			--without-libunwind-ia64
			--with-python={{PYTHON_CMD}}
			--with-source-highlight
CONFIGURE_ENV=		CONFIGURED_M4=m4
			CONFIGURED_BISON=byacc

BUILD_TARGET=		all-gdb

PLIST_SUB=		VER=152

CFLAGS=			-DRL_NO_COMPAT
			-D__STDC_CONSTANT_MACROS
			-D__STDC_LIMIT_MACROS
			-Wno-unused-function
			-Wno-unused-variable
VAR_OPSYS[midnightbsd]=	MAKEFILE_LINE=CONFIGURE_TARGET=x86_64-raven-freebsd12.3

post-patch:
	${REINPLACE_CMD} -e 's|$$| [GDB v15.2 for ${OPSYS}]|' \
		${WRKSRC}/gdb/version.in
	# remove leftover readline removed garbage
	${REINPLACE_CMD} -e 's|..READLINE.*user.texi||' \
		${WRKSRC}/gdb/doc/Makefile.in

do-install:
	${INSTALL_PROGRAM} ${INSTALL_WRKSRC}/gdb/gdb \
		${STAGEDIR}${PREFIX}/bin/gdb152
	${INSTALL_MAN} ${WRKSRC}/gdb/doc/gdb.1 \
		${STAGEDIR}${MAN1PREFIX}/man/man1/gdb152.1
	(cd ${INSTALL_WRKSRC}/gdb/data-directory ; \
		${SETENV} ${MAKE_ENV} ${MAKE_CMD} ${MAKE_ARGS} install-syscalls )
	${LN} -sf gdb152 ${STAGEDIR}${PREFIX}/bin/gdbtui152
	${LN} -sf gdb152 ${STAGEDIR}${PREFIX}/bin/gdb
	(cd ${INSTALL_WRKSRC}/gdb && ${SETENV} ${MAKE_ENV} \
		${MAKE_CMD} ${MAKE_ARGS} install-python )
	(cd ${INSTALL_WRKSRC}/gdb/data-directory && ${SETENV} ${MAKE_ENV} \
		${MAKE_CMD} ${MAKE_ARGS} install-python )
. for f in gdb gdb/command gdb/function gdb/printer
	(cd ${STAGEDIR}${PREFIX}/share/gdb152/python/${f} ; ${CHMOD} 644 *.py* )
. endfor

[FILE:284:descriptions/desc.primary]
GDB is a source-level debugger for Ada, C, C++, Objective-C, Pascal and
many other languages.  GDB can target (i.e., debug programs running on)
more than a dozen different processor architectures, and GDB itself can
run on most popular GNU/Linux, Unix and Microsoft Windows variants.


[FILE:323:distinfo]
83350ccd35b5b5a0cba6b334c41294ea968158c573940904f00b92f76345314d     24332820 gdb_15.2-rev1/gdb-15.2.tar.xz
69b449bd28ae5ec1277b854ee833f8d616186321c49725ad6fa678da61c42f5e        45655 gdb_15.2-rev1/patch-diff-gdb
84a5b15c1c91aef93e9fb8a850904b89efd44bfbe3b353ec047cb424d1aa519e         1650 gdb_15.2-rev1/patch-diff-rest


[FILE:1172:manifests/plist.primary]
bin/
 gdb
 gdb%%VER%%
 gdbtui%%VER%%
share/gdb%%VER%%/python/gdb/
 FrameDecorator.py
 FrameIterator.py
 __init__.py
 disassembler.py
 frames.py
 missing_debug.py
 printing.py
 prompt.py
 styling.py
 types.py
 unwinder.py
 xmethod.py
share/gdb%%VER%%/python/gdb/command/
 __init__.py
 explore.py
 frame_filters.py
 missing_debug.py
 pretty_printers.py
 prompt.py
 type_printers.py
 unwinders.py
 xmethods.py
share/gdb%%VER%%/python/gdb/dap/
 __init__.py
 breakpoint.py
 bt.py
 disassemble.py
 evaluate.py
 events.py
 frames.py
 io.py
 launch.py
 locations.py
 memory.py
 modules.py
 next.py
 pause.py
 scopes.py
 server.py
 sources.py
 startup.py
 state.py
 threads.py
 typecheck.py
 varref.py
share/gdb%%VER%%/python/gdb/function/
 __init__.py
 as_string.py
 caller_is.py
 strfns.py
share/gdb%%VER%%/python/gdb/printer/
 __init__.py
 bound_registers.py
share/gdb%%VER%%/syscalls/
 aarch64-linux.xml
 amd64-linux.xml
 arm-linux.xml
 freebsd.xml
 gdb-syscalls.dtd
 i386-linux.xml
 loongarch-linux.xml
 mips-n32-linux.xml
 mips-n64-linux.xml
 mips-o32-linux.xml
 netbsd.xml
 ppc-linux.xml
 ppc64-linux.xml
 s390-linux.xml
 s390x-linux.xml
 sparc-linux.xml
 sparc64-linux.xml


[FILE:28:manifests/plist.man]
share/man/man1/gdb%%VER%%.1

