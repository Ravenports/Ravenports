# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		gdb
VERSION=		13.2
KEYWORDS=		devel
VARIANTS=		std
SDESC[std]=		GNU debugger
HOMEPAGE=		http://www.gnu.org/software/gdb/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main patchsite
SITES[main]=		GNU/gdb
SITES[patchsite]=	https://raw.githubusercontent.com/jrmarino/gnu_debugger_difference/gdb_13.2-rev1/generated/patches-13.2/
DISTFILE[1]=		gdb-13.2.tar.xz:main
DISTFILE[2]=		patch-diff-gdb:patchsite
DISTFILE[3]=		patch-diff-rest:patchsite
DIST_SUBDIR=		gdb_13.2-rev1
DF_INDEX=		1
SPKGS[std]=		set
			primary
			man

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

NOT_FOR_ARCH=		aarch64

BUILD_DEPENDS=		gmp:dev:std
BUILDRUN_DEPENDS=	gmp:primary:std
			source-highlight:primary:std

USES=			cpe iconv gmake libtool readline pkgconfig makeinfo
			python expat ncurses gettext zstd

EXTRACT_HEAD[1]=	{{TAR}} -xf
EXTRACT_TAIL[1]=	--exclude dejagnu --exclude expect --exclude sim --exclude texinfo --exclude intl --exclude readline

LICENSE=		GPLv3+:primary
LICENSE_TERMS=		primary:{{WRKDIR}}/TERMS
LICENSE_FILE=		GPLv3+:{{WRKSRC}}/COPYING
LICENSE_AWK=		TERMS:"^\#include"
LICENSE_SOURCE=		TERMS:{{WRKSRC}}/gdb/gdb.c
LICENSE_SCHEME=		solo

CPE_VENDOR=		gnu
FPC_EQUIVALENT=		devel/gdb

PATCHFILES=		2 3

MUST_CONFIGURE=		gnu
CONFIGURE_OUTSOURCE=	yes
CONFIGURE_ARGS=		--program-suffix=132
			--enable-targets=all
			--enable-64-bit-bfd
			--enable-tui
			--disable-build-with-cxx
			--with-gdb-datadir={{PREFIX}}/share/gdb132
			{{ICONV_CONFIGURE_ARG}}
			--with-system-readline
			--with-expat=yes
			--with-libexpat-prefix={{LOCALBASE}}
			--without-libunwind-ia64
			--with-python={{PYTHON_CMD}}
			--with-source-highlight
CONFIGURE_ENV=		CONFIGURED_M4=m4
			CONFIGURED_BISON=byacc

PLIST_SUB=		VER=132

CFLAGS=			-DRL_NO_COMPAT
			-D__STDC_CONSTANT_MACROS
			-D__STDC_LIMIT_MACROS
			-Wno-unused-function
			-Wno-unused-variable
VAR_OPSYS[midnightbsd]=	MAKEFILE_LINE=CONFIGURE_TARGET=x86_64-raven-freebsd12.3

post-patch:
	${REINPLACE_CMD} -e 's|$$| [GDB v13.2 for ${OPSYS}]|' \
		${WRKSRC}/gdb/version.in
	# remove leftover readline removed garbage
	${REINPLACE_CMD} -e 's|..READLINE.*user.texi||' \
		${WRKSRC}/gdb/doc/Makefile.in

do-install:
	${INSTALL_PROGRAM} ${INSTALL_WRKSRC}/gdb/gdb \
		${STAGEDIR}${PREFIX}/bin/gdb132
	${INSTALL_MAN} ${WRKSRC}/gdb/doc/gdb.1 \
		${STAGEDIR}${MAN1PREFIX}/man/man1/gdb132.1
	(cd ${INSTALL_WRKSRC}/gdb/data-directory ; \
		${SETENV} ${MAKE_ENV} ${MAKE_CMD} ${MAKE_ARGS} install-syscalls )
	${LN} -sf gdb132 ${STAGEDIR}${PREFIX}/bin/gdbtui132
	${LN} -sf gdb132 ${STAGEDIR}${PREFIX}/bin/gdb
	(cd ${INSTALL_WRKSRC}/gdb && ${SETENV} ${MAKE_ENV} \
		${MAKE_CMD} ${MAKE_ARGS} install-python )
	(cd ${INSTALL_WRKSRC}/gdb/data-directory && ${SETENV} ${MAKE_ENV} \
		${MAKE_CMD} ${MAKE_ARGS} install-python )
. for f in gdb gdb/command gdb/function gdb/printer
	(cd ${STAGEDIR}${PREFIX}/share/gdb132/python/${f} ; ${CHMOD} 644 *.py* )
. endfor

[FILE:284:descriptions/desc.primary]
GDB is a source-level debugger for Ada, C, C++, Objective-C, Pascal and
many other languages.  GDB can target (i.e., debug programs running on)
more than a dozen different processor architectures, and GDB itself can
run on most popular GNU/Linux, Unix and Microsoft Windows variants.


[FILE:323:distinfo]
fd5bebb7be1833abdb6e023c2f498a354498281df9d05523d8915babeb893f0a     23664644 gdb_13.2-rev1/gdb-13.2.tar.xz
c95ce5e089eb28348e75bdefac90d016981806c0363fc4d3f13f3aa35ce1d73e        46729 gdb_13.2-rev1/patch-diff-gdb
807c3ae586e4320d3be0620da4b09b1a085f4a30251f0d77bf462c440fcf2ef7         1650 gdb_13.2-rev1/patch-diff-rest


[FILE:829:manifests/plist.primary]
bin/
 gdb
 gdb%%VER%%
 gdbtui%%VER%%
share/gdb%%VER%%/python/gdb/
 FrameDecorator.py
 FrameIterator.py
 __init__.py
 disassembler.py
 frames.py
 printing.py
 prompt.py
 styling.py
 types.py
 unwinder.py
 xmethod.py
share/gdb%%VER%%/python/gdb/command/
 __init__.py
 explore.py
 frame_filters.py
 pretty_printers.py
 prompt.py
 type_printers.py
 unwinders.py
 xmethods.py
share/gdb%%VER%%/python/gdb/function/
 __init__.py
 as_string.py
 caller_is.py
 strfns.py
share/gdb%%VER%%/python/gdb/printer/
 __init__.py
 bound_registers.py
share/gdb%%VER%%/syscalls/
 aarch64-linux.xml
 amd64-linux.xml
 arm-linux.xml
 freebsd.xml
 gdb-syscalls.dtd
 i386-linux.xml
 mips-n32-linux.xml
 mips-n64-linux.xml
 mips-o32-linux.xml
 netbsd.xml
 ppc-linux.xml
 ppc64-linux.xml
 s390-linux.xml
 s390x-linux.xml
 sparc-linux.xml
 sparc64-linux.xml


[FILE:28:manifests/plist.man]
share/man/man1/gdb%%VER%%.1

