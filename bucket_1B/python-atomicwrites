# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		python-atomicwrites
VERSION=		1.4.0
KEYWORDS=		python
VARIANTS=		py39 py310
SDESC[py310]=		Atomic file writes (3.10)
SDESC[py39]=		Atomic file writes (3.9)
HOMEPAGE=		https://github.com/untitaker/python-atomicwrites
CONTACT=		Python_Automaton[python@ironwolf.systems]

DOWNLOAD_GROUPS=	main
SITES[main]=		PYPIWHL/2c/a0/da5f49008ec6e9a658dbf5d7310a4debd397bce0b4db03cf8a410066bb87
DISTFILE[1]=		atomicwrites-1.4.0-py2.py3-none-any.whl:main
DF_INDEX=		1
SPKGS[py310]=		single
SPKGS[py39]=		single

OPTIONS_AVAILABLE=	PY39 PY310
OPTIONS_STANDARD=	none
VOPTS[py310]=		PY39=OFF PY310=ON
VOPTS[py39]=		PY39=ON PY310=OFF

DISTNAME=		atomicwrites-1.4.0.dist-info

GENERATED=		yes

[PY39].USES_ON=				python:py39,wheel

[PY310].USES_ON=			python:py310,wheel

[FILE:3052:descriptions/desc.single]
===================
python-atomicwrites
===================

Atomic file writes.

.. code-block:: python

    from atomicwrites import atomic_write

    with atomic_write('foo.txt', overwrite=True) as f:
        f.write('Hello world.')
        # "foo.txt" doesn't exist yet.

    # Now it does.

Features that distinguish it from other similar libraries (see
`Alternatives and Credit`_):

- Race-free assertion that the target file doesn't yet exist. This can be
  controlled with the overwrite parameter.

- Windows support, although not well-tested. The MSDN resources are not
very
  explicit about which operations are atomic. I'm basing my assumptions off
[a
  comment
 ]
  by [Doug Crook
 ], who appears
  to be a Microsoft employee:

      FAQ: Is MoveFileEx atomic
      Frequently asked question: Is MoveFileEx atomic if the existing and
new
      files are both on the same drive?

      The simple answer is "usually, but in some cases it will silently
fall-back
      to a non-atomic method, so don't count on it".

      The implementation of MoveFileEx looks something like this: [...]

      The problem is if the rename fails, you might end up with a CopyFile,
which
      is definitely not atomic.

      If you really need atomic-or-nothing, you can try calling
      NtSetInformationFile, which is unsupported but is much more likely to
be
      atomic. 

- Simple high-level API that wraps a very flexible class-based API.

- Consistent error handling across platforms.

How it works
============

It uses a temporary file in the same directory as the given path. This
ensures
that the temporary file resides on the same filesystem.

The temporary file will then be atomically moved to the target location: On
POSIX, it will use rename if files should be overwritten, otherwise a
combination of link and unlink. On Windows, it uses MoveFileEx_ through
stdlib's ctypes with the appropriate flags.

Note that with link and unlink, there's a timewindow where the file
might be available under two entries in the filesystem: The name of the
temporary file, and the name of the target file.

Also note that the permissions of the target file may change this way. In
some
situations a chmod can be issued without any concurrency problems, but
since that is not always the case, this library doesn't do it by itself.

.. _MoveFileEx:
https://msdn.microsoft.com/en-us/library/windows/desktop/aa365240%28v=vs.85%29.aspx

fsync
-----

On POSIX, fsync is invoked on the temporary file after it is written (to
flush file content and metadata), and on the parent directory after the
file is
moved (to flush filename).

fsync does not take care of disks' internal buffers, but there don't seem
to be any standard POSIX APIs for that. On OS X, fcntl is used with
F_FULLFSYNC instead of fsync for that reason.

On Windows, [_commit]
is used, but there are no guarantees about disk internal buffers.

Alternatives and Credit
=======================

Atomicwrites is directly inspired by the following libraries (and shares a
minimal amount of code):


[FILE:118:distinfo]
6d1784dea7c0c8d4a5172b6c620f40b6e4cbfdf96d783691f2e1302a7b88e197         6790 atomicwrites-1.4.0-py2.py3-none-any.whl

