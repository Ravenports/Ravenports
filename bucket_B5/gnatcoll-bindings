# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		gnatcoll-bindings
VERSION=		23.0.0
EPOCH=			1
KEYWORDS=		devel
VARIANTS=		standard
SDESC[standard]=	Core packages of GNAT Components Collection
HOMEPAGE=		https://github.com/AdaCore/gnatcoll-bindings
CONTACT=		John_Marino[draco@marino.st]

DOWNLOAD_GROUPS=	main
SITES[main]=		GITHUB/AdaCore:gnatcoll-bindings:v23.0.0
DISTFILE[1]=		generated:main
DF_INDEX=		1
SPKGS[standard]=	complete
			gmp
			iconv
			python3
			readline
			syslog
			examples

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILD_DEPENDS=		gmp:static:standard
			gmp:shared:standard
			gprbuild:gprlib:standard
			readline:single:standard
			python310:single:standard
BUILDRUN_DEPENDS=	gnatcoll-core:primary:standard
			xmlada:primary:standard
EXRUN[readline]=	readline:single:standard
EXRUN[iconv]=		libiconv:primary:standard
EXRUN[python3]=		python310:single:standard
EXRUN[gmp]=		gmp:shared:standard

USES=			gprbuild gmake iconv:build python:build

LICENSE=		GPLv3+:iconv
LICENSE_TERMS=		iconv:{{WRKDIR}}/TERMS
LICENSE_FILE=		GPLv3+:{{WRKSRC}}/COPYING3
LICENSE_AWK=		TERMS:"^$$"
LICENSE_SOURCE=		TERMS:{{WRKSRC}}/iconv/gnatcoll-iconv.ads
LICENSE_SCHEME=		solo

MAKE_ENV=		BUILD=PROD

INSTALL_REQ_TOOLCHAIN=	yes
SOVERSION=		0.0

do-build:
.for component in gmp iconv readline syslog
.  for libtype in static static-pic relocatable
	(cd ${WRKSRC} && ${SETENV} ${MAKE_ENV} \
		gprbuild -p -XLIBRARY_TYPE=${libtype} \
		-XGNATCOLL_ICONV_OPT="-liconv_pic" \
		-P ${component}/gnatcoll_${component}.gpr)
.  endfor
	# handle python components separately
.  for libtype in static static-pic relocatable
	(cd ${WRKSRC} && ${SETENV} ${MAKE_ENV} AUTOPYTHON=3.10 \
		GNATCOLL_PYTHON_CFLAGS="-I${LOCALBASE}/include/python3.10" \
		gprbuild -p -XLIBRARY_TYPE=${libtype} \
		-P python/gnatcoll_python.gpr)
.  endfor
.endfor

post-extract:
	${MV} ${WRKSRC}/python ${WRKSRC}/python2
	${MV} ${WRKSRC}/python3 ${WRKSRC}/python

do-install:
	${MKDIR} ${STAGEDIR}${PREFIX}/share/gpr
.for component in gmp iconv readline syslog python
.  for libtype in static static-pic relocatable
	${MKDIR} ${WRKDIR}/${component}/${libtype}
	${MKDIR} ${STAGEDIR}${PREFIX}/lib/gnatcoll_${component}.${libtype}
	(cd ${WRKSRC} && ${SETENV} ${MAKE_ENV}\
		gprinstall -p --prefix=${WRKDIR}/${component}/${libtype}\
		-XLIBRARY_TYPE=${libtype} \
		-XGNATCOLL_ICONV_OPT="-liconv_pic" \
		-P ${component}/gnatcoll_${component}.gpr)
.  endfor
	${MKDIR} ${STAGEDIR}${PREFIX}/include/gnatcoll_${component}
	${MV} ${WRKDIR}/${component}/static/include/gnatcoll_${component}/* \
		${STAGEDIR}${PREFIX}/include/gnatcoll_${component}/
.  for libtype in static static-pic relocatable
	${MV} ${WRKDIR}/${component}/${libtype}/lib/gnatcoll_${component}/*.ali \
		${STAGEDIR}${PREFIX}/lib/gnatcoll_${component}.${libtype}/
	@if [ "${libtype}" = "relocatable" ]; then\
		${INSTALL_LIB} ${WRKDIR}/${component}/${libtype}/lib/gnatcoll_${component}/*.so.0.0 \
		${STAGEDIR}${PREFIX}/lib/ ;\
		echo "Relocate ${libtype}/lib/gnatcoll_${component}/*.so.0.0" ;\
	else\
		${MV} ${WRKDIR}/${component}/${libtype}/lib/gnatcoll_${component}/*.a\
		${STAGEDIR}${PREFIX}/lib/gnatcoll_${component}.${libtype}/ ;\
		echo "Relocate ${libtype}/lib/gnatcoll_${component}/*.a" ;\
	fi
.  endfor
	${SH} ${FILESDIR}/gen_gpr.sh \
		"${component}" \
		"${STAGEDIR}${PREFIX}" \
		"-I${LOCALBASE}/include/python3.10" \
		"0.0" \
		"-lpython3.10"
.endfor

[FILE:102:descriptions/desc.gmp]
This is the bindings module of the GNAT Components Collection.
This subpackage contains gmp bindings.


[FILE:104:descriptions/desc.iconv]
This is the bindings module of the GNAT Components Collection.
This subpackage contains iconv bindings.


[FILE:110:descriptions/desc.python3]
This is the bindings module of the GNAT Components Collection.
This subpackage contains the python3 bindings.


[FILE:107:descriptions/desc.readline]
This is the bindings module of the GNAT Components Collection.
This subpackage contains readline bindings.


[FILE:105:descriptions/desc.syslog]
This is the bindings module of the GNAT Components Collection.
This subpackage contains syslog bindings.


[FILE:118:distinfo]
d51a7d1d35b2689feb6b05568702c4a22226538902ffd658e6f98a5d69d7bd51       251006 AdaCore-gnatcoll-bindings-23.0.0.tar.gz


[FILE:1981:manifests/plist.gmp]
include/gnatcoll_gmp/
 gmp_support.c
 gnatcoll-gmp-integers-io.adb
 gnatcoll-gmp-integers-io.ads
 gnatcoll-gmp-integers-misc.adb
 gnatcoll-gmp-integers-misc.ads
 gnatcoll-gmp-integers-number_theoretic.adb
 gnatcoll-gmp-integers-number_theoretic.ads
 gnatcoll-gmp-integers-random.adb
 gnatcoll-gmp-integers-random.ads
 gnatcoll-gmp-integers-root_extraction.adb
 gnatcoll-gmp-integers-root_extraction.ads
 gnatcoll-gmp-integers.adb
 gnatcoll-gmp-integers.ads
 gnatcoll-gmp-lib.ads
 gnatcoll-gmp-mpz_even_p.c
 gnatcoll-gmp-mpz_odd_p.c
 gnatcoll-gmp-mpz_sign.c
 gnatcoll-gmp-random_state.adb
 gnatcoll-gmp-random_state.ads
 gnatcoll-gmp-rational_numbers.adb
 gnatcoll-gmp-rational_numbers.ads
 gnatcoll-gmp.ads
lib/
 libgnatcoll_gmp.so
 libgnatcoll_gmp.so.%%SOMAJOR%%
 libgnatcoll_gmp.so.%%SOVERSION%%
lib/gnatcoll_gmp.relocatable/
 gnatcoll-gmp-integers-io.ali
 gnatcoll-gmp-integers-misc.ali
 gnatcoll-gmp-integers-number_theoretic.ali
 gnatcoll-gmp-integers-random.ali
 gnatcoll-gmp-integers-root_extraction.ali
 gnatcoll-gmp-integers.ali
 gnatcoll-gmp-lib.ali
 gnatcoll-gmp-random_state.ali
 gnatcoll-gmp-rational_numbers.ali
 gnatcoll-gmp.ali
 libgnatcoll_gmp.so
 libgnatcoll_gmp.so.%%SOMAJOR%%
 libgnatcoll_gmp.so.%%SOVERSION%%
lib/gnatcoll_gmp.static/
 gnatcoll-gmp-integers-io.ali
 gnatcoll-gmp-integers-misc.ali
 gnatcoll-gmp-integers-number_theoretic.ali
 gnatcoll-gmp-integers-random.ali
 gnatcoll-gmp-integers-root_extraction.ali
 gnatcoll-gmp-integers.ali
 gnatcoll-gmp-lib.ali
 gnatcoll-gmp-random_state.ali
 gnatcoll-gmp-rational_numbers.ali
 gnatcoll-gmp.ali
 libgnatcoll_gmp.a
lib/gnatcoll_gmp.static-pic/
 gnatcoll-gmp-integers-io.ali
 gnatcoll-gmp-integers-misc.ali
 gnatcoll-gmp-integers-number_theoretic.ali
 gnatcoll-gmp-integers-random.ali
 gnatcoll-gmp-integers-root_extraction.ali
 gnatcoll-gmp-integers.ali
 gnatcoll-gmp-lib.ali
 gnatcoll-gmp-random_state.ali
 gnatcoll-gmp-rational_numbers.ali
 gnatcoll-gmp.ali
 libgnatcoll_gmp.a
share/gpr/gnatcoll_gmp.gpr


[FILE:491:manifests/plist.iconv]
include/gnatcoll_iconv/
 gnatcoll-iconv.adb
 gnatcoll-iconv.ads
 iconv_support.c
lib/
 libgnatcoll_iconv.so
 libgnatcoll_iconv.so.%%SOMAJOR%%
 libgnatcoll_iconv.so.%%SOVERSION%%
lib/gnatcoll_iconv.relocatable/
 gnatcoll-iconv.ali
 libgnatcoll_iconv.so
 libgnatcoll_iconv.so.%%SOMAJOR%%
 libgnatcoll_iconv.so.%%SOVERSION%%
lib/gnatcoll_iconv.static/
 gnatcoll-iconv.ali
 libgnatcoll_iconv.a
lib/gnatcoll_iconv.static-pic/
 gnatcoll-iconv.ali
 libgnatcoll_iconv.a
share/gpr/gnatcoll_iconv.gpr


[FILE:1864:manifests/plist.python3]
include/gnatcoll_python/
 gnatcoll-any_types-python.adb
 gnatcoll-any_types-python.ads
 gnatcoll-python-capsule.adb
 gnatcoll-python-capsule.ads
 gnatcoll-python-ctypes.ads
 gnatcoll-python-errors.ads
 gnatcoll-python-eval.ads
 gnatcoll-python-exceptions.ads
 gnatcoll-python-fileutils.adb
 gnatcoll-python-fileutils.ads
 gnatcoll-python-lifecycle.adb
 gnatcoll-python-lifecycle.ads
 gnatcoll-python-state.adb
 gnatcoll-python-state.ads
 gnatcoll-python.adb
 gnatcoll-python.ads
 gnatcoll-scripts-python.adb
 gnatcoll-scripts-python.ads
 python_support.c
lib/
 libgnatcoll_python3.so
 libgnatcoll_python3.so.%%SOMAJOR%%
 libgnatcoll_python3.so.%%SOVERSION%%
lib/gnatcoll_python.relocatable/
 gnatcoll-any_types-python.ali
 gnatcoll-python-capsule.ali
 gnatcoll-python-ctypes.ali
 gnatcoll-python-errors.ali
 gnatcoll-python-eval.ali
 gnatcoll-python-exceptions.ali
 gnatcoll-python-fileutils.ali
 gnatcoll-python-lifecycle.ali
 gnatcoll-python-state.ali
 gnatcoll-python.ali
 gnatcoll-scripts-python.ali
 libgnatcoll_python3.so
 libgnatcoll_python3.so.%%SOMAJOR%%
 libgnatcoll_python3.so.%%SOVERSION%%
lib/gnatcoll_python.static/
 gnatcoll-any_types-python.ali
 gnatcoll-python-capsule.ali
 gnatcoll-python-ctypes.ali
 gnatcoll-python-errors.ali
 gnatcoll-python-eval.ali
 gnatcoll-python-exceptions.ali
 gnatcoll-python-fileutils.ali
 gnatcoll-python-lifecycle.ali
 gnatcoll-python-state.ali
 gnatcoll-python.ali
 gnatcoll-scripts-python.ali
 libgnatcoll_python3.a
lib/gnatcoll_python.static-pic/
 gnatcoll-any_types-python.ali
 gnatcoll-python-capsule.ali
 gnatcoll-python-ctypes.ali
 gnatcoll-python-errors.ali
 gnatcoll-python-eval.ali
 gnatcoll-python-exceptions.ali
 gnatcoll-python-fileutils.ali
 gnatcoll-python-lifecycle.ali
 gnatcoll-python-state.ali
 gnatcoll-python.ali
 gnatcoll-scripts-python.ali
 libgnatcoll_python3.a
share/gpr/gnatcoll_python.gpr


[FILE:528:manifests/plist.readline]
include/gnatcoll_readline/
 gnatcoll-readline.adb
 gnatcoll-readline.ads
lib/
 libgnatcoll_readline.so
 libgnatcoll_readline.so.%%SOMAJOR%%
 libgnatcoll_readline.so.%%SOVERSION%%
lib/gnatcoll_readline.relocatable/
 gnatcoll-readline.ali
 libgnatcoll_readline.so
 libgnatcoll_readline.so.%%SOMAJOR%%
 libgnatcoll_readline.so.%%SOVERSION%%
lib/gnatcoll_readline.static/
 gnatcoll-readline.ali
 libgnatcoll_readline.a
lib/gnatcoll_readline.static-pic/
 gnatcoll-readline.ali
 libgnatcoll_readline.a
share/gpr/gnatcoll_readline.gpr


[FILE:545:manifests/plist.syslog]
include/gnatcoll_syslog/
 gnatcoll-traces-syslog.adb
 gnatcoll-traces-syslog.ads
 syslog_support.c
lib/
 libgnatcoll_syslog.so
 libgnatcoll_syslog.so.%%SOMAJOR%%
 libgnatcoll_syslog.so.%%SOVERSION%%
lib/gnatcoll_syslog.relocatable/
 gnatcoll-traces-syslog.ali
 libgnatcoll_syslog.so
 libgnatcoll_syslog.so.%%SOMAJOR%%
 libgnatcoll_syslog.so.%%SOVERSION%%
lib/gnatcoll_syslog.static/
 gnatcoll-traces-syslog.ali
 libgnatcoll_syslog.a
lib/gnatcoll_syslog.static-pic/
 gnatcoll-traces-syslog.ali
 libgnatcoll_syslog.a
share/gpr/gnatcoll_syslog.gpr


[FILE:2217:files/gen_gpr.sh]
#!/bin/sh
# This scripts generates gpr files and creates symbolic links
# Expected inputs: component, destdir, python-includes
# component one of (gmp, iconv, readline, syslog, python)

name="$1"
destdir="$2"
python_includes="$3"
soversion="$4"
python3_linking="\"$5\""

case "$name" in
	"gmp")	
		component=GMP
		component_upper=GMP
		component_lower="gmp"
		linker_opts='"-lgmp"'
		;;
	"iconv")	
		component=Iconv
		component_upper=ICONV
		component_lower="iconv"
		linker_opts='"-liconv"'
		;;
	"readline")
		component=Readline
		component_upper=READLINE
		component_lower="readline"
		linker_opts='"-lreadline"'
		;;
	"syslog")
		component=Syslog
		component_upper=SYSLOG
		component_lower="syslog"
		linker_opts=
		;;
	"python")
		name=python3
		component=Python
		component_upper=PYTHON
		component_lower="python"
		linker_opts="${python3_linking}"
		;;
	*)
		echo "Illegal component $component"
		exit 1
		;;
esac

dname=$(dirname "$0")
filesdir=$(cd "$dname" && pwd -P)
target="gnatcoll_${component_lower}.gpr"
major="${soversion%.[0-9]}"

case "$name" in
	python|python3)
		pyhandle="s|%%PYTHON_ON%%||; s|%%PYTHON_INCLUDE%%|${python_includes}|"	
		;;
	*)
		pyhandle="/%%PYTHON_ON%%/d"
		;;
esac

case "$name" in
	"iconv")
		iconvhandle="s|%%ICONV_ON%%||"
		;;
	*)
		iconvhandle="/%%ICONV_ON%%/d"
		;;
esac
	
sed \
 -e "s|%%COMPONENT%%|${component}|"\
 -e "s|%%COMPONENT_U%%|${component_upper}|"\
 -e "s|%%COMPONENT_L%%|${component_lower}|"\
 -e "s|%%NAME%%|${name}|"\
 -e "s|%%LINKER_OPTS%%|${linker_opts}|"\
 -e "${pyhandle}"\
 -e "${iconvhandle}"\
 "${filesdir}/gnatcoll_template.gpr" > "${destdir}/share/gpr/${target}"

ln -s "libgnatcoll_${name}.so.${major}" "${destdir}/lib/libgnatcoll_${name}.so"
ln -s "libgnatcoll_${name}.so.${soversion}" "${destdir}/lib/libgnatcoll_${name}.so.${major}"
ln -s "../libgnatcoll_${name}.so.${soversion}" \
	"${destdir}/lib/gnatcoll_${component_lower}.relocatable/libgnatcoll_${name}.so"
ln -s "../libgnatcoll_${name}.so.${soversion}" \
	"${destdir}/lib/gnatcoll_${component_lower}.relocatable/libgnatcoll_${name}.so.${major}"
ln -s "../libgnatcoll_${name}.so.${soversion}" \
	"${destdir}/lib/gnatcoll_${component_lower}.relocatable/libgnatcoll_${name}.so.${soversion}"


[FILE:1997:files/gnatcoll_template.gpr]
with "gpr";
with "xmlada_schema";
with "xmlada_dom";
with "xmlada_sax";
with "xmlada_input_sources";
with "xmlada_unicode";
with "gnatcoll";

library project GnatColl_%%COMPONENT%% is
   type BUILD_KIND is ("static", "static-pic", "relocatable");
   BUILD : BUILD_KIND := external("GNATCOLL_%%COMPONENT_U%%_BUILD", external("LIBRARY_TYPE", "static-pic"));

   for Languages use ("Ada", "C");

   case BUILD is
      when "static" =>
         for Source_Dirs use ("../../include/gnatcoll_%%COMPONENT_L%%");
         for Library_Dir use "../../lib/gnatcoll_%%COMPONENT_L%%.static";
         for Library_Kind use "static";
      when "static-pic" =>
         for Source_Dirs use ("../../include/gnatcoll_%%COMPONENT_L%%");
         for Library_Dir use "../../lib/gnatcoll_%%COMPONENT_L%%.static-pic";
         for Library_Kind use "static-pic";
      when "relocatable" =>
         for Source_Dirs use ("../../include/gnatcoll_%%COMPONENT_L%%");
         for Library_Dir use "../../lib/gnatcoll_%%COMPONENT_L%%.relocatable";
         for Library_Kind use "relocatable";
   end case;

   for Library_Name use "gnatcoll_%%NAME%%";

   package Naming is
      for dot_replacement use "-";
      for casing use "lowercase";
      for body_suffix ("c") use ".c";
      for body_suffix ("ada") use ".adb";
      for spec_suffix ("c") use ".h";
      for spec_suffix ("ada") use ".ads";
   end Naming;

   package Linker is
      for Linker_Options use (%%LINKER_OPTS%%);
   end Linker;

   package Install is
      for Active use "False";
   end Install;

   for Externally_Built use "True";

   type Build_Type is
     ("DEBUG", "PROD");

   %%PYTHON_ON%%libpython_kind    := "shared";
   %%PYTHON_ON%%python_static_lib := "";
   %%PYTHON_ON%%python_libs       := ();
   %%PYTHON_ON%%python_cflags     := ("%%PYTHON_INCLUDE%%");
   %%ICONV_ON%%iconv_opt    := "-liconv";
   build        : build_type := "PROD";
   name         := "gnatcoll_%%NAME%%";
   version      := "0.0";
end GnatColl_%%COMPONENT%%;

