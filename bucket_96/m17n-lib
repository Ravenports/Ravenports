# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		m17n-lib
VERSION=		1.7.0
KEYWORDS=		textproc devel
VARIANTS=		standard
SDESC[standard]=	Multilingual text processing library
HOMEPAGE=		http://www.nongnu.org/m17n/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		SAVANNAH/m17n
DISTFILE[1]=		m17n-lib-1.7.0.tar.gz:main
DF_INDEX=		1
SPKGS[standard]=	single

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILD_DEPENDS=		bison:primary:standard
BUILDRUN_DEPENDS=	fontconfig:primary:standard
			freetype:primary:standard
			fribidi:single:standard
			libGD:single:standard
			libotf:single:standard
			m17n-db:single:standard

USES=			autoreconf gettext-tools libtool pkgconfig
GNOME_COMPONENTS=	libxml2
XORG_COMPONENTS=	ice sm x11 xaw xft xmu xrender xt

LICENSE=		LGPL21:single
LICENSE_SCHEME=		solo
LICENSE_FILE=		LGPL21:{{WRKSRC}}/COPYING

FPC_EQUIVALENT=		devel/m17n-lib

MUST_CONFIGURE=		gnu
CONFIGURE_ARGS=		--disable-nls
			--without-anthy
			--without-libthai
			HAVE_ISPELL=no

SINGLE_JOB=		yes

INSTALL_TARGET=		install-strip
INSTALL_REQ_TOOLCHAIN=	yes

[FILE:730:descriptions/desc.single]
The m17n library provides following facilities to handle multilingual
text.

  * M-text: A data structure for a multilingual text.  It is
    basically a string but with attributes called text property, and
    is designed to substitute for the C string.  It is the most
    important object of the m17n library.

  * Functions for creating and processing M-texts.

  * Functions for converting M-texts from/to strings encoded in
    various existing formats.

  * A huge character space, which contains all the Unicode
    characters and more non-Unicode characters.

  * Chartable: A data structure that contains per-character
    information efficiently.

  * Functions for inputting and displaying M-text on a window system.



[FILE:100:distinfo]
8eb853e1e0c86a70a09871f3264f950e5d62bba98960b3ffcde11511c138db83      1063169 m17n-lib-1.7.0.tar.gz


[FILE:639:manifests/plist.single]
bin/
 m17n-config
 m17n-conv
 m17n-date
 m17n-dump
 m17n-edit
 m17n-view
include/
 m17n-X.h
 m17n-core.h
 m17n-flt.h
 m17n-gui.h
 m17n-misc.h
 m17n.h
lib/
 libm17n-core.a
 libm17n-core.so
 libm17n-core.so.0
 libm17n-core.so.0.4.1
 libm17n-flt.a
 libm17n-flt.so
 libm17n-flt.so.0
 libm17n-flt.so.0.4.1
 libm17n-gui.a
 libm17n-gui.so
 libm17n-gui.so.0
 libm17n-gui.so.0.4.1
 libm17n.a
 libm17n.so
 libm17n.so.0
 libm17n.so.0.4.1
lib/m17n/1.0/
 libm17n-X.a
 libm17n-X.so
 libm17n-gd.a
 libm17n-gd.so
 libmimx-anthy.a
 libmimx-anthy.so
 libmimx-ispell.a
 libmimx-ispell.so
lib/pkgconfig/
 m17n-core.pc
 m17n-flt.pc
 m17n-gui.pc
 m17n-shell.pc


[FILE:1637:patches/patch-configure.ac]
--- configure.ac.orig	2014-12-10 14:22:52 UTC
+++ configure.ac
@@ -342,6 +342,10 @@ LIBS="$save_LIBS"
 AC_SUBST(XML2_LD_FLAGS)
 
 dnl Check for Anthy usability.
+AC_ARG_WITH(anthy,
+            AC_HELP_STRING([--with-anthy],
+                           [with Anthy library (default is YES)]))
+if test "x$with_anthy" != "xno"; then
 
 PKG_CHECK_MODULES(ANTHY, anthy, HAVE_ANTHY=yes, HAVE_ANTHY=no)
 if test "x$HAVE_ANTHY" = "xyes"; then
@@ -351,6 +355,8 @@ if test "x$HAVE_ANTHY" = "xyes"; then
   ANTHY_LD_FLAGS="$ANTHY_LIBS"
   CONFIG_FLAGS="$CONFIG_FLAGS -DHAVE_ANTHY"
 fi
+
+fi
 AC_SUBST(ANTHY_LD_FLAGS)
 
 dnl Check for Ispell usability.
@@ -365,11 +371,15 @@ dnl Check for Thai word-segmentation lib
 dnl If we have one, define HAVE_THAI_WORDSEG and one of these:
 dnl   HAVE_LIBTHAI, HAVE_WORDCUT, or HAVE_WORDCUT_OLD
 dnl In addition, set THAI_WORDSEG_LD_FLAGS to a proper value.
+AC_ARG_WITH(libthai,
+            AC_HELP_STRING([--with-libthai],
+                           [with libThai library (default is YES)]))
+if test "x$with_libthai" != "xno"; then
 
 PKG_CHECK_MODULES(LIBTHAI, libthai, HAVE_LIBTHAI=yes, HAVE_LIBTHAI=no)
 PKG_CHECK_MODULES(WORDCUT, wordcut, HAVE_WORDCUT=yes, HAVE_WORDCUT=no)
 
-if test "x$HAVE_LIBTHAI" == "xyes"; then
+if test "x$HAVE_LIBTHAI" = "xyes"; then
 
   AC_DEFINE(HAVE_LIBTHAI, 1, [Define if you have libthai])
   THAI_WORDSEG_LD_FLAGS="$LIBTHAI_LIBS"
@@ -425,6 +435,8 @@ if test "x$HAVE_THAI_WORDSEG" = "xyes"; 
   AC_DEFINE(HAVE_THAI_WORDSEG, 1,
             [Define if you have some Thai word-segmentation library])
 fi
+
+fi
 AC_SUBST(THAI_WORDSEG_LD_FLAGS)
 
 AC_SUBST(CONFIG_FLAGS)


[FILE:963:patches/patch-src_input.c]
--- src/input.c.orig	2014-11-28 22:57:48 UTC
+++ src/input.c
@@ -4264,7 +4264,7 @@ filter (MInputContext *ic, MSymbol key, 
   if (ic_info->commit_key_head > 0)
     {
       memmove (ic_info->keys, ic_info->keys + ic_info->commit_key_head,
-	       sizeof (int) * (ic_info->used - ic_info->commit_key_head));
+	       sizeof (MSymbol *) * (ic_info->used - ic_info->commit_key_head));
       ic_info->used -= ic_info->commit_key_head;
       ic_info->key_head -= ic_info->commit_key_head;
       ic_info->state_key_head -= ic_info->commit_key_head;
@@ -4278,7 +4278,7 @@ filter (MInputContext *ic, MSymbol key, 
       if (ic_info->key_head > 0)
 	{
 	  memmove (ic_info->keys, ic_info->keys + ic_info->key_head,
-		   sizeof (int) * (ic_info->used - ic_info->key_head));
+		   sizeof (MSymbol *) * (ic_info->used - ic_info->key_head));
 	  ic_info->used -= ic_info->key_head;
 	  ic_info->key_head = ic_info->state_key_head
 	    = ic_info->commit_key_head = 0;

