# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		opentoken
VERSION=		6.0b
KEYWORDS=		textproc ada
VARIANTS=		standard
SDESC[standard]=	Lexical analyser and parser for the Ada language
HOMEPAGE=		http://stephe-leake.org/ada/opentoken.html
CONTACT=		John_Marino[draco@marino.st]

DOWNLOAD_GROUPS=	main
SITES[main]=		http://stephe-leake.org/ada/
DISTFILE[1]=		opentoken-6.0b.tar.bz2:main
DF_INDEX=		1
SPKGS[standard]=	single

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

USES=			gprbuild ada:single

DISTNAME=		org.opentoken-6.0b

LICENSE=		GMGPL3:single
LICENSE_TERMS=		single:{{WRKDIR}}/TERMS
LICENSE_FILE=		GMGPL3:stock
LICENSE_AWK=		TERMS:"^with "
LICENSE_SOURCE=		TERMS:{{WRKSRC}}/opentoken.ads
LICENSE_SCHEME=		solo

FPC_EQUIVALENT=		textproc/opentoken

BUILD_WRKSRC=		{{WRKSRC}}/build/release

PLIST_SUB=		OTLIBVER={{OTLIBVER}}

do-build:
	(cd ${BUILD_WRKSRC} && ${SETENV} ${MAKE_ENV} \
		gprbuild -p -P opentoken_lib )

do-install:
	${MKDIR} ${STAGEDIR}${PREFIX}/lib/gnat \
		${STAGEDIR}${PREFIX}/lib/opentoken \
		${STAGEDIR}${PREFIX}/include/opentoken
	${INSTALL_DATA} ${BUILD_WRKSRC}/lib/*.ali \
		${STAGEDIR}${PREFIX}/lib/opentoken
	${INSTALL_LIB} ${BUILD_WRKSRC}/lib/libopentoken.so.${OTLIBVER} \
		${STAGEDIR}${PREFIX}/lib/opentoken/${FINALLIB}
	(cd ${STAGEDIR}${PREFIX}/lib/opentoken && \
		${LN} -s ${FINALLIB} libopentoken.${LIBEXT})
	${INSTALL_DATA} ${WRKSRC}/*.ad[bs] \
		${WRKSRC}/Language_Lexers/*.ad[bs] \
		${STAGEDIR}${PREFIX}/include/opentoken
	${INSTALL_DATA} ${FILESDIR}/opentoken.gpr \
		${STAGEDIR}${PREFIX}/lib/gnat

[FILE:469:descriptions/desc.single]
OpenToken is a facility for performing token analysis and parsing within
the Ada language. It is designed to provide all the functionality of a
traditional lexical analyzer/parser generator, such as lex/yacc. But due
to the magic of inheritance and runtime polymorphism it is implemented
entirely in Ada as withed-in code. No precompilation step is required, and
no messy tool-generated source code is created. The tradeoff is that the
grammar is generated at runtime.


[FILE:101:distinfo]
785b469fcd8e3a6a69598a6288b50e5de210694ebdd0a38fc853b7392639fca8       237958 opentoken-6.0b.tar.bz2


[FILE:6415:manifests/plist.single]
include/opentoken/
 ada_lexer.adb
 ada_lexer.ads
 html_lexer-basic.ads
 html_lexer-tags.ads
 html_lexer-task_safe.adb
 html_lexer-task_safe.ads
 html_lexer-task_unsafe.adb
 html_lexer-task_unsafe.ads
 html_lexer.adb
 html_lexer.ads
 java_lexer.ads
 m3_lexer.ads
 opentoken-production-list-print.adb
 opentoken-production-list-print.ads
 opentoken-production-list.adb
 opentoken-production-list.ads
 opentoken-production-parser-lalr-generator.adb
 opentoken-production-parser-lalr-generator.ads
 opentoken-production-parser-lalr-parser.adb
 opentoken-production-parser-lalr-parser.ads
 opentoken-production-parser-lalr-parser_lists.adb
 opentoken-production-parser-lalr-parser_lists.ads
 opentoken-production-parser-lalr.adb
 opentoken-production-parser-lalr.ads
 opentoken-production-parser-lrk_item.adb
 opentoken-production-parser-lrk_item.ads
 opentoken-production-parser.adb
 opentoken-production-parser.ads
 opentoken-production-print.adb
 opentoken-production-print.ads
 opentoken-production.adb
 opentoken-production.ads
 opentoken-recognizer-based_integer.adb
 opentoken-recognizer-based_integer.ads
 opentoken-recognizer-based_integer_ada_style.adb
 opentoken-recognizer-based_integer_ada_style.ads
 opentoken-recognizer-based_integer_java_style.adb
 opentoken-recognizer-based_integer_java_style.ads
 opentoken-recognizer-based_integer_real_ada.adb
 opentoken-recognizer-based_integer_real_ada.ads
 opentoken-recognizer-based_real_ada_style.adb
 opentoken-recognizer-based_real_ada_style.ads
 opentoken-recognizer-bracketed_comment.adb
 opentoken-recognizer-bracketed_comment.ads
 opentoken-recognizer-character_set.adb
 opentoken-recognizer-character_set.ads
 opentoken-recognizer-csv_field.adb
 opentoken-recognizer-csv_field.ads
 opentoken-recognizer-end_of_file.adb
 opentoken-recognizer-end_of_file.ads
 opentoken-recognizer-escape_sequence.adb
 opentoken-recognizer-escape_sequence.ads
 opentoken-recognizer-extended_digits.adb
 opentoken-recognizer-extended_digits.ads
 opentoken-recognizer-graphic_character.adb
 opentoken-recognizer-graphic_character.ads
 opentoken-recognizer-html_entity.adb
 opentoken-recognizer-html_entity.ads
 opentoken-recognizer-identifier.adb
 opentoken-recognizer-identifier.ads
 opentoken-recognizer-integer.adb
 opentoken-recognizer-integer.ads
 opentoken-recognizer-keyword.adb
 opentoken-recognizer-keyword.ads
 opentoken-recognizer-line_comment.adb
 opentoken-recognizer-line_comment.ads
 opentoken-recognizer-nothing.adb
 opentoken-recognizer-nothing.ads
 opentoken-recognizer-octal_escape.adb
 opentoken-recognizer-octal_escape.ads
 opentoken-recognizer-real.adb
 opentoken-recognizer-real.ads
 opentoken-recognizer-separator.adb
 opentoken-recognizer-separator.ads
 opentoken-recognizer-string.adb
 opentoken-recognizer-string.ads
 opentoken-recognizer.ads
 opentoken-text_feeder-counted_gnat_os_lib.adb
 opentoken-text_feeder-counted_gnat_os_lib.ads
 opentoken-text_feeder-string.adb
 opentoken-text_feeder-string.ads
 opentoken-text_feeder-text_io.adb
 opentoken-text_feeder-text_io.ads
 opentoken-text_feeder.ads
 opentoken-token-enumerated-analyzer.adb
 opentoken-token-enumerated-analyzer.ads
 opentoken-token-enumerated-identifier.adb
 opentoken-token-enumerated-identifier.ads
 opentoken-token-enumerated-integer.adb
 opentoken-token-enumerated-integer.ads
 opentoken-token-enumerated-list.adb
 opentoken-token-enumerated-list.ads
 opentoken-token-enumerated-nonterminal.adb
 opentoken-token-enumerated-nonterminal.ads
 opentoken-token-enumerated-real.adb
 opentoken-token-enumerated-real.ads
 opentoken-token-enumerated-string.adb
 opentoken-token-enumerated-string.ads
 opentoken-token-enumerated.adb
 opentoken-token-enumerated.ads
 opentoken-token-linked_list.adb
 opentoken-token-linked_list.ads
 opentoken-token-list.ads
 opentoken-token-list_mixin.adb
 opentoken-token-list_mixin.ads
 opentoken-token-selection.ads
 opentoken-token-selection_mixin.adb
 opentoken-token-selection_mixin.ads
 opentoken-token-sequence.ads
 opentoken-token-sequence_mixin.adb
 opentoken-token-sequence_mixin.ads
 opentoken-token.adb
 opentoken-token.ads
 opentoken.adb
 opentoken.ads
 run_ada_lexer.adb
lib/gnat/opentoken.gpr
lib/opentoken/
 ada_lexer.ali
 html_lexer-basic.ali
 html_lexer-tags.ali
 html_lexer-task_safe.ali
 html_lexer-task_unsafe.ali
 html_lexer.ali
 java_lexer.ali
 libopentoken.so
 libopentoken.so.%%OTLIBVER%%
 m3_lexer.ali
 opentoken-production-list-print.ali
 opentoken-production-list.ali
 opentoken-production-parser-lalr-generator.ali
 opentoken-production-parser-lalr-parser.ali
 opentoken-production-parser-lalr-parser_lists.ali
 opentoken-production-parser-lalr.ali
 opentoken-production-parser-lrk_item.ali
 opentoken-production-parser.ali
 opentoken-production-print.ali
 opentoken-production.ali
 opentoken-recognizer-based_integer.ali
 opentoken-recognizer-based_integer_ada_style.ali
 opentoken-recognizer-based_integer_java_style.ali
 opentoken-recognizer-based_integer_real_ada.ali
 opentoken-recognizer-based_real_ada_style.ali
 opentoken-recognizer-bracketed_comment.ali
 opentoken-recognizer-character_set.ali
 opentoken-recognizer-csv_field.ali
 opentoken-recognizer-end_of_file.ali
 opentoken-recognizer-escape_sequence.ali
 opentoken-recognizer-extended_digits.ali
 opentoken-recognizer-graphic_character.ali
 opentoken-recognizer-html_entity.ali
 opentoken-recognizer-identifier.ali
 opentoken-recognizer-integer.ali
 opentoken-recognizer-keyword.ali
 opentoken-recognizer-line_comment.ali
 opentoken-recognizer-nothing.ali
 opentoken-recognizer-octal_escape.ali
 opentoken-recognizer-real.ali
 opentoken-recognizer-separator.ali
 opentoken-recognizer-string.ali
 opentoken-recognizer.ali
 opentoken-text_feeder-counted_gnat_os_lib.ali
 opentoken-text_feeder-string.ali
 opentoken-text_feeder-text_io.ali
 opentoken-text_feeder.ali
 opentoken-token-enumerated-analyzer.ali
 opentoken-token-enumerated-identifier.ali
 opentoken-token-enumerated-integer.ali
 opentoken-token-enumerated-list.ali
 opentoken-token-enumerated-nonterminal.ali
 opentoken-token-enumerated-real.ali
 opentoken-token-enumerated-string.ali
 opentoken-token-enumerated.ali
 opentoken-token-linked_list.ali
 opentoken-token-list.ali
 opentoken-token-list_mixin.ali
 opentoken-token-selection.ali
 opentoken-token-selection_mixin.ali
 opentoken-token-sequence.ali
 opentoken-token-sequence_mixin.ali
 opentoken-token.ali
 opentoken.ali
 run_ada_lexer.ali


[FILE:317:patches/patch-build_common.gpr]
--- build/common.gpr.orig	2015-05-10 19:22:40 UTC
+++ build/common.gpr
@@ -41,7 +41,7 @@ project Common is
          "-O2",
          "-gnat2012",
          "-gnatfnoqQ",
-         "-gnatwaeL",
+         "-gnatwaL",
          "-fstack-check");
 
       --  The project file syntax does not let us set a variable in a


[FILE:381:patches/patch-build_release_opentoken.gpr]
--- build/release/opentoken.gpr.orig	2015-05-10 19:22:40 UTC
+++ build/release/opentoken.gpr
@@ -19,7 +19,6 @@ project OpenToken is
    package Compiler is
       for Default_Switches ("Ada") use
         Common.Compiler.Release_Switches &
-        Common.Compiler.Style_Checks &
         Common.Compiler'Default_Switches ("Ada");
 
       -- gnat pro 7.3.1 complains without this


[FILE:537:patches/patch-opentoken-production-parser-lalr-parser__lists.adb]
--- opentoken-production-parser-lalr-parser_lists.adb.orig	2015-05-10 19:22:40 UTC
+++ opentoken-production-parser-lalr-parser_lists.adb
@@ -484,7 +484,8 @@ package body OpenToken.Production.Parser
    is
       pragma Unreferenced (Container);
    begin
-      return (Element => Position.Item'Access);
+      --  WORKAROUND: gcc 6 reports an error for 'Access here; this passes all tests
+      return (Element => Position.Item'Unrestricted_Access);
    end Constant_Reference;
 
    type List_Access_Constant is access constant List;


[FILE:238:files/opentoken.gpr]
project OpenToken is
   for Languages use ("ada");
   for Library_Name use "opentoken";
   for Source_Dirs use ("../../include/opentoken");
   for Library_Dir use  "../../lib/opentoken";
   for Externally_Built use "true";
end OpenToken;


[FILE:135:files/special.mk]
OTLIBVER=	5.0.0

.if "${OPSYS}" == "Darwin"
FINALLIB=	libopentoken.${OTLIBVER}.dylib
.else
FINALLIB=	libopentoken.so.${OTLIBVER}
.endif
