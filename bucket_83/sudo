# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		sudo
VERSION=		1.9.13p3
KEYWORDS=		security
VARIANTS=		standard
SDESC[standard]=	Allows restricted root access for specified users
HOMEPAGE=		https://www.sudo.ws/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		https://www.sudo.ws/dist/
			ftp://ftp.sudo.ws/pub/sudo/
DISTFILE[1]=		sudo-1.9.13p3.tar.gz:main
DF_INDEX=		1
SPKGS[standard]=	complete
			primary
			examples
			docs
			nls
			man

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

USES=			cpe libtool gettext cclibs:primary zlib

LICENSE=		CUSTOM1:primary
LICENSE_NAME=		CUSTOM1:"Sudo License"
LICENSE_FILE=		CUSTOM1:{{WRKSRC}}/LICENSE.md
LICENSE_SCHEME=		solo

CPE_VENDOR=		todd_miller
FPC_EQUIVALENT=		security/sudo

MUST_CONFIGURE=		gnu
CONFIGURE_ARGS=		--sysconfdir={{PREFIX}}/etc
			--with-rundir=/var/run/sudo
			--with-exampledir={{PREFIX}}/share/examples/sudo
			--with-ignore-dot
			--with-tty-tickets
			--with-env-editor
			--with-long-otp-prompt
			--with-logfac=authpriv
			--without-pam
			--enable-nls
			--disable-noargs-shell

INSTALL_REQ_TOOLCHAIN=	yes

VAR_OPSYS[dragonfly]=	CONFIGURE_ARGS=--enable-hardening=no

post-patch:
	${REINPLACE_CMD} -E '/install-(binaries|noexec):/,/^$$/ \
		s/\$$\(INSTALL\)/& ${STRIP}/;s/-b\~/-b ~/' \
		${WRKSRC}/src/Makefile.in
	${REINPLACE_CMD} -e 's,$$(srcdir)/sudoers2ldif $$(DESTDIR)$$(docdir),$$(srcdir)/sudoers2ldif $$(DESTDIR)$$(bindir),' \
		${WRKSRC}/plugins/sudoers/Makefile.in
	${REINPLACE_CMD} -e 's|/usr/local|${PREFIX}|g' \
		${WRKSRC}/plugins/sudoers/sudoers.in
	${REINPLACE_CMD} -e "/mansectsu='1m'/d" -e "/mansectform='4'/d" \
		${WRKSRC}/configure

post-install:
	${MKDIR} ${STAGEDIR}${PREFIX}/etc/pam.d
	${INSTALL_DATA} ${FILESDIR}/pam.conf \
		${STAGEDIR}${PREFIX}/etc/pam.d/sudo.default
	${MV} ${STAGEDIR}${PREFIX}/etc/sudo.conf \
		${STAGEDIR}${PREFIX}/etc/sudo.conf.sample
	${MV} ${STAGEDIR}${PREFIX}/etc/sudo_logsrvd.conf \
		${STAGEDIR}${PREFIX}/etc/sudo_logsrvd.conf.sample
	${RM} ${STAGEDIR}${PREFIX}/etc/sudoers
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/sudoreplay
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/cvtsudoers
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/sbin/visudo
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/sbin/sudo_logsrvd
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/sbin/sudo_sendlog
.for f in group_file.so libsudo_util.so sudoers.so system_group.so \
	audit_json.so sudo_intercept.so
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/libexec/sudo/${f}
.endfor

[FILE:244:descriptions/desc.primary]
Sudo (su "do") allows a system administrator to delegate authority to give
certain users (or groups of users) the ability to run some (or all)
commands as root or another user while providing an audit trail of the
commands and their arguments.


[FILE:99:distinfo]
92334a12bb93e0c056b09f53e255ccb7d6f67c6350e2813cd9593ceeca78560b      5100355 sudo-1.9.13p3.tar.gz


[FILE:490:manifests/plist.primary]
@sample etc/pam.d/sudo.default etc/pam.d/sudo
@sample etc/sudo.conf.sample
@sample etc/sudo_logsrvd.conf.sample
@sample etc/sudoers.dist etc/sudoers
bin/
 cvtsudoers
 sudo
 sudoedit
 sudoreplay
include/sudo_plugin.h
libexec/sudo/
 audit_json.so
 group_file.so
 libsudo_util.so
 libsudo_util.so.0
 libsudo_util.so.0.0.0
 sudo_intercept.so
 sudo_noexec.so
 sudoers.so
 system_group.so
sbin/
 sudo_logsrvd
 sudo_sendlog
 visudo
@dir /var/db/sudo/lectured
@dir /var/run/sudo
@dir etc/sudoers.d


[FILE:100:manifests/plist.examples]
share/examples/sudo/
 cvtsudoers.conf
 pam.conf
 sudo.conf
 sudo_logsrvd.conf
 sudoers
 syslog.conf


[FILE:147:manifests/plist.docs]
share/doc/sudo/
 CONTRIBUTING.md
 CONTRIBUTORS.md
 ChangeLog
 HISTORY.md
 LICENSE.md
 NEWS
 README.md
 SECURITY.md
 TROUBLESHOOTING.md
 UPGRADE.md


[FILE:1883:manifests/plist.nls]
share/locale/ast/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/ca/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/cs/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/da/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/de/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/el/LC_MESSAGES/sudoers.mo
share/locale/eo/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/es/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/eu/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/fa/LC_MESSAGES/sudo.mo
share/locale/fi/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/fr/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/fur/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/gl/LC_MESSAGES/sudo.mo
share/locale/hr/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/hu/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/it/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/ja/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/ka/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/ko/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/lt/LC_MESSAGES/sudoers.mo
share/locale/nb/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/nl/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/nn/LC_MESSAGES/sudo.mo
share/locale/pl/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/pt/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/pt_BR/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/ro/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/ru/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/sk/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/sl/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/sq/LC_MESSAGES/sudo.mo
share/locale/sr/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/sv/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/tr/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/uk/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/vi/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/zh_CN/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/zh_TW/LC_MESSAGES/
 sudo.mo
 sudoers.mo


[FILE:277:manifests/plist.man]
share/man/man1/cvtsudoers.1.gz
share/man/man5/
 sudo.conf.5.gz
 sudo_logsrv.proto.5.gz
 sudo_logsrvd.conf.5.gz
 sudo_plugin.5.gz
 sudoers.5.gz
 sudoers_timestamp.5.gz
share/man/man8/
 sudo.8.gz
 sudo_logsrvd.8.gz
 sudo_sendlog.8.gz
 sudoedit.8.gz
 sudoreplay.8.gz
 visudo.8.gz


[FILE:628:patches/patch-plugins__sudoers__sudoers.in]
--- plugins/sudoers/sudoers.in.orig	2023-02-14 16:52:38 UTC
+++ plugins/sudoers/sudoers.in
@@ -32,6 +32,14 @@
 ##
 ## Defaults specification
 ##
+## Uncomment if needed to preserve environmental variables related to the
+## FreeBSD pkg utility and fetch.
+# Defaults     env_keep += "PKG_CACHEDIR PKG_DBDIR FTP_PASSIVE_MODE"
+##
+## Additionally uncomment if needed to preserve environmental variables
+## related to portupgrade
+# Defaults     env_keep += "PORTSDIR PORTS_INDEX PORTS_DBDIR PACKAGES PKGTOOLS_CONF"
+##
 ## You may wish to keep some of the following environment variables
 ## when running commands via sudo.
 ##


[FILE:307:files/pam.conf]
# PAM configuration for the "sudo" service
#

# auth
auth		include		system

# account
account		include		system

# session
# XXX: pam_lastlog (used in system) causes users to appear as though
# they are no longer logged in in system logs.
session		required	pam_permit.so

# password
password	include		system

