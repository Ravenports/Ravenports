# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		sudo
VERSION=		1.8.23
KEYWORDS=		security
VARIANTS=		standard
SDESC[standard]=	Allows restricted root access for specified users
HOMEPAGE=		https://www.sudo.ws/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		https://www.sudo.ws/dist/
			ftp://ftp.sudo.ws/pub/sudo/
DISTFILE[1]=		sudo-1.8.23.tar.gz:main
DF_INDEX=		1
SPKGS[standard]=	complete
			primary
			examples
			docs

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

USES=			cpe libtool gettext-runtime cclibs:primary zlib

LICENSE=		CUSTOM1:primary
LICENSE_NAME=		CUSTOM1:"Sudo License"
LICENSE_FILE=		CUSTOM1:{{WRKSRC}}/doc/LICENSE
LICENSE_SCHEME=		solo

CPE_VENDOR=		todd_miller
FPC_EQUIVALENT=		security/sudo

MUST_CONFIGURE=		gnu
CONFIGURE_ARGS=		--sysconfdir={{PREFIX}}/etc
			--with-exampledir={{PREFIX}}/share/examples/sudo
			--with-ignore-dot
			--with-tty-tickets
			--with-env-editor
			--with-long-otp-prompt
			--with-logfac=authpriv
			--enable-nls
			--disable-noargs-shell

INSTALL_REQ_TOOLCHAIN=	yes

VAR_OPSYS[dragonfly]=	CONFIGURE_ARGS=--enable-hardening=no

post-patch:
	${REINPLACE_CMD} -E '/install-(binaries|noexec):/,/^$$/ \
		s/\$$\(INSTALL\)/& ${STRIP}/;s/-b\~/-b ~/' \
		${WRKSRC}/src/Makefile.in
	${REINPLACE_CMD} -e 's,$$(srcdir)/sudoers2ldif $$(DESTDIR)$$(docdir),$$(srcdir)/sudoers2ldif $$(DESTDIR)$$(bindir),' \
		${WRKSRC}/plugins/sudoers/Makefile.in
	${REINPLACE_CMD} -e 's|/usr/local|${PREFIX}|g' \
		${WRKSRC}/plugins/sudoers/sudoers.in

post-install:
	@${MKDIR} ${STAGEDIR}${PREFIX}/etc/pam.d
	${INSTALL_DATA} ${FILESDIR}/pam.conf \
		${STAGEDIR}${PREFIX}/etc/pam.d/sudo.default
	${RM} ${STAGEDIR}${PREFIX}/etc/sudoers
	(cd ${STAGEDIR}${PREFIX}/share/man && \
		${RMDIR} man[158] && \
		${MV} cat1 man1 && \
		${MV} cat8 man8 && \
		${MV} cat5 man5)
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/sudoreplay
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/sbin/visudo
.for f in group_file.so libsudo_util.so sudoers.so system_group.so
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/libexec/sudo/${f}
.endfor

[FILE:244:descriptions/desc.primary]
Sudo (su "do") allows a system administrator to delegate authority to give
certain users (or groups of users) the ability to run some (or all)
commands as root or another user while providing an audit trail of the
commands and their arguments.


[FILE:97:distinfo]
d863d29b6fc87bc784a3223350e2b28a2ff2c4738f0fb8f1c92bb38c3017e679      3150674 sudo-1.8.23.tar.gz


[FILE:2133:manifests/plist.primary]
bin/
 cvtsudoers
 sudo
 sudoedit
 sudoreplay
@sample etc/pam.d/sudo.default etc/pam.d/sudo
@sample etc/sudoers.dist etc/sudoers
include/sudo_plugin.h
libexec/sudo/
 group_file.so
 libsudo_util.so
 libsudo_util.so.0
 libsudo_util.so.0.0.0
 sudo_noexec.so
 sudoers.so
 system_group.so
sbin/visudo
share/locale/ca/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/cs/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/da/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/de/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/el/LC_MESSAGES/sudoers.mo
share/locale/eo/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/es/LC_MESSAGES/sudo.mo
share/locale/eu/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/fi/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/fr/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/fur/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/gl/LC_MESSAGES/sudo.mo
share/locale/hr/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/hu/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/it/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/ja/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/ko/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/lt/LC_MESSAGES/sudoers.mo
share/locale/nb/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/nl/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/nn/LC_MESSAGES/sudo.mo
share/locale/pl/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/pt_BR/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/ru/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/sk/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/sl/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/sr/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/sv/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/tr/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/uk/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/vi/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/zh_CN/LC_MESSAGES/
 sudo.mo
 sudoers.mo
share/locale/zh_TW/LC_MESSAGES/sudo.mo
share/man/man1/cvtsudoers.1.gz
share/man/man5/
 sudo.conf.5.gz
 sudoers.5.gz
 sudoers_timestamp.5.gz
share/man/man8/
 sudo.8.gz
 sudo_plugin.8.gz
 sudoedit.8.gz
 sudoreplay.8.gz
 visudo.8.gz
@dir /var/db/sudo/lectured
@dir /var/run/sudo
@dir etc/sudoers.d


[FILE:64:manifests/plist.examples]
share/examples/sudo/
 pam.conf
 sudo.conf
 sudoers
 syslog.conf


[FILE:99:manifests/plist.docs]
share/doc/sudo/
 CONTRIBUTORS
 ChangeLog
 HISTORY
 LICENSE
 NEWS
 README
 TROUBLESHOOTING
 UPGRADE


[FILE:725:patches/patch-install-sh]
--- install-sh.orig	2017-01-14 04:30:15 UTC
+++ install-sh
@@ -171,12 +171,6 @@ if ${DIRMODE} ; then
 	if [ ! -d "${DEST}" ] ; then
 	    ${MKDIR} "${DEST}" || exit 1
 	fi
-	if ${CHOWNIT} ; then
-	    ${CHOWN} "${OWNER}" "${DEST}" || exit 1
-	fi
-	if ${CHGROUPIT} ; then
-	    ${CHGRP} "${GROUP}" "${DEST}" || exit 1
-	fi
 	if ${CHMODIT} ; then
 	    ${CHMOD} "${MODE}"  "${DEST}" || exit 1
 	fi
@@ -226,12 +220,6 @@ fi
 ##  Strip and set the owner/mode.
 if ${STRIPIT} ; then
     ${STRIP} "${DEST}" || exit 1
-fi
-if ${CHOWNIT} ; then
-    ${CHOWN} "${OWNER}" "${DEST}" || exit 1
-fi
-if ${CHGROUPIT} ; then
-    ${CHGRP} "${GROUP}" "${DEST}" || exit 1
 fi
 if ${CHMODIT} ; then
     ${CHMOD} "${MODE}" "${DEST}" || exit 1


[FILE:628:patches/patch-plugins__sudoers__sudoers.in]
--- plugins/sudoers/sudoers.in.orig	2017-01-14 04:30:15 UTC
+++ plugins/sudoers/sudoers.in
@@ -32,6 +32,14 @@
 ##
 ## Defaults specification
 ##
+## Uncomment if needed to preserve environmental variables related to the
+## FreeBSD pkg utility and fetch.
+# Defaults     env_keep += "PKG_CACHEDIR PKG_DBDIR FTP_PASSIVE_MODE"
+##
+## Additionally uncomment if needed to preserve environmental variables
+## related to portupgrade
+# Defaults     env_keep += "PORTSDIR PORTS_INDEX PORTS_DBDIR PACKAGES PKGTOOLS_CONF"
+##
 ## You may wish to keep some of the following environment variables
 ## when running commands via sudo.
 ##


[FILE:307:files/pam.conf]
# PAM configuration for the "sudo" service
#

# auth
auth		include		system

# account
account		include		system

# session
# XXX: pam_lastlog (used in system) causes users to appear as though
# they are no longer logged in in system logs.
session		required	pam_permit.so

# password
password	include		system

