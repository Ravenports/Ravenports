# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		freetype
VERSION=		2.12.0
KEYWORDS=		print
VARIANTS=		standard
SDESC[standard]=	Free and portable TrueType font rendering engine
HOMEPAGE=		https://www.freetype.org/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		http://savannah.nongnu.org/download/freetype/
DISTFILE[1]=		freetype-2.12.0.tar.xz:main
DF_INDEX=		1
SPKGS[standard]=	complete
			primary
			docs

OPTIONS_AVAILABLE=	LCD_FILTERING PNG TAB_VALIDATION TT_SZ_METRICS V38
			V40 DEBUG
OPTIONS_STANDARD=	LCD_FILTERING PNG TAB_VALIDATION TT_SZ_METRICS V38
			V40 DEBUG
OPTGROUP_UNLIMITED=	SUBPIX_HINT
OPTDESCR[SUBPIX_HINT]=	Subpixel hinting support
OPTGROUP[SUBPIX_HINT]=	V38 V40
OPT_ON[all]=		LCD_FILTERING V40

BUILDRUN_DEPENDS=	bzip2:complete:standard
RUN_DEPENDS=		zlib:static:standard

USES=			cpe gmake libtool zlib pkgconfig

LICENSE=		GPLv2+:primary CUSTOM1:primary
LICENSE_TERMS=		primary:{{WRKSRC}}/LICENSE.TXT
LICENSE_NAME=		CUSTOM1:"The FreeType Project license"
LICENSE_FILE=		GPLv2+:{{WRKSRC}}/docs/GPLv2.TXT
			CUSTOM1:{{WRKSRC}}/docs/FTL.TXT
LICENSE_SCHEME=		dual

CPE_PRODUCT=		freetype
CPE_VENDOR=		freetype
FPC_EQUIVALENT=		print/freetype2

MUST_CONFIGURE=		gnu
CONFIGURE_WRKSRC=	{{WRKSRC}}/builds/unix
CONFIGURE_ARGS=		--without-harfbuzz

MAKE_ENV=		TOP=""

SOVERSION=		6.18.2

[V40].DESCRIPTION=			v40 mode (minimal, fast, AKA ClearType hinting)
[V40].MAKEFILE_ON=			SUBPIXEL_HINTING_MODE+=2

[LCD_FILTERING].DESCRIPTION=		Sub-pixel rendering (patented)
[LCD_FILTERING].CFLAGS_ON=		-DFT_CONFIG_OPTION_SUBPIXEL_RENDERING

[TT_SZ_METRICS].DESCRIPTION=		TrueType-like size metrics for V40 auto-hinting

[PNG].DESCRIPTION=			PNG compressed OpenType embedded bitmaps support
[PNG].CONFIGURE_WITH_BOTH=		png
[PNG].USES_ON=				png

[V38].DESCRIPTION=			v38 mode (Infinality code)
[V38].MAKEFILE_ON=			SUBPIXEL_HINTING_MODE+=1

[TAB_VALIDATION].DESCRIPTION=		TrueType GX/AAT and OpenType table validation

post-patch:
.if defined(SUBPIXEL_HINTING_MODE)
	${REINPLACE_CMD} -i'.hinting.bak1' \
		-e 's|^\(#define TT_CONFIG_OPTION_SUBPIXEL_HINTING\).*|\1 \
	${SELECTED_MODE:sh}|' \
		${WRKSRC}/include/freetype/config/ftoption.h
.else
	${REINPLACE_CMD} -i'.hinting.bak2' \
		-e 's|^\(#define TT_CONFIG_OPTION_SUBPIXEL_HINTING.*\)|/* \1 */|' \
		${WRKSRC}/include/freetype/config/ftoption.h
.endif

post-patch-TT_SZ_METRICS-ON:
	${REINPLACE_CMD} -i'.metrics.bak' \
		-e 's|.*\(#define AF_CONFIG_OPTION_TT_SIZE_METRICS\).*|\1|' \
		${WRKSRC}/include/freetype/config/ftoption.h

post-patch-TAB_VALIDATION-ON:
	${REINPLACE_CMD} -e '/valid$$/s|#.*\(AUX_MODULES\)|\1|' \
		${WRKSRC}/modules.cfg

post-install:
	${INSTALL_SCRIPT} ${WRKSRC}/builds/unix/freetype-config \
		${STAGEDIR}${PREFIX}/bin/
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/lib/libfreetype.${LIBEXT}
	(cd ${WRKSRC}/docs && \
		${COPYTREE_SHARE} "reference CHANGES formats.txt LICENSE.TXT raster.txt" ${STAGEDIR}${STD_DOCDIR})

post-patch-DEBUG-ON:
	${REINPLACE_CMD} -i'.debug.bak' \
		-e 's|.*\(#define FT_DEBUG_LEVEL_TRACE\).*|\1|' \
		-e 's|.*\(#define FT_DEBUG_MEMORY\).*|\1|' \
		${WRKSRC}/include/freetype/config/ftoption.h

post-configure:
	(cd ${BUILD_WRKSRC}; ${SETENV} ${MAKE_ENV} \
		${MAKE_CMD} ${MAKE_FLAGS} ${MAKEFILE} ${MAKE_ARGS} setup)

post-patch-sunos:
	${REINPLACE_CMD} -e '/_XOPEN_SOURCE/d; /_POSIX_C_SOURCE/d' \
		${WRKSRC}/src/dlg/dlg*.c

[FILE:255:descriptions/desc.primary]
FreeType is a freely available software library to render fonts.

It is written in C, designed to be small, efficient, highly customizable,
and portable while capable of producing high-quality output (glyph images)
of most vector and bitmap font formats.


[FILE:101:distinfo]
ef5c336aacc1a079ff9262d6308d6c2a066dd4d2a905301c4adda9b354399033      2340352 freetype-2.12.0.tar.xz


[FILE:881:manifests/plist.primary]
bin/freetype-config
include/freetype2/ft2build.h
include/freetype2/freetype/
 freetype.h
 ftadvanc.h
 ftbbox.h
 ftbdf.h
 ftbitmap.h
 ftbzip2.h
 ftcache.h
 ftchapters.h
 ftcid.h
 ftcolor.h
 ftdriver.h
 fterrdef.h
 fterrors.h
 ftfntfmt.h
 ftgasp.h
 ftglyph.h
 ftgxval.h
 ftgzip.h
 ftimage.h
 ftincrem.h
 ftlcdfil.h
 ftlist.h
 ftlogging.h
 ftlzw.h
 ftmac.h
 ftmm.h
 ftmodapi.h
 ftmoderr.h
 ftotval.h
 ftoutln.h
 ftparams.h
 ftpfr.h
 ftrender.h
 ftsizes.h
 ftsnames.h
 ftstroke.h
 ftsynth.h
 ftsystem.h
 fttrigon.h
 fttypes.h
 ftwinfnt.h
 otsvg.h
 t1tables.h
 ttnameid.h
 tttables.h
 tttags.h
include/freetype2/freetype/config/
 ftconfig.h
 ftheader.h
 ftmodule.h
 ftoption.h
 ftstdlib.h
 integer-types.h
 mac-support.h
 public-macros.h
lib/
 libfreetype.a
 libfreetype.so
 libfreetype.so.%%SOMAJOR%%
 libfreetype.so.%%SOVERSION%%
lib/pkgconfig/freetype2.pc
share/aclocal/freetype2.m4


[FILE:863:patches/patch-builds_unix_detect.mk]
--- builds/unix/detect.mk.orig	2022-01-27 07:43:19 UTC
+++ builds/unix/detect.mk
@@ -22,6 +22,9 @@ ifeq ($(PLATFORM),ansi)
                      $(wildcard /usr/sbin/init) \
                      $(wildcard /dev/null) \
                      $(wildcard /hurd/auth))
+  # FreeBSD is "unix" so just mandate this to fix the build in
+  # jails that do not have init (see PR#113470).
+  is_unix := true
   ifneq ($(is_unix),)
 
     PLATFORM := unix
@@ -86,10 +89,10 @@ ifeq ($(PLATFORM),unix)
   ifdef must_configure
     ifneq ($(have_Makefile),)
       # we are building FT2 not in the src tree
-	        $(TOP_DIR)/builds/unix/configure $(value CFG)
+#	        $(TOP_DIR)/builds/unix/configure $(value CFG)
     else
-	      cd builds/unix; \
-	        ./configure $(value CFG)
+#	      cd builds/unix; \
+#	        ./configure $(value CFG)
     endif
   endif
 


[FILE:739:files/pkg-message-primary]
The 2.7.x series now uses the new subpixel hinting mode (V40 port's option) as
the default, emulating a modern version of ClearType. This change inevitably
leads to different rendering results, and you might change port's options to
adapt it to your taste (or use the new "FREETYPE_PROPERTIES" environment
variable).

The environment variable "FREETYPE_PROPERTIES" can be used to control the
driver properties. Example:

FREETYPE_PROPERTIES=truetype:interpreter-version=35 \
	cff:no-stem-darkening=1 \
	autofitter:warping=1

This allows to select, say, the subpixel hinting mode at runtime for a given
application.

The controllable properties are listed in the section "Controlling FreeType
Modules" in the reference's table of contents.


[FILE:115:files/special.mk]
SELECTED_MODE=	\
	r=0; \
	for m in ${SUBPIXEL_HINTING_MODE}; \
		do r=$$(($$r | $$m)); \
	done; \
	${ECHO_CMD} $$r

