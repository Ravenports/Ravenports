# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		freetype
VERSION=		2.13.0
KEYWORDS=		print
VARIANTS=		standard
SDESC[standard]=	Free and portable TrueType font rendering engine
HOMEPAGE=		https://www.freetype.org/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		http://savannah.nongnu.org/download/freetype/
DISTFILE[1]=		freetype-2.13.0.tar.xz:main
DF_INDEX=		1
SPKGS[standard]=	complete
			primary
			dev
			docs

OPTIONS_AVAILABLE=	LCD_FILTERING PNG TAB_VALIDATION TT_SZ_METRICS V38
			V40 DEBUG
OPTIONS_STANDARD=	LCD_FILTERING PNG TAB_VALIDATION TT_SZ_METRICS V38
			V40 DEBUG
OPTGROUP_UNLIMITED=	SUBPIX_HINT
OPTDESCR[SUBPIX_HINT]=	Subpixel hinting support
OPTGROUP[SUBPIX_HINT]=	V38 V40
OPT_ON[all]=		LCD_FILTERING V40

USES=			cpe gmake libtool zlib pkgconfig bz2

LICENSE=		GPLv2+:primary CUSTOM1:primary
LICENSE_TERMS=		primary:{{WRKSRC}}/LICENSE.TXT
LICENSE_NAME=		CUSTOM1:"The FreeType Project license"
LICENSE_FILE=		GPLv2+:{{WRKSRC}}/docs/GPLv2.TXT
			CUSTOM1:{{WRKSRC}}/docs/FTL.TXT
LICENSE_SCHEME=		dual

CPE_PRODUCT=		freetype
CPE_VENDOR=		freetype
FPC_EQUIVALENT=		print/freetype2

MUST_CONFIGURE=		gnu
CONFIGURE_WRKSRC=	{{WRKSRC}}/builds/unix
CONFIGURE_ARGS=		--without-harfbuzz

MAKE_ENV=		TOP=""

SOVERSION=		6.19.0

[V40].DESCRIPTION=			v40 mode (minimal, fast, AKA ClearType hinting)
[V40].MAKEFILE_ON=			SUBPIXEL_HINTING_MODE+=2

[LCD_FILTERING].DESCRIPTION=		Sub-pixel rendering (patented)
[LCD_FILTERING].CFLAGS_ON=		-DFT_CONFIG_OPTION_SUBPIXEL_RENDERING

[TT_SZ_METRICS].DESCRIPTION=		TrueType-like size metrics for V40 auto-hinting

[PNG].DESCRIPTION=			PNG compressed OpenType embedded bitmaps support
[PNG].CONFIGURE_WITH_BOTH=		png
[PNG].USES_ON=				png

[V38].DESCRIPTION=			v38 mode (Infinality code)
[V38].MAKEFILE_ON=			SUBPIXEL_HINTING_MODE+=1

[TAB_VALIDATION].DESCRIPTION=		TrueType GX/AAT and OpenType table validation

post-patch:
.if defined(SUBPIXEL_HINTING_MODE)
	${REINPLACE_CMD} -i'.hinting.bak1' \
		-e 's|^\(#define TT_CONFIG_OPTION_SUBPIXEL_HINTING\).*|\1 \
	${SELECTED_MODE:sh}|' \
		${WRKSRC}/include/freetype/config/ftoption.h
.else
	${REINPLACE_CMD} -i'.hinting.bak2' \
		-e 's|^\(#define TT_CONFIG_OPTION_SUBPIXEL_HINTING.*\)|/* \1 */|' \
		${WRKSRC}/include/freetype/config/ftoption.h
.endif

post-patch-TT_SZ_METRICS-ON:
	${REINPLACE_CMD} -i'.metrics.bak' \
		-e 's|.*\(#define AF_CONFIG_OPTION_TT_SIZE_METRICS\).*|\1|' \
		${WRKSRC}/include/freetype/config/ftoption.h

post-patch-TAB_VALIDATION-ON:
	${REINPLACE_CMD} -e '/valid$$/s|#.*\(AUX_MODULES\)|\1|' \
		${WRKSRC}/modules.cfg

post-install:
	${INSTALL_SCRIPT} ${WRKSRC}/builds/unix/freetype-config \
		${STAGEDIR}${PREFIX}/bin/
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/lib/libfreetype.${LIBEXT}
	(cd ${WRKSRC}/docs && \
		${COPYTREE_SHARE} "reference CHANGES formats.txt LICENSE.TXT raster.txt" ${STAGEDIR}${STD_DOCDIR})

post-patch-DEBUG-ON:
	${REINPLACE_CMD} -i'.debug.bak' \
		-e 's|.*\(#define FT_DEBUG_LEVEL_TRACE\).*|\1|' \
		-e 's|.*\(#define FT_DEBUG_MEMORY\).*|\1|' \
		${WRKSRC}/include/freetype/config/ftoption.h

post-configure:
	(cd ${BUILD_WRKSRC}; ${SETENV} ${MAKE_ENV} \
		${MAKE_CMD} ${MAKE_FLAGS} ${MAKEFILE} ${MAKE_ARGS} setup)

post-patch-sunos:
	${REINPLACE_CMD} -e '/_XOPEN_SOURCE/d; /_POSIX_C_SOURCE/d' \
		${WRKSRC}/src/dlg/dlg*.c

[FILE:255:descriptions/desc.primary]
FreeType is a freely available software library to render fonts.

It is written in C, designed to be small, efficient, highly customizable,
and portable while capable of producing high-quality output (glyph images)
of most vector and bitmap font formats.


[FILE:101:distinfo]
5ee23abd047636c24b2d43c6625dcafc66661d1aca64dec9e0d05df29592624c      2492440 freetype-2.13.0.tar.xz


[FILE:63:manifests/plist.primary]
lib/
 libfreetype.so.%%SOMAJOR%%
 libfreetype.so.%%SOVERSION%%


[FILE:823:manifests/plist.dev]
bin/freetype-config
include/freetype2/ft2build.h
include/freetype2/freetype/
 freetype.h
 ftadvanc.h
 ftbbox.h
 ftbdf.h
 ftbitmap.h
 ftbzip2.h
 ftcache.h
 ftchapters.h
 ftcid.h
 ftcolor.h
 ftdriver.h
 fterrdef.h
 fterrors.h
 ftfntfmt.h
 ftgasp.h
 ftglyph.h
 ftgxval.h
 ftgzip.h
 ftimage.h
 ftincrem.h
 ftlcdfil.h
 ftlist.h
 ftlogging.h
 ftlzw.h
 ftmac.h
 ftmm.h
 ftmodapi.h
 ftmoderr.h
 ftotval.h
 ftoutln.h
 ftparams.h
 ftpfr.h
 ftrender.h
 ftsizes.h
 ftsnames.h
 ftstroke.h
 ftsynth.h
 ftsystem.h
 fttrigon.h
 fttypes.h
 ftwinfnt.h
 otsvg.h
 t1tables.h
 ttnameid.h
 tttables.h
 tttags.h
include/freetype2/freetype/config/
 ftconfig.h
 ftheader.h
 ftmodule.h
 ftoption.h
 ftstdlib.h
 integer-types.h
 mac-support.h
 public-macros.h
lib/
 libfreetype.a
 libfreetype.so
lib/pkgconfig/freetype2.pc
share/aclocal/freetype2.m4


[FILE:2550:manifests/plist.docs]
share/doc/freetype/reference/images/favico.ico
share/doc/freetype/reference/javascripts/extra.js
share/doc/freetype/reference/stylesheets/extra.css
share/doc/freetype/reference/assets/images/favicon.png
share/doc/freetype/reference/assets/javascripts/
 bundle.82b56eb2.min.js
 bundle.82b56eb2.min.js.map
share/doc/freetype/reference/assets/javascripts/lunr/min/
 lunr.ar.min.js
 lunr.da.min.js
 lunr.de.min.js
 lunr.du.min.js
 lunr.es.min.js
 lunr.fi.min.js
 lunr.fr.min.js
 lunr.hi.min.js
 lunr.hu.min.js
 lunr.it.min.js
 lunr.ja.min.js
 lunr.jp.min.js
 lunr.multi.min.js
 lunr.nl.min.js
 lunr.no.min.js
 lunr.pt.min.js
 lunr.ro.min.js
 lunr.ru.min.js
 lunr.stemmer.support.min.js
 lunr.sv.min.js
 lunr.th.min.js
 lunr.tr.min.js
 lunr.vi.min.js
 lunr.zh.min.js
share/doc/freetype/reference/assets/javascripts/lunr/
 tinyseg.js
 wordcut.js
share/doc/freetype/reference/assets/javascripts/workers/
 search.477d984a.min.js
 search.477d984a.min.js.map
share/doc/freetype/reference/assets/stylesheets/
 main.ca7ac06f.min.css
 main.ca7ac06f.min.css.map
 palette.f1a3b89f.min.css
 palette.f1a3b89f.min.css.map
share/doc/freetype/reference/
 sitemap.xml
 sitemap.xml.gz
 404.html
 index.html
 ft2-auto_hinter.html
 ft2-base_interface.html
 ft2-basic_types.html
 ft2-bdf_fonts.html
 ft2-bitmap_handling.html
 ft2-bzip2.html
 ft2-cache_subsystem.html
 ft2-cff_driver.html
 ft2-cid_fonts.html
 ft2-color_management.html
 ft2-computations.html
 ft2-debugging_apis.html
 ft2-error_code_values.html
 ft2-error_enumerations.html
 ft2-font_formats.html
 ft2-gasp_table.html
 ft2-glyph_management.html
 ft2-glyph_stroker.html
 ft2-glyph_variants.html
 ft2-gx_validation.html
 ft2-gzip.html
 ft2-header_file_macros.html
 ft2-header_inclusion.html
 ft2-incremental.html
 ft2-index.html
 ft2-layer_management.html
 ft2-lcd_rendering.html
 ft2-list_processing.html
 ft2-lzw.html
 ft2-mac_specific.html
 ft2-module_management.html
 ft2-multiple_masters.html
 ft2-ot_svg_driver.html
 ft2-ot_validation.html
 ft2-outline_processing.html
 ft2-parameter_tags.html
 ft2-pcf_driver.html
 ft2-pfr_fonts.html
 ft2-preamble.html
 ft2-properties.html
 ft2-quick_advance.html
 ft2-raster.html
 ft2-sfnt_names.html
 ft2-sizes_management.html
 ft2-svg_fonts.html
 ft2-system_interface.html
 ft2-t1_cid_driver.html
 ft2-truetype_engine.html
 ft2-truetype_tables.html
 ft2-tt_driver.html
 ft2-type1_tables.html
 ft2-user_allocation.html
 ft2-version.html
 ft2-winfnt_fonts.html
share/doc/freetype/reference/search/search_index.json
share/doc/freetype/
 CHANGES
 formats.txt
 raster.txt


[FILE:863:patches/patch-builds_unix_detect.mk]
--- builds/unix/detect.mk.orig	2022-01-27 07:43:19 UTC
+++ builds/unix/detect.mk
@@ -22,6 +22,9 @@ ifeq ($(PLATFORM),ansi)
                      $(wildcard /usr/sbin/init) \
                      $(wildcard /dev/null) \
                      $(wildcard /hurd/auth))
+  # FreeBSD is "unix" so just mandate this to fix the build in
+  # jails that do not have init (see PR#113470).
+  is_unix := true
   ifneq ($(is_unix),)
 
     PLATFORM := unix
@@ -86,10 +89,10 @@ ifeq ($(PLATFORM),unix)
   ifdef must_configure
     ifneq ($(have_Makefile),)
       # we are building FT2 not in the src tree
-	        $(TOP_DIR)/builds/unix/configure $(value CFG)
+#	        $(TOP_DIR)/builds/unix/configure $(value CFG)
     else
-	      cd builds/unix; \
-	        ./configure $(value CFG)
+#	      cd builds/unix; \
+#	        ./configure $(value CFG)
     endif
   endif
 


[FILE:739:files/pkg-message-primary]
The 2.7.x series now uses the new subpixel hinting mode (V40 port's option) as
the default, emulating a modern version of ClearType. This change inevitably
leads to different rendering results, and you might change port's options to
adapt it to your taste (or use the new "FREETYPE_PROPERTIES" environment
variable).

The environment variable "FREETYPE_PROPERTIES" can be used to control the
driver properties. Example:

FREETYPE_PROPERTIES=truetype:interpreter-version=35 \
	cff:no-stem-darkening=1 \
	autofitter:warping=1

This allows to select, say, the subpixel hinting mode at runtime for a given
application.

The controllable properties are listed in the section "Controlling FreeType
Modules" in the reference's table of contents.


[FILE:115:files/special.mk]
SELECTED_MODE=	\
	r=0; \
	for m in ${SUBPIXEL_HINTING_MODE}; \
		do r=$$(($$r | $$m)); \
	done; \
	${ECHO_CMD} $$r

