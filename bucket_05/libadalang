# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		libadalang
VERSION=		26.0.0
REVISION=		2
EPOCH=			1
KEYWORDS=		lang devel
VARIANTS=		std
SDESC[std]=		High-performance semantic engine for Ada
HOMEPAGE=		https://github.com/AdaCore/libadalang
CONTACT=		John_Marino[draco@marino.st]

DOWNLOAD_GROUPS=	main
SITES[main]=		GITHUB/AdaCore:libadalang:v26.0.0
DISTFILE[1]=		generated:main
DF_INDEX=		1
SPKGS[std]=		set
			primary
			dev
			tools
			examples

OPTIONS_AVAILABLE=	DEBUG REGULAR
OPTIONS_STANDARD=	DEBUG REGULAR

BUILD_DEPENDS=		langkit_support:dev:std
			libgpr2:dev:std
			prettier-ada:dev:std
BUILDRUN_DEPENDS=	langkit_support:primary:std
			langkit_support:modules:std
			libgpr2:primary:std
			gnatcoll-bindings:gmp:std
			prettier-ada:primary:std
EXRUN[tools]=		primary
EXRUN[dev]=		libgpr2:dev:std
			langkit_support:dev:std
			prettier-ada:dev:std

USES=			gprbuild iconv:build python:build,pep517 ada:primary

LICENSE=		APACHE20:primary
LICENSE_TERMS=		primary:{{WRKDIR}}/TERMS
LICENSE_FILE=		APACHE20:{{WRKSRC}}/LICENSE.txt
LICENSE_AWK=		TERMS:"^$$"
LICENSE_SOURCE=		TERMS:{{WRKSRC}}/extensions/src/libadalang-auto_provider.ads
LICENSE_SCHEME=		solo

MUST_CONFIGURE=		yes

MAKE_ARGS=		--build-mode
			dev
			--library-types=static,static-pic,relocatable

INSTALL_REQ_TOOLCHAIN=	yes
SOVERSION=		26.0.0

VAR_OPSYS[freebsd]=	MAKEFILE_LINE=XTRALIB=,"-lutil"
VAR_OPSYS[dragonfly]=	MAKEFILE_LINE=XTRALIB=,"-lutil"
VAR_OPSYS[midnightbsd]=	MAKEFILE_LINE=XTRALIB=,"-lutil"

[DEBUG].MAKEFILE_ON=			WITH_DEBUG=yes

[REGULAR].DESCRIPTION=			Build as regular, not Stand-Alone Library
[REGULAR].MAKEFILE_OFF=			SALTYPE=standard
[REGULAR].MAKEFILE_ON=			SALTYPE=no

do-build:
	(cd ${BUILD_WRKSRC} && ${SETENV} ${MAKE_ENV} \
		${PYTHON_CMD} -m langkit.scripts.lkm build \
		--library-types=static,static-pic,relocatable)

do-configure:
	(cd ${BUILD_WRKSRC} && ${SETENV} ${MAKE_ENV} \
		${PYTHON_CMD} -m langkit.scripts.lkm generate)
	# prepare for mains.gpr modification
	${PATCH} -d ${PATCH_WRKSRC} --backup --forward -E -p0 --batch \
		< ${FILESDIR}/pc-patch-build_mains.gpr
	${REINPLACE_CMD} -e 's|@LIBS@|"-lgnarl","-Wl,-rpath,${PREFIX}/lib"${XTRALIB}|' \
		${WRKSRC}/build/mains.gpr
	# support soname libraries
	${PATCH} -d ${PATCH_WRKSRC} --backup --forward -E -p0 --batch \
		< ${FILESDIR}/pc-patch-build_libadalang.gpr
	${REINPLACE_CMD} -e 's|@SOVERSION@|26.0.0|' \
		-e 's|@SALTYPE@|${SALTYPE}|' \
		${WRKSRC}/build/libadalang.gpr

do-install:
	(cd ${BUILD_WRKSRC} && ${SETENV} ${MAKE_ENV} \
		${PYTHON_CMD} -m langkit.scripts.lkm install \
		--library-types=static,static-pic,relocatable \
		${STAGEDIR}${PREFIX})
	# construct python wheel
	(cd ${WRKSRC} && ${SETENV} ${MAKE_ENV} python -m build \
		--no-isolation --wheel build/python)
	# install wheel in stage directory
	(cd ${BUILD_WRKSRC} && ${SETENV} AUTOPYTHON=${_PYTHON_VERSION} \
		python -m installer \
		--destdir ${STAGEDIR} \
		--prefix ${PREFIX} \
		${BUILD_WRKSRC}/build/python/dist/*.whl)
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/[n]*
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/gnat_compare
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/lal_dda
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/lal_prep
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/lal_parse
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/lal_unparse
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/incrementality
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/lib/libadalang.relocatable/libadalang.so
	${SED} -i'' -e 's|/usr/bin/env python|${PYTHON_CMD}|' \
		${STAGEDIR}${PREFIX}/bin/lal_playground \
		${STAGEDIR}${PREFIX}/share/examples/libadalang/check*.py \
		${STAGEDIR}${PREFIX}/share/examples/libadalang/detect*.py
	${RM} -r ${STAGEDIR}${PREFIX}/share/gpr/manifests
	${RMDIR} ${STAGEDIR}${PREFIX}/lib/windows

[FILE:853:descriptions/desc.primary]
Libadalang is a project to build a high performance semantic engine for
the Ada programming language. It is meant to provide a basis to write Ada
tooling, including tools working on potentially changing and incorrect
code, such as IDEs. Its goals encompass, but are not limited to:

* Full support for parsing the Ada 2012 syntax, plus SPARK extensions.
* Error tolerant parsing: the parser must be able to recover from simple
  errors and provide a "best-guess" tree.
* Error tolerant semantic analysis: it must be possible to create a tool
  that works only on syntax, and completely ignores semantic issues.
* Full symbol resolution respecting Ada 2012 - and prior - semantics.
* Bindings to a variety of languages, including Ada, C, Python and Java, so
  that tools can be written from various ecosystems. 
* Incremental processing of source files.


[FILE:63:descriptions/desc.tools]
This package contains tools based on the Ada language library.


[FILE:111:distinfo]
a2df0e991290b3440dcbae973e56ab2c232e63f73bc78b04cd06b55d7e942c4a      3092312 AdaCore-libadalang-26.0.0.tar.gz


[FILE:146:manifests/plist.primary]
@comment libadalang python module lists are auto-generated
lib/libadalang.so.%%SOVERSION%%
lib/libadalang.relocatable/libadalang.so.%%SOVERSION%%


[FILE:7058:manifests/plist.dev]
%%REGULAR-ON%%include/libadalang/
 libadalang-gdb.c
 libadalang-generic_impl.adb
 libadalang-generic_impl.ads
 libadalang-generic_introspection.adb
 libadalang-generic_introspection.ads
 libadalang-parsers_impl.adb
 libadalang-parsers_impl.ads
 libadalang-unparsers.ads
%%REGULAR-ON%%lib/libadalang.relocatable/
 libadalang-generic_impl.ali
 libadalang-generic_introspection.ali
 libadalang-parsers_impl.ali
 libadalang-unparsers.ali
%%REGULAR-ON%%lib/libadalang.static/
 libadalang-generic_impl.ali
 libadalang-generic_introspection.ali
 libadalang-parsers_impl.ali
 libadalang-unparsers.ali
%%REGULAR-ON%%lib/libadalang.static-pic/
 libadalang-generic_impl.ali
 libadalang-generic_introspection.ali
 libadalang-parsers_impl.ali
 libadalang-unparsers.ali
include/libadalang/
 libadalang-analysis.adb
 libadalang-analysis.ads
 libadalang-auto_provider.adb
 libadalang-auto_provider.ads
 libadalang-c.adb
 libadalang-c.ads
 libadalang-common.adb
 libadalang-common.ads
 libadalang-config_pragmas.adb
 libadalang-config_pragmas.ads
 libadalang-config_pragmas_impl.adb
 libadalang-config_pragmas_impl.ads
 libadalang-data_decomposition.adb
 libadalang-data_decomposition.ads
 libadalang-debug.adb
 libadalang-debug.ads
 libadalang-doc_utils.adb
 libadalang-doc_utils.ads
 libadalang-env_hooks.adb
 libadalang-env_hooks.ads
 libadalang-expr_eval.adb
 libadalang-expr_eval.ads
 libadalang-generic_api-introspection.ads
 libadalang-generic_api.adb
 libadalang-generic_api.ads
 libadalang-gpr_impl.adb
 libadalang-gpr_impl.ads
 libadalang-gpr_utils.adb
 libadalang-gpr_utils.ads
 libadalang-helpers.adb
 libadalang-helpers.ads
 libadalang-implementation-c-extensions.adb
 libadalang-implementation-c-extensions.ads
 libadalang-implementation-c.adb
 libadalang-implementation-c.ads
 libadalang-implementation-extensions.adb
 libadalang-implementation-extensions.ads
 libadalang-implementation.adb
 libadalang-implementation.ads
 libadalang-internal_default_provider.adb
 libadalang-internal_default_provider.ads
 libadalang-iterators-extensions.adb
 libadalang-iterators-extensions.ads
 libadalang-iterators.adb
 libadalang-iterators.ads
 libadalang-lexer.adb
 libadalang-lexer.ads
 libadalang-lexer_implementation.adb
 libadalang-lexer_implementation.ads
 libadalang-lexer_state_machine.adb
 libadalang-lexer_state_machine.ads
 libadalang-parsers.adb
 libadalang-parsers.ads
 libadalang-pp_impl.adb
 libadalang-pp_impl.ads
 libadalang-pp_lexer.adb
 libadalang-pp_lexer.ads
 libadalang-preprocessing.adb
 libadalang-preprocessing.ads
 libadalang-private_converters.adb
 libadalang-private_converters.ads
 libadalang-project_provider.adb
 libadalang-project_provider.ads
 libadalang-public_converters.adb
 libadalang-public_converters.ads
 libadalang-rewriting.adb
 libadalang-rewriting.ads
 libadalang-rewriting_c.adb
 libadalang-rewriting_c.ads
 libadalang-semantic_diagnostics.adb
 libadalang-semantic_diagnostics.ads
 libadalang-sources.adb
 libadalang-sources.ads
 libadalang-target_info.adb
 libadalang-target_info.ads
 libadalang-unit_files.adb
 libadalang-unit_files.ads
 libadalang.ads
 libadalang.h
java/
 Makefile
 pom.xml
java/jni/jni_impl.c
java/src/main/java/com/adacore/libadalang/Libadalang.java
lib/libadalang.so
lib/libadalang.relocatable/
 libadalang-analysis.ali
 libadalang-auto_provider.ali
 libadalang-c.ali
 libadalang-common.ali
 libadalang-config_pragmas.ali
 libadalang-config_pragmas_impl.ali
 libadalang-data_decomposition.ali
 libadalang-debug.ali
 libadalang-doc_utils.ali
 libadalang-env_hooks.ali
 libadalang-expr_eval.ali
 libadalang-generic_api-introspection.ali
 libadalang-generic_api.ali
 libadalang-gpr_impl.ali
 libadalang-gpr_utils.ali
 libadalang-helpers.ali
 libadalang-implementation-c-extensions.ali
 libadalang-implementation-c.ali
 libadalang-implementation-extensions.ali
 libadalang-implementation.ali
 libadalang-internal_default_provider.ali
 libadalang-iterators-extensions.ali
 libadalang-iterators.ali
 libadalang-lexer.ali
 libadalang-lexer_implementation.ali
 libadalang-lexer_state_machine.ali
 libadalang-parsers.ali
 libadalang-pp_impl.ali
 libadalang-pp_lexer.ali
 libadalang-preprocessing.ali
 libadalang-private_converters.ali
 libadalang-project_provider.ali
 libadalang-public_converters.ali
 libadalang-rewriting.ali
 libadalang-rewriting_c.ali
 libadalang-semantic_diagnostics.ali
 libadalang-sources.ali
 libadalang-target_info.ali
 libadalang-unit_files.ali
 libadalang.ali
 libadalang.so
lib/libadalang.static/
 libadalang-analysis.ali
 libadalang-auto_provider.ali
 libadalang-c.ali
 libadalang-common.ali
 libadalang-config_pragmas.ali
 libadalang-config_pragmas_impl.ali
 libadalang-data_decomposition.ali
 libadalang-debug.ali
 libadalang-doc_utils.ali
 libadalang-env_hooks.ali
 libadalang-expr_eval.ali
 libadalang-generic_api-introspection.ali
 libadalang-generic_api.ali
 libadalang-gpr_impl.ali
 libadalang-gpr_utils.ali
 libadalang-helpers.ali
 libadalang-implementation-c-extensions.ali
 libadalang-implementation-c.ali
 libadalang-implementation-extensions.ali
 libadalang-implementation.ali
 libadalang-internal_default_provider.ali
 libadalang-iterators-extensions.ali
 libadalang-iterators.ali
 libadalang-lexer.ali
 libadalang-lexer_implementation.ali
 libadalang-lexer_state_machine.ali
 libadalang-parsers.ali
 libadalang-pp_impl.ali
 libadalang-pp_lexer.ali
 libadalang-preprocessing.ali
 libadalang-private_converters.ali
 libadalang-project_provider.ali
 libadalang-public_converters.ali
 libadalang-rewriting.ali
 libadalang-rewriting_c.ali
 libadalang-semantic_diagnostics.ali
 libadalang-sources.ali
 libadalang-target_info.ali
 libadalang-unit_files.ali
 libadalang.a
 libadalang.ali
lib/libadalang.static-pic/
 libadalang-analysis.ali
 libadalang-auto_provider.ali
 libadalang-c.ali
 libadalang-common.ali
 libadalang-config_pragmas.ali
 libadalang-config_pragmas_impl.ali
 libadalang-data_decomposition.ali
 libadalang-debug.ali
 libadalang-doc_utils.ali
 libadalang-env_hooks.ali
 libadalang-expr_eval.ali
 libadalang-generic_api-introspection.ali
 libadalang-generic_api.ali
 libadalang-gpr_impl.ali
 libadalang-gpr_utils.ali
 libadalang-helpers.ali
 libadalang-implementation-c-extensions.ali
 libadalang-implementation-c.ali
 libadalang-implementation-extensions.ali
 libadalang-implementation.ali
 libadalang-internal_default_provider.ali
 libadalang-iterators-extensions.ali
 libadalang-iterators.ali
 libadalang-lexer.ali
 libadalang-lexer_implementation.ali
 libadalang-lexer_state_machine.ali
 libadalang-parsers.ali
 libadalang-pp_impl.ali
 libadalang-pp_lexer.ali
 libadalang-preprocessing.ali
 libadalang-private_converters.ali
 libadalang-project_provider.ali
 libadalang-public_converters.ali
 libadalang-rewriting.ali
 libadalang-rewriting_c.ali
 libadalang-semantic_diagnostics.ali
 libadalang-sources.ali
 libadalang-target_info.ali
 libadalang-unit_files.ali
 libadalang.a
 libadalang.ali
ocaml/
 dune
 dune-project
 libadalang.ml
 libadalang.mli
 libadalang.opam
python/pyproject.toml
python/libadalang/
 __init__.py
 py.typed
share/gpr/libadalang.gpr


[FILE:141:manifests/plist.tools]
bin/
 gnat_compare
 incrementality
 lal_dda
 lal_parse
 lal_playground
 lal_prep
 lal_unparse
 nameres
 navigate
share/libadalang/gdbinit.py


[FILE:441:manifests/plist.examples]
share/examples/libadalang/
 check_deref_null.py
 check_same_logic.py
 check_same_operands.py
 check_same_test.py
 check_same_then_else.py
 check_subp_boxes.py
 check_test_not_null.py
 check_useless_assign.py
 detect_copy_paste_sa.py
share/examples/libadalang/highlight/
 .gitignore
 README.md
 ada2web.adb
 colors.ads
 example.adb
 highlight.adb
 highlight.gpr
 highlighter.adb
 highlighter.ads
 html.adb
 html.ads
 term256.adb
 term256.ads


[FILE:752:files/pc-patch-build_libadalang.gpr]
--- build/libadalang.gpr.orig	2026-01-26 22:40:48 UTC
+++ build/libadalang.gpr
@@ -31,7 +31,7 @@ library project Libadalang is
 
    type Library_Standalone_Type is ("standard", "no", "encapsulated");
    Library_Standalone : Library_Standalone_Type := external
-     ("LIBADALANG_STANDALONE", external ("STANDALONE", "standard"));
+     ("LIBADALANG_STANDALONE", external ("STANDALONE", "@SALTYPE@"));
 
    type Boolean is ("false", "true");
 
@@ -63,6 +63,7 @@ library project Libadalang is
 
 
    for Library_Name use "adalang";
+   for Library_Version use "libadalang.so.@SOVERSION@";
    for Library_Kind use Library_Kind_Param;
    for Library_Dir use "lib/" & Library_Kind_Param & "/" & Build_Mode;
    for Object_Dir use "obj/" & Build_Mode;


[FILE:289:files/pc-patch-build_mains.gpr]
post-configure patch to generated mains.gpr
(BSD only)

--- build/mains.gpr.orig	2026-01-20 02:55:44 UTC
+++ build/mains.gpr
@@ -62,4 +62,8 @@ project Mains is
       end case;
    end Binder;
 
+   package Linker is
+      for Switches ("ada") use (@LIBS@);
+   end Linker;
+
 end Mains;


[FILE:202:files/special.mk]
setuptools-autolist:
	@echo "[Packing build python modules]"
	@(cd ${STAGEDIR}${PREFIX} && \
		${FIND} lib/pyth* \( -type f -o -type l \) 2>/dev/null | ${SORT}) \
		>> ${WRKDIR}/.manifest.primary.mktmp

