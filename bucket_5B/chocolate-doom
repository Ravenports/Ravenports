# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		chocolate-doom
VERSION=		3.0.0
KEYWORDS=		games
VARIANTS=		standard
SDESC[standard]=	Source port accurately recreating the DooM engine
HOMEPAGE=		https://www.chocolate-doom.org/wiki/index.php/Chocolate_Doom
CONTACT=		Michael_Reim[kraileth@elderlinux.org]

DOWNLOAD_GROUPS=	main
SITES[main]=		https://www.chocolate-doom.org/downloads/3.0.0/
DISTFILE[1]=		chocolate-doom-3.0.0.tar.gz:main
DF_INDEX=		1
SPKGS[standard]=	complete
			primary
			docs

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILDRUN_DEPENDS=	png:single:standard

USES=			gmake pkgconfig python:build
SDL_COMPONENTS=		sdl2 mixer2 net2

LICENSE=		GPLv2+:primary
LICENSE_TERMS=		primary:{{WRKDIR}}/TERMS
LICENSE_FILE=		GPLv2+:{{WRKSRC}}/COPYING
LICENSE_SCHEME=		solo

FPC_EQUIVALENT=		games/chocolate-doom

MUST_CONFIGURE=		gnu

SUB_FILES=		pkg-message-primary

post-patch:
	${REINPLACE_CMD} -e 's!__PREFIX__!${PREFIX}!' ${WRKSRC}/src/d_iwad.c

post-install:
.for f in chocolate-doom-setup chocolate-heretic-setup chocolate-hexen-setup chocolate-strife-setup
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/${f}
.endfor

post-extract:
	${HEAD} -n 13 ${WRKSRC}/src/doomkeys.h > ${WRKDIR}/TERMS

[FILE:779:descriptions/desc.primary]
Chocolate-doom is a so-called source port of the original DooM engine. 
After ID Software released the DooM source code, many such projects were 
created to bring the game to different platforms and add many new features.

What makes chocolate-doom different from all the others is that it does 
not aim to add anything that would alter the gameplay. The project aims to 
faithfully and accurately re-create the original experience from the 90s. 
It goes as far with this as implementing compatibility code so that 
popular hacks for the DOS EXE files are emulated and old patch WADs can be 
supported.

In addition to DooM the following other DooM engine games are supported:
 - DooM II
 - Final DooM (TNT / Plutonia)
 - Heretic
 - HeXen (including DK)
 - Strife
 - Chex Quest



[FILE:106:distinfo]
73aea623930c7d18a7a778eea391e1ddfbe90ad1ac40a91b380afca4b0e1dab8      2495591 chocolate-doom-3.0.0.tar.gz


[FILE:588:manifests/plist.primary]
bin/
 chocolate-doom
 chocolate-doom-setup
 chocolate-heretic
 chocolate-heretic-setup
 chocolate-hexen
 chocolate-hexen-setup
 chocolate-server
 chocolate-strife
 chocolate-strife-setup
share/appdata/
 chocolate-doom.appdata.xml
 chocolate-heretic.appdata.xml
 chocolate-hexen.appdata.xml
 chocolate-strife.appdata.xml
share/applications/
 chocolate-doom.desktop
 chocolate-heretic.desktop
 chocolate-hexen.desktop
 chocolate-setup.desktop
 chocolate-strife.desktop
share/applications/screensavers/chocolate-doom-screensaver.desktop
share/icons/
 chocolate-doom.png
 chocolate-setup.png


[FILE:393:manifests/plist.docs]
share/doc/chocolate-doom/
 ChangeLog
 NEWS.md
 NOT-BUGS.md
 PHILOSOPHY.md
 README.Music.md
 README.md
share/doc/chocolate-heretic/
 ChangeLog
 NEWS.md
 PHILOSOPHY.md
 README.Music.md
 README.md
share/doc/chocolate-hexen/
 ChangeLog
 NEWS.md
 PHILOSOPHY.md
 README.Music.md
 README.md
share/doc/chocolate-strife/
 ChangeLog
 NEWS.md
 PHILOSOPHY.md
 README.Music.md
 README.Strife.md
 README.md


[FILE:788:patches/patch-src_d__iwad.c]
--- src/d_iwad.c.orig	2018-06-19 21:08:47.831584000 +0200
+++ src/d_iwad.c	2018-06-19 21:45:29.501667000 +0200
@@ -652,13 +652,14 @@
     if (env == NULL)
     {
         // (Trailing / omitted from paths, as it is added below)
-        env = "/usr/local/share:/usr/share";
+        env = "/usr/local/share:/usr/share:/__PREFIX__/share";
     }
 
     // The "standard" location for IWADs on Unix that is supported by most
     // source ports is /usr/share/games/doom - we support this through the
     // XDG_DATA_DIRS mechanism, through which it can be overridden.
     AddIWADPath(env, "/games/doom");
+    AddIWADPath(env, "/games/doomengine");
 
     // The convention set by RBDOOM-3-BFG is to install Doom 3: BFG
     // Edition into this directory, under which includes the Doom


[FILE:89:files/pkg-message-primary.in]
Put your game IWAD files into /raven/share/games/doomengine/ and then start a doom game!

