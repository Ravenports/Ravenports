# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		chocolate-doom
VERSION=		3.0.1
KEYWORDS=		games
VARIANTS=		standard
SDESC[standard]=	Source port accurately recreating the DooM engine
HOMEPAGE=		https://www.chocolate-doom.org/wiki/index.php/Chocolate_Doom
CONTACT=		Michael_Reim[kraileth@elderlinux.org]

DOWNLOAD_GROUPS=	main
SITES[main]=		https://www.chocolate-doom.org/downloads/3.0.1/
DISTFILE[1]=		chocolate-doom-3.0.1.tar.gz:main
DF_INDEX=		1
SPKGS[standard]=	complete
			primary
			docs

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILDRUN_DEPENDS=	png:single:standard

USES=			cpe gmake pkgconfig python:build
SDL_COMPONENTS=		sdl2 mixer2 net2

LICENSE=		GPLv2+:primary
LICENSE_TERMS=		primary:{{WRKDIR}}/TERMS
LICENSE_FILE=		GPLv2+:{{WRKSRC}}/COPYING
LICENSE_SCHEME=		solo

CPE_PRODUCT=		chocolate_doom
CPE_VENDOR=		chocolate-doom
FPC_EQUIVALENT=		games/chocolate-doom

MUST_CONFIGURE=		gnu

SUB_FILES=		pkg-message-primary

post-patch:
	${REINPLACE_CMD} -e 's!__PREFIX__!${PREFIX}!' ${WRKSRC}/src/d_iwad.c

post-install:
.for f in chocolate-doom-setup chocolate-heretic-setup chocolate-hexen-setup chocolate-strife-setup
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/${f}
.endfor

post-extract:
	${HEAD} -n 13 ${WRKSRC}/src/doomkeys.h > ${WRKDIR}/TERMS

[FILE:779:descriptions/desc.primary]
Chocolate-doom is a so-called source port of the original DooM engine. 
After ID Software released the DooM source code, many such projects were 
created to bring the game to different platforms and add many new features.

What makes chocolate-doom different from all the others is that it does 
not aim to add anything that would alter the gameplay. The project aims to 
faithfully and accurately re-create the original experience from the 90s. 
It goes as far with this as implementing compatibility code so that 
popular hacks for the DOS EXE files are emulated and old patch WADs can be 
supported.

In addition to DooM the following other DooM engine games are supported:
 - DooM II
 - Final DooM (TNT / Plutonia)
 - Heretic
 - HeXen (including DK)
 - Strife
 - Chex Quest



[FILE:106:distinfo]
d435d6177423491d60be706da9f07d3ab4fabf3e077ec2a3fc216e394fcfc8c7      2514985 chocolate-doom-3.0.1.tar.gz


[FILE:1149:manifests/plist.primary]
bin/
 chocolate-doom
 chocolate-doom-setup
 chocolate-heretic
 chocolate-heretic-setup
 chocolate-hexen
 chocolate-hexen-setup
 chocolate-server
 chocolate-strife
 chocolate-strife-setup
share/appdata/
 chocolate-doom.appdata.xml
 chocolate-heretic.appdata.xml
 chocolate-hexen.appdata.xml
 chocolate-strife.appdata.xml
share/applications/
 chocolate-doom.desktop
 chocolate-heretic.desktop
 chocolate-hexen.desktop
 chocolate-setup.desktop
 chocolate-strife.desktop
share/applications/screensavers/chocolate-doom-screensaver.desktop
share/bash-completion/completions/
 chocolate-doom
 chocolate-heretic
 chocolate-hexen
 chocolate-strife
share/icons/
 chocolate-doom.png
 chocolate-setup.png
share/man/man5/
 chocolate-doom.cfg.5.gz
 chocolate-heretic.cfg.5.gz
 chocolate-hexen.cfg.5.gz
 chocolate-strife.cfg.5.gz
 default.cfg.5.gz
 heretic.cfg.5.gz
 hexen.cfg.5.gz
 strife.cfg.5.gz
share/man/man6/
 chocolate-doom-setup.6.gz
 chocolate-doom.6.gz
 chocolate-heretic-setup.6.gz
 chocolate-heretic.6.gz
 chocolate-hexen-setup.6.gz
 chocolate-hexen.6.gz
 chocolate-server.6.gz
 chocolate-setup.6.gz
 chocolate-strife-setup.6.gz
 chocolate-strife.6.gz


[FILE:517:manifests/plist.docs]
share/doc/chocolate-doom/
 CMDLINE.doom
 ChangeLog
 INSTALL.doom
 NEWS.md
 NOT-BUGS.md
 PHILOSOPHY.md
 README.Music.md
 README.md
share/doc/chocolate-heretic/
 CMDLINE.heretic
 ChangeLog
 INSTALL.heretic
 NEWS.md
 PHILOSOPHY.md
 README.Music.md
 README.md
share/doc/chocolate-hexen/
 CMDLINE.hexen
 ChangeLog
 INSTALL.hexen
 NEWS.md
 PHILOSOPHY.md
 README.Music.md
 README.md
share/doc/chocolate-strife/
 CMDLINE.strife
 ChangeLog
 INSTALL.strife
 NEWS.md
 PHILOSOPHY.md
 README.Music.md
 README.Strife.md
 README.md


[FILE:769:patches/patch-src_d__iwad.c]
--- src/d_iwad.c.orig	2020-06-25 03:10:06 UTC
+++ src/d_iwad.c
@@ -652,13 +652,14 @@ static void AddXdgDirs(void)
     if (env == NULL)
     {
         // (Trailing / omitted from paths, as it is added below)
-        env = "/usr/local/share:/usr/share";
+        env = "/usr/local/share:/usr/share:/__PREFIX__/share";
     }
 
     // The "standard" location for IWADs on Unix that is supported by most
     // source ports is /usr/share/games/doom - we support this through the
     // XDG_DATA_DIRS mechanism, through which it can be overridden.
     AddIWADPath(env, "/games/doom");
+    AddIWADPath(env, "/games/doomengine");
 
     // The convention set by RBDOOM-3-BFG is to install Doom 3: BFG
     // Edition into this directory, under which includes the Doom


[FILE:303:patches/patch-src_hexen_mn__menu.c]
--- src/hexen/mn_menu.c.orig	2020-06-25 03:10:06 UTC
+++ src/hexen/mn_menu.c
@@ -131,7 +131,6 @@ boolean MenuActive;
 int InfoType;
 int messageson = true;
 boolean mn_SuicideConsole;
-boolean demoextend; // from h2def.h
 
 // PRIVATE DATA DEFINITIONS ------------------------------------------------
 


[FILE:407:files/pkg-message-primary.in]
This is just the game engine which cannot be used without game data. If you own any full version of the supported games, put the WAD (resource container) files into /raven/share/games/doomengine so that chocolate-doom will find them.

If you do not have any retail IWAD, have a look at the doomgame-iwad package. The shareware / demo versions of the games as well as some fan-made free games are available.

