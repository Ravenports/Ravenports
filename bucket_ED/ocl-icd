# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		ocl-icd
VERSION=		2.3.3
KEYWORDS=		devel
VARIANTS=		std
SDESC[std]=		Utility to regenerate the GNU info page index
HOMEPAGE=		https://github.com/OCL-dev/ocl-icd
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		GITHUB/OCL-dev:ocl-icd:v2.3.3
DISTFILE[1]=		generated:main
DF_INDEX=		1
SPKGS[std]=		set
			primary
			tools
			dev
			man
			docs
			examples

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILD_DEPENDS=		asciidoc:single:std
			xmlto:primary:std

USES=			autoreconf gmake libtool ruby:build

FPC_EQUIVALENT=		devel/ocl-icd

MUST_CONFIGURE=		gnu
CONFIGURE_ARGS=		--enable-official-khronos-headers
			--enable-custom-vendordir

MAKE_ARGS=		RUBY=ruby{{RUBY_SUFFIX}}

INSTALL_TARGET=		install-strip

post-patch:
	${REINPLACE_CMD} -e 's|/etc/|${LOCALBASE}/etc/|g' \
		${WRKSRC}/doc/libOpenCL.7.txt.in
	${REINPLACE_CMD} -e 's|--destination-dir=$$(CURDIR)|--no-xmllint|' \
		${WRKSRC}/doc/Makefile.am

post-stage:
	${MKDIR} -p ${STAGEDIR}${PREFIX}/share/examples/ocl-icd
	${MV} ${STAGEDIR}${PREFIX}/share/doc/ocl-icd/examples/ocl_icd_bindings.c \
		${STAGEDIR}${PREFIX}/share/examples/ocl-icd/
	${RMDIR} ${STAGEDIR}${PREFIX}/share/doc/ocl-icd/examples

[FILE:232:descriptions/desc.primary]
OpenCL implementations are provided as ICD (Installable Client Driver). An
OpenCL program can use several ICD thanks to the use of an ICD Loader as
provided by this project. This free ICD Loader can load any (free or non
free) ICD.


[FILE:44:descriptions/desc.tools]
This package contains the cllayerinfo tool.


[FILE:107:distinfo]
8cd8e8e129db3081a64090fc1252bec39dc88cdb7b3f929315e014b75069bd9d       109854 OCL-dev-ocl-icd-2.3.3.tar.gz


[FILE:41:manifests/plist.primary]
lib/
 libOpenCL.so.1
 libOpenCL.so.1.0.0


[FILE:16:manifests/plist.tools]
bin/cllayerinfo


[FILE:73:manifests/plist.dev]
include/ocl_icd.h
lib/libOpenCL.so
lib/pkgconfig/
 OpenCL.pc
 ocl-icd.pc


[FILE:45:manifests/plist.man]
share/man/man7/
 libOpenCL.7
 libOpenCL.so.7


[FILE:38:manifests/plist.docs]
share/doc/ocl-icd/html/libOpenCL.html


[FILE:42:manifests/plist.examples]
share/examples/ocl-icd/ocl_icd_bindings.c


[FILE:366:patches/patch-icd__generator.rb]
--- icd_generator.rb.orig	2023-06-02 21:36:20 UTC
+++ icd_generator.rb
@@ -561,7 +561,7 @@ EOF
   end
 
   def self.generate_ocl_icd_loader_map
-    ocl_icd_loader_map = "/**\n#{$license}\n*/\n\n"
+    ocl_icd_loader_map = "\n"
     prev_version=""
     $versions_entries.keys.sort.each { |version|
       ocl_icd_loader_map += "OPENCL_#{version.sub('_','.')} {\n";


[FILE:469:patches/patch-ocl__icd__debug.h]
--- ocl_icd_debug.h.orig	2023-06-02 21:36:20 UTC
+++ ocl_icd_debug.h
@@ -69,9 +69,9 @@ extern int debug_ocl_icd_mask;
 	return ret; \
    } while(0)
 #  define RETURN_STR(val) do { \
-	char* _ret=(char*)(val);		\
-	debug(D_TRACE, "return: %s", _ret);	\
-	return _ret; \
+	char* _return_str=(char*)(val);		\
+	debug(D_TRACE, "return: %s", _return_str);	\
+	return _return_str; \
    } while(0)
 #  ifdef DEBUG_OCL_ICD_PROVIDE_DUMP_FIELD
 #    pragma GCC diagnostic push

