# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		cgit
VERSION=		1.2.3
KEYWORDS=		www devel
VARIANTS=		std
SDESC[std]=		Fast web interface for git
HOMEPAGE=		https://git.zx2c4.com/cgit/about/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main fixedgit
SITES[main]=		https://git.zx2c4.com/cgit/snapshot/
SITES[fixedgit]=	https://www.kernel.org/pub/software/scm/git/
DISTFILE[1]=		cgit-1.2.3.tar.xz:main
DISTFILE[2]=		git-2.28.0.tar.xz:fixedgit
DF_INDEX=		1 2
SPKGS[std]=		single

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

USES=			cpe gmake iconv python:build shebangfix ssl zlib

LICENSE=		GPLv2:single
LICENSE_TERMS=		single:{{WRKDIR}}/TERMS
LICENSE_FILE=		GPLv2:{{WRKSRC}}/COPYING
LICENSE_AWK=		TERMS:"^$$"
LICENSE_SOURCE=		TERMS:{{WRKSRC}}/cgit.c
LICENSE_SCHEME=		solo

CPE_VENDOR=		lars_hjemli
FPC_EQUIVALENT=		devel/cgit
SHEBANG_FILES=		filters/email-gravatar.py
			filters/html-converters/md2html
			filters/html-converters/rst2html
			filters/syntax-highlighting.py

MAKE_ARGS=		CGIT_SCRIPT_PATH={{PREFIX}}/www/cgit
			CGIT_CONFIG={{PREFIX}}/etc/cgitrc
			prefix={{PREFIX}}
			NO_GETTEXT=1
			NO_LUA=1
			NO_R_TO_GCC_LINKER=1
			V=1
			{{ICONV_LIB:S/-liconv/NEEDS_LIBICONV=1/}}

INSTALL_REQ_TOOLCHAIN=	yes

CFLAGS=			-I{{OPENSSLINC}}
LDFLAGS=		-L{{OPENSSLLIB}}

post-patch:
	${REINPLACE_CMD} -e 's/^\(GIT_VER =\).*$$/\1 2.28.0/' \
		${WRKSRC}/Makefile
	${REINPLACE_CMD} \
		-e "s|\(ALL_CFLAGS =\)|\1 ${CFLAGS}|g" \
		-e "s|\(ALL_LDFLAGS =\)|\1 ${LDFLAGS}|g" \
		${WRKSRC}/git/Makefile
	${REINPLACE_CMD} -e '/ucb\/install/d' ${WRKSRC}/git/config.mak.uname

post-install:
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/www/cgit/cgit.cgi

post-extract:
	${RMDIR} ${WRKSRC}/git
	${MV} ${WRKDIR}/git-2.28.0 ${WRKSRC}/git

[FILE:102:descriptions/desc.single]
cgit is a fast web interface for the Git SCM, using a built-in cache to
decrease server I/O pressure.


[FILE:192:distinfo]
5a5f12d2f66bd3629c8bc103ec8ec2301b292e97155d30a9a61884ea414a6da4        90632 cgit-1.2.3.tar.xz
dfa5d1a253aa451465478fe45c6a40ab8605b340fdb4c4e80b16d7f87708439d      6117608 git-2.28.0.tar.xz


[FILE:406:manifests/plist.single]
lib/cgit/filters/
 about-formatting.sh
 commit-links.sh
 email-gravatar.lua
 email-gravatar.py
 email-libravatar.lua
 file-authentication.lua
 gentoo-ldap-authentication.lua
 owner-example.lua
 simple-authentication.lua
 syntax-highlighting.py
 syntax-highlighting.sh
lib/cgit/filters/html-converters/
 man2html
 md2html
 rst2html
 txt2html
www/cgit/
 cgit.cgi
 cgit.css
 cgit.png
 favicon.ico
 robots.txt

