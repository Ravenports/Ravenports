# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		libproxy
VERSION=		0.4.15
KEYWORDS=		net devel
VARIANTS=		standard minimal
SDESC[minimal]=		Libproxy without any additional bindings
SDESC[standard]=	Library for automatic proxy configuration mgmt
HOMEPAGE=		https://libproxy.github.io/libproxy
CONTACT=		Michael_Reim[kraileth@elderlinux.org]

DOWNLOAD_GROUPS=	main
SITES[main]=		GITHUB/libproxy:libproxy:0.4.15
DISTFILE[1]=		generated:main
DF_INDEX=		1
SPKGS[minimal]=		single
SPKGS[standard]=	single

OPTIONS_AVAILABLE=	PERL PYTHON VALA
OPTIONS_STANDARD=	PERL PYTHON VALA
VOPTS[minimal]=		PERL=OFF PYTHON=OFF VALA=OFF
OPT_ON[all]=		PERL PYTHON VALA

USES=			cclibs:single c++:single cmake pkgconfig

FPC_EQUIVALENT=		net/libproxy

SOVERSION=		1.0.0

CXXFLAGS=		-std=c++03
CMAKE_ARGS=		-DBIPR:BOOL=OFF
			-DWITH_DOTNET:BOOL=OFF
			-DWITH_NATUS:BOOL=OFF
			-DWITH_NM:BOOL=OFF
			-DWITH_GNOME2:BOOL=OFF
			-DWITH_GNOME3:BOOL=OFF
			-DWITH_KDE:BOOL=OFF
			-DWITH_MOZJS:BOOL=OFF
			-DWITH_PYTHON2:BOOL=OFF
			-DWITH_PYTHON3:BOOL=OFF
			-DWITH_WEBKIT:BOOL=OFF
			-DWITH_WEBKIT3:BOOL=OFF
VAR_OPSYS[sunos]=	LDFLAGS=-lsocket
			LDFLAGS=-lnsl

[PERL].DESCRIPTION=			Build with Perl binding
[PERL].CMAKE_ARGS_OFF=			-DWITH_PERL:BOOL=OFF
[PERL].CMAKE_ARGS_ON=			-DWITH_PERL:BOOL=ON
					-DPERL_LINK_LIBPERL:BOOL=OFF
[PERL].USES_ON=				perl:perl_default

[VALA].DESCRIPTION=			Build with Vala binding
[VALA].BUILDRUN_DEPENDS_ON=		vala:single:standard
[VALA].CMAKE_ARGS_OFF=			-DWITH_VALA:BOOL=OFF
[VALA].CMAKE_ARGS_ON=			-DWITH_VALA:BOOL=ON

[PYTHON].DESCRIPTION=			Build with Python binding
[PYTHON].CMAKE_ARGS_ON=			-DWITH_PYTHON{{PYTHON_MAJOR_VER}}:BOOL=ON
					-DPYTHON_SITEPKG_DIR={{PYTHON_SITELIBDIR}}
[PYTHON].USES_ON=			python

post-patch:
	# support python 3.7
	${REINPLACE_CMD} -e 's/ 3\.6/ 3.7 3.6/' \
		${WRKSRC}/cmake/FindPython3Interp.cmake

post-install-PERL-ON:
	${STRIP_CMD} ${STAGEDIR}${SITE_ARCH}/auto/Net/Libproxy/Libproxy.so

post-install:
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/proxy
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/lib/libproxy.so.*

[FILE:218:descriptions/desc.single]
Libproxy is a library that provides automatic proxy configuration 
management. It supports various programming language bindings and is able 
to work with GConf/Gsettings for GNOME or kreadconfig/kreadconfig5 for KDE.


[FILE:110:distinfo]
18f58b0a0043b6881774187427ead158d310127fc46a1c668ad6d207fb28b4e0        93084 libproxy-libproxy-0.4.15.tar.gz


[FILE:353:manifests/plist.single]
%%PERL-ON%%%%SITE_ARCH%%/Net/Libproxy.pm
%%PERL-ON%%%%SITE_ARCH%%/auto/Net/Libproxy/Libproxy.so
%%PYTHON-ON%%%%PYTHON_SITELIBDIR%%/libproxy.py
%%VALA-ON%%share/vala/vapi/libproxy-1.0.vapi
bin/proxy
include/proxy.h
lib/
 libproxy.so
 libproxy.so.%%SOMAJOR%%
 libproxy.so.%%SOVERSION%%
lib/pkgconfig/libproxy-1.0.pc
share/cmake/Modules/Findlibproxy.cmake


[FILE:709:patches/patch-fix-typo]
From e636fff0d58afbc2d2ef417db914f866978da7ec Mon Sep 17 00:00:00 2001
From: David King <amigadave@amigadave.com>
Date: Mon, 24 Jul 2017 05:25:12 +0100
Subject: [PATCH] get-pac-test: Fix typo

Closes: #64
---
 libproxy/test/get-pac-test.cpp | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/libproxy/test/get-pac-test.cpp b/libproxy/test/get-pac-test.cpp
index 00b4564..0059dfb 100644
--- libproxy/test/get-pac-test.cpp
+++ libproxy/test/get-pac-test.cpp
@@ -130,7 +130,7 @@ class TestServer {
 
 #ifdef SO_NOSIGPIPE
 			int i = 1;
-			setsockopt(c_sock, SOL_SOCKET, SO_NOSIGPIPE, &i, sizeof(i));
+			setsockopt(csock, SOL_SOCKET, SO_NOSIGPIPE, &i, sizeof(i));
 #endif
 
 			// Read request


[FILE:329:dragonfly/patch-libproxy_CMakeLists.txt]
--- libproxy/CMakeLists.txt.orig	2017-05-11 09:33:33 UTC
+++ libproxy/CMakeLists.txt
@@ -6,7 +6,6 @@ set_project_version(0 4 15)
 if (WIN32)
   add_definitions(-D_CRT_SECURE_NO_WARNINGS=1)
 else(WIN32)
-  add_definitions(-D_POSIX_C_SOURCE=200112L)
   set(CMAKE_CXX_FLAGS "-fvisibility=hidden ${CMAKE_CXX_FLAGS}")
 endif(WIN32)
 


[FILE:479:sunos/patch-libmodman_test_CMakeLists.txt]
--- libmodman/test/CMakeLists.txt.orig	2017-05-11 09:33:33 UTC
+++ libmodman/test/CMakeLists.txt
@@ -28,10 +28,6 @@ function(mm_create_program name EXTTYPE)
     set_property(TARGET ${name} PROPERTY 
                  COMPILE_DEFINITIONS
                  EXTTYPE=${EXTTYPE}_extension;SYMB=1)
-    if(NOT WIN32 AND NOT APPLE)
-      set_property(TARGET ${name} PROPERTY
-                   LINK_FLAGS -Wl,--no-as-needed)
-    endif()
   endif()
 endfunction(mm_create_program)
 

