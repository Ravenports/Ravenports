# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		langkit_support
VERSION=		2021
KEYWORDS=		ada devel
VARIANTS=		standard
SDESC[standard]=	Support files for Ada Langkit
HOMEPAGE=		https://github.com/AdaCore/langkit
CONTACT=		John_Marino[draco@marino.st]

DOWNLOAD_GROUPS=	main
SITES[main]=		ADACORE/709e5ffa66fd8181655951e0ec8ed04e1d2977e2?filename=langkit-2021-20210518-19B8E-src.tar.gz&x=/
DISTFILE[1]=		langkit-2021-20210518-19B8E-src.tar.gz:main
DF_INDEX=		1
SPKGS[standard]=	single

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILDRUN_DEPENDS=	gnatcoll-core:primary:standard
			gnatcoll-bindings:iconv:standard
			xmlada:primary:standard

USES=			gprbuild

DISTNAME=		langkit-2021-20210518-19B8E-src/support

LICENSE=		GPLv3+:single GPLv3RLE:single
LICENSE_TERMS=		single:{{WRKDIR}}/TERMS
LICENSE_FILE=		GPLv3+:{{WRKSRC}}/COPYING3
			GPLv3RLE:{{WRKSRC}}/COPYING.RUNTIME
LICENSE_AWK=		TERMS:"^$$"
LICENSE_SOURCE=		TERMS:{{WRKSRC}}/langkit_support.ads
LICENSE_SCHEME=		multi

INSTALL_REQ_TOOLCHAIN=	yes

do-build:
.for LT in static-pic relocatable static
	@${ECHO_CMD} Building ${LT} library ...
	(cd ${WRKSRC} && ${SETENV} ${MAKE_ENV} \
		gprbuild -p -P langkit_support.gpr\
		-XLIBRARY_TYPE="${LT}"\
		-XBUILD_MODE="prod")
.endfor

do-install:
.for LT in static-pic relocatable static
	@${ECHO_CMD} Installing ${LT} library ...
	(cd ${WRKSRC} && ${SETENV} ${MAKE_ENV} \
		gprinstall -p -P langkit_support.gpr\
		--prefix=${STAGEDIR}${PREFIX}\
		--lib-subdir=lib/langkit_support.${LT}\
		-XLIBRARY_TYPE="${LT}"\
		-XBUILD_MODE="prod")
.endfor
	${RM} -r ${STAGEDIR}${PREFIX}/share/gpr/manifests
	# replace gpr file
	${INSTALL_DATA} ${FILESDIR}/langkit_support.gpr \
		${STAGEDIR}${PREFIX}/share/gpr

[FILE:116:descriptions/desc.single]
Support files for Ada Langkit.
These used to be part of langkit, but they have been split out to their
own project.


[FILE:117:distinfo]
7d3923754ebef6412d999e9d7f8c800ca52c1b3ef7bfe612cf1121f5ad2e3def      1029581 langkit-2021-20210518-19B8E-src.tar.gz


[FILE:7250:manifests/plist.single]
include/langkit_support/
 langkit_support-adalog-abstract_relation.adb
 langkit_support-adalog-abstract_relation.ads
 langkit_support-adalog-debug.adb
 langkit_support-adalog-debug.ads
 langkit_support-adalog-eq_same.adb
 langkit_support-adalog-eq_same.ads
 langkit_support-adalog-logic_ref.adb
 langkit_support-adalog-logic_ref.ads
 langkit_support-adalog-logic_var.ads
 langkit_support-adalog-main_support.adb
 langkit_support-adalog-main_support.ads
 langkit_support-adalog-operations.adb
 langkit_support-adalog-operations.ads
 langkit_support-adalog-predicates.adb
 langkit_support-adalog-predicates.ads
 langkit_support-adalog-pure_relations.adb
 langkit_support-adalog-pure_relations.ads
 langkit_support-adalog-relations.adb
 langkit_support-adalog-relations.ads
 langkit_support-adalog-unify.adb
 langkit_support-adalog-unify.ads
 langkit_support-adalog-unify_lr.adb
 langkit_support-adalog-unify_lr.ads
 langkit_support-adalog-unify_one_side.adb
 langkit_support-adalog-unify_one_side.ads
 langkit_support-adalog.ads
 langkit_support-array_utils.adb
 langkit_support-array_utils.ads
 langkit_support-boxes.adb
 langkit_support-boxes.ads
 langkit_support-bump_ptr-vectors.adb
 langkit_support-bump_ptr-vectors.ads
 langkit_support-bump_ptr.adb
 langkit_support-bump_ptr.ads
 langkit_support-cheap_sets.adb
 langkit_support-cheap_sets.ads
 langkit_support-diagnostics-output.adb
 langkit_support-diagnostics-output.ads
 langkit_support-diagnostics.adb
 langkit_support-diagnostics.ads
 langkit_support-errors.ads
 langkit_support-file_readers.adb
 langkit_support-file_readers.ads
 langkit_support-generic_api-analysis.adb
 langkit_support-generic_api-analysis.ads
 langkit_support-generic_api.adb
 langkit_support-generic_api.ads
 langkit_support-hashes.adb
 langkit_support-hashes.ads
 langkit_support-images.adb
 langkit_support-images.ads
 langkit_support-internal.ads
 langkit_support-iterators.adb
 langkit_support-iterators.ads
 langkit_support-lexical_envs.ads
 langkit_support-lexical_envs_impl.adb
 langkit_support-lexical_envs_impl.ads
 langkit_support-packrat.adb
 langkit_support-packrat.ads
 langkit_support-relative_get.adb
 langkit_support-relative_get.ads
 langkit_support-slocs.adb
 langkit_support-slocs.ads
 langkit_support-symbols-precomputed.adb
 langkit_support-symbols-precomputed.ads
 langkit_support-symbols.adb
 langkit_support-symbols.ads
 langkit_support-text.adb
 langkit_support-text.ads
 langkit_support-token_data_handlers.adb
 langkit_support-token_data_handlers.ads
 langkit_support-tree_traversal_iterator.adb
 langkit_support-tree_traversal_iterator.ads
 langkit_support-types.ads
 langkit_support-vectors.adb
 langkit_support-vectors.ads
 langkit_support.ads
lib/liblangkit_support.so
lib/langkit_support.relocatable/
 langkit_support-adalog-abstract_relation.ali
 langkit_support-adalog-debug.ali
 langkit_support-adalog-eq_same.ali
 langkit_support-adalog-logic_ref.ali
 langkit_support-adalog-logic_var.ali
 langkit_support-adalog-main_support.ali
 langkit_support-adalog-operations.ali
 langkit_support-adalog-predicates.ali
 langkit_support-adalog-pure_relations.ali
 langkit_support-adalog-relations.ali
 langkit_support-adalog-unify.ali
 langkit_support-adalog-unify_lr.ali
 langkit_support-adalog-unify_one_side.ali
 langkit_support-adalog.ali
 langkit_support-array_utils.ali
 langkit_support-boxes.ali
 langkit_support-bump_ptr-vectors.ali
 langkit_support-bump_ptr.ali
 langkit_support-cheap_sets.ali
 langkit_support-diagnostics-output.ali
 langkit_support-diagnostics.ali
 langkit_support-errors.ali
 langkit_support-file_readers.ali
 langkit_support-generic_api-analysis.ali
 langkit_support-generic_api.ali
 langkit_support-hashes.ali
 langkit_support-images.ali
 langkit_support-internal.ali
 langkit_support-iterators.ali
 langkit_support-lexical_envs.ali
 langkit_support-lexical_envs_impl.ali
 langkit_support-packrat.ali
 langkit_support-relative_get.ali
 langkit_support-slocs.ali
 langkit_support-symbols-precomputed.ali
 langkit_support-symbols.ali
 langkit_support-text.ali
 langkit_support-token_data_handlers.ali
 langkit_support-tree_traversal_iterator.ali
 langkit_support-types.ali
 langkit_support-vectors.ali
 langkit_support.ali
 liblangkit_support.so
lib/langkit_support.static/
 langkit_support-adalog-abstract_relation.ali
 langkit_support-adalog-debug.ali
 langkit_support-adalog-eq_same.ali
 langkit_support-adalog-logic_ref.ali
 langkit_support-adalog-logic_var.ali
 langkit_support-adalog-main_support.ali
 langkit_support-adalog-operations.ali
 langkit_support-adalog-predicates.ali
 langkit_support-adalog-pure_relations.ali
 langkit_support-adalog-relations.ali
 langkit_support-adalog-unify.ali
 langkit_support-adalog-unify_lr.ali
 langkit_support-adalog-unify_one_side.ali
 langkit_support-adalog.ali
 langkit_support-array_utils.ali
 langkit_support-boxes.ali
 langkit_support-bump_ptr-vectors.ali
 langkit_support-bump_ptr.ali
 langkit_support-cheap_sets.ali
 langkit_support-diagnostics-output.ali
 langkit_support-diagnostics.ali
 langkit_support-errors.ali
 langkit_support-file_readers.ali
 langkit_support-generic_api-analysis.ali
 langkit_support-generic_api.ali
 langkit_support-hashes.ali
 langkit_support-images.ali
 langkit_support-internal.ali
 langkit_support-iterators.ali
 langkit_support-lexical_envs.ali
 langkit_support-lexical_envs_impl.ali
 langkit_support-packrat.ali
 langkit_support-relative_get.ali
 langkit_support-slocs.ali
 langkit_support-symbols-precomputed.ali
 langkit_support-symbols.ali
 langkit_support-text.ali
 langkit_support-token_data_handlers.ali
 langkit_support-tree_traversal_iterator.ali
 langkit_support-types.ali
 langkit_support-vectors.ali
 langkit_support.ali
 liblangkit_support.a
lib/langkit_support.static-pic/
 langkit_support-adalog-abstract_relation.ali
 langkit_support-adalog-debug.ali
 langkit_support-adalog-eq_same.ali
 langkit_support-adalog-logic_ref.ali
 langkit_support-adalog-logic_var.ali
 langkit_support-adalog-main_support.ali
 langkit_support-adalog-operations.ali
 langkit_support-adalog-predicates.ali
 langkit_support-adalog-pure_relations.ali
 langkit_support-adalog-relations.ali
 langkit_support-adalog-unify.ali
 langkit_support-adalog-unify_lr.ali
 langkit_support-adalog-unify_one_side.ali
 langkit_support-adalog.ali
 langkit_support-array_utils.ali
 langkit_support-boxes.ali
 langkit_support-bump_ptr-vectors.ali
 langkit_support-bump_ptr.ali
 langkit_support-cheap_sets.ali
 langkit_support-diagnostics-output.ali
 langkit_support-diagnostics.ali
 langkit_support-errors.ali
 langkit_support-file_readers.ali
 langkit_support-generic_api-analysis.ali
 langkit_support-generic_api.ali
 langkit_support-hashes.ali
 langkit_support-images.ali
 langkit_support-internal.ali
 langkit_support-iterators.ali
 langkit_support-lexical_envs.ali
 langkit_support-lexical_envs_impl.ali
 langkit_support-packrat.ali
 langkit_support-relative_get.ali
 langkit_support-slocs.ali
 langkit_support-symbols-precomputed.ali
 langkit_support-symbols.ali
 langkit_support-text.ali
 langkit_support-token_data_handlers.ali
 langkit_support-tree_traversal_iterator.ali
 langkit_support-types.ali
 langkit_support-vectors.ali
 langkit_support.ali
 liblangkit_support.a
share/gpr/langkit_support.gpr


[FILE:723:patches/patch-langkit__support.gpr]
--- langkit_support.gpr.orig	2021-05-19 05:15:54 UTC
+++ langkit_support.gpr
@@ -13,7 +13,7 @@ library project Langkit_Support is
 
    for Languages use ("Ada");
    for Source_Dirs use (".");
-   for Object_Dir use "obj/" & Build_Mode;
+   for Object_Dir use "obj/" & Library_Kind_Param;
 
    for Library_Name use "langkit_support";
    for Library_Kind use Library_Kind_Param;
@@ -61,7 +61,7 @@ library project Langkit_Support is
       "Langkit_Support.Tree_Traversal_Iterator",
       "Langkit_Support.Vectors");
 
-   for Library_Dir use "lib/" & Library_Kind_Param & "/" & Build_Mode;
+   for Library_Dir use "lib/langkit_support." & Library_Kind_Param;
 
    Common_Ada_Cargs := ("-gnatwa", "-gnatyg", "-fPIC");
 


[FILE:1597:files/langkit_support.gpr]
with "gnatcoll_iconv";
with "gpr";
with "xmlada_schema";
with "xmlada_dom";
with "xmlada_sax";
with "xmlada_input_sources";
with "xmlada_unicode";
with "gnatcoll";

library project Langkit_Support is
   type BUILD_KIND is ("static", "static-pic", "relocatable");
   BUILD : BUILD_KIND := external("LANGKIT_SUPPORT_BUILD",external("LIBRARY_TYPE", "static-pic"));

   for Languages use ("Ada");

   case BUILD is
      when "static" =>
         for Source_Dirs use ("../../include/langkit_support");
         for Library_Dir use "../../lib/langkit_support.static";
         for Library_Kind use "static";
      when "static-pic" =>
         for Source_Dirs use ("../../include/langkit_support");
         for Library_Dir use "../../lib/langkit_support.static-pic";
         for Library_Kind use "static-pic";
      when "relocatable" =>
         for Source_Dirs use ("../../include/langkit_support");
         for Library_Dir use "../../lib/langkit_support.relocatable";
         for Library_Kind use "relocatable";
   end case;

   for Library_Name use "langkit_support";

   package Naming is
      for dot_replacement use "-";
      for casing use "lowercase";
      for body_suffix ("ada") use ".adb";
      for spec_suffix ("ada") use ".ads";
   end Naming;

   package Linker is
      null;
   end Linker;

   package Install is
      for Active use "False";
   end Install;

   for Externally_Built use "True";

   type Build_Mode_Type is
     ("dev", "prod");

   common_ada_cargs   := ("-gnatwa", "-gnatyg", "-fPIC");
   build_mode         : build_mode_type := "prod";
end Langkit_Support;

