# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		libxml2
VERSION=		2.10.4
KEYWORDS=		textproc
VARIANTS=		standard
SDESC[standard]=	XML parser library for GNOME
HOMEPAGE=		http://xmlsoft.org/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		GNOME/libxml2/2.10
DISTFILE[1]=		libxml2-2.10.4.tar.xz:main
DIST_SUBDIR=		gnome2
DF_INDEX=		1
SPKGS[standard]=	complete
			primary
			dev
			man

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

USES=			cpe gmake iconv libtool pkgconfig shebangfix mbsdfix

CPE_VENDOR=		xmlsoft
FPC_EQUIVALENT=		textproc/libxml2
SHEBANG_GLOB=		*.py

MUST_CONFIGURE=		gnu
CONFIGURE_ARGS=		--with-schemas
			--with-threads
			--with-iconv={{ICONV_PREFIX}}
			--without-icu
			--with-lzma=/usr
			--without-python
			--enable-static

INSTALL_TARGET=		install-strip
INSTALL_REQ_TOOLCHAIN=	yes
SOVERSION=		2.10.4

post-patch:
.for d in . doc doc/devhelp doc/examples
	${REINPLACE_CMD} -e '/^install-data-am:/ s|install-data-local||' \
		${WRKSRC}/${d}/Makefile.in
.endfor
.for f in catalog.c xmlcatalog.c xmllint.c doc/xmllint.1
	${REINPLACE_CMD} -e \
		's|/etc/xml/catalog|${LOCALBASE}/share/xml/catalog|g; \
		 s|/etc/sgml/catalog|${LOCALBASE}/share/sgml/catalog|g' \
		${WRKSRC}/${f}
.endfor

post-install:
	${RM} -r ${STAGEDIR}${PREFIX}/share/gtk-doc
	${RM} -r ${STAGEDIR}${STD_DOCDIR}

[FILE:313:descriptions/desc.primary]
Libxml2 is the XML C parser and toolkit developed for the Gnome project
(but usable outside of the Gnome platform).  XML itself is a metalanguage
to design markup languages, i.e. text language where semantic and
structure are added to the content using extra "markup" information
enclosed between angle brackets.


[FILE:107:distinfo]
ed0c91c5845008f1936739e4eee2035531c1c94742c6541f44ee66d885948d45      2643600 gnome2/libxml2-2.10.4.tar.xz


[FILE:94:manifests/plist.primary]
bin/
 xml2-config
 xmlcatalog
 xmllint
lib/
 libxml2.so.%%SOMAJOR%%
 libxml2.so.%%SOVERSION%%


[FILE:688:manifests/plist.dev]
include/libxml2/libxml/
 HTMLparser.h
 HTMLtree.h
 SAX.h
 SAX2.h
 c14n.h
 catalog.h
 chvalid.h
 debugXML.h
 dict.h
 encoding.h
 entities.h
 globals.h
 hash.h
 list.h
 nanoftp.h
 nanohttp.h
 parser.h
 parserInternals.h
 pattern.h
 relaxng.h
 schemasInternals.h
 schematron.h
 threads.h
 tree.h
 uri.h
 valid.h
 xinclude.h
 xlink.h
 xmlIO.h
 xmlautomata.h
 xmlerror.h
 xmlexports.h
 xmlmemory.h
 xmlmodule.h
 xmlreader.h
 xmlregexp.h
 xmlsave.h
 xmlschemas.h
 xmlschemastypes.h
 xmlstring.h
 xmlunicode.h
 xmlversion.h
 xmlwriter.h
 xpath.h
 xpathInternals.h
 xpointer.h
lib/
 libxml2.a
 libxml2.so
lib/cmake/libxml2/libxml2-config.cmake
lib/pkgconfig/libxml-2.0.pc
share/aclocal/libxml.m4


[FILE:65:manifests/plist.man]
share/man/man1/
 xml2-config.1.gz
 xmlcatalog.1.gz
 xmllint.1.gz


[FILE:1723:patches/patch-Makefile.in]
--- Makefile.in.orig	2023-04-11 11:28:11 UTC
+++ Makefile.in
@@ -711,7 +711,7 @@ m4datadir = $(datadir)/aclocal
 m4data_DATA = libxml.m4
 runtest_SOURCES = runtest.c
 runtest_CFLAGS = $(EXTRA_CFLAGS) $(THREAD_CFLAGS)
-runtest_LDFLAGS = 
+runtest_LDFLAGS = -pthread
 runtest_DEPENDENCIES = $(DEPS)
 runtest_LDADD = $(BASE_THREAD_LIBS) $(THREAD_LIBS) $(LDADDS)
 testrecurse_SOURCES = testrecurse.c
@@ -744,7 +744,7 @@ xmlcatalog_DEPENDENCIES = $(DEPS)
 xmlcatalog_LDADD = $(RDL_LIBS) $(LDADDS)
 testThreads_SOURCES = testThreads.c
 testThreads_CFLAGS = $(EXTRA_CFLAGS) $(THREAD_CFLAGS)
-testThreads_LDFLAGS = 
+testThreads_LDFLAGS = -pthread
 testThreads_DEPENDENCIES = $(DEPS)
 testThreads_LDADD = $(BASE_THREAD_LIBS) $(THREAD_LIBS) $(LDADDS)
 testAutomata_SOURCES = testAutomata.c
@@ -1149,7 +1149,7 @@ am--depfiles: $(am__depfiles_remade)
 @am__fastdepCC_FALSE@	$(AM_V_CC@am__nodep@)$(COMPILE) -c -o $@ `$(CYGPATH_W) '$<'`
 
 .c.lo:
-@am__fastdepCC_TRUE@	$(AM_V_CC)$(LTCOMPILE) -MT $@ -MD -MP -MF $(DEPDIR)/$*.Tpo -c -o $@ $<
+@am__fastdepCC_TRUE@	$(AM_V_CC)$(LTCOMPILE) -fPIC -DPIC -MT $@ -MD -MP -MF $(DEPDIR)/$*.Tpo -c -o $@ $<
 @am__fastdepCC_TRUE@	$(AM_V_at)$(am__mv) $(DEPDIR)/$*.Tpo $(DEPDIR)/$*.Plo
 @AMDEP_TRUE@@am__fastdepCC_FALSE@	$(AM_V_CC)source='$<' object='$@' libtool=yes @AMDEPBACKSLASH@
 @AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
@@ -1906,7 +1906,7 @@ check-am: all-am
 	$(MAKE) $(AM_MAKEFLAGS) $(check_PROGRAMS)
 	$(MAKE) $(AM_MAKEFLAGS) check-local
 check: check-recursive
-all-am: Makefile $(PROGRAMS) $(LTLIBRARIES) $(SCRIPTS) $(DATA) \
+all-am: Makefile $(LTLIBRARIES) $(SCRIPTS) $(DATA) \
 		config.h
 install-binPROGRAMS: install-libLTLIBRARIES
 


[FILE:321:patches/patch-python_Makefile.in]
--- python/Makefile.in.orig	2023-04-11 11:28:11 UTC
+++ python/Makefile.in
@@ -489,7 +489,7 @@ target_alias = @target_alias@
 top_build_prefix = @top_build_prefix@
 top_builddir = @top_builddir@
 top_srcdir = @top_srcdir@
-SUBDIRS = . tests
+SUBDIRS = .
 docsdir = $(docdir)/python
 dist_docs_DATA = TODO
 EXTRA_DIST = \


[FILE:828:patches/patch-uri.c]
Revert the following commit, it makes the freebsd doc chain fail.

From 8eb55d782a2b9afacc7938694891cc6fad7b42a5 Mon Sep 17 00:00:00 2001
From: Dennis Filder <d.filder@web.de>
Date: Fri, 13 Jun 2014 14:56:14 +0800
Subject: xmlSaveUri() incorrectly recomposes URIs with rootless paths

For https://bugzilla.gnome.org/show_bug.cgi?id=731063

xmlSaveUri() of libxml2 (snapshot 2014-05-31 and earlier) returns
bogus values when called with URIs that have rootless paths
(e.g. "urx:b:b" becomes "urx://b%3Ab" where "urx:b%3Ab" would be
correct)

--- uri.c.orig	2023-04-11 10:36:35 UTC
+++ uri.c
@@ -1207,6 +1207,8 @@ xmlSaveUri(xmlURIPtr uri) {
                 if (temp == NULL) goto mem_error;
                 ret = temp;
 	    }
+	    ret[len++] = '/';
+	    ret[len++] = '/';
 	}
 	if (uri->path != NULL) {
 	    p = uri->path;

