# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		R-openssl
VERSION=		2.0.3
KEYWORDS=		cran
VARIANTS=		standard
SDESC[standard]=	Encryption, signature and certificate toolkit
HOMEPAGE=		https://github.com/jeroen/openssl
CONTACT=		CRAN_Automaton[cran@ironwolf.systems]

DOWNLOAD_GROUPS=	main
SITES[main]=		CRAN/src/contrib
DISTFILE[1]=		openssl_2.0.3.tar.gz:main
DIST_SUBDIR=		CRAN
DF_INDEX=		1
SPKGS[standard]=	single

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILDRUN_DEPENDS=	R-askpass:single:standard

USES=			cran gmake ssl:openssl11 pkgconfig shebangfix

DISTNAME=		openssl

SHEBANG_ADD_SH=		configure
SHEBANG_FILES=		tests/google.dk/generate.bash
GENERATED=		yes

INSTALL_REQ_TOOLCHAIN=	yes

post-patch:
	${REINPLACE_CMD} \
	-e 's|PKG_LIBS=[$$]{PKGCONFIG_LIBS}|PKG_LIBS="$${PKGCONFIG_LIBS} -Wl,-rpath,${OPENSSLRPATH}"|' \
	${WRKSRC}/configure

[FILE:765:descriptions/desc.single]
openssl: Toolkit for Encryption, Signatures and Certificates Based
onOpenSSL

Bindings to OpenSSL libssl and libcrypto, plus custom SSH key parsers.
Supports RSA, DSA and EC curves P-256, P-384, P-521, and curve25519.
Cryptographic signatures can either be created and verified manually or via
x509 certificates. AES can be used in cbc, ctr or gcm mode for symmetric
encryption; RSA for asymmetric (public key) encryption or EC for Diffie
Hellman. High-level envelope functions combine RSA and AES for encrypting
arbitrary sized data. Other utilities include key generators, hash
functions (md5, sha1, sha256, etc), base64 encoder, a secure random number
generator, and 'bignum' math methods for manually performing crypto
calculations on large multibyte integers.


[FILE:104:distinfo]
7cde98520bec857f043fb6aae92334e2ae0dcd86108adc9b18ca298ec16286aa      1204224 CRAN/openssl_2.0.3.tar.gz


[FILE:587:patches/patch-src_ssl.c]
Expose PF_UNSPEC

--- src/ssl.c.orig	2021-04-30 12:20:43 UTC
+++ src/ssl.c
@@ -1,5 +1,5 @@
 //getaddrinfo is an extension (not C99)
-#if !defined(_WIN32) && !defined(__sun) && !defined(_POSIX_C_SOURCE)
+#if !defined(_WIN32) && !defined(__sun) && !defined(_POSIX_C_SOURCE) && !defined(__DragonFly__)
 #define _POSIX_C_SOURCE 200112L
 #endif
 
@@ -9,7 +9,7 @@
 #endif
 
 //see https://github.com/jeroen/openssl/issues/41
-#if defined(__FreeBSD__) && !defined(__BSD_VISIBLE)
+#if defined(__FreeBSD__) && !defined(__BSD_VISIBLE) && !defined(__DragonFly__)
 #define __BSD_VISIBLE 1
 #endif
 

