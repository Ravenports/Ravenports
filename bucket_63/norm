# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		norm
VERSION=		1.5r6
KEYWORDS=		net
VARIANTS=		standard
SDESC[standard]=	NACK-Oriented Reliable Multicast (NORM)
HOMEPAGE=		https://www.nrl.navy.mil/itd/ncs/products/norm
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		http://downloads.pf.itd.nrl.navy.mil/norm/archive/
DISTFILE[1]=		src-norm-1.5r6.tgz:main
DF_INDEX=		1
SPKGS[standard]=	single

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILD_DEPENDS=		python27:single:standard

USES=			libtool c++:single

FPC_EQUIVALENT=		net/norm

MUST_CONFIGURE=		yes
CONFIGURE_ARGS=		--prefix="{{PREFIX}}"
			-j{{MAKE_JOBS_NUMBER}}

BUILD_TARGET=		build
DESTDIRNAME=		--destdir
SINGLE_JOB=		yes

PLIST_SUB=		SOVERSION=1.0.0
			SOMAJOR=1

post-install:
	${INSTALL_DATA} ${WRKSRC}/include/normApi.h \
		${STAGEDIR}${PREFIX}/include/
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/lib/libnorm.so

[FILE:1185:descriptions/desc.single]
This a port of NACK-Oriented Reliable Multicast (N.O.R.M.), as specified 
in RFC5740.

The NORM protocol is designed to provide end-to-end reliable transport of 
bulk data objects or streams over generic IP multicast routing and 
forwarding services. NORM uses a selective, negative acknowledgement 
(NACK) mechanism for transport reliability and offers additional protocol 
mechanisms to conduct reliable multicast sessions with limited "a priori" 
coordination among senders and receivers. A congestion control scheme is 
specified to allow the NORM protocol fairly share available network 
bandwidth with other transport protocols such as Transmission Control 
Protocol (TCP). It is capable of operating with both reciprocal multicast 
routing among senders and receivers and with asymmetric connectivity 
(possibly a unicast return path) from the senders to receivers. The 
protocol offers a number of features to allow different types of 
applications or possibly other higher level transport protocols to utilize 
its service in different ways. The protocol leverages the use of FEC-based 
repair and other IETF reliable multicast transport (RMT) building blocks 
in its design.


[FILE:97:distinfo]
20ea2e8dd5d5e1ff1ff91dc7dab6db53a77d7b7183d8cf2425c215fd294f22a7      2297898 src-norm-1.5r6.tgz


[FILE:85:manifests/plist.single]
include/normApi.h
lib/
 libnorm.so
 libnorm.so.%%SOMAJOR%%
 libnorm.so.%%SOVERSION%%


[FILE:709:patches/patch-protolib_include_protoSocket.h]
--- protolib/include/protoSocket.h.orig	2015-02-06 00:47:50.000000000 +0200
+++ protolib/include/protoSocket.h
@@ -94,7 +94,7 @@ class ProtoSocket
 // On Mac OSX, only version 10.7 and later support IGMPv3 
 // and the "MCAST_JOIN_GROUP" macro definition is a "tell" for this
 // (we _reallly_ need to go to a more sophisticated build system!)
-#if (!defined(WIN32) && !defined(ANDROID) && (!defined(MACOSX))) || (defined(MACOSX) && defined(MCAST_JOIN_GROUP))
+#if (!defined(WIN32) && !defined(ANDROID) && !defined(__DragonFly__) &&(!defined(MACOSX))) || (defined(MACOSX) && defined(MCAST_JOIN_GROUP)) 
 #define _PROTOSOCKET_IGMPV3_SSM
 #endif // !WIN32 && !ANDROID && (!MACOSX || MCAST_JOIN_GROUP)
         


[FILE:914:patches/patch-protolib_include_protoTree.h]
--- protolib/include/protoTree.h.orig	2014-06-05 00:12:02 UTC
+++ protolib/include/protoTree.h
@@ -648,12 +648,12 @@ class ProtoSortedTreeTemplate : public P
                 
                 ITEM_TYPE* GetPrevItem()
                     {return static_cast<ITEM_TYPE*>(ProtoSortedTree::Iterator::GetPrevItem());}
-                ITEM_TYPE* PeekPrevItem() const
+                ITEM_TYPE* PeekPrevItem()
                     {return static_cast<ITEM_TYPE*>(ProtoSortedTree::Iterator::PeekPrevItem());}
                 
                 ITEM_TYPE* GetNextItem()
                     {return static_cast<ITEM_TYPE*>(ProtoSortedTree::Iterator::GetNextItem());}
-                ITEM_TYPE* PeekNextItem() const
+                ITEM_TYPE* PeekNextItem()
                     {return static_cast<ITEM_TYPE*>(ProtoSortedTree::Iterator::PeekNextItem());}
 
         };  // end class ProtoSortedTreeTemplate::Iterator


[FILE:456:patches/patch-protolib_setup.py]
--- protolib/setup.py.orig	2014-03-01 18:17:04.000000000 +0200
+++ protolib/setup.py
@@ -23,7 +23,7 @@ system = platform.system().lower()
 sys_macros = [('HAVE_ASSERT',None), ('HAVE_IPV6',None), ('PROTO_DEBUG', None)]
 sys_libs = ['protokit']
 
-if system in ('linux', 'darwin', 'freebsd'):
+if system in ('linux', 'darwin', 'freebsd', 'dragonfly'):
     sys_macros.append(('UNIX',None))
 elif system in ('windows'):
     sys_macros.append(('WIN32',None))


[FILE:1442:patches/patch-protolib_wscript]
--- protolib/wscript.orig	2015-06-27 19:08:57.000000000 +0300
+++ protolib/wscript
@@ -55,7 +55,7 @@ def configure(ctx):
     # Use this USE variable to add flags to protolib's compilation
     ctx.env.USE_BUILD_PROTOLIB += ['BUILD_PROTOLIB']
 
-    if system in ('linux', 'darwin', 'freebsd'):
+    if system in ('linux', 'darwin', 'freebsd', 'dragonfly'):
         ctx.env.DEFINES_BUILD_PROTOLIB += ['UNIX', 'HAVE_DIRFD', 'HAVE_IPV6',
                 'HAVE_ASSERT', 'HAVE_GETLOGIN']
 
@@ -83,7 +83,7 @@ def configure(ctx):
         ctx.check_cxx(lib='resolv')
         ctx.env.USE_BUILD_PROTOLIB += ['RESOLV']
 
-    if system == 'freebsd':
+    if system in ('freebsd', 'dragonfly'):
         ctx.env.DEFINES_BUILD_PROTOLIB += ['HAVE_FLOCK']
 
     if system == 'windows':
@@ -172,7 +172,7 @@ def build(ctx):
         ]]
     )
 
-    if system in ('linux', 'darwin', 'freebsd'):
+    if system in ('linux', 'darwin', 'freebsd', 'dragonfly'):
         protolib.source.extend(['src/unix/{0}.cpp'.format(x) for x in [
             'unixNet',
             'unixSerial',
@@ -194,7 +194,7 @@ def build(ctx):
             protolib.source.append('src/linux/linuxDetour.cpp')
             protolib.use.append('NETFILTER_QUEUE')
 
-    if system in ('darwin', 'freebsd'):
+    if system in ('darwin', 'freebsd', 'dragonfly'):
         protolib.source.extend(['src/bsd/{0}.cpp'.format(x) for x in [
             'bsdDetour',
             'bsdNet',


[FILE:426:patches/patch-wscript]
--- wscript.orig	2015-06-30 18:02:38.000000000 +0300
+++ wscript
@@ -38,7 +38,7 @@ def configure(ctx):
     # Use this USE variable to add flags to NORM's compilation
     ctx.env.USE_BUILD_NORM += ['BUILD_NORM', 'protolib']
 
-    if system in ('linux', 'darwin', 'freebsd'):
+    if system in ('linux', 'darwin', 'freebsd', 'dragonfly'):
         ctx.env.DEFINES_BUILD_NORM += ['ECN_SUPPORT']
 
     if system == 'windows':


[FILE:164:files/special.mk]
# Emulate USES=waf
MAKE_CMD=	${LOCALBASE}/bin/python2.7 ./waf
CONFIGURE_CMD=	${LOCALBASE}/bin/python2.7 ./waf configure
MAKEFILE=
MAKE_FLAGS=
MAKE_ARGS+=	--verbose

