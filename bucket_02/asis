# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		asis
VERSION=		2016
KEYWORDS=		lang ada
VARIANTS=		standard
SDESC[standard]=	Ada Semantic Interface Specification (GNAT)
HOMEPAGE=		http://www.sigada.org/wg/asiswg/
CONTACT=		John_Marino[draco@marino.st]

DOWNLOAD_GROUPS=	main
SITES[main]=		http://downloads.dragonlace.net/src/
DISTFILE[1]=		asis-gpl-2016-src.tar.gz:main
DF_INDEX=		1
SPKGS[standard]=	complete
			primary
			docs

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILD_DEPENDS=		xmlada:primary:standard
			python-Sphinx:single:python_default
BUILDRUN_DEPENDS=	gnat-util:single:standard

USES=			gmake gprbuild

DISTNAME=		asis-gpl-2016-src

LICENSE=		GPLv3+:primary
LICENSE_TERMS=		primary:{{WRKDIR}}/TERMS
LICENSE_FILE=		GPLv3+:{{WRKSRC}}/COPYING3
LICENSE_AWK=		TERMS:"^$$"
LICENSE_SOURCE=		TERMS:{{WRKSRC}}/asis/asis.ads
LICENSE_SCHEME=		solo

FPC_EQUIVALENT=		lang/asis

MAKE_ARGS=		PROCESSORS={{MAKE_JOBS_NUMBER}}

do-build:
	# This target is recreated because -j cannot be set, but
	# MAKE_JOBS_UNSAFE=yes would break PROCESSORS value
	(cd ${WRKSRC} && ${SETENV} ${MAKE_ENV} ${MAKE_CMD} ${MAKE_ARGS} all)
	(cd ${WRKSRC}/doc && ${SETENV} ${MAKE_ENV} ${MAKE_CMD} html-all)

post-extract:
	${REINPLACE_CMD} -e 's|OPSYS|ASISOPSYS|g' \
		-e 's|(prefix)|(DESTDIR)$$(prefix)|g' \
		${WRKSRC}/Makefile \
		${WRKSRC}/Makefile.stub \
		${WRKSRC}/common.gpr
	${RM} -r ${WRKSRC}/gnat

do-install:
	# gprinstall seems to be malfunctioning, just install manually
	${MKDIR} ${STAGEDIR}${PREFIX}/bin \
		${STAGEDIR}${PREFIX}/include/asis \
		${STAGEDIR}${PREFIX}/lib/asis \
		${STAGEDIR}${PREFIX}/lib/gnat \
		${STAGEDIR}${STD_DOCDIR}
	${INSTALL_PROGRAM} ${WRKSRC}/tools/asistant/asistant \
		${STAGEDIR}${PREFIX}/bin
	${INSTALL_DATA} ${WRKSRC}/asis/*.ad[bs] \
		${STAGEDIR}${PREFIX}/include/asis
	${INSTALL_DATA} ${WRKSRC}/lib/*.ali ${STAGEDIR}${PREFIX}/lib/asis
	${INSTALL_DATA} ${WRKSRC}/lib/*.a ${STAGEDIR}${PREFIX}/lib/asis
	${INSTALL_DATA} ${FILESDIR}/asis.gpr ${STAGEDIR}${PREFIX}/lib/gnat
	(cd ${WRKSRC}/doc/html && ${COPYTREE_SHARE} . ${STAGEDIR}${STD_DOCDIR})

[FILE:794:descriptions/desc.primary]
The Ada Semantic Interface Specification (ASIS) is an interface between an
Ada environment as defined by ISO/IEC 8652 (the Ada Reference Manual) and
any tool requiring information from this environment. An Ada environment
includes valuable semantic and syntactic information. ASIS is an open and
published callable interface which gives CASE tool and application
developers access to this information. ASIS has been designed to be
independent of underlying Ada environment implementations, thus supporting
portability of software engineering tools while relieving tool developers
from having to understand the complexities of an Ada environment's
proprietary internal representation.

ASIS 95 is the ASIS interface to Ada 95 (ISO/IEC 8652:1995).
ASIS 95 is now available as ISO/IEC 15291:1999.


[FILE:103:distinfo]
3e36e0835e291dafe6dd2246748ed12b449d33044c32209d3af012c83064c38e      5240554 asis-gpl-2016-src.tar.gz


[FILE:4532:manifests/plist.primary]
bin/asistant
include/asis/
 a4g-a_alloc.ads
 a4g-a_debug.adb
 a4g-a_debug.ads
 a4g-a_elists.adb
 a4g-a_elists.ads
 a4g-a_opt.adb
 a4g-a_opt.ads
 a4g-a_osint.adb
 a4g-a_osint.ads
 a4g-a_output.adb
 a4g-a_output.ads
 a4g-a_sem.adb
 a4g-a_sem.ads
 a4g-a_sinput.adb
 a4g-a_sinput.ads
 a4g-a_stand.ads
 a4g-a_types.adb
 a4g-a_types.ads
 a4g-asis_tables.adb
 a4g-asis_tables.ads
 a4g-contt-dp.adb
 a4g-contt-dp.ads
 a4g-contt-sd.adb
 a4g-contt-sd.ads
 a4g-contt-tt.adb
 a4g-contt-tt.ads
 a4g-contt-ut.adb
 a4g-contt-ut.ads
 a4g-contt.adb
 a4g-contt.ads
 a4g-cu_info2.adb
 a4g-cu_info2.ads
 a4g-dda_aux.adb
 a4g-dda_aux.ads
 a4g-decl_sem.adb
 a4g-decl_sem.ads
 a4g-defaults.adb
 a4g-defaults.ads
 a4g-ee_cache.adb
 a4g-ee_cache.ads
 a4g-encl_el.adb
 a4g-encl_el.ads
 a4g-expr_sem.adb
 a4g-expr_sem.ads
 a4g-get_unit.adb
 a4g-get_unit.ads
 a4g-gnat_int.adb
 a4g-gnat_int.ads
 a4g-gnsa_switch.ads
 a4g-int_knds.ads
 a4g-itests.adb
 a4g-itests.ads
 a4g-knd_conv.adb
 a4g-knd_conv.ads
 a4g-mapping.adb
 a4g-mapping.ads
 a4g-norm.adb
 a4g-norm.ads
 a4g-queries.adb
 a4g-queries.ads
 a4g-skip_tb.adb
 a4g-skip_tb.ads
 a4g-span_beginning.adb
 a4g-span_beginning.ads
 a4g-span_end.adb
 a4g-span_end.ads
 a4g-stand.adb
 a4g-stand.ads
 a4g-tree_rec.ads
 a4g-u_conv.adb
 a4g-u_conv.ads
 a4g-unit_rec.ads
 a4g-vcheck.adb
 a4g-vcheck.ads
 a4g.ads
 asis-ada_environments-containers.adb
 asis-ada_environments-containers.ads
 asis-ada_environments.adb
 asis-ada_environments.ads
 asis-clauses.adb
 asis-clauses.ads
 asis-compilation_units-relations.adb
 asis-compilation_units-relations.ads
 asis-compilation_units-times.adb
 asis-compilation_units-times.ads
 asis-compilation_units.adb
 asis-compilation_units.ads
 asis-data_decomposition-aux.adb
 asis-data_decomposition-aux.ads
 asis-data_decomposition-debug.adb
 asis-data_decomposition-debug.ads
 asis-data_decomposition-extensions.adb
 asis-data_decomposition-extensions.ads
 asis-data_decomposition-set_get.adb
 asis-data_decomposition-set_get.ads
 asis-data_decomposition-vcheck.adb
 asis-data_decomposition-vcheck.ads
 asis-data_decomposition.adb
 asis-data_decomposition.ads
 asis-declarations.adb
 asis-declarations.ads
 asis-definitions.adb
 asis-definitions.ads
 asis-elements.adb
 asis-elements.ads
 asis-errors.ads
 asis-exceptions.ads
 asis-expressions.adb
 asis-expressions.ads
 asis-extensions-flat_kinds.adb
 asis-extensions-flat_kinds.ads
 asis-extensions-iterator.adb
 asis-extensions-iterator.ads
 asis-extensions-strings.adb
 asis-extensions-strings.ads
 asis-extensions.adb
 asis-extensions.ads
 asis-ids.adb
 asis-ids.ads
 asis-implementation-permissions.adb
 asis-implementation-permissions.ads
 asis-implementation.adb
 asis-implementation.ads
 asis-iterator.adb
 asis-iterator.ads
 asis-limited_views.adb
 asis-limited_views.ads
 asis-set_get.adb
 asis-set_get.ads
 asis-statements.adb
 asis-statements.ads
 asis-text-set_get.adb
 asis-text-set_get.ads
 asis-text.adb
 asis-text.ads
 asis.ads
lib/asis/
 a4g-a_alloc.ali
 a4g-a_debug.ali
 a4g-a_elists.ali
 a4g-a_opt.ali
 a4g-a_osint.ali
 a4g-a_output.ali
 a4g-a_sem.ali
 a4g-a_sinput.ali
 a4g-a_stand.ali
 a4g-a_types.ali
 a4g-asis_tables.ali
 a4g-contt-dp.ali
 a4g-contt-sd.ali
 a4g-contt-tt.ali
 a4g-contt-ut.ali
 a4g-contt.ali
 a4g-cu_info2.ali
 a4g-dda_aux.ali
 a4g-decl_sem.ali
 a4g-defaults.ali
 a4g-ee_cache.ali
 a4g-encl_el.ali
 a4g-expr_sem.ali
 a4g-get_unit.ali
 a4g-gnat_int.ali
 a4g-gnsa_switch.ali
 a4g-int_knds.ali
 a4g-itests.ali
 a4g-knd_conv.ali
 a4g-mapping.ali
 a4g-norm.ali
 a4g-queries.ali
 a4g-skip_tb.ali
 a4g-span_beginning.ali
 a4g-span_end.ali
 a4g-stand.ali
 a4g-tree_rec.ali
 a4g-u_conv.ali
 a4g-unit_rec.ali
 a4g-vcheck.ali
 a4g.ali
 asis-ada_environments-containers.ali
 asis-ada_environments.ali
 asis-clauses.ali
 asis-compilation_units-relations.ali
 asis-compilation_units-times.ali
 asis-compilation_units.ali
 asis-data_decomposition-aux.ali
 asis-data_decomposition-debug.ali
 asis-data_decomposition-extensions.ali
 asis-data_decomposition-set_get.ali
 asis-data_decomposition-vcheck.ali
 asis-data_decomposition.ali
 asis-declarations.ali
 asis-definitions.ali
 asis-elements.ali
 asis-errors.ali
 asis-exceptions.ali
 asis-expressions.ali
 asis-extensions-flat_kinds.ali
 asis-extensions-iterator.ali
 asis-extensions-strings.ali
 asis-extensions.ali
 asis-ids.ali
 asis-implementation-permissions.ali
 asis-implementation.ali
 asis-iterator.ali
 asis-limited_views.ali
 asis-set_get.ali
 asis-statements.ali
 asis-text-set_get.ali
 asis-text.ali
 asis.ali
 libasis.a
lib/gnat/asis.gpr


[FILE:321:patches/patch-Makefile.stub]
--- Makefile.stub.orig	2015-06-22 09:23:18 UTC
+++ Makefile.stub
@@ -3,8 +3,7 @@ host := $(shell gcc -dumpmachine)
 
 # Where Asis library should be installed
 # Default is into current GNAT directory
-INSTALL_DIR = $(dir $(shell which gnatls))..
-prefix=$(INSTALL_DIR)
+prefix=$(PREFIX)
 
 # System commands
 LN = ln -s


[FILE:1764:patches/patch-asis_a4g-gnat__int.adb]
--- asis/a4g-gnat_int.adb.orig	2016-05-16 09:17:27 UTC
+++ asis/a4g-gnat_int.adb
@@ -231,46 +231,10 @@ package body A4G.GNAT_Int is
       Opt.Tree_Read;
 
       if Strong_Version_Check then
-         --  We check only the dates here!
-         First_A_Idx :=
-           Index (Source  => ASIS_GNAT_V,
-                  Pattern => "(") + 1;
-
-         First_T_Idx :=
-           Index (Source  => Tree_Version_String.all,
-                  Pattern => "(") + 1;
-
-         Last_A_Idx := Index (Source  => ASIS_GNAT_V,
-                     Pattern => ")") - 1;
-
-         if Index
-              (Source  => ASIS_GNAT_V (First_A_Idx .. Last_A_Idx),
-               Pattern => "-") /= 0
-         then
-            Last_A_Idx :=
-              Index (Source  => ASIS_GNAT_V (First_A_Idx .. Last_A_Idx),
-                     Pattern => "-") - 1;
-         end if;
-
-         Last_T_Idx := Index (Source  => Tree_Version_String.all,
-                              Pattern => ")") - 1;
-
-         if Index
-              (Source  => Tree_Version_String.all (First_T_Idx .. Last_T_Idx),
-               Pattern => "-") /= 0
-         then
-            Last_T_Idx :=
-              Index (Source  =>
-                       Tree_Version_String.all (First_T_Idx .. Last_T_Idx),
-                     Pattern => "-") - 1;
-         end if;
-
-         if ASIS_GNAT_V (First_A_Idx .. Last_A_Idx) /=
-            Tree_Version_String (First_T_Idx .. Last_T_Idx)
-         then
-            Note_Version_Mismatch;
-         end if;
-
+         --  No need for any version check at all
+         --  FreeBSD Ports system ensures gnat_util is from same sources
+         --  as compiler building ASIS
+         null;
       end if;
 
       --  GNAT/ASIS version check


[FILE:275:files/asis.gpr]
with "gnat_util";
Library project Asis is

   for Languages use ("Ada");

   for Source_Dirs use ("../../include/asis");
   for Library_Dir use "../../lib/asis";
   for Library_Name use "asis";
   for Library_Kind use "static";
   for Externally_Built use "True";

end Asis;

