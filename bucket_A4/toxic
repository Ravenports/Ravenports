# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		toxic
VERSION=		0.15.1
REVISION=		2
KEYWORDS=		net net_im net_p2p
VARIANTS=		std
SDESC[std]=		Ncurses-based Tox client
HOMEPAGE=		https://github.com/Jfreegman/toxic
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		GITHUB/JFreegman:toxic:v0.15.1
DISTFILE[1]=		generated:main
DIST_SUBDIR=		tox
DF_INDEX=		1
SPKGS[std]=		set
			primary
			man

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILD_DEPENDS=		evdev-proto:single:std
			libnotify:dev:std
			toxcore:dev:std
			openal:dev:std
			libconfig:dev:std
			qrencode:dev:std
BUILDRUN_DEPENDS=	freealut:single:std
			libnotify:primary:std
			qrencode:primary:std
			toxcore:primary:std
			openal:primary:std
			libconfig:primary:std

USES=			desktop-utils:primary gmake ncurses pkgconfig curl
			png zlib:build gettext shebangfix ssl:build
GNOME_COMPONENTS=	glib
XORG_COMPONENTS=	x11

LICENSE=		GPLv3+:primary
LICENSE_TERMS=		primary:{{WRKDIR}}/TERMS
LICENSE_FILE=		GPLv3+:{{WRKSRC}}/LICENSE
LICENSE_AWK=		TERMS:"^\#include"
LICENSE_SOURCE=		TERMS:{{WRKSRC}}/src/toxic.c
LICENSE_SCHEME=		solo

FPC_EQUIVALENT=		net-im/toxic
SHEBANG_FILES=		apidoc/python/source/conf.py

MAKE_ARGS=		ENABLE_PYTHON=0
			MANDIR="{{MANPREFIX}}/man"
			PREFIX="{{PREFIX}}"
			USER_CFLAGS="{{CFLAGS}}"
			USER_LDFLAGS="{{LDFLAGS}}"
SINGLE_JOB=		yes

CFLAGS=			-I{{NCURSESINC}}

post-install:
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/toxic

pre-configure:
	${REINPLACE_CMD} \
		-e 's|LIBS = python3|LIBS = python-${PYTHON_VER}|' \
		${WRKSRC}/cfg/checks/python.mk
	# log the build
	${REINPLACE_CMD} -e '/@.[(]CC[)]/ s|@||' ${WRKSRC}/Makefile

[FILE:63:descriptions/desc.primary]
Toxic is a Tox-based instant messenging and video chat client.


[FILE:112:distinfo]
56cedc37b22a1411c68fd8b395f40f515d6a4779be02540c5cd495665caa127c      1246436 tox/JFreegman-toxic-0.15.1.tar.gz


[FILE:293:manifests/plist.primary]
bin/toxic
share/applications/toxic.desktop
share/toxic/
 nameservers
 toxic.conf.example
share/toxic/sounds/
 ToxicContactOffline.wav
 ToxicContactOnline.wav
 ToxicError.wav
 ToxicIncomingCall.wav
 ToxicOutgoingCall.wav
 ToxicRecvMessage.wav
 ToxicTransferComplete.wav
 ToxicTransferStart.wav


[FILE:51:manifests/plist.man]
share/man/man1/toxic.1
share/man/man5/toxic.conf.5


[FILE:855:patches/patch-Makefile]
--- Makefile.orig	2024-03-29 18:32:19 UTC
+++ Makefile
@@ -3,7 +3,7 @@ CFG_DIR = $(BASE_DIR)/cfg
 
 -include $(CFG_DIR)/global_vars.mk
 
-LIBS = toxcore ncursesw libconfig libcurl
+LIBS = toxcore ncurses libconfig libcurl
 
 CFLAGS ?= -std=c11 -pthread -Wall -Wpedantic -Wunused -fstack-protector-all -Wvla -Wno-missing-braces -Wmissing-prototypes -Wcast-align -Wcast-qual -Wmissing-declarations -Wshadow -Wunused-macros -Wformat-nonliteral -Wno-unknown-pragmas
 CFLAGS += '-DTOXICVER="$(VERSION)"' -DHAVE_WIDECHAR -D_XOPEN_SOURCE_EXTENDED -D_FILE_OFFSET_BITS=64
@@ -42,10 +42,6 @@ ifeq ($(UNAME_S), OpenBSD)
 LIBS := $(filter-out ncursesw, $(LIBS))
 LDFLAGS += -lncursesw
 endif
-ifeq ($(UNAME_S), NetBSD)
-LIBS := $(filter-out ncursesw, $(LIBS))
-LDFLAGS += -lncursesw
-endif
 ifeq ($(UNAME_S), Darwin)
     -include $(CFG_DIR)/systems/Darwin.mk
 endif

