# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		librsvg
VERSION=		2.48.2
KEYWORDS=		graphics
VARIANTS=		standard
SDESC[standard]=	SVG vector-graphic files rendering library
HOMEPAGE=		http://live.gnome.org/LibRsvg
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		GNOME/librsvg/2.48
DISTFILE[1]=		librsvg-2.48.2.tar.xz:main
DISTFILE[2]=		librsvg-2.40.21.tar.xz:main
DF_INDEX=		1 2
SPKGS[standard]=	complete
			primary
			docs

OPTIONS_AVAILABLE=	RUSTLESS
OPTIONS_STANDARD=	RUSTLESS
OPT_ON[sunos]=		RUSTLESS

BUILDRUN_DEPENDS=	freetype:primary:standard

USES=			gettext-tools gmake png libtool pkgconfig perl:build
			python:build
GNOME_COMPONENTS=	cairo pango gdkpixbuf libxml2 introspection libcroco

DISTNAME=		generic-librsvg

LICENSE=		LGPL21+:primary
LICENSE_TERMS=		primary:{{WRKDIR}}/TERMS
LICENSE_FILE=		LGPL21+:{{WRKSRC}}/COPYING.LIB
LICENSE_SCHEME=		solo

FPC_EQUIVALENT=		graphics/librsvg2-rust

MUST_CONFIGURE=		gnu
CONFIGURE_ARGS=		--disable-vala
			--disable-Bsymbolic
			--disable-dependency-tracking
			--docdir={{STD_DOCDIR}}

INSTALL_TARGET=		install-strip
INSTALL_REQ_TOOLCHAIN=	yes
PLIST_SUB=		PORTVERSION=2.48.2
			GTK_VERSION=2.10.0

[RUSTLESS].DESCRIPTION=			Build version 2.40.21 instead (no rust)
[RUSTLESS].BUILD_DEPENDS_OFF=		rust:single:standard
[RUSTLESS].CONFIGURE_ENV_OFF=		CARGO={{LOCALBASE}}/bin/cargo
					RUSTC={{LOCALBASE}}/bin/rustc
[RUSTLESS].MAKEFILE_OFF=		VAR1=2.48.2
					SOVERSION=2.47.0
[RUSTLESS].MAKEFILE_ON=			VAR1=2.40.21
					SOVERSION=2.40.21
[RUSTLESS].MAKE_ENV_OFF=		RUSTC={{LOCALBASE}}/bin/rustc

post-patch-RUSTLESS-ON:
	# extract license terms
	${AWK} '/RSVG_H/ {exit}; {print}' ${WRKSRC}/rsvg.h > ${WRKDIR}/TERMS
	# disable gtk3 check
	${REINPLACE_CMD} -e 's|GTK3_REQUIRED=3.[0-9][0-9].[0-9]|GTK3_REQUIRED=9.90.0|g' \
		${WRKSRC}/configure

pre-configure-RUSTLESS-OFF:
	cd ${WRKSRC} && ${SETENV} ${CONFIGURE_ENV} \
		${LOCALBASE}/bin/cargo update

post-install:
	${MKDIR} ${STAGEDIR}${STD_DOCDIR}
	${MV} ${STAGEDIR}${PREFIX}/share/gtk-doc/html/rsvg-2.0 \
		${STAGEDIR}${STD_DOCDIR}/html
	${RM} -r ${STAGEDIR}${PREFIX}/share/gtk-doc

post-patch-RUSTLESS-OFF:
	# extract license terms
	${AWK} '/RSVG_H/ {exit}; {print}' ${WRKSRC}/librsvg/rsvg.h > ${WRKDIR}/TERMS
	# disable vendor checksums
	${REINPLACE_CMD} -e 's/"files":{[^}]*}/"files":{}/' \
		${WRKSRC}/vendor/*/.cargo-checksum.json

post-extract:
	${MV} ${WRKDIR}/librsvg-${VAR1} ${WRKSRC}

[FILE:316:descriptions/desc.primary]
The librsvg library is a lightweight library for parsing and rendering
vector-graphic files in SVG format (like the ones made by sodipodi).  It
also includes functions that render anti-aliased fonts using freetype,
including caching of glyphs.  It is used by Nautilus for drawing vector
icons and anti-aliased text.


[FILE:201:distinfo]
272658a0e04fce21eb1368c345cc1305bfeada4ca6d7db99e77323ed0668bdca     13125500 librsvg-2.48.2.tar.xz
f7628905f1cada84e87e2b14883ed57d8094dca3281d5bcb24ece4279e9a92ba      1655860 librsvg-2.40.21.tar.xz


[FILE:906:manifests/plist.primary]
%%RUSTLESS-OFF%%share/locale/es/LC_MESSAGES/librsvg.mo
%%RUSTLESS-ON%%include/librsvg-2.0/librsvg/librsvg-enum-types.h
bin/rsvg-convert
include/librsvg-2.0/librsvg/
 librsvg-features.h
 rsvg-cairo.h
 rsvg.h
lib/
 librsvg-2.a
 librsvg-2.so
 librsvg-2.so.%%SOMAJOR%%
 librsvg-2.so.%%SOVERSION%%
lib/gdk-pixbuf-2.0/%%GTK_VERSION%%/loaders/
 libpixbufloader-svg.a
 libpixbufloader-svg.so
lib/girepository-1.0/Rsvg-2.0.typelib
lib/pkgconfig/librsvg-2.0.pc
share/gir-1.0/Rsvg-2.0.gir
share/man/man1/rsvg-convert.1.gz
share/thumbnailers/librsvg.thumbnailer
@postexec %D/bin/gdk-pixbuf-query-loaders > /dev/null 2>&1 && %D/bin/gdk-pixbuf-query-loaders > %D/lib/gdk-pixbuf-2.0/%%GTK_VERSION%%/loaders.cache 2>/dev/null || /usr/bin/true
@postunexec %D/bin/gdk-pixbuf-query-loaders > /dev/null 2>&1 && %D/bin/gdk-pixbuf-query-loaders > %D/lib/gdk-pixbuf-2.0/%%GTK_VERSION%%/loaders.cache 2>/dev/null || /usr/bin/true


[FILE:609:manifests/plist.docs]
%%RUSTLESS-OFF%%share/doc/librsvg/
 COMPILING.md
 CONTRIBUTING.md
 README.md
 code-of-conduct.md
%%RUSTLESS-OFF%%share/doc/librsvg/html/
 ch01.html
 ch02.html
 recommendations-assets.html
share/doc/librsvg/html/
 RsvgHandle.html
 annotation-glossary.html
 api-index-full.html
 home.png
 index.html
 left-insensitive.png
 left.png
 licence.html
 object-tree.html
 right-insensitive.png
 right.png
 rsvg-2.0.devhelp2
 rsvg-Using-RSVG-with-GIO.html
 rsvg-Using-RSVG-with-GdkPixbuf.html
 rsvg-Using-RSVG-with-cairo.html
 rsvg-Version-check-and-feature-tests.html
 rsvg.html
 style.css
 up-insensitive.png
 up.png

