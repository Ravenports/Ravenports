# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		upower
VERSION=		0.99.11
REVISION=		1
KEYWORDS=		sysutils
VARIANTS=		standard
SDESC[standard]=	D-Bus daemon for power management tasks
HOMEPAGE=		https://upower.freedesktop.org
CONTACT=		Michael_Reim[kraileth@elderlinux.org]

DOWNLOAD_GROUPS=	main
SITES[main]=		https://upower.freedesktop.org/releases/
DISTFILE[1]=		upower-0.99.11.tar.xz:main
DF_INDEX=		1
SPKGS[standard]=	complete
			primary
			docs

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILD_DEPENDS=		automake:single:standard
			autoconf:single:standard
			docbook-xsl:primary:standard
			gobject-introspection:single:standard
			gtk-doc:single:standard
			libtool:single:standard
BUILDRUN_DEPENDS=	dbus-glib:primary:standard
			polkit:single:standard

USES=			gettext-tools:build gettext-runtime gmake libtool
			pkgconfig python:build
GNOME_COMPONENTS=	glib intltool

LICENSE=		GPLv2+:primary
LICENSE_TERMS=		primary:{{WRKDIR}}/TERMS
LICENSE_FILE=		GPLv2+:{{WRKSRC}}/COPYING
LICENSE_AWK=		TERMS:"^$$"
LICENSE_SOURCE=		TERMS:{{WRKSRC}}/src/up-native.h
LICENSE_SCHEME=		solo

FPC_EQUIVALENT=		sysutils/upower

MUST_CONFIGURE=		gnu
CONFIGURE_ARGS=		--enable-gtk-doc
			--without-idevice

INSTALL_TARGET=		install-strip
SOVERSION=		3.0.1

CFLAGS=			-Wno-deprecated-declarations
VAR_OPSYS[freebsd]=	CONFIGURE_ARGS=--with-backend=freebsd
VAR_OPSYS[linux]=	CONFIGURE_ARGS=--with-backend=dummy

post-patch:
	${REINPLACE_CMD} -e 's|docbook.sourceforge.net|cdn.docbook.org|g' \
		${WRKSRC}/doc/man/Makefile.in

post-stage:
	${MV} ${STAGEDIR}${PREFIX}/share/gtk-doc/html/UPower \
		${STAGEDIR}${PREFIX}/share/doc
	${RM} -r ${STAGEDIR}${PREFIX}/share/gtk-doc
	${RM} -r ${STAGEDIR}/var

post-patch-sunos:
	${REINPLACE_CMD} -e '/as-needed/ s/^.*$$/NOOP=1/' ${WRKSRC}/configure

[FILE:863:descriptions/desc.primary]
UPower is an abstraction for enumerating power devices, listening to 
device events and querying history and statistics. Any application or 
service on the system can access the org.freedesktop.UPower service via 
the system message bus. Some operations (such as suspending the system) 
are restricted using PolicyKit.

UPower was once called DeviceKit-power. UPower aims to make a large chunk 
of HAL redundant, as HAL is officially deprecated.

UPower is also useful to control the latency of different operations on 
your computer, which enables you to save significant amounts of power. 
Nothing much uses this interface yet, but this is a classic chicken and 
egg scenario, and I think it's important to encourage the egg to lay a 
chicken. Please report any problems to the Freedesktop bugzilla or send a 
mail to the DeviceKit mailing list for discussion.


[FILE:100:distinfo]
64b5ffbfccd5bdb15d925777979a4dbee1a957f9eaeb158dc76175267eddbdef       430128 upower-0.99.11.tar.xz


[FILE:944:manifests/plist.primary]
bin/upower
etc/UPower/UPower.conf
include/libupower-glib/
 up-autocleanups.h
 up-client.h
 up-device.h
 up-history-item.h
 up-stats-item.h
 up-types.h
 up-version.h
 up-wakeup-item.h
 up-wakeups.h
 upower.h
lib/
 libupower-glib.a
 libupower-glib.so
 libupower-glib.so.%%SOMAJOR%%
 libupower-glib.so.%%SOVERSION%%
lib/girepository-1.0/UPowerGlib-1.0.typelib
lib/pkgconfig/upower-glib.pc
libexec/upowerd
share/dbus-1/interfaces/
 org.freedesktop.UPower.Device.xml
 org.freedesktop.UPower.KbdBacklight.xml
 org.freedesktop.UPower.Wakeups.xml
 org.freedesktop.UPower.xml
share/dbus-1/system-services/org.freedesktop.UPower.service
share/dbus-1/system.d/org.freedesktop.UPower.conf
share/gir-1.0/UPowerGlib-1.0.gir
share/locale/fr/LC_MESSAGES/upower.mo
share/locale/it/LC_MESSAGES/upower.mo
share/locale/pl/LC_MESSAGES/upower.mo
share/locale/sv/LC_MESSAGES/upower.mo
share/man/man1/upower.1.gz
share/man/man7/UPower.7.gz
share/man/man8/upowerd.8.gz


[FILE:583:manifests/plist.docs]
share/doc/UPower/
 UPower-up-types.html
 UPower-up-version.html
 UPower-up-wakeups.html
 UpClient.html
 UpDevice.html
 UpHistoryItem.html
 UpStatsItem.html
 UpWakeupItem.html
 annotation-glossary.html
 api-index-0-9-0.html
 api-index-0-9-1.html
 api-index-0-9-19.html
 api-index-0-9-2.html
 api-index-0-9-22.html
 api-index-0-99-5.html
 api-index-0-99-8.html
 api-index-1-0.html
 api-index-full.html
 ch01.html
 deprecated-api-index.html
 home.png
 index.html
 left-insensitive.png
 left.png
 object-tree.html
 right-insensitive.png
 right.png
 style.css
 up-insensitive.png
 up.png


[FILE:394:patches/patch-doc_man_Makefile.am]
--- doc/man/Makefile.am.orig	2019-03-05 14:18:32 UTC
+++ doc/man/Makefile.am
@@ -6,7 +6,7 @@ man_MANS = 				\
 	UPower.7
 
 %.1 %.7 %.8 : %.xml
-	$(XSLTPROC) -nonet http://docbook.sourceforge.net/release/xsl/current/manpages/docbook.xsl $<
+	$(XSLTPROC) -nonet --path __DBPATH__ http://docbook.sourceforge.net/release/xsl/current/manpages/docbook.xsl $<
 
 MAINTAINERCLEANFILES = $(man_MANS)
 


[FILE:363:freebsd/patch-src_freebsd_up-devd.c]
--- src/freebsd/up-devd.c.orig	2019-03-05 14:18:32 UTC
+++ src/freebsd/up-devd.c
@@ -195,7 +195,7 @@ up_devd_event_cb (GIOChannel *source, GI
 		event[terminator] = 0;
 		up_devd_process_event(event, user_data);
 		g_free(event);
-	} else if (status == G_IO_STATUS_AGAIN) {
+	} else {
 		up_devd_init (UP_BACKEND(user_data));
 		if (up_devd_inited) {
 			int fd;

