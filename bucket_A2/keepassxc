# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		keepassxc
VERSION=		2.4.3
KEYWORDS=		security
VARIANTS=		standard
SDESC[standard]=	Community fork of the KeePassX password manager
HOMEPAGE=		https://keepassxc.org
CONTACT=		Michael_Reim[kraileth@elderlinux.org]

DOWNLOAD_GROUPS=	main
SITES[main]=		https://github.com/keepassxreboot/keepassxc/releases/download/2.4.3/
DISTFILE[1]=		keepassxc-2.4.3-src.tar.xz:main
DF_INDEX=		1
SPKGS[standard]=	single

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILDRUN_DEPENDS=	argon2:single:standard
			qt5-qtbase:primary:standard
			qt5-qttools:single:standard
			qt5-qtsvg:single:standard
			qt5-qtx11extras:single:standard
			qrencode:single:standard
			libsodium:single:standard

USES=			cmake pkgconfig qt5 desktop-utils:single
			mime-info:single

LICENSE=		GPLv2:single GPLv3:single BSD3CLAUSE:single
			MIT:single LGPL20:single LGPL21:single LGPL3+:single
			CUSTOM1:single CUSTOM2:single
LICENSE_TERMS=		single:{{WRKSRC}}/COPYING
LICENSE_NAME=		CUSTOM1:"Boost Software License 1.0"
			CUSTOM2:"Nokia LGPL exception"
LICENSE_FILE=		GPLv2:{{WRKSRC}}/LICENSE.GPL-2
			GPLv3:{{WRKSRC}}/LICENSE.GPL-3
			BSD3CLAUSE:{{WRKSRC}}/LICENSE.BSD
			MIT:{{WRKSRC}}/LICENSE.MIT
			LGPL20:stock
			LGPL21:{{WRKSRC}}/LICENSE.LGPL-2.1
			LGPL3+:{{WRKSRC}}/LICENSE.LGPL-3
			CUSTOM1:{{WRKSRC}}/LICENSE.BOOST-1.0
			CUSTOM2:{{WRKSRC}}/LICENSE.NOKIA-LGPL-EXCEPTION
LICENSE_SCHEME=		multi

FPC_EQUIVALENT=		security/keepassxc

post-patch:
	${REINPLACE_CMD} -e "s|__PREFIX__|${PREFIX}|" \
		${WRKSRC}/CMakeLists.txt \
		${WRKSRC}/src/autotype/CMakeLists.txt

post-install:
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/keepassxc
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/keepassxc-cli
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/lib/keepassxc/libkeepassx-autotype-xcb.so

do-install:
	(cd ${WRKDIR}/.build ; \
	make DESTDIR=${STAGEDIR} install)

[FILE:260:descriptions/desc.single]
KeePassXC is a community fork of KeePassX, a native cross-platform port of 
KeePass Password Safe, with the goal to extend and improve it with new 
features and bugfixes to provide a feature-rich, fully cross-platform and 
modern open-source password manager.


[FILE:105:distinfo]
d7c952192131047689c3f8fb7275df0e0dfbf2094a554dbbee9a6d6cfa8f2734      3301944 keepassxc-2.4.3-src.tar.xz


[FILE:7509:manifests/plist.single]
bin/
 keepassxc
 keepassxc-cli
lib/keepassxc/libkeepassx-autotype-xcb.so
share/applications/org.keepassxc.KeePassXC.desktop
share/icons/hicolor/128x128/apps/
 keepassxc-dark.png
 keepassxc-locked.png
 keepassxc-unlocked.png
 keepassxc.png
share/icons/hicolor/128x128/mimetypes/application-x-keepassxc.png
share/icons/hicolor/16x16/apps/
 keepassxc-dark.png
 keepassxc-locked.png
 keepassxc-unlocked.png
 keepassxc.png
share/icons/hicolor/16x16/mimetypes/application-x-keepassxc.png
share/icons/hicolor/22x22/mimetypes/application-x-keepassxc.png
share/icons/hicolor/24x24/apps/
 keepassxc-dark.png
 keepassxc-locked.png
 keepassxc-unlocked.png
 keepassxc.png
share/icons/hicolor/256x256/apps/
 keepassxc-dark.png
 keepassxc-locked.png
 keepassxc-unlocked.png
 keepassxc.png
share/icons/hicolor/32x32/apps/
 keepassxc-dark.png
 keepassxc-locked.png
 keepassxc-unlocked.png
 keepassxc.png
share/icons/hicolor/32x32/mimetypes/application-x-keepassxc.png
share/icons/hicolor/48x48/apps/
 keepassxc-dark.png
 keepassxc-locked.png
 keepassxc-unlocked.png
 keepassxc.png
share/icons/hicolor/64x64/apps/
 keepassxc-dark.png
 keepassxc-locked.png
 keepassxc-unlocked.png
 keepassxc.png
share/icons/hicolor/64x64/mimetypes/application-x-keepassxc.png
share/icons/hicolor/scalable/apps/
 keepassxc-dark.svg
 keepassxc-locked.svg
 keepassxc-unlocked.svg
 keepassxc.svg
share/icons/hicolor/scalable/mimetypes/application-x-keepassxc.svg
share/keepassxc/icons/application/128x128/apps/
 keepassxc-dark.png
 keepassxc-locked.png
 keepassxc-unlocked.png
 keepassxc.png
 preferences-system-network-sharing.png
share/keepassxc/icons/application/128x128/mimetypes/application-x-keepassxc.png
share/keepassxc/icons/application/16x16/actions/
 application-exit.png
 auto-type.png
 configure.png
 database-change-key.png
 document-close.png
 document-edit.png
 document-encrypt.png
 document-new.png
 document-open.png
 document-save-as.png
 document-save.png
 edit-clear-locationbar-ltr.png
 edit-clear-locationbar-rtl.png
 entry-clone.png
 entry-delete.png
 entry-edit.png
 entry-new.png
 favicon-download.png
 group-delete.png
 group-edit.png
 group-empty-trash.png
 group-new.png
 help-about.png
 message-close.png
 paperclip.png
 password-copy.png
 password-generate.png
 password-generator.png
 password-show-off.png
 password-show-on.png
 system-help.png
 system-search.png
 url-copy.png
 username-copy.png
share/keepassxc/icons/application/16x16/apps/
 keepassxc-dark.png
 keepassxc-locked.png
 keepassxc-unlocked.png
 keepassxc.png
share/keepassxc/icons/application/16x16/mimetypes/application-x-keepassxc.png
share/keepassxc/icons/application/22x22/actions/
 auto-type.png
 chronometer.png
 database-change-key.png
 dialog-close.png
 dialog-ok.png
 document-encrypt.png
 document-new.png
 document-open.png
 document-save.png
 entry-clone.png
 entry-delete.png
 entry-edit.png
 entry-new.png
 favicon-download.png
 group-empty-trash.png
 help-about.png
 message-close.png
 paperclip.png
 password-copy.png
 password-generate.png
 password-generator.png
 system-help.png
 system-search.png
 url-copy.png
 username-copy.png
share/keepassxc/icons/application/22x22/mimetypes/application-x-keepassxc.png
share/keepassxc/icons/application/22x22/status/
 dialog-error.png
 dialog-information.png
 dialog-warning.png
share/keepassxc/icons/application/24x24/apps/
 keepassxc-dark.png
 keepassxc-locked.png
 keepassxc-unlocked.png
 keepassxc.png
share/keepassxc/icons/application/256x256/apps/
 keepassxc-dark.png
 keepassxc-locked.png
 keepassxc-unlocked.png
 keepassxc.png
share/keepassxc/icons/application/32x32/actions/
 application-exit.png
 auto-type.png
 chronometer.png
 configure.png
 database-change-key.png
 dialog-close.png
 dialog-ok.png
 document-close.png
 document-edit.png
 document-encrypt.png
 document-new.png
 document-open.png
 document-properties.png
 document-save.png
 edit-clear-locationbar-ltr.png
 edit-clear-locationbar-rtl.png
 entry-clone.png
 entry-delete.png
 entry-edit.png
 entry-new.png
 favicon-download.png
 group-empty-trash.png
 help-about.png
 key-enter.png
 paperclip.png
 password-copy.png
 password-generate.png
 password-generator.png
 password-show-off.png
 password-show-on.png
 system-help.png
 system-search.png
 url-copy.png
 username-copy.png
 view-history.png
share/keepassxc/icons/application/32x32/apps/
 internet-web-browser.png
 keepassxc-dark.png
 keepassxc-locked.png
 keepassxc-unlocked.png
 keepassxc.png
 preferences-desktop-icons.png
 utilities-terminal.png
share/keepassxc/icons/application/32x32/categories/preferences-other.png
share/keepassxc/icons/application/32x32/mimetypes/application-x-keepassxc.png
share/keepassxc/icons/application/32x32/status/security-high.png
share/keepassxc/icons/application/48x48/apps/
 keepassxc-dark.png
 keepassxc-locked.png
 keepassxc-unlocked.png
 keepassxc.png
share/keepassxc/icons/application/64x64/apps/
 keepassxc-dark.png
 keepassxc-locked.png
 keepassxc-unlocked.png
 keepassxc.png
share/keepassxc/icons/application/64x64/mimetypes/application-x-keepassxc.png
share/keepassxc/icons/application/scalable/apps/
 keepassxc-dark.svg
 keepassxc-locked.svg
 keepassxc-unlocked.svg
 keepassxc.svg
share/keepassxc/icons/application/scalable/mimetypes/application-x-keepassxc.svg
share/keepassxc/icons/database/
 C00_Password.png
 C01_Package_Network.png
 C02_MessageBox_Warning.png
 C03_Server.png
 C04_Klipper.png
 C05_Edu_Languages.png
 C06_KCMDF.png
 C07_Kate.png
 C08_Socket.png
 C09_Identity.png
 C10_Kontact.png
 C11_Camera.png
 C12_IRKickFlash.png
 C13_KGPG_Key3.png
 C14_Laptop_Power.png
 C15_Scanner.png
 C16_Mozilla_Firebird.png
 C17_CDROM_Unmount.png
 C18_Display.png
 C19_Mail_Generic.png
 C20_Misc.png
 C21_KOrganizer.png
 C22_ASCII.png
 C23_Icons.png
 C24_Connect_Established.png
 C25_Folder_Mail.png
 C26_FileSave.png
 C27_NFS_Unmount.png
 C28_QuickTime.png
 C29_KGPG_Term.png
 C30_Konsole.png
 C31_FilePrint.png
 C32_FSView.png
 C33_Run.png
 C34_Configure.png
 C35_KRFB.png
 C36_Ark.png
 C37_KPercentage.png
 C38_Samba_Unmount.png
 C39_History.png
 C40_Mail_Find.png
 C41_VectorGfx.png
 C42_KCMMemory.png
 C43_EditTrash.png
 C44_KNotes.png
 C45_Cancel.png
 C46_Help.png
 C47_KPackage.png
 C48_Folder.png
 C49_Folder_Blue_Open.png
 C50_Folder_Tar.png
 C51_Decrypted.png
 C52_Encrypted.png
 C53_Apply.png
 C54_Signature.png
 C55_Thumbnail.png
 C56_KAddressBook.png
 C57_View_Text.png
 C58_KGPG.png
 C59_Package_Development.png
 C60_KFM_Home.png
 C61_Services.png
 C62_Tux.png
 C63_Feather.png
 C64_Apple.png
 C65_W.png
 C66_Money.png
 C67_Certificate.png
 C68_BlackBerry.png
share/keepassxc/translations/
 keepassx_ar.qm
 keepassx_bn.qm
 keepassx_ca.qm
 keepassx_cs.qm
 keepassx_da.qm
 keepassx_de.qm
 keepassx_el.qm
 keepassx_en_GB.qm
 keepassx_en_US.qm
 keepassx_es.qm
 keepassx_eu.qm
 keepassx_fi.qm
 keepassx_fr.qm
 keepassx_he.qm
 keepassx_hr_HR.qm
 keepassx_hu.qm
 keepassx_id.qm
 keepassx_is_IS.qm
 keepassx_it.qm
 keepassx_ja.qm
 keepassx_kk.qm
 keepassx_ko.qm
 keepassx_la.qm
 keepassx_lt.qm
 keepassx_lv.qm
 keepassx_nb.qm
 keepassx_nl_NL.qm
 keepassx_pl.qm
 keepassx_pt.qm
 keepassx_pt_BR.qm
 keepassx_pt_PT.qm
 keepassx_ro.qm
 keepassx_ru.qm
 keepassx_sk.qm
 keepassx_sl_SI.qm
 keepassx_sr.qm
 keepassx_sv.qm
 keepassx_th.qm
 keepassx_tr.qm
 keepassx_uk.qm
 keepassx_zh_CN.qm
 keepassx_zh_TW.qm
share/keepassxc/wizard/background-pixmap.png
share/keepassxc/wordlists/eff_large.wordlist
share/man/man1/keepassxc-cli.1.gz
share/metainfo/org.keepassxc.KeePassXC.appdata.xml
share/mime/packages/keepassxc.xml


[FILE:655:patches/patch-CMakeLists.txt]
--- CMakeLists.txt.orig	2019-05-31 20:03:47 UTC
+++ CMakeLists.txt
@@ -346,7 +346,7 @@ include(CLangFormat)
 
 set(QT_COMPONENTS Core Network Concurrent Gui Svg Widgets Test LinguistTools)
 if(UNIX AND NOT APPLE)
-    find_package(Qt5 COMPONENTS ${QT_COMPONENTS} DBus REQUIRED)
+    find_package(Qt5 COMPONENTS ${QT_COMPONENTS} DBus REQUIRED HINTS /__PREFIX__/lib/qt5/cmake ENV PATH)
 elseif(APPLE)
     find_package(Qt5 COMPONENTS ${QT_COMPONENTS} REQUIRED HINTS /usr/local/opt/qt/lib/cmake /usr/local/Cellar/qt/*/lib/cmake ENV PATH)
     find_package(Qt5 COMPONENTS MacExtras HINTS /usr/local/opt/qt/lib/cmake /usr/local/Cellar/qt/*/lib/cmake ENV PATH)


[FILE:568:patches/patch-src_autotype_CMakeLists.txt]
--- src/autotype/CMakeLists.txt.orig	2019-05-31 20:03:47 UTC
+++ src/autotype/CMakeLists.txt
@@ -1,7 +1,7 @@
 if(WITH_XC_AUTOTYPE)
     if(UNIX AND NOT APPLE AND NOT HAIKU)
         find_package(X11)
-        find_package(Qt5X11Extras 5.2)
+        find_package(Qt5X11Extras 5.2 HINTS /__PREFIX__/lib/qt5/cmake ENV PATH)
         if(PRINT_SUMMARY)
             add_feature_info(libXi X11_Xi_FOUND "The X11 Xi Protocol library is required for auto-type")
             add_feature_info(libXtst X11_XTest_FOUND "The X11 XTEST Protocol library is required for auto-type")


[FILE:600:patches/patch-src_core_Alloc.cpp]
--- src/core/Alloc.cpp.orig	2019-05-31 20:03:47 UTC
+++ src/core/Alloc.cpp
@@ -21,7 +21,7 @@
 #ifdef Q_OS_MACOS
 #include <malloc/malloc.h>
 #else
-#include <malloc.h>
+#include <stdlib.h>
 #endif
 
 #if defined(NDEBUG) && !defined(__cpp_sized_deallocation)
@@ -61,8 +61,6 @@ void operator delete(void* ptr) noexcept
     ::operator delete(ptr, _msize(ptr));
 #elif defined(Q_OS_MACOS)
     ::operator delete(ptr, malloc_size(ptr));
-#elif defined(Q_OS_UNIX)
-    ::operator delete(ptr, malloc_usable_size(ptr));
 #else
     // whatever OS this is, give up and simply free stuff
     std::free(ptr);

