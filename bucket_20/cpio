# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		cpio
VERSION=		2.13
KEYWORDS=		archivers
VARIANTS=		standard
SDESC[standard]=	Utility that copies files to or from archives
HOMEPAGE=		https://www.gnu.org/software/cpio/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		GNU/cpio
DISTFILE[1]=		cpio-2.13.tar.bz2:main
DF_INDEX=		1
SPKGS[standard]=	complete
			primary
			nls

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

USES=			cpe gettext

INFO=			primary:cpio
CPE_VENDOR=		gnu
FPC_EQUIVALENT=		archivers/gcpio
INFO_SUBDIR=		.

MUST_CONFIGURE=		gnu
CONFIGURE_ARGS=		--with-rmt=/etc/rmt
			--enable-nls

[FILE:601:descriptions/desc.primary]
GNU cpio copies files into or out of a cpio or tar archive. The archive
can be another file on the disk, a magnetic tape, or a pipe.

GNU cpio supports the following archive formats: binary, old ASCII, new
ASCII, crc, HPUX binary, HPUX old ASCII, old tar, and POSIX.1 tar. The
tar format is provided for compatibility with the tar program. By default,
cpio creates binary format archives, for compatibility with older cpio
programs. When extracting from archives, cpio automatically recognizes
which kind of archive it is reading and can read archives created on
machines with a different byte-order.


[FILE:96:distinfo]
eab5bdc5ae1df285c59f2a4f140a98fc33678a0bf61bdba67d9436ae26b46f6d      1354559 cpio-2.13.tar.bz2


[FILE:34:manifests/plist.primary]
bin/cpio
share/man/man1/cpio.1.gz


[FILE:945:manifests/plist.nls]
share/locale/da/LC_MESSAGES/cpio.mo
share/locale/de/LC_MESSAGES/cpio.mo
share/locale/es/LC_MESSAGES/cpio.mo
share/locale/fi/LC_MESSAGES/cpio.mo
share/locale/fr/LC_MESSAGES/cpio.mo
share/locale/ga/LC_MESSAGES/cpio.mo
share/locale/gl/LC_MESSAGES/cpio.mo
share/locale/hr/LC_MESSAGES/cpio.mo
share/locale/hu/LC_MESSAGES/cpio.mo
share/locale/id/LC_MESSAGES/cpio.mo
share/locale/it/LC_MESSAGES/cpio.mo
share/locale/ja/LC_MESSAGES/cpio.mo
share/locale/ko/LC_MESSAGES/cpio.mo
share/locale/nl/LC_MESSAGES/cpio.mo
share/locale/pl/LC_MESSAGES/cpio.mo
share/locale/pt/LC_MESSAGES/cpio.mo
share/locale/pt_BR/LC_MESSAGES/cpio.mo
share/locale/ro/LC_MESSAGES/cpio.mo
share/locale/ru/LC_MESSAGES/cpio.mo
share/locale/sr/LC_MESSAGES/cpio.mo
share/locale/sv/LC_MESSAGES/cpio.mo
share/locale/tr/LC_MESSAGES/cpio.mo
share/locale/uk/LC_MESSAGES/cpio.mo
share/locale/vi/LC_MESSAGES/cpio.mo
share/locale/zh_CN/LC_MESSAGES/cpio.mo
share/locale/zh_TW/LC_MESSAGES/cpio.mo


[FILE:375:patches/patch-gnu_Makefile.in]
--- gnu/Makefile.in.orig	2019-11-06 07:29:32 UTC
+++ gnu/Makefile.in
@@ -2129,7 +2129,7 @@ inttypes.h: inttypes.in.h $(top_builddir
 # avoid installing it.
 
 all-local: charset.alias ref-add.sed ref-del.sed
-install-exec-local: install-exec-localcharset
+install-exec-local:
 install-exec-localcharset: all-local
 	if test $(GLIBC21) = no; then \
 	  case '$(host_os)' in \


[FILE:386:patches/patch-src_global.c]
--- src/global.c.orig	2019-11-03 15:07:23 UTC
+++ src/global.c
@@ -184,9 +184,6 @@ unsigned int warn_option = 0;
 /* Extract to standard output? */
 bool to_stdout_option = false;
 
-/* The name this program was run with.  */
-char *program_name;
-
 /* A pointer to either lstat or stat, depending on whether
    dereferencing of symlinks is done for input files.  */
 int (*xstat) ();


[FILE:740:patches/patch-src_util.c]
https://git.savannah.gnu.org/cgit/cpio.git/commit/?id=df55fb19be545e22d023950263ed5d0756edf81e

--- src/util.c.orig	2019-11-03 15:07:23 UTC
+++ src/util.c
@@ -1140,8 +1140,16 @@ stat_to_cpio (struct cpio_file_stat *hdr
   hdr->c_nlink = st->st_nlink;
   hdr->c_uid = CPIO_UID (st->st_uid);
   hdr->c_gid = CPIO_GID (st->st_gid);
-  hdr->c_rdev_maj = major (st->st_rdev);
-  hdr->c_rdev_min = minor (st->st_rdev);
+  if (S_ISBLK (st->st_mode) || S_ISCHR (st->st_mode))
+    {
+      hdr->c_rdev_maj = major (st->st_rdev);
+      hdr->c_rdev_min = minor (st->st_rdev);
+    }
+  else
+    {
+      hdr->c_rdev_maj = 0;
+      hdr->c_rdev_min = 0;
+    }
   hdr->c_mtime = st->st_mtime;
   hdr->c_filesize = st->st_size;
   hdr->c_chksum = 0;


[FILE:433:patches/patch-tests_symlink-bad-length.at]
--- tests/symlink-bad-length.at.orig	2017-01-02 12:45:58 UTC
+++ tests/symlink-bad-length.at
@@ -44,7 +44,7 @@ AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
 # but that could hurt backward compatibility.
 
 AT_CHECK([
-base64 -d ARCHIVE.base64 > ARCHIVE || AT_SKIP_TEST
+b64decode -r ARCHIVE.base64 > ARCHIVE || AT_SKIP_TEST
 TZ=UTC cpio -ntv < ARCHIVE 2>stderr 
 cat stderr | grep -v \
     -e 'stored filename length is out of range' \

