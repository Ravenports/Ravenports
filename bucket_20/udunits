# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		udunits
VERSION=		2.2.28
REVISION=		1
KEYWORDS=		science
VARIANTS=		standard
SDESC[standard]=	Library for manipulating physical quantity units
HOMEPAGE=		https://www.unidata.ucar.edu/software/udunits/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		https://artifacts.unidata.ucar.edu/repository/downloads-udunits/
DISTFILE[1]=		udunits-2.2.28.tar.gz:main
DF_INDEX=		1
SPKGS[standard]=	complete
			primary
			docs

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

USES=			expat libtool makeinfo

LICENSE=		CUSTOM1:primary
LICENSE_NAME=		CUSTOM1:"University Corporation for Atmospheric Research/Unidata"
LICENSE_FILE=		CUSTOM1:{{WRKSRC}}/COPYRIGHT
LICENSE_SCHEME=		solo

INFO=			primary:udunits2
			primary:udunits2lib
			primary:udunits2prog
FPC_EQUIVALENT=		science/udunits
INFO_SUBDIR=		.

MUST_CONFIGURE=		gnu
CONFIGURE_ENV=		ac_cv_header_CUnit_CUnit_h=no

INSTALL_TARGET=		install-strip
SOVERSION=		0.1.0

CFLAGS=			-std=c17
VAR_OPSYS[netbsd]=	CONFIGURE_ENV=ac_cv_lib_dl_dlopen=no

post-install:
	${RM} ${STAGEDIR}${STD_DOCDIR}/COPYRIGHT

[FILE:230:descriptions/desc.primary]
The Unidata units library, udunits, supports conversion of unit
specifications between formatted and binary forms, arithmetic
manipulation of unit specifications, and conversion of values between
compatible scales of measurement.


[FILE:100:distinfo]
590baec83161a3fd62c00efa66f6113cec8a7c461e3f61a5182167e0cc5d579e      1224503 udunits-2.2.28.tar.gz


[FILE:289:manifests/plist.primary]
bin/udunits2
include/
 converter.h
 udunits.h
 udunits2.h
lib/
 libudunits2.a
 libudunits2.so
 libudunits2.so.%%SOMAJOR%%
 libudunits2.so.%%SOVERSION%%
share/udunits/
 udunits2-accepted.xml
 udunits2-base.xml
 udunits2-common.xml
 udunits2-derived.xml
 udunits2-prefixes.xml
 udunits2.xml


[FILE:161:manifests/plist.docs]
share/doc/udunits/
 CHANGE_LOG
 README
 udunits2-derived.xml
 udunits2-accepted.xml
 udunits2-common.xml
 udunits2-base.xml
 udunits2-prefixes.xml
 udunits2.xml


[FILE:864:patches/patch-lib_xml.c]
--- lib/xml.c.orig	2020-12-07 18:37:03 UTC
+++ lib/xml.c
@@ -38,7 +38,11 @@
 #endif
 #include <sys/stat.h>
 #include <sys/types.h>
-#if defined(__linux__)
+#if defined(__linux__) || defined(__DragonFly__) || defined(__FreeBSD__)
+#define __BSD_VISIBLE 1
+#include <dlfcn.h>
+#elif defined(__NetBSD__)
+#define _NETBSD_SOURCE
 #include <dlfcn.h>
 #elif defined(__APPLE__)
 #define _DARWIN_C_SOURCE
@@ -2137,7 +2141,7 @@ default_udunits2_xml_path()
     if (absXmlPathname[0] == 0) {
         const char* prefix = NULL; // Installation directory
 
-#       if defined(__APPLE__) || defined(__linux__)
+#       if defined(__APPLE__) || defined(__linux__) || defined(__FreeBSD__) || defined(__DragonFly__) || defined(__NetBSD__)
             Dl_info     info;
             const char  sep = '/'; // Pathname component separator
             char        buf[PATH_MAX];

