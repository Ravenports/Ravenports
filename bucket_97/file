# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		file
VERSION=		5.46
KEYWORDS=		sysutils
VARIANTS=		std ravensys
SDESC[ravensys]=	Static file type utility based at /usr
SDESC[std]=		Utility to determine file type
HOMEPAGE=		http://darwinsys.com/file
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		http://ftp.astron.com/pub/file/
DISTFILE[1]=		file-5.46.tar.gz:main
DF_INDEX=		1
SPKGS[ravensys]=	set
			primary
			dev
			man
SPKGS[std]=		set
			primary
			dev
			man

OPTIONS_AVAILABLE=	RAVENSYS
OPTIONS_STANDARD=	none
VOPTS[ravensys]=	RAVENSYS=ON

USES=			cpe libtool

LICENSE=		BSD2CLAUSE:primary
LICENSE_FILE=		BSD2CLAUSE:{{WRKSRC}}/COPYING
LICENSE_SCHEME=		solo

CPE_VENDOR=		file_project
FPC_EQUIVALENT=		sysutils/file

MUST_CONFIGURE=		gnu
CONFIGURE_ARGS=		--enable-fsect-man5
			--enable-static

MAKE_ENV=		INSTALL_STRIP_FLAG="{{STRIP}}"

INSTALL_TARGET=		install-strip

[RAVENSYS].DESCRIPTION=			Static version of file used by raven-sysroot
[RAVENSYS].CONFIGURE_ARGS_OFF=		--enable-shared=yes
[RAVENSYS].CONFIGURE_ARGS_ON=		--enable-shared=no
					--datarootdir=/usr/share
[RAVENSYS].USES_OFF=			zlib
[RAVENSYS].USES_ON=			zlib:build

post-patch:
	${REINPLACE_CMD} -e 's|$$(datadir)/misc|$$(datadir)/file|g' \
		${WRKSRC}/configure

post-install-RAVENSYS-ON:
	${MV} ${STAGEDIR}/usr/share/file ${STAGEDIR}${PREFIX}/share/
	${RMDIR} ${STAGEDIR}/usr/share
	${RMDIR} ${STAGEDIR}/usr

do-test:
	(cd ${WRKSRC} && ${SETENV} ${MAKE_ENV} ${MAKE_CMD} ${MAKE_ARGS} check)

[FILE:250:descriptions/desc.primary]
File tests each argument in an attempt to classify it. There are three sets
of tests, performed in the following order:

  - filesystem tests
  - magic number tests
  - language tests

The first test that succeeds causes the file type to be printed.


[FILE:95:distinfo]
c9cc77c7c560c543135edc555af609d5619dbef011997e988ce40a3d75d86088      1312892 file-5.46.tar.gz


[FILE:85:manifests/plist.primary]
%%RAVENSYS-OFF%%lib/
 libmagic.so.1
 libmagic.so.1.0.0
bin/file
share/file/magic.mgc


[FILE:89:manifests/plist.dev]
%%RAVENSYS-OFF%%lib/libmagic.so
include/magic.h
lib/libmagic.a
lib/pkgconfig/libmagic.pc


[FILE:71:manifests/plist.man]
share/man/man1/file.1
share/man/man3/libmagic.3
share/man/man5/magic.5


[FILE:200:dragonfly/patch-src_file.h]
--- src/file.h.orig	2022-12-26 18:00:48 UTC
+++ src/file.h
@@ -90,6 +90,7 @@
 #include <stdarg.h>
 #include <locale.h>
 #if defined(HAVE_XLOCALE_H)
+#include <wchar.h>
 #include <xlocale.h>
 #endif
 

