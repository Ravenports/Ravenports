# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		l-smash
VERSION=		2.18.0
KEYWORDS=		multimedia
VARIANTS=		standard
SDESC[standard]=	MP4 muxer and other tools
HOMEPAGE=		https://l-smash.github.io/l-smash/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		GITHUB/vimeo:l-smash:2c0696c
DISTFILE[1]=		generated:main
DF_INDEX=		1
SPKGS[standard]=	complete
			primary
			dev
			tools

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILD_DEPENDS=		obuparse:dev:standard
BUILDRUN_DEPENDS=	obuparse:primary:standard
EXRUN[tools]=		primary

USES=			gmake

LICENSE=		ISCL:primary
LICENSE_FILE=		ISCL:{{WRKSRC}}/LICENSE
LICENSE_SCHEME=		solo

FPC_EQUIVALENT=		multimedia/l-smash

MUST_CONFIGURE=		yes
CONFIGURE_ARGS=		--prefix="{{PREFIX}}"
			--cc="{{CC}}"
			--extra-cflags="{{CPPFLAGS}} {{CFLAGS}}"
			--extra-ldflags="{{LDFLAGS}}"
			--extra-libs="{{LIBS}}"
			--enable-shared

MAKE_ARGS=		STRIP="{{STRIP_CMD}}"

VAR_OPSYS[sunos]=	CPPFLAGS=-D_XOPEN_SOURCE=600

post-patch:
	${REINPLACE_CMD} -e 's/-Os //; /=.*-fexcess-precision/d' \
		-e '/sed/{s/-i/& ""/; s/i \\/&\\"$$'"'\\\n'"'"/; s/%"/&$$'"'\\\012'"'/;}' \
		${WRKSRC}/configure
	${REINPLACE_CMD} -e '/SHARED/,/^$$/ { /STRIP/s/-x //; }' \
		${WRKSRC}/${MAKEFILE}

[FILE:177:descriptions/desc.primary]
L-SMASH is a cross-platform library for dealing with ISO Base Media
derived formats, including MP4.

This is built from the vimeo fork which continues the original
development.


[FILE:58:descriptions/desc.tools]
This package contains the tools based on L-SMASH library.


[FILE:107:distinfo]
f079286f3f88947f3770a456daac896497e90ac0a6b1cfa4b13b2f52c332e72c       492637 vimeo-l-smash-2c0696c.tar.gz


[FILE:19:manifests/plist.primary]
lib/liblsmash.so.2


[FILE:76:manifests/plist.dev]
lib/pkgconfig/liblsmash.pc
include/lsmash.h
lib/
 liblsmash.a
 liblsmash.so


[FILE:48:manifests/plist.tools]
bin/
 boxdumper
 muxer
 remuxer
 timelineeditor


[FILE:221:patches/patch-configure]
--- configure.orig	2023-07-30 19:24:45 UTC
+++ configure
@@ -282,7 +282,7 @@ if test -n "$DEBUG"; then
     CFLAGS="$CFLAGS -g3 -O0"
     STRIP=""
 else
-    CFLAGS="-Os -ffast-math $CFLAGS"
+    CFLAGS="$CFLAGS"
 fi
 
 

