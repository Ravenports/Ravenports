# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		kf6-kimageformats
VERSION=		6.21.0
KEYWORDS=		graphics
VARIANTS=		std
SDESC[std]=		KF6 plugins for QImage extra file formats support
HOMEPAGE=		https://invent.kde.org/frameworks/kimageformats
CONTACT=		Michael_Reim[kraileth@elderlinux.org]

DOWNLOAD_GROUPS=	main
SITES[main]=		https://download.kde.org/stable/frameworks/6.21/
DISTFILE[1]=		kimageformats-6.21.0.tar.xz:main
DIST_SUBDIR=		kde6
DF_INDEX=		1
SPKGS[std]=		set
			primary
			dev

OPTIONS_AVAILABLE=	LINUX
OPTIONS_STANDARD=	LINUX
OPT_ON[linux]=		LINUX

BUILD_DEPENDS=		brotli:dev:std
			highway:dev:std
			kf6-extra-cmake-modules:primary:std
			kf6-karchive:dev:std
			libheif:dev:std
			libjxl:dev:std
			libraw:dev:std
			openexr:dev:std
			qt6-qtbase:dev:std
BUILDRUN_DEPENDS=	kf6-kconfig:primary:std
			kf6-karchive:primary:std
			libheif:primary:std
			libjxl:primary:std
			libraw:primary:std
			openexr:primary:std
			qt6-qtbase:primary:std

USES=			cpe cmake pkgconfig

DISTNAME=		kimageformats-6.21.0

LICENSE=		BSD2CLAUSE:primary BSD3CLAUSE:primary
			LGPL20+:primary LGPL21+:primary
LICENSE_TERMS=		primary:{{WRKDIR}}/TERMS
LICENSE_FILE=		BSD2CLAUSE:{{WRKSRC}}/LICENSES/BSD-2-Clause.txt
			BSD3CLAUSE:{{WRKSRC}}/LICENSES/BSD-3-Clause.txt
			LGPL20+:{{WRKSRC}}/LICENSES/LGPL-2.0-or-later.txt
			LGPL21+:{{WRKSRC}}/LICENSES/LGPL-2.1-or-later.txt
LICENSE_SCHEME=		multi

CPE_PRODUCT=		kimageformats
CPE_VENDOR=		kde
FPC_EQUIVALENT=		graphics/kf6-kimageformats

SOVERSION=		6.21.0

CMAKE_ARGS=		-DCMAKE_PREFIX_PATH:PATH={{PREFIX}}/lib/qt6/cmake
			-DKIMAGEFORMATS_HEIF:BOOL=ON

[LINUX].DESCRIPTION=			Special instructions for Linux
[LINUX].BUILDRUN_DEPENDS_OFF=		libavif:primary:std
[LINUX].BUILD_DEPENDS_OFF=		libavif:dev:std

post-install:
.for p in ani eps exr hdr jxl kra ora pcx pic psd qoi ras raw rgb tga xcf heif pfm pxr
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/lib/qt6/plugins/imageformats/kimg_${p}.so
.endfor

post-extract:
	${ECHO} "Terms extracted from 'src/imageformats/jxl.cpp':" > ${WRKDIR}/TERMS
	${SED} -n '/include/!p;//q' ${WRKSRC}/src/imageformats/jxl.cpp >> ${WRKDIR}/TERMS
	${ECHO} "Terms extracted from 'src/imageformats/fastmath_p.h':" >> ${WRKDIR}/TERMS
	${SED} -n '/ifndef/!p;//q' ${WRKSRC}/src/imageformats/fastmath_p.h >> ${WRKDIR}/TERMS
	${ECHO} "Terms extracted from 'src/imageformats/pic_p.h':" >> ${WRKDIR}/TERMS
	${SED} -n '/ifndef/!p;//q' ${WRKSRC}/src/imageformats/pic_p.h >> ${WRKDIR}/TERMS
	${ECHO} "Terms extracted from 'src/imageformats/gimp_p.h':" >> ${WRKDIR}/TERMS
	${SED} -n '/ifndef/!p;//q' ${WRKSRC}/src/imageformats/gimp_p.h >> ${WRKDIR}/TERMS

post-install-LINUX-OFF:
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/lib/qt6/plugins/imageformats/kimg_avif.so

[FILE:227:descriptions/desc.primary]
KImageFormats provides additional image format plugins for QtGui. As such 
it is not required for the compilation of any other software, but may be a 
runtime requirement for Qt-based software to support certain image formats.


[FILE:111:distinfo]
9c756b81e61d8b5ecca6e756269454cec3619a1a13a43803cb2104796cbff850     28950228 kde6/kimageformats-6.21.0.tar.xz


[FILE:372:manifests/plist.primary]
%%LINUX-OFF%%lib/qt6/plugins/imageformats/kimg_avif.so
lib/qt6/plugins/imageformats/
 kimg_ani.so
 kimg_dds.so
 kimg_eps.so
 kimg_exr.so
 kimg_hdr.so
 kimg_heif.so
 kimg_iff.so
 kimg_jxl.so
 kimg_kra.so
 kimg_ora.so
 kimg_pcx.so
 kimg_pfm.so
 kimg_pic.so
 kimg_psd.so
 kimg_pxr.so
 kimg_qoi.so
 kimg_ras.so
 kimg_raw.so
 kimg_rgb.so
 kimg_sct.so
 kimg_tga.so
 kimg_xcf.so


[FILE:92:manifests/plist.dev]
lib/cmake/KF6ImageFormats/
 KF6ImageFormatsConfig.cmake
 KF6ImageFormatsConfigVersion.cmake


[FILE:297:patches/patch-metainfo.yaml]
--- metainfo.yaml.orig	2024-05-31 13:26:00 UTC
+++ metainfo.yaml
@@ -4,6 +4,9 @@ type: functional
 platforms:
     - name: Linux
     - name: FreeBSD
+    - name: DragonFly
+    - name: NetBSD
+    - name: MidnightBSD
     - name: macOS
     - name: Windows
       note: No EPS support on Windows

