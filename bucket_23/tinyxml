# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		tinyxml
VERSION=		2.6.2
REVISION=		1
KEYWORDS=		textproc
VARIANTS=		std
SDESC[std]=		Simple, small, C++ XML parser
HOMEPAGE=		https://sourceforge.net/projects/tinyxml/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		SF/tinyxml/tinyxml/2.6.2
DISTFILE[1]=		tinyxml_2_6_2.tar.gz:main
DF_INDEX=		1
SPKGS[std]=		set
			primary
			dev
			docs

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

USES=			cpe cmake dos2unix c++:primary

DISTNAME=		tinyxml

LICENSE=		ZLIB:primary
LICENSE_FILE=		ZLIB:{{WRKDIR}}/LICENSE
LICENSE_AWK=		ZLIB:"^\*\/$"
LICENSE_SOURCE=		ZLIB:{{WRKSRC}}/tinyxml.h
LICENSE_SCHEME=		solo

CPE_VENDOR=		tinyxml_project
FPC_EQUIVALENT=		textproc/tinyxml

SOVERSION=		3.0.0

CVE_FIXED=		CVE-2021-42260 CVE-2023-34194

post-install:
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/lib/libtinyxml.so
	${MKDIR} ${STAGEDIR}${STD_DOCDIR}
	${INSTALL_DATA} ${WRKSRC}/docs/* ${STAGEDIR}${STD_DOCDIR}

post-extract:
	${CP} ${FILESDIR}/CMakeLists.txt ${WRKSRC}/

[FILE:399:descriptions/desc.primary]
TinyXML is a simple, small, minimal, C++ XML parser that can be easily
integrating into other programs. It reads XML and creates C++ objects
representing the XML document. The objects can be manipulated, changed,
and saved again as XML.

*Please Note* that TinyXML development has stopped and all development
has moved to TinyXML-2. TinyXML-2 is available at
https://github.com/leethomason/tinyxml2


[FILE:99:distinfo]
15bdfdcec58a7da30adc87ac2b078e4417dbe5392f3afb719f9ba6d062645593       210124 tinyxml_2_6_2.tar.gz


[FILE:61:manifests/plist.primary]
lib/
 libtinyxml.so.%%SOMAJOR%%
 libtinyxml.so.%%SOVERSION%%


[FILE:65:manifests/plist.dev]
include/
 tinystr.h
 tinyxml.h
lib/
 libtinyxml.a
 libtinyxml.so


[FILE:1994:manifests/plist.docs]
share/doc/tinyxml/
 annotated.html
 classTiXmlAttribute-members.html
 classTiXmlAttribute.html
 classTiXmlAttribute.png
 classTiXmlBase-members.html
 classTiXmlBase.html
 classTiXmlBase.png
 classTiXmlComment-members.html
 classTiXmlComment.html
 classTiXmlComment.png
 classTiXmlDeclaration-members.html
 classTiXmlDeclaration.html
 classTiXmlDeclaration.png
 classTiXmlDocument-members.html
 classTiXmlDocument.html
 classTiXmlDocument.png
 classTiXmlElement-members.html
 classTiXmlElement.html
 classTiXmlElement.png
 classTiXmlHandle-members.html
 classTiXmlHandle.html
 classTiXmlNode-members.html
 classTiXmlNode.html
 classTiXmlNode.png
 classTiXmlPrinter-members.html
 classTiXmlPrinter.html
 classTiXmlPrinter.png
 classTiXmlText-members.html
 classTiXmlText.html
 classTiXmlText.png
 classTiXmlUnknown-members.html
 classTiXmlUnknown.html
 classTiXmlUnknown.png
 classTiXmlVisitor-members.html
 classTiXmlVisitor.html
 classTiXmlVisitor.png
 classes.html
 deprecated.html
 doxygen.css
 doxygen.png
 files.html
 functions.html
 functions_0x63.html
 functions_0x64.html
 functions_0x65.html
 functions_0x66.html
 functions_0x67.html
 functions_0x69.html
 functions_0x6c.html
 functions_0x6e.html
 functions_0x6f.html
 functions_0x70.html
 functions_0x71.html
 functions_0x72.html
 functions_0x73.html
 functions_0x74.html
 functions_0x75.html
 functions_0x76.html
 functions_enum.html
 functions_func.html
 functions_func_0x63.html
 functions_func_0x64.html
 functions_func_0x65.html
 functions_func_0x66.html
 functions_func_0x67.html
 functions_func_0x69.html
 functions_func_0x6c.html
 functions_func_0x6e.html
 functions_func_0x70.html
 functions_func_0x71.html
 functions_func_0x72.html
 functions_func_0x73.html
 functions_func_0x74.html
 functions_func_0x75.html
 functions_func_0x76.html
 functions_rela.html
 functions_vars.html
 hierarchy.html
 index.html
 pages.html
 tab_b.gif
 tab_l.gif
 tab_r.gif
 tabs.css
 tinystr_8h_source.html
 tinyxml_8h_source.html
 tutorial0.html


[FILE:938:patches/patch-CVE-2021-42260]
Description: In stamp always advance the pointer if *p= 0xef
 .
 The current implementation only advanced if 0xef is followed
 by two non-zero bytes. In case of malformed input (0xef should be
 the start byte of a three byte character) this leads to an infinite
 loop. (CVE-2021-42260)
Origin: https://sourceforge.net/p/tinyxml/git/merge-requests/1/
Bug-Debian: https://security-tracker.debian.org/tracker/CVE-2021-42260
Bug-Debian: https://security-tracker.debian.org/tracker/CVE-2023-40458

--- tinyxmlparser.cpp.orig
+++ tinyxmlparser.cpp
@@ -274,6 +274,12 @@ void TiXmlParsingData::Stamp( const char* now, TiXmlEncoding encoding )
 						else
 							{ p +=3; ++col; }	// A normal character.
 					}
+					else
+					{
+						// TIXML_UTF_LEAD_0 (239) is the start character of a 3 byte sequence, so
+						// there is something wrong here. Just advance the pointer to evade infinite loops
+						++p;
+					}
 				}
 				else
 				{


[FILE:824:patches/patch-CVE-2023-34194]
From: Guilhem Moulin <guilhem@debian.org>
Date: Sat, 30 Dec 2023 14:15:54 +0100
Subject: Avoid reachable assertion via crafted XML document with a '\0'
 located after whitespace

Bug: https://www.forescout.com/resources/sierra21-vulnerabilities
Bug-Debian: https://bugs.debian.org/1059315
Bug-Debian: https://security-tracker.debian.org/tracker/CVE-2023-34194
Bug-Debian: https://security-tracker.debian.org/tracker/CVE-2023-40462
---
 tinyxmlparser.cpp | 4 ++++
 1 file changed, 4 insertions(+)

--- tinyxmlparser.cpp.orig
+++ tinyxmlparser.cpp
@@ -1606,6 +1606,10 @@ const char* TiXmlDeclaration::Parse( const char* p, TiXmlParsingData* data, TiXm
 		}
 
 		p = SkipWhiteSpace( p, _encoding );
+		if ( !p || !*p )
+		{
+			break;
+		}
 		if ( StringEqual( p, "version", true, _encoding ) )
 		{
 			TiXmlAttribute attrib;


[FILE:998:patches/patch-tinyxml.cpp]
--- tinyxml.cpp.orig	2011-05-15 02:24:57 UTC
+++ tinyxml.cpp
@@ -57,30 +57,7 @@ void TiXmlBase::EncodeString( const TIXM
 	{
 		unsigned char c = (unsigned char) str[i];
 
-		if (    c == '&' 
-		     && i < ( (int)str.length() - 2 )
-			 && str[i+1] == '#'
-			 && str[i+2] == 'x' )
-		{
-			// Hexadecimal character reference.
-			// Pass through unchanged.
-			// &#xA9;	-- copyright symbol, for example.
-			//
-			// The -1 is a bug fix from Rob Laveaux. It keeps
-			// an overflow from happening if there is no ';'.
-			// There are actually 2 ways to exit this loop -
-			// while fails (error case) and break (semicolon found).
-			// However, there is no mechanism (currently) for
-			// this function to return an error.
-			while ( i<(int)str.length()-1 )
-			{
-				outString->append( str.c_str() + i, 1 );
-				++i;
-				if ( str[i] == ';' )
-					break;
-			}
-		}
-		else if ( c == '&' )
+		if ( c == '&' )
 		{
 			outString->append( entity[0].str, entity[0].strLength );
 			++i;


[FILE:245:patches/patch-tinyxml.h]
--- tinyxml.h.orig	2011-05-15 02:24:57 UTC
+++ tinyxml.h
@@ -26,6 +26,8 @@ distribution.
 #ifndef TINYXML_INCLUDED
 #define TINYXML_INCLUDED
 
+#define TIXML_USE_STL
+
 #ifdef _MSC_VER
 #pragma warning( push )
 #pragma warning( disable : 4530 )


[FILE:749:files/CMakeLists.txt]
cmake_minimum_required(VERSION 3.16)
project(ossp-uuid)

SET(CMAKE_SKIP_BUILD_RPATH  TRUE)

set (xxsrcs
	${CMAKE_SOURCE_DIR}/tinystr.cpp
	${CMAKE_SOURCE_DIR}/tinyxmlerror.cpp
	${CMAKE_SOURCE_DIR}/tinyxml.cpp
	${CMAKE_SOURCE_DIR}/tinyxmlparser.cpp
)

include_directories(
	${CMAKE_SOURCE_DIR}
	${CMAKE_CURRENT_BINARY_DIR}
)

add_library(tinyxml_static ${xxsrcs})
add_library(tinyxml SHARED ${xxsrcs})

set_target_properties(tinyxml PROPERTIES
	VERSION   3.0.0
	SOVERSION 3)

install(TARGETS tinyxml
	LIBRARY DESTINATION ${CMAKE_INSTALL_LIBDIR}
)

install(FILES ${CMAKE_CURRENT_BINARY_DIR}/libtinyxml_static.a
	RENAME libtinyxml.a
	DESTINATION lib)

install(FILES
	${CMAKE_SOURCE_DIR}/tinystr.h
 	${CMAKE_SOURCE_DIR}/tinyxml.h
 	DESTINATION include
)

