# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		rrdtool
VERSION=		1.7.2
KEYWORDS=		databases graphics
VARIANTS=		standard
SDESC[standard]=	Round Robin Database tools
HOMEPAGE=		https://oss.oetiker.ch/rrdtool/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		https://oss.oetiker.ch/rrdtool/pub/
DISTFILE[1]=		rrdtool-1.7.2.tar.gz:main
DF_INDEX=		1
SPKGS[standard]=	complete
			primary
			examples
			docs

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILD_DEPENDS=		groff:primary:standard
BUILDRUN_DEPENDS=	freetype:primary:standard
RUN_DEPENDS=		fonts-dejavu:single:standard

USES=			gmake libtool pkgconfig shebangfix png perl python
			cpe
GNOME_COMPONENTS=	libxml2 glib cairo pango

LICENSE=		GPLv2+:primary
LICENSE_TERMS=		primary:{{WRKSRC}}/COPYRIGHT
LICENSE_FILE=		GPLv2+:{{WRKSRC}}/LICENSE
LICENSE_SCHEME=		solo

CPE_TARGET_SW=		python
CPE_VENDOR=		rrdtool_project
FPC_EQUIVALENT=		databases/rrdtool
SHEBANG_FILES=		examples/stripes.py
			examples/rrdcached/rrdcached-size.pl

MUST_CONFIGURE=		gnu
CONFIGURE_ARGS=		--disable-tcl
			--enable-perl
			--enable-perl-site-install
			--enable-python
			--enable-mmap
			--disable-nls
			--disable-ruby

MAKE_ARGS=		PERL_MAKE_OPTIONS='PREFIX="{{PREFIX}}"
			INSTALLPRIVLIB="{{PREFIX}}/lib"
			INSTALLARCHLIB="{{PREFIX}}/lib"'

INSTALL_TARGET=		install-strip
INSTALL_REQ_TOOLCHAIN=	yes
SOVERSION=		8.2.1
RC_SUBR=		rrdcached:primary

CPPFLAGS=		-I{{LOCALBASE}}/include/freetype2

post-install:
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/${SITE_ARCH_REL}/auto/RRDs/RRDs.so
	${STRIP_CMD} ${STAGEDIR}${PYTHON_SITELIBDIR}/rrdtool*.so

post-extract:
	${REINPLACE_CMD} -E 's|(^rrdcached_LDADD = librrd_th.la)|\1 $$\(ALL_LIBS\)|' \
		${WRKSRC}/src/Makefile.in
	${REINPLACE_CMD} -E 's|(^rrdtool_LDADD = librrd.la)|\1 $$\(ALL_LIBS\)|' \
		${WRKSRC}/src/Makefile.in

[FILE:559:descriptions/desc.primary]
It is pretty easy to gather status information from all sorts of things,
ranging from the temperature in your office to the number of octets which
have passed through the FDDI interface of your router. But it is not so
trivial to store this data in a efficient and systematic manner. This is
where RRDtool kicks in. It lets you log and analyze the data you gather
from all kinds of data-sources. The data analysis part of RRDtool is based
on the ability to quickly generate graphical representations of the data
values collected over a definable time period.


[FILE:99:distinfo]
a199faeb7eff7cafc46fac253e682d833d08932f3db93a550a4a5af180ca58db      2883737 rrdtool-1.7.2.tar.gz


[FILE:1311:manifests/plist.primary]
%%ONLY-DRAGONFLY%%%%PYTHON_SITELIBDIR%%/rrdtool.cpython-%%PYTHON_SUFFIX%%.so
%%ONLY-FREEBSD%%%%PYTHON_SITELIBDIR%%/rrdtool.cpython-%%PYTHON_SUFFIX%%.so
%%ONLY-LINUX%%%%PYTHON_SITELIBDIR%%/rrdtool.cpython-%%PYTHON_SUFFIX%%%%PYTHON_ABIVER%%-x86_64-linux-gnu.so
%%ONLY-SUNOS%%%%PYTHON_SITELIBDIR%%/rrdtool.cpython-%%PYTHON_SUFFIX%%.so
%%PERL5_MAN3%%/
 RRDp.3.gz
 RRDs.3.gz
%%PYTHON_SITELIBDIR%%/rrdtool-0.1.10-py%%PYTHON_VER%%.egg-info
%%SITE_ARCH%%/RRDs.pm
%%SITE_ARCH%%/auto/RRDp/.packlist
%%SITE_ARCH%%/auto/RRDs/
 .packlist
 RRDs.so
%%SITE_PERL%%/RRDp.pm
bin/
 rrdcached
 rrdcgi
 rrdcreate
 rrdinfo
 rrdtool
 rrdupdate
include/
 rrd.h
 rrd_client.h
 rrd_format.h
lib/
 librrd.a
 librrd.so
 librrd.so.%%SOMAJOR%%
 librrd.so.%%SOVERSION%%
lib/pkgconfig/librrd.pc
share/man/man1/
 bin_dec_hex.1.gz
 cdeftutorial.1.gz
 rpntutorial.1.gz
 rrd-beginners.1.gz
 rrd_pdpcalc.1.gz
 rrdbuild.1.gz
 rrdcached.1.gz
 rrdcgi.1.gz
 rrdcreate.1.gz
 rrddump.1.gz
 rrdfetch.1.gz
 rrdfirst.1.gz
 rrdflushcached.1.gz
 rrdgraph.1.gz
 rrdgraph_data.1.gz
 rrdgraph_examples.1.gz
 rrdgraph_graph.1.gz
 rrdgraph_rpn.1.gz
 rrdinfo.1.gz
 rrdlast.1.gz
 rrdlastupdate.1.gz
 rrdlist.1.gz
 rrdresize.1.gz
 rrdrestore.1.gz
 rrdthreads.1.gz
 rrdtool.1.gz
 rrdtune.1.gz
 rrdtutorial.1.gz
 rrdupdate.1.gz
 rrdxport.1.gz
share/man/man3/librrd.3.gz


[FILE:208:manifests/plist.examples]
share/examples/rrdtool/
 4charts.pl
 bigtops.pl
 cgi-demo.cgi
 minmax.pl
 perftest.pl
 piped-demo.pl
 shared-demo.pl
 stripes.pl
 stripes.py
share/examples/rrdtool/rrdcached/
 RRDCached.pm
 rrdcached-size.pl


[FILE:1564:manifests/plist.docs]
share/doc/rrdtool/html/
 RRDp.html
 RRDs.html
 bin_dec_hex.html
 cdeftutorial.html
 index.html
 librrd.html
 rpntutorial.html
 rrd-beginners.html
 rrd_pdpcalc.html
 rrdbuild.html
 rrdcached.html
 rrdcgi.html
 rrdcreate.html
 rrddump.html
 rrdfetch.html
 rrdfirst.html
 rrdflushcached.html
 rrdgraph.html
 rrdgraph_data.html
 rrdgraph_examples.html
 rrdgraph_graph.html
 rrdgraph_rpn.html
 rrdinfo.html
 rrdlast.html
 rrdlastupdate.html
 rrdlist.html
 rrdresize.html
 rrdrestore.html
 rrdthreads.html
 rrdtool.html
 rrdtune.html
 rrdtutorial.html
 rrdupdate.html
 rrdxport.html
share/doc/rrdtool/txt/
 bin_dec_hex.pod
 bin_dec_hex.txt
 cdeftutorial.pod
 cdeftutorial.txt
 librrd.txt
 rpntutorial.pod
 rpntutorial.txt
 rrd-beginners.pod
 rrd-beginners.txt
 rrd_pdpcalc.pod
 rrd_pdpcalc.txt
 rrdbuild.pod
 rrdbuild.txt
 rrdcached.pod
 rrdcached.txt
 rrdcgi.pod
 rrdcgi.txt
 rrdcreate.pod
 rrdcreate.txt
 rrddump.pod
 rrddump.txt
 rrdfetch.pod
 rrdfetch.txt
 rrdfirst.pod
 rrdfirst.txt
 rrdflushcached.pod
 rrdflushcached.txt
 rrdgraph.pod
 rrdgraph.txt
 rrdgraph_data.pod
 rrdgraph_data.txt
 rrdgraph_examples.pod
 rrdgraph_examples.txt
 rrdgraph_graph.pod
 rrdgraph_graph.txt
 rrdgraph_rpn.pod
 rrdgraph_rpn.txt
 rrdinfo.pod
 rrdinfo.txt
 rrdlast.pod
 rrdlast.txt
 rrdlastupdate.pod
 rrdlastupdate.txt
 rrdlist.pod
 rrdlist.txt
 rrdresize.pod
 rrdresize.txt
 rrdrestore.pod
 rrdrestore.txt
 rrdthreads.pod
 rrdthreads.txt
 rrdtool.pod
 rrdtool.txt
 rrdtune.pod
 rrdtune.txt
 rrdtutorial.pod
 rrdtutorial.txt
 rrdupdate.pod
 rrdupdate.txt
 rrdxport.pod
 rrdxport.txt


[FILE:918:patches/patch-bindings-Makefile.in]
--- bindings/Makefile.in.orig	2019-05-27 18:46:41 UTC
+++ bindings/Makefile.in
@@ -724,15 +724,15 @@ all-local:  @COMP_PERL@ @COMP_RUBY@ @COM
 install-data-local:
 	$(AM_V_GEN)test -f ${builddir}/perl-piped/Makefile \
            && ( cd ${builddir}/perl-piped \
-	        && $(MAKE) install ) \
+	        && $(MAKE) pure_install ) \
 	   || true
 	$(AM_V_GEN)test -f ${builddir}/perl-shared/Makefile \
            && ( cd ${builddir}/perl-shared \
-                && $(MAKE) install ) \
+                && $(MAKE) pure_install ) \
            || true
 	$(AM_V_GEN)test -f ${builddir}/ruby/Makefile \
            && ( cd ${builddir}/ruby \
-                && $(MAKE) EPREFIX=$(DESTDIR)$(exec_prefix) $(RUBY_MAKE_OPTIONS) install ) \
+                && $(MAKE) EPREFIX=$(DESTDIR)$(exec_prefix) install ) \
            || true
 	$(AM_V_GEN)test -d ${builddir}/python/build \
            && ( cd ${builddir}/python \


[FILE:412:patches/patch-bindings_python_setup.py]
--- bindings/python/setup.py.orig	2019-02-04 13:54:27 UTC
+++ bindings/python/setup.py
@@ -2,10 +2,7 @@
 import os
 import sys
 
-try:
-    from setuptools import setup, Extension
-except ImportError:
-    sys.exit('The setup requires setuptools.')
+from distutils.core import setup, Extension
 
 TOP_SRCDIR = os.environ.get('ABS_TOP_SRCDIR', '../..')
 TOP_BUILDDIR = os.environ.get('ABS_TOP_BUILDDIR', '../..')


[FILE:2034:patches/patch-configure]
--- configure.orig	2019-05-27 18:46:40 UTC
+++ configure
@@ -13698,7 +13698,7 @@ fi
 
 
 if test "x$GCC" = "xyes"; then
-  for flag in -fno-strict-aliasing -Wall -std=gnu99 -pedantic -Wundef -Wshadow -Wpointer-arith -Wcast-align -Wmissing-prototypes -Wmissing-declarations -Wnested-externs -Winline -Wold-style-definition -W; do
+  for flag in -fno-strict-aliasing -Wall -std=gnu99 -pedantic -Wundef -Wshadow -Wpointer-arith -Wcast-align -Wmissing-prototypes -Wmissing-declarations -Wnested-externs -Winline -Wold-style-definition; do
     oCFLAGS="$CFLAGS"
     CFLAGS="$CFLAGS $flag"
     cachename=rd_cv_gcc_flag_`echo $flag|sed 's/[^A-Za-z]/_/g'`
@@ -23309,9 +23309,9 @@ $as_echo "$am_cv_python_pyexecdir" >&6;
 $as_echo_n "checking for headers required to compile python extensions... " >&6; }
 py_prefix=`$PYTHON -c "import sys; print(sys.prefix)"`
 py_exec_prefix=`$PYTHON -c "import sys; print(sys.exec_prefix)"`
-PYTHON_INCLUDES="-I${py_prefix}/include/python${PYTHON_VERSION}"
+PYTHON_INCLUDES="-I${py_prefix}/include/python${PYTHON_VERSION} -I${py_prefix}/include/python${PYTHON_VERSION}m"
 if test "$py_prefix" != "$py_exec_prefix"; then
-  PYTHON_INCLUDES="$PYTHON_INCLUDES -I${py_exec_prefix}/include/python${PYTHON_VERSION}"
+  PYTHON_INCLUDES="$PYTHON_INCLUDES -I${py_exec_prefix}/include/python${PYTHON_VERSION} -I${py_exec_prefix}/include/python${PYTHON_VERSION}m"
 fi
 
 save_CPPFLAGS="$CPPFLAGS"
@@ -28701,18 +28701,6 @@ $as_echo_n "checking in... " >&6; }
 { $as_echo "$as_me:${as_lineno-$LINENO}: result: and out again" >&5
 $as_echo "and out again" >&6; }
 
-echo $ECHO_N "ordering CD from https://tobi.oetiker.ch/wish $ECHO_C" 1>&6
-sleep 1
-echo $ECHO_N ".$ECHO_C" 1>&6
-sleep 1
-echo $ECHO_N ".$ECHO_C" 1>&6
-sleep 1
-echo $ECHO_N ".$ECHO_C" 1>&6
-sleep 1
-echo $ECHO_N ".$ECHO_C" 1>&6
-sleep 1
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result:  just kidding ;-)" >&5
-$as_echo " just kidding ;-)" >&6; }
 echo
 echo "----------------------------------------------------------------"
 echo "Config is DONE!"


[FILE:521:patches/patch-doc-Makefile.in]
--- doc/Makefile.in.orig	2019-05-27 18:46:41 UTC
+++ doc/Makefile.in
@@ -390,9 +390,9 @@ CLEANFILES = $(GENERATED_EXTRADIST) pod2
 
 # what should go into the distribution
 EXTRA_DIST = $(GENERATED_EXTRADIST) $(POD) $(POD3) rrdtool-dump.dtd rrdtool-xport.dtd rrdgraph_libdbi.pod rrdlua.pod
-idocdir = $(RRDDOCDIR)/txt
+idocdir = $(datadir)/doc/rrdtool/txt
 idoc_DATA = $(POD) $(TXT)
-ihtmldir = $(RRDDOCDIR)/html
+ihtmldir = $(datadir)/doc/rrdtool/html
 ihtml_DATA = $(HTML)
 imandir = $(mandir)/man1
 iman_DATA = $(MAN)


[FILE:442:patches/patch-examples-Makefile.in]
--- examples/Makefile.in.orig	2019-05-27 18:46:41 UTC
+++ examples/Makefile.in
@@ -431,7 +431,7 @@ top_builddir = @top_builddir@
 top_srcdir = @top_srcdir@
 SUBDIRS = rrdcached
 EXTRA_DIST = cgi-demo.cgi.in stripes.py
-examplesdir = $(pkgdatadir)/examples
+examplesdir = $(datadir)/examples/rrdtool
 examples_SCRIPTS = cgi-demo.cgi piped-demo.pl shared-demo.pl \
 	stripes.pl bigtops.pl minmax.pl 4charts.pl perftest.pl \
         stripes.py


[FILE:468:patches/patch-examples_rrdcached_Makefile.in]
--- examples/rrdcached/Makefile.in.orig	2019-05-27 18:46:41 UTC
+++ examples/rrdcached/Makefile.in
@@ -368,7 +368,7 @@ target_vendor = @target_vendor@
 top_build_prefix = @top_build_prefix@
 top_builddir = @top_builddir@
 top_srcdir = @top_srcdir@
-examplesdir = $(pkgdatadir)/examples/rrdcached
+examplesdir = $(datadir)/examples/rrdtool/rrdcached
 examples_SCRIPTS = rrdcached-size.pl
 examples_DATA = RRDCached.pm
 EXTRA_DIST = $(examples_DATA) $(examples_SCRIPTS)


[FILE:568:files/rrdcached.in]
#!/bin/sh
#
# PROVIDE: rrdcached
# REQUIRE: DAEMON
# KEYWORD: shutdown
#
# Add the following line to /etc/rc.conf to enable rrdcached:
#
# rrdcached_enable (bool):	Set to "NO" by default.
#				Set to "YES" to enable rrdcached
#
# rrdcached_flags (str):	Set to "" by default.
#

. /etc/rc.subr

name=rrdcached
rcvar=rrdcached_enable

load_rc_config $name

# Set defaults
: ${rrdcached_enable="NO"}
: ${rrdcached_flags="-s www -l /var/run/rrdcached.sock -p /var/run/rrdcached.pid"}

pidfile=/var/run/${name}.pid   
command=%%PREFIX%%/bin/${name}

run_rc_command "$1"   

