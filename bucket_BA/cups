# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		cups
VERSION=		2.3.1
REVISION=		1
KEYWORDS=		print
VARIANTS=		standard
SDESC[standard]=	Common UNIX Printing System
HOMEPAGE=		https://www.cups.org/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		GITHUB/apple:cups:v2.3.1
DISTFILE[1]=		generated:main
DF_INDEX=		1
SPKGS[standard]=	complete
			primary
			docs
			examples

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILDRUN_DEPENDS=	gnutls:single:standard
			libpaper:single:standard
			dbus:single:standard

USERS=			cups
GROUPS=			cups
USERGROUP_SPKG=		primary

USES=			cpe gmake iconv pkgconfig

LICENSE=		APACHE20:primary
LICENSE_TERMS=		primary:{{WRKDIR}}/TERMS
LICENSE_FILE=		APACHE20:{{WRKSRC}}/LICENSE.txt
LICENSE_AWK=		TERMS:"^$$"
LICENSE_SOURCE=		TERMS:{{WRKSRC}}/cups/cups.h
LICENSE_SCHEME=		solo

CPE_VENDOR=		apple
FPC_EQUIVALENT=		print/cups

MUST_CONFIGURE=		gnu
CONFIGURE_ARGS=		--enable-libpaper
			--enable-gnutls
			--enable-dbus
			--disable-dnssd
			--disable-gssapi
			--disable-launchd
			--disable-systemd
			--disable-avahi
			--with-cups-user=cups
			--with-cups-group=cups
			--with-dbusdir="{{PREFIX}}/etc/dbus-1"
			--with-icondir="{{PREFIX}}/share/icons"
			--with-menudir="{{PREFIX}}/share/applications"
			--with-printcap="{{PREFIX}}/etc/printcap"
			--with-rcdir=no
			--with-optim=" "
			--with-pam-module="unix"
CONFIGURE_ENV=		ac_cv_path_JAVA=
			ac_cv_path_PERL=
			ac_cv_path_PHPCGI=
			ac_cv_path_PHP=
			ac_cv_path_PYTHON=

DESTDIRNAME=		DSTROOT

RC_SUBR=		cupsd:primary

VAR_OPSYS[freebsd]=	CONFIGURE_ARGS=--with-system-groups=wheel
VAR_OPSYS[sunos]=	CONFIGURE_ARGS=LSB_BUILD=y
			LDFLAGS=-lrt
VAR_OPSYS[dragonfly]=	CONFIGURE_ARGS=--with-system-groups=wheel

post-patch:
	${REINPLACE_CMD} -e '/SILENT/d' ${WRKSRC}/Makedefs.in
	${REINPLACE_CMD} 's/usblp/ulpt/g' ${WRKSRC}/backend/usb-libusb.c
	${REINPLACE_CMD} -e 's|/usr/local/etc/pam.d|${LOCALBASE}/etc/pam.d|' \
		-e 's/-fstack-protector//' ${WRKSRC}/configure
	${FIND} ${WRKSRC}/doc ${WRKSRC}/templates -type f -exec ${SED} -i'' \
		's|http://www.cups.org|https://www.cups.org|g' {} +
	${REINPLACE_CMD} '/stripopt=/s/-x//' ${WRKSRC}/install-sh
	${GREP} -l '/etc/cups/' ${WRKSRC}/man/*.[1-7] | ${XARGS} \
		${REINPLACE_CMD} 's|/etc/cups|${LOCALBASE}/etc/cups|g'
	${REINPLACE_CMD} -e 's|\.default|.sample|'\
		-e 's|-g .(.*_GROUP)||g' \
		${WRKSRC}/cgi-bin/admin.c\
		${WRKSRC}/conf/Makefile \
		${WRKSRC}/notifier/Makefile \
		${WRKSRC}/scheduler/Makefile

post-install:
	${LN} -sf lpr ${STAGEDIR}${PREFIX}/bin/lpr-cups
	@${MKDIR} ${STAGEDIR}${PREFIX}/etc/pam.d \
		${STAGEDIR}${PREFIX}/etc/devd \
		${STAGEDIR}${STD_EXAMPLESDIR}
	${INSTALL_DATA} ${FILESDIR}/cups.conf.sample \
		${STAGEDIR}${PREFIX}/etc/devd
	${INSTALL_DATA} ${FILESDIR}/cups ${STAGEDIR}${PREFIX}/etc/pam.d
	${MV} ${STAGEDIR}${PREFIX}/share/cups/examples/* \
		${STAGEDIR}${STD_EXAMPLESDIR}
	${RMDIR} ${STAGEDIR}${PREFIX}/share/cups/examples
	${RM} ${STAGEDIR}${PREFIX}/etc/cups/*.conf

post-patch-sunos:
	${REINPLACE_CMD} -e '/-o .. ippeveprinter.o/ s/$$/ -lsocket/' \
		${WRKSRC}/tools/Makefile
	${REINPLACE_CMD} \
		-e '/-o lpd/ s/$$/ -lsocket/' \
		-e '/-o ipp/ s/$$/ -lsocket/' \
		-e '/-o .* socket\.o/ s/socket\.o/socket.o -lsocket/' \
		-e '/snmp \\$$/d' \
		${WRKSRC}/backend/Makefile
	${REINPLACE_CMD} \
		-e '/-o cups-lpd/ s/$$/ -lsocket/' \
		${WRKSRC}/scheduler/Makefile

[FILE:228:descriptions/desc.primary]
CUPS is the standards-based, open source printing system developed by
Apple Inc. for macOS and other UNIX-like operating systems. CUPS uses
the Internet Printing Protocol (IPP) to support printing to local and
network printers.


[FILE:102:distinfo]
c4fb4cb0f56d811166c64eab27661336a9b7cc64a128638e0efb1cbfed5b5d00      8141287 apple-cups-2.3.1.tar.gz


[FILE:13559:manifests/plist.primary]
@sample etc/cups/cups-files.conf.sample
@sample etc/cups/cupsd.conf.sample
@sample etc/cups/snmp.conf.sample
@sample etc/devd/cups.conf.sample
%%ONLY-DARWIN%%libexec/cups/backend/snmp
%%ONLY-DRAGONFLY%%libexec/cups/backend/snmp
%%ONLY-DRAGONFLY%%share/cups/usb/org.cups.usb-quirks
%%ONLY-FREEBSD%%libexec/cups/backend/snmp
%%ONLY-FREEBSD%%share/cups/usb/org.cups.usb-quirks
%%ONLY-LINUX%%libexec/cups/backend/snmp
bin/
 cancel
 cups-config
 cupstestppd
 ippeveprinter
 ipptool
 lp
 lpoptions
 lpq
 lpr
 lpr-cups
 lprm
 lpstat
 ppdc
 ppdhtml
 ppdi
 ppdmerge
 ppdpo
etc/dbus-1/system.d/cups.conf
etc/pam.d/cups
include/cups/
 adminutil.h
 array.h
 backend.h
 cups.h
 dir.h
 file.h
 http.h
 ipp.h
 language.h
 ppd.h
 pwg.h
 raster.h
 sidechannel.h
 transcode.h
 versioning.h
lib/
 libcups.so
 libcups.so.2
 libcupsimage.so
 libcupsimage.so.2
libexec/cups/backend/
 http
 https
 ipp
 ipps
 lpd
 socket
 usb
libexec/cups/cgi-bin/
 admin.cgi
 classes.cgi
 help.cgi
 jobs.cgi
 printers.cgi
libexec/cups/command/
 ippevepcl
 ippeveps
libexec/cups/daemon/
 cups-deviced
 cups-driverd
 cups-exec
 cups-lpd
libexec/cups/filter/
 commandtops
 gziptoany
 pstops
 rastertoepson
 rastertohp
 rastertolabel
 rastertopwg
libexec/cups/monitor/
 bcp
 tbcp
libexec/cups/notifier/
 dbus
 mailto
 rss
sbin/
 cupsaccept
 cupsctl
 cupsd
 cupsdisable
 cupsenable
 cupsfilter
 cupsreject
 lpadmin
 lpc
 lpinfo
 lpmove
share/applications/cups.desktop
share/cups/drv/sample.drv
share/cups/ipptool/
 cancel-current-job.test
 color.jpg
 create-job-format.test
 create-job-sheets.test
 create-job-timeout.test
 create-job.test
 create-printer-subscription.test
 cups-create-local-printer.test
 document-a4.pdf
 document-a4.ps
 document-letter.pdf
 document-letter.ps
 fax-job.test
 get-completed-jobs.test
 get-devices.test
 get-job-attributes.test
 get-job-attributes2.test
 get-job-template-attributes.test
 get-jobs.test
 get-notifications.test
 get-ppd-printer.test
 get-ppd.test
 get-ppds-drv-only.test
 get-ppds-language.test
 get-ppds-make-and-model.test
 get-ppds-make.test
 get-ppds-product.test
 get-ppds-psversion.test
 get-ppds.test
 get-printer-attributes-suite.test
 get-printer-attributes.test
 get-printer-description-attributes.test
 get-printers-printer-id.test
 get-printers.test
 get-subscriptions.test
 gray.jpg
 identify-printer-display.test
 identify-printer-multiple.test
 identify-printer.test
 ipp-1.1.test
 ipp-2.0.test
 ipp-2.1.test
 ipp-2.2.test
 ipp-backend.test
 ipp-everywhere.test
 onepage-a4.pdf
 onepage-a4.ps
 onepage-letter.pdf
 onepage-letter.ps
 print-job-and-wait.test
 print-job-deflate.test
 print-job-gzip.test
 print-job-hold.test
 print-job-letter.test
 print-job-manual.test
 print-job-media-col.test
 print-job-password.test
 print-job.test
 print-uri.test
 set-attrs-hold.test
 testfile.jpg
 testfile.pcl
 testfile.pdf
 testfile.ps
 testfile.txt
 validate-job.test
share/cups/mime/
 mime.convs
 mime.types
share/cups/ppdc/
 epson.h
 font.defs
 hp.h
 label.h
 media.defs
 raster.defs
share/cups/templates/
 add-class.tmpl
 add-printer.tmpl
 admin.tmpl
 choose-device.tmpl
 choose-make.tmpl
 choose-model.tmpl
 choose-serial.tmpl
 choose-uri.tmpl
 class-added.tmpl
 class-confirm.tmpl
 class-deleted.tmpl
 class-jobs-header.tmpl
 class-modified.tmpl
 class.tmpl
 classes-header.tmpl
 classes.tmpl
 command.tmpl
 edit-config.tmpl
 error-op.tmpl
 error.tmpl
 header.tmpl
 help-header.tmpl
 help-printable.tmpl
 help-trailer.tmpl
 job-cancel.tmpl
 job-hold.tmpl
 job-move.tmpl
 job-moved.tmpl
 job-release.tmpl
 job-restart.tmpl
 jobs-header.tmpl
 jobs.tmpl
 list-available-printers.tmpl
 modify-class.tmpl
 modify-printer.tmpl
 norestart.tmpl
 option-boolean.tmpl
 option-conflict.tmpl
 option-header.tmpl
 option-pickmany.tmpl
 option-pickone.tmpl
 option-trailer.tmpl
 pager.tmpl
 printer-accept.tmpl
 printer-added.tmpl
 printer-cancel-jobs.tmpl
 printer-configured.tmpl
 printer-confirm.tmpl
 printer-default.tmpl
 printer-deleted.tmpl
 printer-jobs-header.tmpl
 printer-modified.tmpl
 printer-reject.tmpl
 printer-start.tmpl
 printer-stop.tmpl
 printer.tmpl
 printers-header.tmpl
 printers.tmpl
 restart.tmpl
 search.tmpl
 set-printer-options-header.tmpl
 set-printer-options-trailer.tmpl
 test-page.tmpl
 trailer.tmpl
 users.tmpl
share/cups/templates/de/
 add-class.tmpl
 add-printer.tmpl
 admin.tmpl
 choose-device.tmpl
 choose-make.tmpl
 choose-model.tmpl
 choose-serial.tmpl
 choose-uri.tmpl
 class-added.tmpl
 class-confirm.tmpl
 class-deleted.tmpl
 class-jobs-header.tmpl
 class-modified.tmpl
 class.tmpl
 classes-header.tmpl
 classes.tmpl
 command.tmpl
 edit-config.tmpl
 error-op.tmpl
 error.tmpl
 header.tmpl
 help-header.tmpl
 help-printable.tmpl
 help-trailer.tmpl
 job-cancel.tmpl
 job-hold.tmpl
 job-move.tmpl
 job-moved.tmpl
 job-release.tmpl
 job-restart.tmpl
 jobs-header.tmpl
 jobs.tmpl
 list-available-printers.tmpl
 modify-class.tmpl
 modify-printer.tmpl
 norestart.tmpl
 option-boolean.tmpl
 option-conflict.tmpl
 option-header.tmpl
 option-pickmany.tmpl
 option-pickone.tmpl
 option-trailer.tmpl
 pager.tmpl
 printer-accept.tmpl
 printer-added.tmpl
 printer-cancel-jobs.tmpl
 printer-configured.tmpl
 printer-confirm.tmpl
 printer-default.tmpl
 printer-deleted.tmpl
 printer-jobs-header.tmpl
 printer-modified.tmpl
 printer-reject.tmpl
 printer-start.tmpl
 printer-stop.tmpl
 printer.tmpl
 printers-header.tmpl
 printers.tmpl
 restart.tmpl
 search.tmpl
 set-printer-options-header.tmpl
 set-printer-options-trailer.tmpl
 test-page.tmpl
 trailer.tmpl
 users.tmpl
share/cups/templates/es/
 add-class.tmpl
 add-printer.tmpl
 admin.tmpl
 choose-device.tmpl
 choose-make.tmpl
 choose-model.tmpl
 choose-serial.tmpl
 choose-uri.tmpl
 class-added.tmpl
 class-confirm.tmpl
 class-deleted.tmpl
 class-jobs-header.tmpl
 class-modified.tmpl
 class.tmpl
 classes-header.tmpl
 classes.tmpl
 command.tmpl
 edit-config.tmpl
 error-op.tmpl
 error.tmpl
 header.tmpl
 help-header.tmpl
 help-printable.tmpl
 help-trailer.tmpl
 job-cancel.tmpl
 job-hold.tmpl
 job-move.tmpl
 job-moved.tmpl
 job-release.tmpl
 job-restart.tmpl
 jobs-header.tmpl
 jobs.tmpl
 list-available-printers.tmpl
 modify-class.tmpl
 modify-printer.tmpl
 norestart.tmpl
 option-boolean.tmpl
 option-conflict.tmpl
 option-header.tmpl
 option-pickmany.tmpl
 option-pickone.tmpl
 option-trailer.tmpl
 pager.tmpl
 printer-accept.tmpl
 printer-added.tmpl
 printer-cancel-jobs.tmpl
 printer-configured.tmpl
 printer-confirm.tmpl
 printer-default.tmpl
 printer-deleted.tmpl
 printer-jobs-header.tmpl
 printer-modified.tmpl
 printer-reject.tmpl
 printer-start.tmpl
 printer-stop.tmpl
 printer.tmpl
 printers-header.tmpl
 printers.tmpl
 restart.tmpl
 search.tmpl
 set-printer-options-header.tmpl
 set-printer-options-trailer.tmpl
 test-page.tmpl
 trailer.tmpl
 users.tmpl
share/cups/templates/fr/
 add-class.tmpl
 add-printer.tmpl
 admin.tmpl
 choose-device.tmpl
 choose-make.tmpl
 choose-model.tmpl
 choose-serial.tmpl
 choose-uri.tmpl
 class-added.tmpl
 class-confirm.tmpl
 class-deleted.tmpl
 class-jobs-header.tmpl
 class-modified.tmpl
 class.tmpl
 classes-header.tmpl
 classes.tmpl
 command.tmpl
 edit-config.tmpl
 error-op.tmpl
 error.tmpl
 header.tmpl
 help-header.tmpl
 help-printable.tmpl
 help-trailer.tmpl
 job-cancel.tmpl
 job-hold.tmpl
 job-move.tmpl
 job-moved.tmpl
 job-release.tmpl
 job-restart.tmpl
 jobs-header.tmpl
 jobs.tmpl
 list-available-printers.tmpl
 modify-class.tmpl
 modify-printer.tmpl
 norestart.tmpl
 option-boolean.tmpl
 option-conflict.tmpl
 option-header.tmpl
 option-pickmany.tmpl
 option-pickone.tmpl
 option-trailer.tmpl
 pager.tmpl
 printer-accept.tmpl
 printer-added.tmpl
 printer-cancel-jobs.tmpl
 printer-configured.tmpl
 printer-confirm.tmpl
 printer-default.tmpl
 printer-deleted.tmpl
 printer-jobs-header.tmpl
 printer-modified.tmpl
 printer-reject.tmpl
 printer-start.tmpl
 printer-stop.tmpl
 printer.tmpl
 printers-header.tmpl
 printers.tmpl
 restart.tmpl
 search.tmpl
 set-printer-options-header.tmpl
 set-printer-options-trailer.tmpl
 test-page.tmpl
 trailer.tmpl
 users.tmpl
share/cups/templates/ja/
 add-class.tmpl
 add-printer.tmpl
 admin.tmpl
 choose-device.tmpl
 choose-make.tmpl
 choose-model.tmpl
 choose-serial.tmpl
 choose-uri.tmpl
 class-added.tmpl
 class-confirm.tmpl
 class-deleted.tmpl
 class-jobs-header.tmpl
 class-modified.tmpl
 class.tmpl
 classes-header.tmpl
 classes.tmpl
 command.tmpl
 edit-config.tmpl
 error-op.tmpl
 error.tmpl
 header.tmpl
 help-header.tmpl
 help-printable.tmpl
 help-trailer.tmpl
 job-cancel.tmpl
 job-hold.tmpl
 job-move.tmpl
 job-moved.tmpl
 job-release.tmpl
 job-restart.tmpl
 jobs-header.tmpl
 jobs.tmpl
 list-available-printers.tmpl
 modify-class.tmpl
 modify-printer.tmpl
 norestart.tmpl
 option-boolean.tmpl
 option-conflict.tmpl
 option-header.tmpl
 option-pickmany.tmpl
 option-pickone.tmpl
 option-trailer.tmpl
 pager.tmpl
 printer-accept.tmpl
 printer-added.tmpl
 printer-cancel-jobs.tmpl
 printer-configured.tmpl
 printer-confirm.tmpl
 printer-default.tmpl
 printer-deleted.tmpl
 printer-jobs-header.tmpl
 printer-modified.tmpl
 printer-reject.tmpl
 printer-start.tmpl
 printer-stop.tmpl
 printer.tmpl
 printers-header.tmpl
 printers.tmpl
 restart.tmpl
 search.tmpl
 set-printer-options-header.tmpl
 set-printer-options-trailer.tmpl
 test-page.tmpl
 trailer.tmpl
 users.tmpl
share/cups/templates/pt_BR/
 add-class.tmpl
 add-printer.tmpl
 admin.tmpl
 choose-device.tmpl
 choose-make.tmpl
 choose-model.tmpl
 choose-serial.tmpl
 choose-uri.tmpl
 class-added.tmpl
 class-confirm.tmpl
 class-deleted.tmpl
 class-jobs-header.tmpl
 class-modified.tmpl
 class.tmpl
 classes-header.tmpl
 classes.tmpl
 command.tmpl
 edit-config.tmpl
 error-op.tmpl
 error.tmpl
 header.tmpl
 help-header.tmpl
 help-printable.tmpl
 help-trailer.tmpl
 job-cancel.tmpl
 job-hold.tmpl
 job-move.tmpl
 job-moved.tmpl
 job-release.tmpl
 job-restart.tmpl
 jobs-header.tmpl
 jobs.tmpl
 list-available-printers.tmpl
 modify-class.tmpl
 modify-printer.tmpl
 norestart.tmpl
 option-boolean.tmpl
 option-conflict.tmpl
 option-header.tmpl
 option-pickmany.tmpl
 option-pickone.tmpl
 option-trailer.tmpl
 pager.tmpl
 printer-accept.tmpl
 printer-added.tmpl
 printer-cancel-jobs.tmpl
 printer-configured.tmpl
 printer-confirm.tmpl
 printer-default.tmpl
 printer-deleted.tmpl
 printer-jobs-header.tmpl
 printer-modified.tmpl
 printer-reject.tmpl
 printer-start.tmpl
 printer-stop.tmpl
 printer.tmpl
 printers-header.tmpl
 printers.tmpl
 restart.tmpl
 search.tmpl
 set-printer-options-header.tmpl
 set-printer-options-trailer.tmpl
 test-page.tmpl
 trailer.tmpl
 users.tmpl
share/cups/templates/ru/
 add-class.tmpl
 add-printer.tmpl
 admin.tmpl
 choose-device.tmpl
 choose-make.tmpl
 choose-model.tmpl
 choose-serial.tmpl
 choose-uri.tmpl
 class-added.tmpl
 class-confirm.tmpl
 class-deleted.tmpl
 class-jobs-header.tmpl
 class-modified.tmpl
 class.tmpl
 classes-header.tmpl
 classes.tmpl
 command.tmpl
 edit-config.tmpl
 error-op.tmpl
 error.tmpl
 header.tmpl
 help-header.tmpl
 help-printable.tmpl
 help-trailer.tmpl
 job-cancel.tmpl
 job-hold.tmpl
 job-move.tmpl
 job-moved.tmpl
 job-release.tmpl
 job-restart.tmpl
 jobs-header.tmpl
 jobs.tmpl
 list-available-printers.tmpl
 modify-class.tmpl
 modify-printer.tmpl
 norestart.tmpl
 option-boolean.tmpl
 option-conflict.tmpl
 option-header.tmpl
 option-pickmany.tmpl
 option-pickone.tmpl
 option-trailer.tmpl
 pager.tmpl
 printer-accept.tmpl
 printer-added.tmpl
 printer-cancel-jobs.tmpl
 printer-configured.tmpl
 printer-confirm.tmpl
 printer-default.tmpl
 printer-deleted.tmpl
 printer-jobs-header.tmpl
 printer-modified.tmpl
 printer-reject.tmpl
 printer-start.tmpl
 printer-stop.tmpl
 printer.tmpl
 printers-header.tmpl
 printers.tmpl
 restart.tmpl
 search.tmpl
 set-printer-options-header.tmpl
 set-printer-options-trailer.tmpl
 test-page.tmpl
 trailer.tmpl
 users.tmpl
share/icons/hicolor/128x128/apps/cups.png
share/icons/hicolor/16x16/apps/cups.png
share/icons/hicolor/32x32/apps/cups.png
share/icons/hicolor/64x64/apps/cups.png
share/locale/ca/cups_ca.po
share/locale/cs/cups_cs.po
share/locale/de/cups_de.po
share/locale/en/cups_en.po
share/locale/es/cups_es.po
share/locale/fr/cups_fr.po
share/locale/it/cups_it.po
share/locale/ja/cups_ja.po
share/locale/pt_BR/cups_pt_BR.po
share/locale/ru/cups_ru.po
share/locale/zh_CN/cups_zh_CN.po
share/man/man1/
 cancel.1.gz
 cups-config.1.gz
 cups.1.gz
 cupstestppd.1.gz
 ippeveprinter.1.gz
 ipptool.1.gz
 lp.1.gz
 lpoptions.1.gz
 lpq.1.gz
 lpr.1.gz
 lprm.1.gz
 lpstat.1.gz
 ppdc.1.gz
 ppdhtml.1.gz
 ppdi.1.gz
 ppdmerge.1.gz
 ppdpo.1.gz
share/man/man5/
 classes.conf.5.gz
 client.conf.5.gz
 cups-files.conf.5.gz
 cups-snmp.conf.5.gz
 cupsd-logs.5.gz
 cupsd.conf.5.gz
 ipptoolfile.5.gz
 mailto.conf.5.gz
 mime.convs.5.gz
 mime.types.5.gz
 ppdcfile.5.gz
 printers.conf.5.gz
 subscriptions.conf.5.gz
share/man/man7/
 backend.7.gz
 filter.7.gz
 ippevepcl.7.gz
 ippeveps.7.gz
 notifier.7.gz
share/man/man8/
 cups-deviced.8.gz
 cups-driverd.8.gz
 cups-exec.8.gz
 cups-lpd.8.gz
 cups-snmp.8.gz
 cupsaccept.8.gz
 cupsctl.8.gz
 cupsd-helper.8.gz
 cupsd.8.gz
 cupsdisable.8.gz
 cupsenable.8.gz
 cupsfilter.8.gz
 cupsreject.8.gz
 lpadmin.8.gz
 lpc.8.gz
 lpinfo.8.gz
 lpmove.8.gz
@dir /var/log/cups
@dir /var/run/cups
@dir libexec/cups/driver
@dir share/cups/banners
@dir share/cups/data
@dir share/cups/model
@dir share/cups/profiles
@dir(,cups,) etc/cups/ppd
@dir(,cups,1770) /var/spool/cups/tmp
@dir(,cups,700) etc/cups/ssl
@dir(,cups,775) /var/cache/cups/rss
@dir(cups,,511) /var/run/cups/certs
@postexec chmod 710 /var/spool/cups && chgrp cups /var/spool/cups
@postexec chmod 770 /var/cache/cups && chgrp cups /var/cache/cups


[FILE:1837:manifests/plist.docs]
share/doc/cups/
 apple-touch-icon.png
 cups-printable.css
 cups.css
 index.html
 robots.txt
share/doc/cups/de/index.html
share/doc/cups/es/index.html
share/doc/cups/help/
 accounting.html
 admin.html
 api-admin.html
 api-filter.html
 api-ppd.html
 api-raster.html
 cgi.html
 cupspm.html
 encryption.html
 firewalls.html
 glossary.html
 kerberos.html
 license.html
 man-backend.html
 man-cancel.html
 man-classes.conf.html
 man-client.conf.html
 man-cups-config.html
 man-cups-files.conf.html
 man-cups-lpd.html
 man-cups-snmp.html
 man-cups.html
 man-cupsaccept.html
 man-cupsd-helper.html
 man-cupsd-logs.html
 man-cupsd.conf.html
 man-cupsd.html
 man-cupsenable.html
 man-cupstestppd.html
 man-filter.html
 man-ippevepcl.html
 man-ippeveprinter.html
 man-ipptool.html
 man-ipptoolfile.html
 man-lp.html
 man-lpadmin.html
 man-lpc.html
 man-lpinfo.html
 man-lpmove.html
 man-lpoptions.html
 man-lpq.html
 man-lpr.html
 man-lprm.html
 man-lpstat.html
 man-mime.convs.html
 man-mime.types.html
 man-notifier.html
 man-ppdc.html
 man-ppdhtml.html
 man-ppdi.html
 man-ppdmerge.html
 man-ppdpo.html
 man-printers.conf.html
 man-subscriptions.conf.html
 network.html
 options.html
 overview.html
 policies.html
 postscript-driver.html
 ppd-compiler.html
 raster-driver.html
 ref-ppdcfile.html
 security.html
 sharing.html
 spec-banner.html
 spec-command.html
 spec-design.html
 spec-ipp.html
 spec-ppd.html
 spec-raster.html
 spec-stp.html
 translation.html
share/doc/cups/images/
 color-wheel.png
 cups-block-diagram.png
 cups-command-chain.png
 cups-icon.png
 cups-postscript-chain.png
 cups-raster-chain.png
 cups.png
 generic.png
 left.gif
 raster-organization.png
 raster.png
 right.gif
 sample-image.png
 sel.gif
 smiley.jpg
 unsel.gif
 wait.gif
share/doc/cups/ja/index.html
share/doc/cups/pt_BR/index.html
share/doc/cups/ru/index.html


[FILE:193:manifests/plist.examples]
share/examples/cups/
 color.drv
 constraint.drv
 custom.drv
 grouping.drv
 laserjet-basic.drv
 laserjet-pjl.drv
 minimum.drv
 postscript.drv
 r300-basic.drv
 r300-colorman.drv
 r300-remote.drv


[FILE:1240:patches/patch-backend_socket.c]
--- backend/socket.c.orig	2019-12-13 14:44:10 UTC
+++ backend/socket.c
@@ -292,7 +292,6 @@ main(int  argc,				/* I - Number of comm
   */
 
   fprintf(stderr, "DEBUG: Connecting to %s:%d\n", hostname, port);
-  _cupsLangPrintFilter(stderr, "INFO", _("Connecting to printer."));
 
   for (delay = 5;;)
   {
@@ -372,7 +371,6 @@ main(int  argc,				/* I - Number of comm
   }
 
   fputs("STATE: -connecting-to-device\n", stderr);
-  _cupsLangPrintFilter(stderr, "INFO", _("Connected to printer."));
 
   fprintf(stderr, "DEBUG: Connected to %s:%d...\n",
 	  httpAddrString(&(addr->addr), addrname, sizeof(addrname)),
@@ -403,7 +401,7 @@ main(int  argc,				/* I - Number of comm
       tbytes = bytes;
 
     if (print_fd != 0 && tbytes >= 0)
-      _cupsLangPrintFilter(stderr, "INFO", _("Print file sent."));
+      fputs("DEBUG: Print file sent.\n", stderr);
   }
 
   fputs("STATE: +cups-waiting-for-job-completed\n", stderr);
@@ -414,7 +412,7 @@ main(int  argc,				/* I - Number of comm
     * Shutdown the socket and wait for the other end to finish...
     */
 
-    _cupsLangPrintFilter(stderr, "INFO", _("Waiting for printer to finish."));
+    fputs("DEBUG: Waiting for printer to finish.\n", stderr);
 
     shutdown(device_fd, 1);
 


[FILE:362:patches/patch-backend_usb-libusb.c]
--- backend/usb-libusb.c.orig	2019-12-13 14:44:10 UTC
+++ backend/usb-libusb.c
@@ -1436,7 +1436,7 @@ open_device(usb_printer_t *printer,	/* I
   * works without the module attached.
   */
 
-  errcode = libusb_kernel_driver_active(printer->handle, printer->iface);
+  errcode = 0;
   if (errcode == 0)
     printer->usblp_attached = 0;
   else if (errcode == 1)


[FILE:582:patches/patch-conf_mime.convs.in]
Lower PostScript-to-PostScript cost such that PostScript files are sent to
PostScript printers directly without intermediate conversion to PDF, see
http://www.linuxfoundation.org/collaborate/workgroups/openprinting/pdf_as_standard_print_job_format

--- conf/mime.convs.in.orig	2019-12-13 14:44:10 UTC
+++ conf/mime.convs.in
@@ -33,7 +33,7 @@
 # PostScript filters
 #
 
-application/postscript		application/vnd.cups-postscript	66	pstops
+application/postscript		application/vnd.cups-postscript	65	pstops
 
 ########################################################################
 #


[FILE:3454:patches/patch-configure]
--- configure.orig	2019-12-13 14:44:10 UTC
+++ configure
@@ -5691,7 +5691,7 @@ fi
 
 
 case $host_os_name in
-        darwin* | *bsd*)
+        darwin* | *bsd* | dragonfly* | solaris*)
                 ARFLAGS="-rcv"
                 ;;
         *)
@@ -5775,7 +5775,6 @@ fi
 fi
 LIBS="$SAVELIBS"
 
-DBUSDIR=""
 DBUS_NOTIFIER=""
 DBUS_NOTIFIERLIBS=""
 
@@ -6358,7 +6357,7 @@ _ACEOF
 # Locale data
 if test "$localedir" = "\${datarootdir}/locale"; then
 	case "$host_os_name" in
-		linux* | gnu* | *bsd* | darwin*)
+		linux* | gnu* | *bsd* | dragonfly*| darwin* | solaris*)
 			CUPS_LOCALEDIR="$datarootdir/locale"
 			;;
 
@@ -6412,11 +6411,15 @@ _ACEOF
 
 # Server executables...
 case "$host_os_name" in
-	*bsd* | darwin*)
+	*bsd* | dragonfly* | darwin* | solaris*)
 		# *BSD and Darwin (macOS)
 		INSTALL_SYSV=""
 		CUPS_SERVERBIN="$exec_prefix/libexec/cups"
 		;;
+	linux*)
+		INSTALL_SYSV="install-sysv"
+		CUPS_SERVERBIN="$exec_prefix/libexec/cups"
+		;;
 	*)
 		# All others
 		INSTALL_SYSV="install-sysv"
@@ -6473,7 +6476,7 @@ fi
 
 if test "$mandir" = "\${prefix}/man" -a "$prefix" = "/"; then
 	case "$host_os_name" in
-        	darwin* | linux* | gnu* | *bsd*)
+        	darwin* | linux* | gnu* | *bsd* | dragonfly* | solaris*)
         		# Darwin, macOS, Linux, GNU HURD, and *BSD
         		mandir="/usr/share/man"
         		;;
@@ -6511,7 +6514,7 @@ if test x$enable_shared != xno; then
 			DSOXX="\$(CXX)"
 			DSOFLAGS="$DSOFLAGS -Wl,-h\`basename \$@\` -G"
 			;;
-		linux* | gnu* | *bsd*)
+		linux* | gnu* | *bsd* | dragonfly*)
 			LIBCUPS="lib$cupsbase.so.2"
 			if test "x$cupsimagebase" != x; then
 				LIBCUPSIMAGE="lib$cupsimagebase.so.2"
@@ -6585,12 +6588,11 @@ if test "$DSO" != ":"; then
 				EXPORT_LDFLAGS="-R$libdir"
 			fi
 			;;
-                *bsd*)
+                *bsd* | dragonfly*)
                         # *BSD...
 			if test $exec_prefix != /usr; then
 				DSOFLAGS="-Wl,-R$libdir $DSOFLAGS"
 				LDFLAGS="$LDFLAGS -Wl,-R$libdir"
-				EXPORT_LDFLAGS="-Wl,-R$libdir"
 			fi
 			;;
                 linux* | gnu*)
@@ -6806,13 +6808,13 @@ if test -n "$GCC"; then
     		OPTIM="-fPIC $OPTIM"
 	fi
 
-	# The -fstack-protector option is available with some versions of
+	# The  option is available with some versions of
 	# GCC and adds "stack canaries" which detect when the return address
 	# has been overwritten, preventing many types of exploit attacks.
-	{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether compiler supports -fstack-protector" >&5
-$as_echo_n "checking whether compiler supports -fstack-protector... " >&6; }
+	{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether compiler supports " >&5
+$as_echo_n "checking whether compiler supports ... " >&6; }
 	OLDCFLAGS="$CFLAGS"
-	CFLAGS="$CFLAGS -fstack-protector"
+	CFLAGS="$CFLAGS "
 	cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
@@ -6829,7 +6831,7 @@ if ac_fn_c_try_link "$LINENO"; then :
 			# Can't use stack-protector with LSB binaries...
 			OPTIM="$OPTIM -fno-stack-protector"
 		else
-			OPTIM="$OPTIM -fstack-protector"
+			OPTIM="$OPTIM "
 		fi
 		{ $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
 $as_echo "yes" >&6; }
@@ -8562,13 +8564,7 @@ fi
 			PAMLIBS="-lpam"
 		fi
 
-		# Find the PAM configuration directory, if any...
-		for dir in /private/etc/pam.d /etc/pam.d; do
-			if test -d $dir; then
-				PAMDIR=$dir
-				break;
-			fi
-		done
+		PAMDIR=/raven/etc/pam.d
 	fi
 
 	LIBS="$SAVELIBS"


[FILE:487:patches/patch-cups_getifaddrs-internal.h]
--- cups/getifaddrs-internal.h.orig	2019-12-13 14:44:10 UTC
+++ cups/getifaddrs-internal.h
@@ -28,6 +28,14 @@
 #    define CUPS_SOCAST
 #  endif /* _WIN32 */
 
+#  if defined(__DragonFly__) || defined(__FreeBSD__)
+#    include <netinet/in.h>
+#  endif
+
+#  if !defined(_WIN32) && !defined(HAVE_GETIFADDRS)
+#    include <cups/versioning.h>
+#  endif
+
 #  if defined(__APPLE__) && !defined(_SOCKLEN_T)
 /*
  * macOS 10.2.x does not define socklen_t, and in fact uses an int instead of


[FILE:775:patches/patch-scheduler_auth.c]
--- scheduler/auth.c.orig	2019-12-13 14:44:10 UTC
+++ scheduler/auth.c
@@ -441,7 +441,7 @@ cupsdAuthorize(cupsd_client_t *con)	/* I
 
     peersize = sizeof(peercred);
 
-#  ifdef __APPLE__
+#  if defined(__APPLE__) || defined(__FreeBSD__)
     if (getsockopt(httpGetFd(con->http), 0, LOCAL_PEERCRED, &peercred, &peersize))
 #  else
     if (getsockopt(httpGetFd(con->http), SOL_SOCKET, SO_PEERCRED, &peercred, &peersize))
@@ -839,7 +839,7 @@ cupsdAuthorize(cupsd_client_t *con)	/* I
 
       peersize = sizeof(peercred);
 
-#    ifdef __APPLE__
+#    if defined(__APPLE__) || defined(__FreeBSD__)
       if (getsockopt(httpGetFd(con->http), 0, LOCAL_PEERCRED, &peercred, &peersize))
 #    else
       if (getsockopt(httpGetFd(con->http), SOL_SOCKET, SO_PEERCRED, &peercred,


[FILE:468:patches/patch-scheduler_client.c]
--- scheduler/client.c.orig	2019-12-13 14:44:10 UTC
+++ scheduler/client.c
@@ -3519,8 +3519,8 @@ pipe_command(cupsd_client_t *con,	/* I -
   * Then execute the command...
   */
 
-  if (cupsdStartProcess(command, argv, envp, infile, fds[1], CGIPipes[1],
-			-1, -1, root, DefaultProfile, NULL, &pid) < 0)
+  if (!cupsdStartProcess(command, argv, envp, infile, fds[1], CGIPipes[1],
+			 -1, -1, root, DefaultProfile, NULL, &pid))
   {
    /*
     * Error - can't fork!


[FILE:683:patches/patch-scheduler_cups-driverd.cxx]
--- scheduler/cups-driverd.cxx.orig	2019-12-13 14:44:10 UTC
+++ scheduler/cups-driverd.cxx
@@ -909,7 +909,7 @@ get_file(const char *name,		/* I - Name
   }
   else
 
-#elif defined(__linux)
+#elif defined(__linux) || defined(__FreeBSD__) || defined(__DragonFly__)
   if (!strncmp(name, "lsb/usr/", 8))
   {
    /*
@@ -1089,7 +1089,7 @@ list_ppds(int        request_id,	/* I -
   load_ppds("/System/Library/Printers/PPDs/Contents/Resources/en.lproj",
             "System/Library/Printers/PPDs/Contents/Resources/en.lproj", 0);
 
-#elif defined(__linux)
+#elif defined(__linux) || defined(__FreeBSD__) || defined(__DragonFly__)
  /*
   * Load PPDs from LSB-defined locations...
   */


[FILE:462:patches/patch-scheduler_subscriptions.c]
--- scheduler/subscriptions.c.orig	2019-12-13 14:44:10 UTC
+++ scheduler/subscriptions.c
@@ -1527,8 +1527,8 @@ cupsd_start_notifier(
   * Create the notifier process...
   */
 
-  if (cupsdStartProcess(command, argv, envp, fds[0], -1, NotifierPipes[1],
-			-1, -1, 0, DefaultProfile, NULL, &pid) < 0)
+  if (!cupsdStartProcess(command, argv, envp, fds[0], -1, NotifierPipes[1],
+			 -1, -1, 0, DefaultProfile, NULL, &pid))
   {
    /*
     * Error - can't fork!


[FILE:118:files/cups]
# $FreeBSD: head/print/cups/files/cups 410825 2016-03-11 11:53:42Z tijl $

auth	include	system
account	include	system


[FILE:318:files/cups.conf.sample]
# Allow members of group cups to access generic USB printer devices

notify 100 {
	match "system"		"USB";
	match "subsystem"	"INTERFACE";
	match "type"		"ATTACH";
	match "intclass"	"0x07";
	match "intsubclass"	"0x01";
	match "intprotocol"	"(0x01|0x02|0x03)";
	action "chgrp cups /dev/$cdev; chmod g+rw /dev/$cdev";
};


[FILE:435:files/cupsd.in]
#!/bin/sh
#
# PROVIDE: cupsd
# REQUIRE: DAEMON dbus
# KEYWORD: shutdown
#
# Add the following to /etc/rc.conf[.local] to enable this service
#
# cupsd_enable="YES"
#

. /etc/rc.subr

name="cupsd"
rcvar="cupsd_enable"

start_precmd="${name}_prestart"

command="%%PREFIX%%/sbin/cupsd"
extra_commands="reload"

cupsd_prestart()
{
	if [ -n "$TZ" ]; then
		export TZ
	fi
}

load_rc_config ${name}

: ${cupsd_enable=NO}

run_rc_command "$1"

