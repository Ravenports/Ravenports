# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		rhash
VERSION=		1.4.6
KEYWORDS=		security
VARIANTS=		std ssl
SDESC[std]=		File digest library and utility
SDESC[ssl]=		File digest utility with ssl runtime loading
HOMEPAGE=		https://github.com/rhash/RHash
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		GITHUB/rhash:RHash:v1.4.6
DISTFILE[1]=		generated:main
DF_INDEX=		1
SPKGS[std]=		set
			primary
			tools
			dev
			man
SPKGS[ssl]=		set
			primary
			tools
			dev
			man

OPTIONS_AVAILABLE=	SSL
OPTIONS_STANDARD=	none
VOPTS[ssl]=		SSL=ON

EXRUN[tools]=		primary

USES=			cpe gettext

DISTNAME=		RHash-1.4.6

LICENSE=		MIT:primary
LICENSE_FILE=		MIT:{{WRKSRC}}/COPYING
LICENSE_SCHEME=		solo

CPE_VENDOR=		rhash_project
FPC_EQUIVALENT=		security/rhash

MUST_CONFIGURE=		yes
CONFIGURE_ARGS=		--prefix="{{PREFIX}}"
			--enable-lib-shared
			--enable-lib-static
			--disable-gettext
			--extra-cflags="{{CPPFLAGS}}"
			--extra-ldflags="{{LDFLAGS}}"
			--mandir="{{MANPREFIX}}/man"

MAKE_ARGS=		INSTALL_PROGRAM="{{INSTALL_PROGRAM}}"
			INSTALL_SHARED="{{INSTALL_PROGRAM}}"

INSTALL_TARGET=		install install-pkg-config install-lib-so-link
INSTALL_REQ_TOOLCHAIN=	yes

[SSL].DESCRIPTION=			Use OpenSSL's MD5, SHA1 and SHA2 algorithms
[SSL].CONFIGURE_ARGS_OFF=		--disable-openssl
[SSL].CONFIGURE_ARGS_ON=		--enable-openssl-runtime
[SSL].USES_ON=				ssl:openssl

post-patch:
	${REINPLACE_CMD} -e 's,/etc/,${PREFIX}&,' ${WRKSRC}/parse_cmdline.c
	${REINPLACE_CMD} -e '/BYTE_ORDER/s,__,_,g' \
		${WRKSRC}/librhash/byte_order.h
	# remove windows-only function that sun linker squawks on
	# because its scraped into a symbol map while undefined
	${REINPLACE_CMD} -e '/rhash_wfile/d' ${WRKSRC}/librhash/rhash.h

post-install:
	${MV} ${STAGEDIR}${PREFIX}/etc/rhashrc \
	      ${STAGEDIR}${PREFIX}/etc/rhashrc.sample

[FILE:606:descriptions/desc.primary]
RHash is a console utility and library for computing and verifying hash sums
of files.  It supports CRC32, MD4, MD5, SHA1, SHA256, SHA512, SHA3, Tiger,
TTH, Torrent BTIH, AICH, ED2K, GOST R 34.11-94, RIPEMD-160, HAS-160, EDON-R
256/512, Whirlpool, and Snefru-128/256 hash sums.  Its features are:

  * Can calculate Magnet links
  * Output in a predefined (SFV, BSD-like) or a user-defined format
  * Ability to process directories recursively
  * Updating existing hash-files (adding hash sums of files missing in a
    hash-file)
  * Portable, written in pure C, small in size, open source (MIT license)


[FILE:60:descriptions/desc.tools]
This package contains the tools based on the RHash library.


[FILE:103:distinfo]
9f6019cfeeae8ace7067ad22da4e4f857bb2cfa6c2deaa2258f55b2227ec937a       461244 rhash-RHash-1.4.6.tar.gz


[FILE:18:manifests/plist.primary]
lib/librhash.so.1


[FILE:188:manifests/plist.tools]
@sample etc/rhashrc.sample
bin/
 ed2k-link
 edonr256-hash
 edonr512-hash
 gost12-256-hash
 gost12-512-hash
 has160-hash
 magnet-link
 rhash
 sfv-hash
 tiger-hash
 tth-hash
 whirlpool-hash


[FILE:91:manifests/plist.dev]
include/
 rhash.h
 rhash_torrent.h
lib/
 librhash.a
 librhash.so
lib/pkgconfig/librhash.pc


[FILE:196:manifests/plist.man]
share/man/man1/
 ed2k-link.1
 edonr256-hash.1
 edonr512-hash.1
 gost12-256-hash.1
 gost12-512-hash.1
 has160-hash.1
 magnet-link.1
 rhash.1
 sfv-hash.1
 tiger-hash.1
 tth-hash.1
 whirlpool-hash.1


[FILE:687:patches/patch-configure]
--- configure.orig	2025-05-13 20:58:34 UTC
+++ configure
@@ -725,9 +725,6 @@ elif darwin; then
   SHARED_EXT=".${RHASH_VERSION}.dylib"
   SO_MAJ_EXT=".${RHASH_VERSION_MAJOR}.dylib"
   SOLINK_EXT=".dylib"
-elif linux || bsd || gnu; then
-  # use the full library version for the library file extension
-  SHARED_EXT=".so.${RHASH_VERSION}"
 fi
 
 #####################################################################
@@ -1058,4 +1055,4 @@ if test -f "${MAN_PATH}.in"; then
   SED_SYSCONFDIR=$(echo $INSTALL_SYSCONFDIR | sed -e 's/\([|\\&]\)/\\\1/g')
   echo "Writing ${MAN_PATH}"
   sed -e "s|@SYSCONFDIR@|$SED_SYSCONFDIR|" ${MAN_PATH}.in > ${MAN_PATH}
-fi
\ No newline at end of file
+fi


[FILE:482:patches/patch-librhash_Makefile]
--- librhash/Makefile.orig	2025-05-13 20:58:34 UTC
+++ librhash/Makefile
@@ -27,9 +27,6 @@ install-lib-static: $(LIBRHASH_STATIC)
 install-lib-shared: $(LIBRHASH_SHARED) $(EXTRA_INSTALL_LIBSHARED)
 	$(INSTALL) -d $(SO_DIR)
 	$(INSTALL_SHARED) $(LIBRHASH_SHARED) $(SO_DIR)/
-	test "x$(LIBRHASH_SO_MAJ)" = "x$(LIBRHASH_SHARED)" || ( \
-	  rm -f $(LIBDIR)/$(LIBRHASH_SO_MAJ) && \
-	  ln -s $(LIBRHASH_SHARED) $(LIBDIR)/$(LIBRHASH_SO_MAJ) )
 
 install-implib:
 	$(INSTALL) -d $(LIBDIR)


[FILE:430:patches/patch-librhash_byte__order.h]
--- librhash/byte_order.h.orig	2025-05-13 20:58:34 UTC
+++ librhash/byte_order.h
@@ -18,6 +18,13 @@
 extern "C" {
 #endif
 
+#ifdef __sun__
+#undef  _LITTLE_ENDIAN
+#define _LITTLE_ENDIAN	1234
+#define _BIG_ENDIAN	4321
+#define _BYTE_ORDER	_LITTLE_ENDIAN
+#endif
+
 /* if x86 compatible cpu */
 #if defined(i386) || defined(__i386__) || defined(__i486__) || \
 	defined(__i586__) || defined(__i686__) || defined(__pentium__) || \

