# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		rhash
VERSION=		1.3.6
KEYWORDS=		security
VARIANTS=		standard
SDESC[standard]=	File digest library and utility
HOMEPAGE=		http://rhash.anz.ru/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		SF/rhash/rhash/1.3.6
DISTFILE[1]=		rhash-1.3.6-src.tar.gz:main
DF_INDEX=		1
SPKGS[standard]=	single

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

USES=			gettext-runtime ssl

DISTNAME=		RHash-1.3.6

LICENSE=		MIT:single
LICENSE_FILE=		MIT:{{WRKSRC}}/COPYING
LICENSE_SCHEME=		solo

FPC_EQUIVALENT=		security/rhash

MUST_CONFIGURE=		yes
CONFIGURE_ARGS=		--prefix="{{PREFIX}}"
			--disable-openssl-runtime
			--enable-lib-shared
			--enable-lib-static
			--enable-openssl
			--extra-cflags="{{CFLAGS}}"
			--extra-ldflags="{{LDFLAGS}}"
			--mandir="{{MANPREFIX}}/man"

BUILD_TARGET=		build-shared
MAKE_ARGS=		INSTALL_PROGRAM="{{INSTALL_PROGRAM}}"
			INSTALL_SHARED="{{INSTALL_PROGRAM}}"

INSTALL_TARGET=		install install-pkg-config
INSTALL_REQ_TOOLCHAIN=	yes

post-patch:
	${REINPLACE_CMD} -e 's,/etc/,${PREFIX}&,' ${WRKSRC}/parse_cmdline.c
	${REINPLACE_CMD} -e '/BYTE_ORDER/s,__,_,g' \
		${WRKSRC}/librhash/byte_order.h
	# remove windows-only function that sun linker squawks on
	# because its scraped into a symbol map while undefined
	${REINPLACE_CMD} -e '/rhash_wfile/d' ${WRKSRC}/librhash/rhash.h

post-install:
	${LN} -s librhash.so.0 ${STAGEDIR}${PREFIX}/lib/librhash.so
	${MV} ${STAGEDIR}${PREFIX}/etc/rhashrc \
	      ${STAGEDIR}${PREFIX}/etc/rhashrc.sample

[FILE:606:descriptions/desc.single]
RHash is a console utility and library for computing and verifying hash sums
of files.  It supports CRC32, MD4, MD5, SHA1, SHA256, SHA512, SHA3, Tiger,
TTH, Torrent BTIH, AICH, ED2K, GOST R 34.11-94, RIPEMD-160, HAS-160, EDON-R
256/512, Whirlpool, and Snefru-128/256 hash sums.  Its features are:

  * Can calculate Magnet links
  * Output in a predefined (SFV, BSD-like) or a user-defined format
  * Ability to process directories recursively
  * Updating existing hash-files (adding hash sums of files missing in a
    hash-file)
  * Portable, written in pure C, small in size, open source (MIT license)


[FILE:101:distinfo]
964df972b60569b5cb35ec989ced195ab8ea514fc46a74eab98e86569ffbcf92       328097 rhash-1.3.6-src.tar.gz


[FILE:475:manifests/plist.single]
@sample etc/rhashrc.sample
bin/
 ed2k-link
 edonr256-hash
 edonr512-hash
 gost-hash
 has160-hash
 magnet-link
 rhash
 sfv-hash
 tiger-hash
 tth-hash
 whirlpool-hash
include/
 rhash.h
 rhash_torrent.h
lib/
 librhash.a
 librhash.so
 librhash.so.0
lib/pkgconfig/librhash.pc
share/man/man1/
 ed2k-link.1.gz
 edonr256-hash.1.gz
 edonr512-hash.1.gz
 gost-hash.1.gz
 has160-hash.1.gz
 magnet-link.1.gz
 rhash.1.gz
 sfv-hash.1.gz
 tiger-hash.1.gz
 tth-hash.1.gz
 whirlpool-hash.1.gz


[FILE:430:patches/patch-librhash_byte__order.h]
--- librhash/byte_order.h.orig	2018-01-24 16:00:42 UTC
+++ librhash/byte_order.h
@@ -16,6 +16,13 @@
 extern "C" {
 #endif
 
+#ifdef __sun__
+#undef  _LITTLE_ENDIAN
+#define _LITTLE_ENDIAN	1234
+#define _BIG_ENDIAN	4321
+#define _BYTE_ORDER	_LITTLE_ENDIAN
+#endif
+
 /* if x86 compatible cpu */
 #if defined(i386) || defined(__i386__) || defined(__i486__) || \
 	defined(__i586__) || defined(__i686__) || defined(__pentium__) || \

