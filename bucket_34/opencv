# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		opencv
VERSION=		3.4.5
REVISION=		1
KEYWORDS=		graphics
VARIANTS=		standard
SDESC[standard]=	Open Source Computer Vision library
HOMEPAGE=		https://opencv.org/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		GITHUB/opencv:opencv:3.4.5
DISTFILE[1]=		generated:main
DF_INDEX=		1
SPKGS[standard]=	primary
			core

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILD_DEPENDS=		eigen:single:standard
BUILDRUN_DEPENDS=	jasper:primary:standard
			tiff:primary:standard
			WebP:single:standard
EXRUN[primary]=		opencv:core:standard

USES=			cmake pkgconfig jpeg png shebangfix zlib

LICENSE=		BSD3CLAUSE:primary
LICENSE_FILE=		BSD3CLAUSE:{{WRKSRC}}/LICENSE
LICENSE_SCHEME=		solo

FPC_EQUIVALENT=		graphics/opencv
SHEBANG_FILES=		cmake/templates/opencv_run_all_tests_unix.sh.in
			cmake/templates/setup_vars_linux.sh.in
			cmake/templates/setup_vars_macosx.sh.in

SOVERSION=		3.4.5
PLIST_SUB=		SOXDOTY=3.4
SUB_FILES=		FindOpenCVCore.cmake
SUB_LIST=		OCV_VERSION=3.4.5

CMAKE_ARGS=		-DWITH_VTK:BOOL=OFF
			-DWITH_CUDA:BOOL=OFF
			-DWITH_CUFFT:BOOL=OFF
			-DWITH_CUBLAS:BOOL=OFF
			-DWITH_NVCUVID:BOOL=OFF
			-DWITH_GSTREAMER_0_10:BOOL=OFF
			-DWITH_GTK:BOOL=OFF
			-DWITH_IPP:BOOL=OFF
			-DWITH_PVAPI:BOOL=OFF
			-DWITH_GIGEAPI:BOOL=OFF
			-DWITH_QUICKTIME:BOOL=OFF
			-DWITH_OPENCL_SVM:BOOL=OFF
			-DWITH_INTELPERC:BOOL=OFF
			-DWITH_IPP_A:BOOL=OFF
			-DWITH_MATLAB:BOOL=OFF
			-DWITH_VA:BOOL=OFF
			-DWITH_VA_INTEL:BOOL=OFF
			-DWITH_LAPACK:BOOL=OFF
			-DWITH_EIGEN:BOOL=ON
			-DWITH_JASPER:BOOL=ON
			-DWITH_JPEG:BOOL=ON
			-DWITH_PNG:BOOL=ON
			-DWITH_TIFF:BOOL=ON
			-DWITH_WEBP:BOOL=ON
			-DWITH_V4L:BOOL=OFF
			-DWITH-LIB4VL:BOOL=OFF
			-DBUILD_SHARED_LIBS:BOOL=ON
			-DBUILD_ANDROID_EXAMPLES:BOOL=OFF
			-DBUILD_DOCS:BOOL=OFF
			-DBUILD_PACKAGE:BOOL=OFF
			-DBUILD_PERF_TESTS:BOOL=OFF
			-DBUILD_TESTS:BOOL=OFF
			-DBUILD_WITH_DEBUG_INFO:BOOL=OFF
			-DBUILD_WITH_STATIC_CRT:BOOL=OFF
			-DBUILD_WITH_DYNAMIC_IPP:BOOL=OFF
			-DBUILD_FAT_JAVA_LIB:BOOL=OFF
			-DBUILD_ANDROID_SERVICE:BOOL=OFF
			-DBUILD_CUDA_STUBS:BOOL=OFF
			-DBUILD_ZLIB:BOOL=OFF
			-DBUILD_TIFF:BOOL=OFF
			-DBUILD_JASPER:BOOL=OFF
			-DBUILD_JPEG:BOOL=OFF
			-DBUILD_PNG:BOOL=OFF
			-DBUILD_OPENEXR:BOOL=OFF
			-DBUILD_TBB:BOOL=OFF
			-DBUILD_PROTOBUF:BOOL=OFF
			-DBUILD_EXAMPLES:BOOL=OFF
			-DENABLE_OMIT_FRAME_POINTER:BOOL=ON
			-DENABLE_FAST_MATH:BOOL=OFF
			-DENABLE_PRECOMPILED_HEADERS:BOOL=OFF
			-DEOPENCV_WARNINGS_ARE_ERRORS:BOOL=OFF
			-DANDROID_EXAMPLES_WITH_LIBS:BOOL=ON
			-DDOWNLOAD_EXTERNAL_TEST_DATA:BOOL=OFF
			-DBUILD_opencv_apps:BOOL=ON
			-DBUILD_opencv_cnn_3dobj:BOOL=OFF
			-DBUILD_opencv_ts:BOOL=OFF
			-DBUILD_opencv_world:BOOL=OFF
			-DBUILD_opencv_java:BOOL=OFF
			-DBUILD_opencv_python2:BOOL=OFF
			-DBUILD_opencv_python3:BOOL=OFF
VAR_ARCH[x86_64]=	CMAKE_ARGS=-DCPU_BASELINE_DISABLE:STRING="FP16,POPCNT,FMA3"

post-patch:
	${REINPLACE_CMD} -e 's|share/OpenCV/doc|${DOCSDIR_REL}|g' \
		-e 's|share/OpenCV/samples|${EXAMPLESDIR_REL}|g' \
		${WRKSRC}/CMakeLists.txt
	${FIND} ${WRKSRC} -name '*.orig' -delete
	${REINPLACE_CMD} -e 's|__PREFIX__|${PREFIX}|' \
		${WRKSRC}/cmake/templates/opencv_run_all_tests_unix.sh.in \
		${WRKSRC}/cmake/templates/setup_vars_linux.sh.in \
		${WRKSRC}/cmake/templates/setup_vars_macosx.sh.in \

post-install:
	${SED} -e 's|Name:.*|Name: OpenCV-core|' \
		${STAGEDIR}${PREFIX}/lib/pkgconfig/opencv.pc \
		> ${STAGEDIR}${PREFIX}/lib/pkgconfig/opencv-core.pc
	${MKDIR} ${STAGEDIR}${PREFIX}/share/cmake/Modules
	${INSTALL_DATA} ${WRKDIR}/FindOpenCVCore.cmake \
		${STAGEDIR}${PREFIX}/share/cmake/Modules
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/lib/*.so
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/opencv_*

[FILE:796:descriptions/desc.primary]
OpenCV (Open Source Computer Vision Library) is released under a BSD
license and hence it is free for both academic and commercial use. It has
C++, C, Python and Java interfaces and supports Windows, Linux, Mac OS, iOS
and Android. OpenCV was designed for computational efficiency and with a
strong focus on real-time applications. Written in optimized C/C++, the
library can take advantage of multi-core processing. Enabled with OpenCL,
it can take advantage of the hardware acceleration of the underlying
heterogeneous compute platform.

Adopted all around the world, OpenCV has more than 47 thousand people of
user community and estimated number of downloads exceeding 14 million.
Usage ranges from interactive art, to mines inspection, stitching maps on
the web or through advanced robotics.


[FILE:198:descriptions/desc.core]
OpenCV (Open Source Computer Vision Library) is released under a BSD
license and hence it is free for both academic and commercial use. 

This package contains files of the core and improc modules.


[FILE:105:distinfo]
0c57d9dd6d30cbffe68a09b03f4bebe773ee44dc8ff5cd6eaeb7f4d5ef3b428e     87999144 opencv-opencv-3.4.5.tar.gz


[FILE:5439:manifests/plist.primary]
bin/
 opencv_annotation
 opencv_createsamples
 opencv_interactive-calibration
 opencv_traincascade
 opencv_version
 opencv_visualisation
 setup_vars_opencv3.sh
include/opencv/
 cv.h
 cv.hpp
 cvaux.h
 cvaux.hpp
 cvwimage.h
 cxcore.h
 cxcore.hpp
 cxeigen.hpp
 cxmisc.h
 highgui.h
 ml.h
include/opencv2/
 calib3d.hpp
 cvconfig.h
 features2d.hpp
 flann.hpp
 highgui.hpp
 imgcodecs.hpp
 ml.hpp
 objdetect.hpp
 opencv.hpp
 opencv_modules.hpp
 photo.hpp
 shape.hpp
 stitching.hpp
 superres.hpp
 video.hpp
 videoio.hpp
 videostab.hpp
include/opencv2/calib3d/
 calib3d.hpp
 calib3d_c.h
include/opencv2/core/vsx_utils.hpp
include/opencv2/core/hal/
 intrin_avx.hpp
 intrin_vsx.hpp
include/opencv2/core/opencl/
 ocl_defs.hpp
 opencl_info.hpp
 opencl_svm.hpp
include/opencv2/core/opencl/runtime/
 opencl_clamdblas.hpp
 opencl_clamdfft.hpp
 opencl_core.hpp
 opencl_core_wrappers.hpp
 opencl_gl.hpp
 opencl_gl_wrappers.hpp
 opencl_svm_20.hpp
 opencl_svm_definitions.hpp
 opencl_svm_hsa_extension.hpp
include/opencv2/core/opencl/runtime/autogenerated/
 opencl_clamdblas.hpp
 opencl_clamdfft.hpp
 opencl_core.hpp
 opencl_core_wrappers.hpp
 opencl_gl.hpp
 opencl_gl_wrappers.hpp
include/opencv2/core/utils/
 filesystem.hpp
 logger.defines.hpp
include/opencv2/features2d/features2d.hpp
include/opencv2/features2d/hal/interface.h
include/opencv2/flann/
 all_indices.h
 allocator.h
 any.h
 autotuned_index.h
 composite_index.h
 config.h
 defines.h
 dist.h
 dummy.h
 dynamic_bitset.h
 flann.hpp
 flann_base.hpp
 general.h
 ground_truth.h
 hdf5.h
 heap.h
 hierarchical_clustering_index.h
 index_testing.h
 kdtree_index.h
 kdtree_single_index.h
 kmeans_index.h
 linear_index.h
 logger.h
 lsh_index.h
 lsh_table.h
 matrix.h
 miniflann.hpp
 nn_index.h
 object_factory.h
 params.h
 random.h
 result_set.h
 sampling.h
 saving.h
 simplex_downhill.h
 timer.h
include/opencv2/highgui/
 highgui.hpp
 highgui_c.h
include/opencv2/imgcodecs/
 imgcodecs.hpp
 imgcodecs_c.h
 ios.h
include/opencv2/ml/
 ml.hpp
 ml.inl.hpp
include/opencv2/objdetect/
 detection_based_tracker.hpp
 objdetect.hpp
 objdetect_c.h
include/opencv2/photo/
 cuda.hpp
 photo.hpp
 photo_c.h
include/opencv2/shape/
 emdL1.hpp
 hist_cost.hpp
 shape.hpp
 shape_distance.hpp
 shape_transformer.hpp
include/opencv2/stitching/warpers.hpp
include/opencv2/stitching/detail/
 autocalib.hpp
 blenders.hpp
 camera.hpp
 exposure_compensate.hpp
 matchers.hpp
 motion_estimators.hpp
 seam_finders.hpp
 timelapsers.hpp
 util.hpp
 util_inl.hpp
 warpers.hpp
 warpers_inl.hpp
include/opencv2/superres/optical_flow.hpp
include/opencv2/video/
 background_segm.hpp
 tracking.hpp
 tracking_c.h
 video.hpp
include/opencv2/videoio/
 cap_ios.h
 registry.hpp
 videoio.hpp
 videoio_c.h
include/opencv2/videostab/
 deblurring.hpp
 fast_marching.hpp
 fast_marching_inl.hpp
 frame_source.hpp
 global_motion.hpp
 inpainting.hpp
 log.hpp
 motion_core.hpp
 motion_stabilizing.hpp
 optical_flow.hpp
 outlier_rejection.hpp
 ring_buffer.hpp
 stabilizer.hpp
 wobble_suppression.hpp
lib/
 libopencv_calib3d.so
 libopencv_calib3d.so.%%SOVERSION%%
 libopencv_calib3d.so.%%SOXDOTY%%
 libopencv_features2d.so
 libopencv_features2d.so.%%SOVERSION%%
 libopencv_features2d.so.%%SOXDOTY%%
 libopencv_flann.so
 libopencv_flann.so.%%SOVERSION%%
 libopencv_flann.so.%%SOXDOTY%%
 libopencv_highgui.so
 libopencv_highgui.so.%%SOVERSION%%
 libopencv_highgui.so.%%SOXDOTY%%
 libopencv_imgcodecs.so
 libopencv_imgcodecs.so.%%SOVERSION%%
 libopencv_imgcodecs.so.%%SOXDOTY%%
 libopencv_ml.so
 libopencv_ml.so.%%SOVERSION%%
 libopencv_ml.so.%%SOXDOTY%%
 libopencv_objdetect.so
 libopencv_objdetect.so.%%SOVERSION%%
 libopencv_objdetect.so.%%SOXDOTY%%
 libopencv_photo.so
 libopencv_photo.so.%%SOVERSION%%
 libopencv_photo.so.%%SOXDOTY%%
 libopencv_shape.so
 libopencv_shape.so.%%SOVERSION%%
 libopencv_shape.so.%%SOXDOTY%%
 libopencv_stitching.so
 libopencv_stitching.so.%%SOVERSION%%
 libopencv_stitching.so.%%SOXDOTY%%
 libopencv_superres.so
 libopencv_superres.so.%%SOVERSION%%
 libopencv_superres.so.%%SOXDOTY%%
 libopencv_video.so
 libopencv_video.so.%%SOVERSION%%
 libopencv_video.so.%%SOXDOTY%%
 libopencv_videoio.so
 libopencv_videoio.so.%%SOVERSION%%
 libopencv_videoio.so.%%SOXDOTY%%
 libopencv_videostab.so
 libopencv_videostab.so.%%SOVERSION%%
 libopencv_videostab.so.%%SOXDOTY%%
lib/pkgconfig/opencv.pc
share/OpenCV/
 OpenCVConfig-version.cmake
 OpenCVConfig.cmake
 OpenCVModules-release.cmake
 OpenCVModules.cmake
 valgrind.supp
 valgrind_3rdparty.supp
share/OpenCV/haarcascades/
 haarcascade_eye.xml
 haarcascade_eye_tree_eyeglasses.xml
 haarcascade_frontalcatface.xml
 haarcascade_frontalcatface_extended.xml
 haarcascade_frontalface_alt.xml
 haarcascade_frontalface_alt2.xml
 haarcascade_frontalface_alt_tree.xml
 haarcascade_frontalface_default.xml
 haarcascade_fullbody.xml
 haarcascade_lefteye_2splits.xml
 haarcascade_licence_plate_rus_16stages.xml
 haarcascade_lowerbody.xml
 haarcascade_profileface.xml
 haarcascade_righteye_2splits.xml
 haarcascade_russian_plate_number.xml
 haarcascade_smile.xml
 haarcascade_upperbody.xml
share/OpenCV/lbpcascades/
 lbpcascade_frontalcatface.xml
 lbpcascade_frontalface.xml
 lbpcascade_frontalface_improved.xml
 lbpcascade_profileface.xml
 lbpcascade_silverware.xml
share/OpenCV/licenses/
 SoftFloat-COPYING.txt
 ittnotify-LICENSE.BSD
 ittnotify-LICENSE.GPL
 opencl-headers-LICENSE.txt
 openexr-AUTHORS.ilmbase
 openexr-AUTHORS.openexr
 openexr-LICENSE
 openexr-fix_msvc2013_errors.patch
 quirc-LICENSE


[FILE:1785:manifests/plist.core]
include/opencv2/
 core.hpp
 imgproc.hpp
include/opencv2/core/
 affine.hpp
 base.hpp
 bindings_utils.hpp
 bufferpool.hpp
 check.hpp
 core.hpp
 core_c.h
 cuda.hpp
 cuda.inl.hpp
 cuda_stream_accessor.hpp
 cuda_types.hpp
 cv_cpu_dispatch.h
 cv_cpu_helper.h
 cvdef.h
 cvstd.hpp
 cvstd.inl.hpp
 directx.hpp
 eigen.hpp
 fast_math.hpp
 ippasync.hpp
 mat.hpp
 mat.inl.hpp
 matx.hpp
 neon_utils.hpp
 ocl.hpp
 ocl_genbase.hpp
 opengl.hpp
 operations.hpp
 optim.hpp
 ovx.hpp
 persistence.hpp
 ptr.inl.hpp
 saturate.hpp
 softfloat.hpp
 sse_utils.hpp
 traits.hpp
 types.hpp
 types_c.h
 utility.hpp
 va_intel.hpp
 version.hpp
 wimage.hpp
include/opencv2/core/cuda/
 block.hpp
 border_interpolate.hpp
 color.hpp
 common.hpp
 datamov_utils.hpp
 dynamic_smem.hpp
 emulation.hpp
 filters.hpp
 funcattrib.hpp
 functional.hpp
 limits.hpp
 reduce.hpp
 saturate_cast.hpp
 scan.hpp
 simd_functions.hpp
 transform.hpp
 type_traits.hpp
 utility.hpp
 vec_distance.hpp
 vec_math.hpp
 vec_traits.hpp
 warp.hpp
 warp_reduce.hpp
 warp_shuffle.hpp
include/opencv2/core/cuda/detail/
 color_detail.hpp
 reduce.hpp
 reduce_key_val.hpp
 transform_detail.hpp
 type_traits_detail.hpp
 vec_distance_detail.hpp
include/opencv2/core/hal/
 hal.hpp
 interface.h
 intrin.hpp
 intrin_cpp.hpp
 intrin_forward.hpp
 intrin_neon.hpp
 intrin_sse.hpp
 intrin_sse_em.hpp
include/opencv2/core/utils/
 logger.hpp
 trace.hpp
include/opencv2/imgproc/
 imgproc.hpp
 imgproc_c.h
 types_c.h
include/opencv2/imgproc/detail/distortion_model.hpp
include/opencv2/imgproc/hal/
 hal.hpp
 interface.h
lib/
 libopencv_core.so
 libopencv_core.so.%%SOVERSION%%
 libopencv_core.so.%%SOXDOTY%%
 libopencv_imgproc.so
 libopencv_imgproc.so.%%SOVERSION%%
 libopencv_imgproc.so.%%SOXDOTY%%
lib/pkgconfig/opencv-core.pc
share/cmake/Modules/FindOpenCVCore.cmake


[FILE:457:patches/patch-3rdparty_ittnotify_include_ittnotify.h]
--- 3rdparty/ittnotify/include/ittnotify.h.orig	2018-12-21 14:31:20 UTC
+++ 3rdparty/ittnotify/include/ittnotify.h
@@ -146,7 +146,7 @@ The same ID may not be reused for differ
 #    define ITT_OS ITT_OS_WIN
 #  elif defined( __APPLE__ ) && defined( __MACH__ )
 #    define ITT_OS ITT_OS_MAC
-#  elif defined( __FreeBSD__ )
+#  elif defined( __FreeBSD__ ) || defined __DragonFly__
 #    define ITT_OS ITT_OS_FREEBSD
 #  else
 #    define ITT_OS ITT_OS_LINUX


[FILE:428:patches/patch-3rdparty_ittnotify_include_legacy_ittnotify.h]
--- 3rdparty/ittnotify/include/legacy/ittnotify.h.orig	2018-12-21 14:31:20 UTC
+++ 3rdparty/ittnotify/include/legacy/ittnotify.h
@@ -85,7 +85,7 @@
 #    define ITT_OS ITT_OS_WIN
 #  elif defined( __APPLE__ ) && defined( __MACH__ )
 #    define ITT_OS ITT_OS_MAC
-#  elif defined( __FreeBSD__ )
+#  elif defined( __FreeBSD__ ) || defined __DragonFly__
 #    define ITT_OS ITT_OS_FREEBSD
 #  else
 #    define ITT_OS ITT_OS_LINUX


[FILE:440:patches/patch-3rdparty_ittnotify_src_ittnotify_ittnotify__config.h]
--- 3rdparty/ittnotify/src/ittnotify/ittnotify_config.h.orig	2018-12-21 14:31:20 UTC
+++ 3rdparty/ittnotify/src/ittnotify/ittnotify_config.h
@@ -80,7 +80,7 @@
 #    define ITT_OS ITT_OS_WIN
 #  elif defined( __APPLE__ ) && defined( __MACH__ )
 #    define ITT_OS ITT_OS_MAC
-#  elif defined( __FreeBSD__ )
+#  elif defined( __FreeBSD__ ) || defined __DragonFly__
 #    define ITT_OS ITT_OS_FREEBSD
 #  else
 #    define ITT_OS ITT_OS_LINUX


[FILE:452:patches/patch-3rdparty_protobuf_src_google_protobuf_message__lite.cc]
Needed for INT_MAX on sunos

--- 3rdparty/protobuf/src/google/protobuf/message_lite.cc.orig	2018-12-21 14:31:20 UTC
+++ 3rdparty/protobuf/src/google/protobuf/message_lite.cc
@@ -40,6 +40,7 @@
 #include <google/protobuf/message_lite.h>
 #include <google/protobuf/repeated_field.h>
 #include <string>
+#include <climits>
 #include <google/protobuf/stubs/logging.h>
 #include <google/protobuf/stubs/common.h>
 #include <google/protobuf/io/coded_stream.h>


[FILE:600:patches/patch-modules_core_include_opencv2_core_utils_filesystem.private.hpp]
--- modules/core/include/opencv2/core/utils/filesystem.private.hpp.orig	2018-12-21 14:31:20 UTC
+++ modules/core/include/opencv2/core/utils/filesystem.private.hpp
@@ -12,7 +12,7 @@
 #  elif defined WINRT
      /* not supported */
 #  elif defined __ANDROID__ || defined __linux__ || defined _WIN32 || \
-        defined __FreeBSD__ || defined __bsdi__ || defined __HAIKU__
+        defined __FreeBSD__ || defined __bsdi__ || defined __HAIKU__ || defined __DragonFly__ || defined __sun__
 #      define OPENCV_HAVE_FILESYSTEM_SUPPORT 1
 #  elif defined(__APPLE__)
 #    include <TargetConditionals.h>


[FILE:457:patches/patch-modules_core_src_downhill__simplex.cpp]
Avoid DS conflict on SunOS

--- modules/core/src/downhill_simplex.cpp.orig	2018-12-21 14:31:20 UTC
+++ modules/core/src/downhill_simplex.cpp
@@ -449,7 +449,9 @@ protected:
     }
 };
 
-
+#ifdef __sun__
+#undef DS
+#endif
 // both minRange & minError are specified by termcrit.epsilon;
 // In addition, user may specify the number of iterations that the algorithm does.
 Ptr<DownhillSolver> DownhillSolver::create( const Ptr<MinProblemSolver::Function>& f,


[FILE:959:patches/patch-modules_core_src_system.cpp]
--- modules/core/src/system.cpp.orig	2018-12-21 14:31:20 UTC
+++ modules/core/src/system.cpp
@@ -94,7 +94,7 @@ void* allocSingletonBuffer(size_t size)
 #include <cstdlib>        // std::abort
 #endif
 
-#if defined __ANDROID__ || defined __linux__ || defined __FreeBSD__ || defined __HAIKU__
+#if defined __ANDROID__ || defined __linux__ || defined __FreeBSD__ || defined __HAIKU__ || defined __DragonFly__ || defined __sun__
 #  include <unistd.h>
 #  include <fcntl.h>
 #  include <elf.h>
@@ -202,7 +202,7 @@ std::wstring GetTempFileNameWinRT(std::w
 #include "omp.h"
 #endif
 
-#if defined __linux__ || defined __APPLE__ || defined __EMSCRIPTEN__ || defined __FreeBSD__ || defined __GLIBC__ || defined __HAIKU__
+#if defined __linux__ || defined __APPLE__ || defined __EMSCRIPTEN__ || defined __FreeBSD__ || defined __GLIBC__ || defined __HAIKU__ || defined __DragonFly__ || defined __sun__
 #include <unistd.h>
 #include <stdio.h>
 #include <sys/types.h>


[FILE:1683:patches/patch-modules_core_src_utils_filesystem.cpp]
--- modules/core/src/utils/filesystem.cpp.orig	2018-12-21 14:31:20 UTC
+++ modules/core/src/utils/filesystem.cpp
@@ -34,7 +34,7 @@
 #include <errno.h>
 #include <io.h>
 #include <stdio.h>
-#elif defined __linux__ || defined __APPLE__ || defined __HAIKU__ || defined __FreeBSD__
+#elif defined __linux__ || defined __APPLE__ || defined __HAIKU__ || defined __FreeBSD__ || defined __DragonFly__ || defined __sun__
 #include <sys/types.h>
 #include <sys/stat.h>
 #include <fcntl.h>
@@ -178,7 +178,7 @@ cv::String getcwd()
     sz = GetCurrentDirectoryA((DWORD)buf.size(), buf.data());
     return cv::String(buf.data(), (size_t)sz);
 #endif
-#elif defined __linux__ || defined __APPLE__ || defined __HAIKU__ || defined __FreeBSD__
+#elif defined __linux__ || defined __APPLE__ || defined __HAIKU__ || defined __FreeBSD__ || defined __DragonFly__ || defined __sun__
     for(;;)
     {
         char* p = ::getcwd(buf.data(), buf.size());
@@ -212,7 +212,7 @@ bool createDirectory(const cv::String& p
 #else
     int result = _mkdir(path.c_str());
 #endif
-#elif defined __linux__ || defined __APPLE__ || defined __HAIKU__ || defined __FreeBSD__
+#elif defined __linux__ || defined __APPLE__ || defined __HAIKU__ || defined __FreeBSD__ || defined __DragonFly__ || defined __sun__
     int result = mkdir(path.c_str(), 0777);
 #else
     int result = -1;
@@ -327,7 +327,7 @@ private:
     Impl& operator=(const Impl&); // disabled
 };
 
-#elif defined __linux__ || defined __APPLE__ || defined __HAIKU__ || defined __FreeBSD__
+#elif defined __linux__ || defined __APPLE__ || defined __HAIKU__ || defined __FreeBSD__ || defined __DragonFly__ || defined __sun__
 
 struct FileLock::Impl
 {


[FILE:386:patches/patch-modules_dnn_src_torch_THGeneral.cpp]
--- modules/dnn/src/torch/THGeneral.cpp.orig	2018-12-21 14:31:20 UTC
+++ modules/dnn/src/torch/THGeneral.cpp
@@ -2,7 +2,11 @@
 
 #if defined(TH_DISABLE_HEAP_TRACKING)
 #elif (defined(__unix) || defined(_WIN32))
+#  if defined __FreeBSD__ || defined __DragonFly__
+#include <stdlib.h>
+#  else
 #include <malloc.h>
+#  endif
 #elif defined(__APPLE__)
 #include <malloc/malloc.h>
 #endif


[FILE:302:patches/patch-modules_flann_include_opencv2_flann_defines.h]
--- modules/flann/include/opencv2/flann/defines.h.orig	2018-12-21 14:31:20 UTC
+++ modules/flann/include/opencv2/flann/defines.h
@@ -58,6 +58,9 @@
 #define FLANN_PLATFORM_32_BIT
 #endif
 
+#ifdef __sun__
+#undef CS
+#endif
 
 #undef FLANN_ARRAY_LEN
 #define FLANN_ARRAY_LEN(a) (sizeof(a)/sizeof(a[0]))


[FILE:2703:patches/patch-modules_videoio_src_cap__libv4l.cpp]
--- modules/videoio/src/cap_libv4l.cpp.orig	2018-12-21 14:31:20 UTC
+++ modules/videoio/src/cap_libv4l.cpp
@@ -251,7 +251,9 @@ make & enjoy!
 #include <sys/mman.h>
 #include <string.h>
 #include <stdlib.h>
+#ifdef __linux__
 #include <asm/types.h>          /* for videodev2.h */
+#endif
 #include <assert.h>
 #include <sys/stat.h>
 #include <sys/ioctl.h>
@@ -298,12 +300,12 @@ static unsigned int n_buffers = 0;
 /* TODO: Consider at program exit return controls to the initial values - See v4l2_free_ranges function */
 /* TODO: Consider at program exit reset the device to default values - See v4l2_free_ranges function */
 typedef struct v4l2_ctrl_range {
-  __u32 ctrl_id;
-  __s32 initial_value;
-  __s32 current_value;
-  __s32 minimum;
-  __s32 maximum;
-  __s32 default_value;
+  uint32_t ctrl_id;
+  int32_t initial_value;
+  int32_t current_value;
+  int32_t minimum;
+  int32_t maximum;
+  int32_t default_value;
 } v4l2_ctrl_range;
 
 typedef struct CvCaptureCAM_V4L
@@ -543,7 +545,7 @@ static void v4l2_add_ctrl_range(CvCaptur
   capture->v4l2_ctrl_ranges = (v4l2_ctrl_range**)realloc((v4l2_ctrl_range**)capture->v4l2_ctrl_ranges, (capture->v4l2_ctrl_count + 1) * sizeof(v4l2_ctrl_range*));
 }
 
-static int v4l2_get_ctrl_default(CvCaptureCAM_V4L* capture, __u32 id) {
+static int v4l2_get_ctrl_default(CvCaptureCAM_V4L* capture, uint32_t id) {
   int i;
   for (i = 0; i < capture->v4l2_ctrl_count; i++) {
     if (id == capture->v4l2_ctrl_ranges[i]->ctrl_id) {
@@ -553,7 +555,7 @@ static int v4l2_get_ctrl_default(CvCaptu
   return -1;
 }
 
-static int v4l2_get_ctrl_min(CvCaptureCAM_V4L* capture, __u32 id) {
+static int v4l2_get_ctrl_min(CvCaptureCAM_V4L* capture, uint32_t id) {
   int i;
   for (i = 0; i < capture->v4l2_ctrl_count; i++) {
     if (id == capture->v4l2_ctrl_ranges[i]->ctrl_id) {
@@ -563,7 +565,7 @@ static int v4l2_get_ctrl_min(CvCaptureCA
   return -1;
 }
 
-static int v4l2_get_ctrl_max(CvCaptureCAM_V4L* capture, __u32 id) {
+static int v4l2_get_ctrl_max(CvCaptureCAM_V4L* capture, uint32_t id) {
   int i;
   for (i = 0; i < capture->v4l2_ctrl_count; i++) {
     if (id == capture->v4l2_ctrl_ranges[i]->ctrl_id) {
@@ -576,7 +578,7 @@ static int v4l2_get_ctrl_max(CvCaptureCA
 
 static void v4l2_scan_controls(CvCaptureCAM_V4L* capture) {
 
-  __u32 ctrl_id;
+  uint32_t ctrl_id;
   struct v4l2_control c;
   if (capture->v4l2_ctrl_ranges != NULL) {
     v4l2_free_ranges(capture);
@@ -1660,7 +1662,7 @@ static int icvSetVideoSize( CvCaptureCAM
 
 static int icvSetControl (CvCaptureCAM_V4L* capture, int property_id, double value) {
   struct v4l2_control c;
-  __s32 ctrl_value;
+  int32_t ctrl_value;
   char name[32];
   int is_v4l2  = 1;
   int v4l2_min = 0;


[FILE:303:patches/patch-modules_videoio_src_cap__v4l.cpp]
--- modules/videoio/src/cap_v4l.cpp.orig	2018-12-21 14:31:20 UTC
+++ modules/videoio/src/cap_v4l.cpp
@@ -228,7 +228,9 @@ make & enjoy!
 #include <sys/ioctl.h>
 
 #ifdef HAVE_CAMV4L2
+#ifdef __linux__
 #include <asm/types.h>          /* for videodev2.h */
+#endif
 #include <linux/videodev2.h>
 #endif
 


[FILE:1363:files/FindOpenCVCore.cmake.in]
# Module for finding the core components of OpenCV installed by
# graphics/opencv-core.  Use for projects that require only
# opencv_core or opencv_imgproc.  Others should use the
# standard OpenCV CMake find routines provided by graphics/opencv.
#
# This module provides:
# OPENCVCORE_FOUND - defined if the required OpenCV components are found
# OpenCV_INCLUDE_DIRS - the path to the OpenCV headers
# OpenCV_LIBS - the OpenCV libraries to link to
# OpenCV_VERSION - the version of OpenCV
#
# Example usage: find_package( OpenCVCore COMPONENTS core imgproc REQUIRED )

include( FindPackageHandleStandardArgs )

set( OpenCV_VERSION %%OCV_VERSION%% )

find_path( OpenCV_INCLUDE_DIRS NAMES opencv2/core/core.hpp )

if( OpenCVCore_FIND_COMPONENTS )
  foreach( component ${OpenCVCore_FIND_COMPONENTS} )
    string( TOUPPER ${component} _COMPONENT )
    set( OPENCV_USE_${_COMPONENT} 1 )
  endforeach()
endif()

# opencv_core is always required
find_library( OPENCV_CORE_LIBRARY NAMES opencv_core )

if( OPENCV_USE_IMGPROC OR NOT OpenCVCore_FIND_COMPONENTS )
  find_library( OPENCV_IMGPROC_LIBRARY NAMES opencv_imgproc )
endif()

set( OpenCV_LIBS ${OPENCV_CORE_LIBRARY} ${OPENCV_IMGPROC_LIBRARY} )

find_package_handle_standard_args( OpenCVCore DEFAULT_MSG OpenCV_LIBS OpenCV_INCLUDE_DIRS )

mark_as_advanced( ${OpenCV_LIBS} ${OpenCV_INCLUDE_DIRS} ${OpenCV_VERSION} )

