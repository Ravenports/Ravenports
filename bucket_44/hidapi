# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		hidapi
VERSION=		0.15.0
KEYWORDS=		comms
VARIANTS=		std
SDESC[std]=		Lib to access USB and Bluetooth HID-Class devices
HOMEPAGE=		https://github.com/libusb/hidapi/
CONTACT=		Michael_Reim[kraileth@elderlinux.org]

DOWNLOAD_GROUPS=	main
SITES[main]=		https://github.com/libusb/hidapi/archive/
DISTFILE[1]=		hidapi-0.15.0.tar.gz:main
DF_INDEX=		1
SPKGS[std]=		set
			primary
			dev

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

B_DEPS[linux]=		libusb:dev:std
B_DEPS[netbsd]=		libusb:dev:std
BR_DEPS[linux]=		libusb:primary:std
BR_DEPS[netbsd]=	libusb:primary:std

USES=			cmake pkgconfig

DISTNAME=		hidapi-hidapi-0.15.0

LICENSE=		CUSTOM1:primary BSD3CLAUSE:primary GPLv3:primary
LICENSE_TERMS=		primary:{{WRKDIR}}/TERMS
LICENSE_NAME=		CUSTOM1:"Signal 11 Software License"
LICENSE_FILE=		CUSTOM1:{{WRKSRC}}/LICENSE-orig.txt
			BSD3CLAUSE:{{WRKSRC}}/LICENSE-bsd.txt
			GPLv3:{{WRKSRC}}/LICENSE-gpl3.txt
LICENSE_AWK=		TERMS:"^$$"
LICENSE_SOURCE=		TERMS:{{WRKSRC}}/hidapi/hidapi.h
LICENSE_SCHEME=		dual

FPC_EQUIVALENT=		comms/hidapi

SOVERSION=		0.15.0

CMAKE_ARGS=		-DCMAKE_POLICY_VERSION_MINIMUM=3.5

post-install:
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/lib/libhidapi-libusb.so

[FILE:324:descriptions/desc.primary]
HIDAPI is a multi-platform library which allows an application to 
interface with USB and Bluetooth HID-Class devices on Windows, Linux, 
FreeBSD and macOS.

It can be built either as a shared library or can be embedded directly 
into a target application by adding a single source file (per platform) 
and a single header.


[FILE:99:distinfo]
5d84dec684c27b97b921d2f3b73218cb773cf4ea915caee317ac8fc73cef8136       363838 hidapi-0.15.0.tar.gz


[FILE:248:manifests/plist.primary]
%%ONLY-LINUX%%lib/
 libhidapi-hidraw.so.%%SOMAJOR%%
 libhidapi-hidraw.so.%%SOVERSION%%
%%ONLY-NETBSD%%lib/
 libhidapi-netbsd.so.%%SOMAJOR%%
 libhidapi-netbsd.so.%%SOVERSION%%
lib/
 libhidapi-libusb.so.%%SOMAJOR%%
 libhidapi-libusb.so.%%SOVERSION%%


[FILE:376:manifests/plist.dev]
%%ONLY-LINUX%%lib/libhidapi-hidraw.so
%%ONLY-LINUX%%lib/pkgconfig/hidapi-hidraw.pc
%%ONLY-NETBSD%%lib/libhidapi-netbsd.so
%%ONLY-NETBSD%%lib/pkgconfig/hidapi-netbsd.pc
include/hidapi/
 hidapi.h
 hidapi_libusb.h
lib/libhidapi-libusb.so
lib/cmake/hidapi/
 hidapi-config-version.cmake
 hidapi-config.cmake
 libhidapi-release.cmake
 libhidapi.cmake
lib/pkgconfig/hidapi-libusb.pc


[FILE:526:patches/patch-netbsd_hid.c]
--- netbsd/hid.c.orig	2025-05-18 18:25:13 UTC
+++ netbsd/hid.c
@@ -1087,7 +1087,7 @@ int HID_API_EXPORT_CALL hid_get_indexed_
 	struct usb_string_desc usd;
 	usb_string_descriptor_t *str;
 	iconv_t ic;
-	const char *src;
+	char *src;
 	size_t srcleft;
 	char *dst;
 	size_t dstleft;
@@ -1131,7 +1131,7 @@ int HID_API_EXPORT_CALL hid_get_indexed_
 		return -1;
 	}
 
-	src = (const char *) str->bString;
+	src = (char *) str->bString;
 	srcleft = str->bLength - 2;
 	dst = (char *) string;
 	dstleft = sizeof(wchar_t[maxlen]);

