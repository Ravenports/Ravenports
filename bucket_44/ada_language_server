# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		ada_language_server
VERSION=		23.0.0
EPOCH=			1
KEYWORDS=		ada textproc
VARIANTS=		standard
SDESC[standard]=	Microsoft Language Server Protocol for Ada
HOMEPAGE=		https://github.com/AdaCore/ada_language_server
CONTACT=		John_Marino[draco@marino.st]

DOWNLOAD_GROUPS=	main
SITES[main]=		GITHUB/AdaCore:ada_language_server:v23.0.0
DISTFILE[1]=		generated:main
DF_INDEX=		1
SPKGS[standard]=	single

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILD_DEPENDS=		ada_libfswatch:single:standard
			libvss:single:standard
			gnatdoc:single:standard
BUILDRUN_DEPENDS=	libadalang:single:standard
			libadalang-tools:single:standard
			ada_spawn:single:standard
			gpr:single:standard

USES=			gmake gprbuild

LICENSE=		GPLv3+:single
LICENSE_TERMS=		single:{{WRKDIR}}/TERMS
LICENSE_FILE=		GPLv3+:{{WRKSRC}}/LICENSE
LICENSE_AWK=		TERMS:"^$$"
LICENSE_SOURCE=		TERMS:{{WRKSRC}}/source/server/lsp-servers.ads
LICENSE_SCHEME=		solo

MAKE_ARGS=		BUILD_MODE=prod
			OS=unix

INSTALL_REQ_TOOLCHAIN=	yes

post-install:
	${RM} -r ${STAGEDIR}${PREFIX}/share/gpr/manifests
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/*

[FILE:451:descriptions/desc.single]
Ada_Language_Server an implementation of the Microsoft Language Server
Protocol for Ada/SPARK.

Current features:
 * GNAT project files support.
 * Code completion for names, keywords, aggregates, etc.
 * Code navigation, such as Go to Definition/Declaration, Find All
   References, Call Hierarchies, etc.
 * Code refactoring like insert named associations, auto-add with-clauses.
 * Document/Workspace symbol search.
 * Code folding and formatting.


[FILE:120:distinfo]
3efa8a48e45c37fe1dffd3fb25ac5685f7b456c9315b09f8a5dbe35027694760      1224007 AdaCore-ada_language_server-23.0.0.tar.gz


[FILE:4567:manifests/plist.single]
bin/
 ada_language_server
 codec_test
 tester-run
include/codec_test/codec_test.adb
include/lsp/
 lsp-client_message_receivers.ads
 lsp-client_notification_receivers.ads
 lsp-client_request_receivers.ads
 lsp-client_response_senders.ads
 lsp-commands.adb
 lsp-commands.ads
 lsp-errors.adb
 lsp-errors.ads
 lsp-generic_notifications.adb
 lsp-generic_notifications.ads
 lsp-generic_optional.adb
 lsp-generic_optional.ads
 lsp-generic_optional_with_read_write.adb
 lsp-generic_optional_with_read_write.ads
 lsp-generic_requests.adb
 lsp-generic_requests.ads
 lsp-generic_responses.adb
 lsp-generic_responses.ads
 lsp-generic_sets.adb
 lsp-generic_sets.ads
 lsp-generic_vectors.adb
 lsp-generic_vectors.ads
 lsp-json_streams.adb
 lsp-json_streams.ads
 lsp-message_io.adb
 lsp-message_io.ads
 lsp-messages-client_notifications.adb
 lsp-messages-client_notifications.ads
 lsp-messages-client_requests.adb
 lsp-messages-client_requests.ads
 lsp-messages-client_responses.adb
 lsp-messages-client_responses.ads
 lsp-messages-common_writers.adb
 lsp-messages-common_writers.ads
 lsp-messages-server_notifications.adb
 lsp-messages-server_notifications.ads
 lsp-messages-server_requests.adb
 lsp-messages-server_requests.ads
 lsp-messages-server_responses.adb
 lsp-messages-server_responses.ads
 lsp-messages-visitors.adb
 lsp-messages-visitors.ads
 lsp-messages.adb
 lsp-messages.ads
 lsp-server_notification_receivers.ads
 lsp-server_request_receivers.ads
 lsp-server_response_senders.ads
 lsp-stdio_streams-init_others.adb
 lsp-stdio_streams-init_windows.adb
 lsp-stdio_streams.adb
 lsp-stdio_streams.ads
 lsp-types-utils.adb
 lsp-types-utils.ads
 lsp-types.adb
 lsp-types.ads
 lsp.ads
 uris.adb
 uris.ads
 vss-json-pull_readers-look_ahead.adb
 vss-json-pull_readers-look_ahead.ads
include/lsp_client/
 lsp-clients-request_handlers.ads
 lsp-clients-response_handlers.ads
 lsp-clients.adb
 lsp-clients.ads
 lsp-raw_clients.adb
 lsp-raw_clients.ads
include/lsp_client_glib/
 lsp-clients-request_handlers.ads
 lsp-clients-response_handlers.ads
 lsp-clients.adb
 lsp-clients.ads
 lsp-raw_clients.adb
 lsp-raw_clients.ads
include/tester/
 tester-macros.adb
 tester-macros.ads
 tester-run.adb
 tester-tests.adb
 tester-tests.ads
 tester.ads
lib/lsp/
 lsp-client_message_receivers.ali
 lsp-client_message_receivers.o
 lsp-client_notification_receivers.ali
 lsp-client_notification_receivers.o
 lsp-client_request_receivers.ali
 lsp-client_request_receivers.o
 lsp-client_response_senders.ali
 lsp-client_response_senders.o
 lsp-commands.ali
 lsp-commands.o
 lsp-errors.ali
 lsp-errors.o
 lsp-generic_notifications.ali
 lsp-generic_notifications.o
 lsp-generic_optional.ali
 lsp-generic_optional.o
 lsp-generic_optional_with_read_write.ali
 lsp-generic_optional_with_read_write.o
 lsp-generic_requests.ali
 lsp-generic_requests.o
 lsp-generic_responses.ali
 lsp-generic_responses.o
 lsp-generic_sets.ali
 lsp-generic_sets.o
 lsp-generic_vectors.ali
 lsp-generic_vectors.o
 lsp-json_streams.ali
 lsp-json_streams.o
 lsp-message_io.ali
 lsp-message_io.o
 lsp-messages-client_notifications.ali
 lsp-messages-client_notifications.o
 lsp-messages-client_requests.ali
 lsp-messages-client_requests.o
 lsp-messages-client_responses.ali
 lsp-messages-client_responses.o
 lsp-messages-common_writers.ali
 lsp-messages-common_writers.o
 lsp-messages-server_notifications.ali
 lsp-messages-server_notifications.o
 lsp-messages-server_requests.ali
 lsp-messages-server_requests.o
 lsp-messages-server_responses.ali
 lsp-messages-server_responses.o
 lsp-messages-visitors.ali
 lsp-messages-visitors.o
 lsp-messages.ali
 lsp-messages.o
 lsp-server_notification_receivers.ali
 lsp-server_notification_receivers.o
 lsp-server_request_receivers.ali
 lsp-server_request_receivers.o
 lsp-server_response_senders.ali
 lsp-server_response_senders.o
 lsp-stdio_streams.ali
 lsp-stdio_streams.o
 lsp-types-utils.ali
 lsp-types-utils.o
 lsp-types.ali
 lsp-types.o
 lsp.ali
 lsp.o
 uris.ali
 uris.o
 vss-json-pull_readers-look_ahead.ali
 vss-json-pull_readers-look_ahead.o
lib/lsp_client/
 lsp-clients-request_handlers.ali
 lsp-clients-request_handlers.o
 lsp-clients-response_handlers.ali
 lsp-clients-response_handlers.o
 lsp-clients.ali
 lsp-clients.o
 lsp-raw_clients.ali
 lsp-raw_clients.o
lib/lsp_client_glib/
 lsp-clients-request_handlers.ali
 lsp-clients-request_handlers.o
 lsp-clients-response_handlers.ali
 lsp-clients-response_handlers.o
 lsp-clients.ali
 lsp-clients.o
 lsp-raw_clients.ali
 lsp-raw_clients.o
share/gpr/
 codec_test.gpr
 lsp.gpr
 lsp_client.gpr
 lsp_client_glib.gpr
 tester.gpr


[FILE:1694:patches/patch-Makefile]
--- Makefile.orig	2022-09-20 14:18:47 UTC
+++ Makefile
@@ -38,13 +38,12 @@ ifeq ($(OS),Windows_NT)
    EXE=.exe
 else
    UNAME_S := $(shell uname -s)
-   ifeq ($(UNAME_S),Linux)
-      PLATFORM=linux
-      OS=unix
-   endif
    ifeq ($(UNAME_S),Darwin)
       PLATFORM=darwin
       OS=osx
+   else
+      PLATFORM=linux
+      OS=unix
    endif
    PYTHON=python3
    EXE=
@@ -77,6 +76,7 @@ all: coverage-instrument
 	$(GPRBUILD) -P gnat/codec_test.gpr -p $(COVERAGE_BUILD_FLAGS)
 	$(GPRBUILD) -P gnat/lsp_client.gpr -p $(COVERAGE_BUILD_FLAGS) \
 		-XVERSION=$(TRAVIS_TAG)
+	$(GPRBUILD) -P gnat/lsp_client_glib.gpr -p $(COVERAGE_BUILD_FLAGS)
 	mkdir -p integration/vscode/ada/$(PLATFORM)
 	cp -f $(ALS)$(EXE) integration/vscode/ada/$(PLATFORM)
 
@@ -99,16 +99,18 @@ endif
 
 install:
 	gprinstall -f -P gnat/lsp_server.gpr -p -r --mode=usage \
-		--prefix=$(DESTDIR) $(LIBRARY_FLAGS)
-	gprinstall -f -P gnat/tester.gpr -p --prefix=$(DESTDIR) $(LIBRARY_FLAGS)
-	gprinstall -f -P gnat/codec_test.gpr -p --prefix=$(DESTDIR) $(LIBRARY_FLAGS)
+		--prefix=$(DESTDIR)$(PREFIX) $(LIBRARY_FLAGS)
+	gprinstall -f -P gnat/tester.gpr -p --prefix=$(DESTDIR)$(PREFIX) $(LIBRARY_FLAGS)
+	gprinstall -f -P gnat/codec_test.gpr -p --prefix=$(DESTDIR)$(PREFIX) $(LIBRARY_FLAGS)
 	gprinstall -f -P gnat/lsp_client.gpr -p -r	\
 		--mode=dev				\
-		--prefix=$(DESTDIR)			\
+		--prefix=$(DESTDIR)$(PREFIX)		\
 		$(LIBRARY_FLAGS)
+	gprinstall -f -P gnat/lsp_client_glib.gpr -p -r \
+		--prefix=$(DESTDIR)$(PREFIX) $(LIBRARY_FLAGS)
 ifneq ($(COVERAGE),)
 	mkdir -p $(DESTDIR)/share/als/sids || true
-	cp .obj/*/*.sid $(DESTDIR)/share/als/sids/
+	cp .obj/*/*.sid $(DESTDIR)$(PREFIX)/share/als/sids/
 endif
 
 clean:

