# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		facter
VERSION=		3.12.0
KEYWORDS=		sysutils
VARIANTS=		standard
SDESC[standard]=	Cross-platform library for retrieving OS facts
HOMEPAGE=		https://github.com/puppetlabs/facter
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		GITHUB/puppetlabs:facter:3.12.0
DISTFILE[1]=		generated:main
DF_INDEX=		1
SPKGS[standard]=	single

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

NOT_FOR_OPSYS=		dragonfly

BUILDRUN_DEPENDS=	curl:primary:standard
			leatherman:single:standard
			cpp-hocon:single:standard
			yaml-cpp:single:standard
			boost-libraries:rest:python_default

USES=			ssl cmake ruby

LICENSE=		APACHE20:single
LICENSE_TERMS=		single:{{WRKSRC}}/LICENSE
LICENSE_FILE=		APACHE20:stock
LICENSE_SCHEME=		solo

FPC_EQUIVALENT=		sysutils/facter

SOVERSION=		3.12.0

CMAKE_ARGS=		-DWITHOUT_JRUBY:BOOL=ON

post-patch:
	${REINPLACE_CMD} -e 's|%%PREFIX%%|${PREFIX}|g' \
		${WRKSRC}/lib/src/facts/posix/cache.cc \
		${WRKSRC}/lib/src/facts/posix/collection.cc \
		${WRKSRC}/lib/src/util/config/posix/config.cc
	# ignore MANDIR override by FreeBSD
	${REINPLACE_CMD} -e 's,OpenBSD|FreeBSD,disable,' \
		${WRKSRC}/CMakeLists.txt

post-install:
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/lib/*.so
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/facter

[FILE:161:descriptions/desc.single]
Facter is Puppet's cross-platform system profiling library.

It discovers and reports per-node facts, which are
available in your Puppet manifests as variables.


[FILE:110:distinfo]
abd98d5eaedecf0016dd154273cb85ed26e8d726c8dc2b9d6227ff59f9bcf724       390445 puppetlabs-facter-3.12.0.tar.gz


[FILE:473:manifests/plist.single]
bin/facter
include/facter/
 cwrapper.hpp
 export.h
 version.h
include/facter/facts/
 array_value.hpp
 collection.hpp
 fact.hpp
 map_value.hpp
 os.hpp
 os_family.hpp
 resolver.hpp
 scalar_value.hpp
 value.hpp
 vm.hpp
include/facter/facts/external/resolver.hpp
include/facter/logging/logging.hpp
include/facter/ruby/ruby.hpp
include/facter/util/
 config.hpp
 string.hpp
lib/
 libfacter.so
 libfacter.so.%%SOVERSION%%
lib/ruby/vendor_ruby/facter.rb
share/man/man8/facter.8.gz


[FILE:516:patches/patch-cmake_FindCPPHOCON.cmake]
--- cmake/FindCPPHOCON.cmake.orig	2018-09-14 15:27:42 UTC
+++ cmake/FindCPPHOCON.cmake
@@ -1,5 +1,5 @@
 include(FindDependency)
-find_dependency(CPPHOCON DISPLAY "cpp-hocon" HEADERS "hocon/config.hpp" LIBRARIES "libcpp-hocon.a")
+find_dependency(CPPHOCON DISPLAY "cpp-hocon" HEADERS "hocon/config.hpp" LIBRARIES "liblibcpp-hocon.so")
 
 include(FeatureSummary)
 set_package_properties(CPPHOCON PROPERTIES DESCRIPTION "A C++ parser for the HOCON configuration language" URL "https://github.com/puppetlabs/cpp-hocon")


[FILE:382:patches/patch-lib_src_facts_posix_cache.cc]
--- lib/src/facts/posix/cache.cc.orig	2018-09-14 15:27:42 UTC
+++ lib/src/facts/posix/cache.cc
@@ -3,7 +3,7 @@
 namespace facter { namespace facts { namespace cache {
 
     std::string fact_cache_location() {
-        return "/opt/puppetlabs/facter/cache/cached_facts/";
+        return "%%PREFIX%%/var/facter/cache/cached_facts/";
     }
 
 }}}  // namespace facter::facts::cache


[FILE:673:patches/patch-lib_src_facts_posix_collection.cc]
--- lib/src/facts/posix/collection.cc.orig	2018-09-14 15:27:42 UTC
+++ lib/src/facts/posix/collection.cc
@@ -26,9 +26,8 @@ namespace facter { namespace facts {
                 directories.emplace_back(home + "/.facter/facts.d");
             }
         } else {
-            directories.emplace_back("/opt/puppetlabs/facter/facts.d");
-            directories.emplace_back("/etc/facter/facts.d");
-            directories.emplace_back("/etc/puppetlabs/facter/facts.d");
+            directories.emplace_back("%%PREFIX%%/etc/facter/facts.d");
+            directories.emplace_back("%%PREFIX%%/etc/puppetlabs/facter/facts.d");
         }
         return directories;
     }


[FILE:374:patches/patch-lib_src_util_config_posix_config.cc]
--- lib/src/util/config/posix/config.cc.orig	2018-09-14 15:27:42 UTC
+++ lib/src/util/config/posix/config.cc
@@ -7,6 +7,6 @@ namespace facter { namespace util { name
     }
 
     std::string default_config_location() {
-        return "/etc/puppetlabs/facter/facter.conf";
+        return "%%PREFIX%%/etc/facter/facter.conf";
     }
 }}}  // namespace facter::util::config

