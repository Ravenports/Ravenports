# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		gnatformat
VERSION=		26.0.0
KEYWORDS=		textproc ada
VARIANTS=		std
SDESC[std]=		Ada code formatter based on Prettier-Ada library
HOMEPAGE=		https://github.com/AdaCore/gnatformat
CONTACT=		John_Marino[draco@marino.st]

DOWNLOAD_GROUPS=	main
SITES[main]=		GITHUB/AdaCore:gnatformat:v26.0.0
DISTFILE[1]=		generated:main
DF_INDEX=		1
SPKGS[std]=		set
			primary
			tools
			dev

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILD_DEPENDS=		libadalang:dev:std
			vss-extra:dev:std
BUILDRUN_DEPENDS=	libadalang:primary:std
			vss-extra:primary:std
EXRUN[tools]=		gmp:primary:std

USES=			gprbuild iconv:build gmake

LICENSE=		APACHE20:primary
LICENSE_TERMS=		primary:{{WRKDIR}}/TERMS
LICENSE_FILE=		APACHE20:{{WRKSRC}}/LICENSE.txt
LICENSE_AWK=		TERMS:"^$$"
LICENSE_SOURCE=		TERMS:{{WRKSRC}}/src/gnatformat.ads
LICENSE_SCHEME=		solo

BUILD_TARGET=		lib bin
MAKE_ARGS=		PROCESSORS={{MAKE_JOBS_NUMBER}}
MAKE_ENV=		GPR_PROJECT_PATH={{WRKSRC}}

INSTALL_REQ_TOOLCHAIN=	yes
SOVERSION=		26.0.0

post-install:
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/gnatformat
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/lib/libgnatformat.so

pre-configure:
	${REINPLACE_CMD} -e 's/@SOVERSION@/26.0.0/' ${WRKSRC}/gnat/gnatformat.gpr

[FILE:505:descriptions/desc.primary]
GNATformat

This project implements an opinionated code formatter for the Ada language.
It is based on the Prettier-Ada library, a port of the Prettier formatter
engine to the Ada programming language.

The intent of gnatformat is to format a valid Ada source code according to
the coding style described in the GNAT Coding Style guide.

Usage:
gnatformat can be used as a command line tool or as a library.

As a command line tool, for a given GNAT project, execute
   > gnatformat -P [project_name].gpr


[FILE:57:descriptions/desc.tools]
This package contains the standalone gnatformat program.


[FILE:111:distinfo]
826caa75ccd4684fb3f6cda3c91d70ac9127e810bbd4644fd96b6f00d7bb1642       273619 AdaCore-gnatformat-26.0.0.tar.gz


[FILE:104:manifests/plist.primary]
lib/libgnatformat.so.%%SOVERSION%%
lib/gnatformat/gnatformat.relocatable/libgnatformat.so.%%SOVERSION%%


[FILE:15:manifests/plist.tools]
bin/gnatformat


[FILE:1455:manifests/plist.dev]
include/gnatformat/gnatformat/
 gnatformat-configuration.adb
 gnatformat-configuration.ads
 gnatformat-edits.adb
 gnatformat-edits.ads
 gnatformat-formatting.adb
 gnatformat-formatting.ads
 gnatformat-helpers.adb
 gnatformat-helpers.ads
 gnatformat-utils.ads
 gnatformat.ads
include/gnatformat/gnatformat_driver/
 gitdiff.adb
 gitdiff.ads
 gnatformat-abstract_writers.ads
 gnatformat-ada_driver.adb
 gnatformat-command_line-configuration.adb
 gnatformat-command_line-configuration.ads
 gnatformat-command_line.ads
 gnatformat-console_writers.adb
 gnatformat-console_writers.ads
 gnatformat-file_writers.adb
 gnatformat-file_writers.ads
 gnatformat-full_format.adb
 gnatformat-full_format.ads
 gnatformat-project.adb
 gnatformat-project.ads
 gnatformat-range_format.adb
 gnatformat-range_format.ads
lib/libgnatformat.so
lib/gnatformat/gnatformat.relocatable/
 gnatformat-configuration.ali
 gnatformat-edits.ali
 gnatformat-formatting.ali
 gnatformat-helpers.ali
 gnatformat-utils.ali
 gnatformat.ali
 libgnatformat.so
lib/gnatformat/gnatformat.static/
 gnatformat-configuration.ali
 gnatformat-edits.ali
 gnatformat-formatting.ali
 gnatformat-helpers.ali
 gnatformat-utils.ali
 gnatformat.ali
 libgnatformat.a
lib/gnatformat/gnatformat.static-pic/
 gnatformat-configuration.ali
 gnatformat-edits.ali
 gnatformat-formatting.ali
 gnatformat-helpers.ali
 gnatformat-utils.ali
 gnatformat.ali
 libgnatformat.a
share/gpr/
 gnatformat.gpr
 gnatformat_driver.gpr


[FILE:931:patches/patch-Makefile]
--- Makefile.orig	2025-09-24 12:13:12 UTC
+++ Makefile
@@ -70,7 +70,8 @@ install-lib:
 			-XLIBRARY_TYPE=$$library_type \
 			-XGNATFORMAT_BUILD_MODE=$(BUILD_MODE) \
 			--install-name=gnatformat \
-			--prefix="$(PREFIX)" \
+			--prefix="$(DESTDIR)$(PREFIX)" \
+			--no-manifests \
 			--sources-subdir=include/gnatformat \
 			--build-name=$$library_type \
 			--build-var=LIBRARY_TYPE \
@@ -86,7 +87,8 @@ install-bin:
 		-XLIBRARY_TYPE=$(LIBRARY_TYPE) \
 		-XBUILD_MODE=$(BUILD_MODE) \
 		--install-name=gnatformat \
-		--prefix="$(PREFIX)" \
+		--prefix="$(DESTDIR)$(PREFIX)" \
+		--no-manifests \
 		-P $(GNATFORMAT_DRIVER_PROJECT) \
 		-p \
 		-f ;
@@ -103,7 +105,8 @@ install-bin-stripped:
 		-XLIBRARY_TYPE=$(LIBRARY_TYPE) \
 		-XBUILD_MODE=$(BUILD_MODE) \
 		--install-name=gnatformat \
-		--prefix="$(PREFIX)" \
+		--prefix="$(DESTDIR)$(PREFIX)" \
+		--no-manifests \
 		-P $(GNATFORMAT_DRIVER_PROJECT) \
 		-p \
 		-f ;


[FILE:418:patches/patch-gnat_gnatformat.gpr]
--- gnat/gnatformat.gpr.orig	2025-09-24 12:13:12 UTC
+++ gnat/gnatformat.gpr
@@ -17,6 +17,7 @@ library project Gnatformat is
    Build_Slug := Library_Type & "." & Gnatformat_Common.Build_Mode;
 
    for Library_Name use "gnatformat";
+   for Library_Version use "libgnatformat.so.@SOVERSION@";
    for Library_Dir use "../lib/" & Build_Slug;
    for Library_Kind use Library_Type;
    for Source_Dirs use ("../src");

