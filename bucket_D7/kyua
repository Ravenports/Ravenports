# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		kyua
VERSION=		0.14.1
KEYWORDS=		devel
VARIANTS=		std
SDESC[std]=		Testing framework for infrastructure software
HOMEPAGE=		https://github.com/jmmv
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		GITHUB/freebsd:kyua:kyua-0.14.1
DISTFILE[1]=		generated:main
DF_INDEX=		1
SPKGS[std]=		set
			primary
			man

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILD_DEPENDS=		atf:dev:std
BUILDRUN_DEPENDS=	lutok:primary:std
			atf:primary:std

USERS=			tests
GROUPS=			rpnobody
USERGROUP_SPKG=		primary

USES=			lua:5.4 pkgconfig sqlite autoreconf

LICENSE=		BSD3CLAUSE:primary
LICENSE_FILE=		BSD3CLAUSE:{{WRKSRC}}/LICENSE
LICENSE_SCHEME=		solo

FPC_EQUIVALENT=		devel/kyua

MUST_CONFIGURE=		gnu
CONFIGURE_ARGS=		--without-doxygen
			--docdir={{STD_DOCDIR}}

MAKE_ARGS=		examplesdir={{STD_EXAMPLESDIR}}

post-install:
	${MKDIR} ${STAGEDIR}${PREFIX}/etc/kyua/
	${INSTALL_DATA} ${FILESDIR}/kyua.conf \
		${STAGEDIR}${PREFIX}/etc/kyua/kyua.conf.sample
	${RM} -r ${STAGEDIR}${STD_DOCDIR}
	${RM} -r ${STAGEDIR}${STD_EXAMPLESDIR}

[FILE:867:descriptions/desc.primary]
Kyua is a testing framework for infrastructure software, originally
designed to equip BSD-based operating systems with a test suite.  This
means that Kyua is lightweight and simple, and that Kyua integrates well
with various build systems and continuous integration frameworks.

Kyua features an expressive test suite definition language, a safe
runtime engine for test suites and a powerful report generation engine.

Kyua is for both developers and users, from the developer applying a
simple fix to a library to the system administrator deploying a new
release on a production machine.

Kyua is able to execute test programs written with a plethora of testing
libraries and languages.  The library of choice is ATF, for which Kyua
was originally designed, but simple, framework-less test programs and
TAP-compliant test programs can also be executed through Kyua.


[FILE:110:distinfo]
0818efe916f07bd3f7b32c530e0a3af2fcb28529569e47758a37a4ea6d5783dd       522558 freebsd-kyua-kyua-0.14.1.tar.gz


[FILE:187:manifests/plist.primary]
@sample etc/kyua/kyua.conf.sample
bin/kyua
share/kyua/misc/
 context.html
 index.html
 report.css
 test_result.html
share/kyua/store/
 migrate_v1_v2.sql
 migrate_v2_v3.sql
 schema_v3.sql


[FILE:238:manifests/plist.man]
share/man/man1/
 kyua-about.1
 kyua-config.1
 kyua-db-exec.1
 kyua-db-migrate.1
 kyua-debug.1
 kyua-help.1
 kyua-list.1
 kyua-report-html.1
 kyua-report-junit.1
 kyua-report.1
 kyua-test.1
 kyua.1
share/man/man5/
 kyua.conf.5
 kyuafile.5


[FILE:277:patches/patch-os_freebsd_utils_jail.cpp]
--- os/freebsd/utils/jail.cpp.orig	2025-03-29 21:43:20 UTC
+++ os/freebsd/utils/jail.cpp
@@ -27,6 +27,7 @@
 // OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 
 #include "os/freebsd/utils/jail.hpp"
+#include <cstring>
 
 extern "C" {
 #include <limits.h>


[FILE:371:files/kyua.conf]
--
-- System-wide configuration file for kyua(1).  See kyua.conf(5) for details
-- on the syntax.
--

syntax(2)

-- User to drop privileges to when invoking kyua(1) as root and a test case
-- requests to be run with non-root permissions.
unprivileged_user = 'tests'

-- An example to set a configuration property specific to FreeBSD.
--test_suites.FreeBSD.fstype = 'ffs'

