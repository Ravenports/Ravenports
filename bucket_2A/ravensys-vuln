# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		ravensys-vuln
VERSION=		1.2rc
KEYWORDS=		raven
VARIANTS=		std
SDESC[std]=		Ravenports Vulnerability Database
HOMEPAGE=		https://github.com/Ravenports/vulnerability_server
CONTACT=		John_Marino[draco@marino.st]

DOWNLOAD_GROUPS=	main
SITES[main]=		GITHUB/Ravenports:vulnerability_server:2a18bd2
DISTFILE[1]=		generated:main
DF_INDEX=		1
SPKGS[std]=		single

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

RUN_DEPENDS=		mariadb114:server:std
			python-mysql-connector-python:single:python_default
			python-PyYAML:single:python_default

USES=			python:run

LICENSE=		ISCL:single
LICENSE_FILE=		ISCL:{{WRKSRC}}/LICENSE
LICENSE_SCHEME=		solo

MAKE_ARGS=		PORTNAME={{NAMEBASE}}

SUB_FILES=		messages-single.ucl

INFRASTRUCTURE=		yes

[FILE:336:descriptions/desc.single]
This package installs the service that queries the National Vulnerability
Database for all Ravenports that have a defined CPE string.  This is
done once per day.

It also install a dedicated web server on port (configurable but 8008
is the default).  This web server queries the local database for
queries by remote rvn audit commands.


[FILE:125:distinfo]
b3d3c9138c98e7259cb69fc51eb9b77c54134f96572aa7ac050e88709ea9eaef         9832 Ravenports-vulnerability_server-2a18bd2.tar.gz


[FILE:230:manifests/plist.single]
@sample etc/vuln.conf.sample
etc/newsyslog.conf.d/rpaudit.conf
etc/periodic/daily/125.ravenports_nvd
etc/rc.d/ravencve
sbin/
 rpaudit.sh
 rpcve.py
share/ravensys-vuln/
 check_vulnerability.py
 scan_repology_json.py
 structure.sql


[FILE:725:files/messages-single.ucl.in]
primary: {
  type: "install"
  message: <<EOM
To populate the database, see comments in the 
%%PREFIX%%/share/ravensys-vuln/structure.sql file.
Once the mysql/mariadb server is ready, finish the configuration
by editing the %%PREFIX%%/etc/vuln.conf file.

To run the scraper daily, either set a cron task
    e.g [ 5 21 * * * %%PREFIX%%/bin/rpaudit.sh ]
    Note: see comments in rpaudit.sh to rotate /var/log/rpaudit logs

-or- by adding the following lines to /etc/periodic.conf:

local_periodic="%%PREFIX%%/etc/periodic /usr/local/etc/periodic"
daily_rp_audit_enable="YES"
daily_output="/var/log/daily.log"

The latter is not recommended unless the daily output is sent
to the daily.log rather than the root's mail.
EOM
}

