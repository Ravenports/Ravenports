# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		libnatpmp
VERSION=		20230423
KEYWORDS=		net
VARIANTS=		standard
SDESC[standard]=	Library for NAT Port Mapping Protocol
HOMEPAGE=		https://github.com/miniupnp/libnatpmp
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		GITHUB/miniupnp:libnatpmp:a7d2fd6
DISTFILE[1]=		generated:main
DF_INDEX=		1
SPKGS[standard]=	single

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

USES=			gmake

LICENSE=		BSD3CLAUSE:single
LICENSE_FILE=		BSD3CLAUSE:{{WRKSRC}}/LICENSE
LICENSE_SCHEME=		solo

FPC_EQUIVALENT=		net/libnatpmp

MAKE_ARGS=		CC="{{CC}}"
MAKE_ENV=		INSTALLPREFIX={{PREFIX}}

post-install:
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/natpmpc \
		${STAGEDIR}${PREFIX}/lib/libnatpmp.so

[FILE:276:descriptions/desc.single]
libnatpmp is an attempt to make a portable and fully compliant
implementation of the protocol for the client side. It is based on
non-blocking sockets and all calls of the API are asynchronous. It is
therefore very easy to integrate the NAT-PMP code to any event driven code.


[FILE:112:distinfo]
ecc880c8b0e20fcbdafffe58cb34581a0f9930ebac5e0206b849fc653f61c39a        27734 miniupnp-libnatpmp-a7d2fd6.tar.gz


[FILE:122:manifests/plist.single]
bin/natpmpc
include/
 natpmp.h
 natpmp_declspec.h
lib/
 libnatpmp.a
 libnatpmp.so
 libnatpmp.so.1
lib/pkgconfig/natpmp.pc


[FILE:2347:patches/patch-Makefile]
From f7fd32e5409a9e85fa41ae7cf3cf3498b8402904 Mon Sep 17 00:00:00 2001
From: Ka Ho Ng <khng@FreeBSD.org>
Date: Tue, 25 Jan 2022 23:10:56 -0500
Subject: [PATCH] Makefile: prepend DESTDIR to INSTALLDIRx variables

This allows the files to be first staged instead of being directly
installed into the path specified in INSTALLPREFIX.

The purpose is to allow the FreeBSD ports Makefile to cleanly install
the files into the stagedir without hacks.

Sponsored by:	The FreeBSD Foundation
---
 Makefile | 26 +++++++++++++-------------
 1 file changed, 13 insertions(+), 13 deletions(-)

--- Makefile.orig
+++ Makefile
@@ -110,16 +110,16 @@ depend:
 	makedepend -f$(MAKEFILE_LIST) -Y $(OBJS:.o=.c) 2>/dev/null
 
 install:	$(HEADERS) $(STATICLIB) $(SHAREDLIB) natpmpc-shared natpmp.pc
-	$(INSTALL) -d $(INSTALLDIRINC)
-	$(INSTALL) -m 644 $(HEADERS) $(INSTALLDIRINC)
-	$(INSTALL) -d $(INSTALLDIRLIB)
-	$(INSTALL) -m 644 $(STATICLIB) $(INSTALLDIRLIB)
-	$(INSTALL) -m 644 $(SHAREDLIB) $(INSTALLDIRLIB)/$(SONAME)
+	$(INSTALL) -d $(DESTDIR)$(INSTALLDIRINC)
+	$(INSTALL) -m 644 $(HEADERS) $(DESTDIR)$(INSTALLDIRINC)
+	$(INSTALL) -d $(DESTDIR)$(INSTALLDIRLIB)
+	$(INSTALL) -m 644 $(STATICLIB) $(DESTDIR)$(INSTALLDIRLIB)
+	$(INSTALL) -m 644 $(SHAREDLIB) $(DESTDIR)$(INSTALLDIRLIB)/$(SONAME)
 	$(INSTALL) -d $(DESTDIR)$(PKGCONFIGDIR)
 	$(INSTALL) -m 644 natpmp.pc $(DESTDIR)$(PKGCONFIGDIR)
-	$(INSTALL) -d $(INSTALLDIRBIN)
-	$(INSTALL) -m 755 natpmpc-shared $(INSTALLDIRBIN)/natpmpc
-	ln -s -f $(SONAME) $(INSTALLDIRLIB)/$(SHAREDLIB)
+	$(INSTALL) -d $(DESTDIR)$(INSTALLDIRBIN)
+	$(INSTALL) -m 755 natpmpc-shared $(DESTDIR)$(INSTALLDIRBIN)/natpmpc
+	ln -s -f $(SONAME) $(DESTDIR)$(INSTALLDIRLIB)/$(SHAREDLIB)
 
 $(JNIHEADERS): fr/free/miniupnp/libnatpmp/NatPmp.class
 	$(JAVAH) -jni fr.free.miniupnp.libnatpmp.NatPmp
@@ -169,11 +169,11 @@ mvn_install:
 	 -DcreateChecksum=true
 
 cleaninstall:
-	$(RM) $(addprefix $(INSTALLDIRINC), $(HEADERS))
-	$(RM) $(INSTALLDIRLIB)/$(SONAME)
-	$(RM) $(INSTALLDIRLIB)/$(SHAREDLIB)
-	$(RM) $(INSTALLDIRLIB)/$(STATICLIB)
-	$(RM) $(INSTALLDIRLIB)/$(PKGCONFIGDIR)
+	$(RM) $(addprefix $(DESTDIR)$(INSTALLDIRINC)/, $(HEADERS))
+	$(RM) $(DESTDIR)$(INSTALLDIRLIB)/$(SONAME)
+	$(RM) $(DESTDIR)$(INSTALLDIRLIB)/$(SHAREDLIB)
+	$(RM) $(DESTDIR)$(INSTALLDIRLIB)/$(STATICLIB)
+	$(RM) $(DESTDIR)$(PKGCONFIGDIR)
 
 natpmp.pc: VERSION
 	$(RM) $@

