# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		gdal
VERSION=		3.7.0
KEYWORDS=		graphics geography
VARIANTS=		standard
SDESC[standard]=	Geospatial Data Abstraction Library
HOMEPAGE=		https://www.gdal.org/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		http://download.osgeo.org/gdal/3.7.0/
DISTFILE[1]=		gdal-3.7.0.tar.xz:main
DF_INDEX=		1
SPKGS[standard]=	complete
			primary
			tools
			dev
			man

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILD_DEPENDS=		geos:dev:standard
			Imath:dev:standard
			libheif:dev:standard
			openexr:dev:standard
			proj:dev:standard
			hdf5:dev:standard
			WebP:dev:standard
BUILDRUN_DEPENDS=	libgeotiff:single:standard
			cfitsio:primary:standard
			WebP:primary:standard
			openjpeg:single:standard
			libheif:primary:standard
			hdf5:primary:standard
			geos:primary:standard
			openexr:primary:standard
			proj:primary:standard
			libarchive:single:standard
EXRUN[tools]=		gdal:primary:standard

USES=			cpe cmake png jpeg gif tiff iconv sqlite pkgconfig
			zstd expat lz4 zlib xz pcre2 ssl curl
GNOME_COMPONENTS=	libxml2

DISTNAME=		gdal-3.7.0

LICENSE=		MIT:primary
LICENSE_FILE=		MIT:{{WRKSRC}}/LICENSE.TXT
LICENSE_SCHEME=		solo

CPE_VENDOR=		osgeo
FPC_EQUIVALENT=		graphics/gdal

PLIST_SUB=		GDAL_SOMAJOR=33
			GDAL_SOVERSION=33.3.7.0

CMAKE_ARGS=		-DGDAL_USE_INTERNAL_LIBS=OFF
			-DGDAL_USE_JSONC_INTERNAL=ON
			-DGDAL_USE_LERC_INTERNAL=ON
			-DGDAL_USE_JPEG12_INTERNAL=ON
			-DGDAL_USE_OPENCAD_INTERNAL=ON
			-DGDAL_USE_QHULL_INTERNAL=ON
			-DGDAL_USE_CFITSIO=ON
			-DGDAL_USE_EXPAT=ON
			-DGDAL_USE_GEOS=ON
			-DGDAL_USE_GEOTIFF=ON
			-DGDAL_USE_GIF=ON
			-DGDAL_USE_HDF5=ON
			-DGDAL_USE_HEIF=ON
			-DGDAL_USE_ICONV=ON
			-DGDAL_USE_JPEG=ON
			-DGDAL_USE_LIBXML2=ON
			-DGDAL_USE_LZ4=ON
			-DGDAL_USE_OPENEXR=ON
			-DGDAL_USE_OPENJPEG=ON
			-DGDAL_USE_PCRE2=ON
			-DGDAL_USE_PNG=ON
			-DGDAL_USE_SQLITE3=ON
			-DGDAL_USE_TIFF=ON
			-DGDAL_USE_WEBP=ON
			-DGDAL_USE_ZLIB=ON
			-DGDAL_USE_ZSTD=ON
			-DGDAL_USE_ARMADILLO=OFF
			-DGDAL_USE_ARROW=OFF
			-DGDAL_USE_BASISU=OFF
			-DGDAL_USE_BLOSC=OFF
			-DGDAL_USE_BRUNSLI=OFF
			-DGDAL_USE_CRNLIB=OFF
			-DGDAL_USE_CURL=OFF
			-DGDAL_USE_CRYPTOPP=OFF
			-DGDAL_USE_DEFLATE=OFF
			-DGDAL_USE_ECW=OFF
			-DGDAL_USE_FILEGDB=OFF
			-DGDAL_USE_FREEXL=OFF
			-DGDAL_USE_FYBA=OFF
			-DGDAL_USE_GTA=OFF
			-DGDAL_USE_HDF4=OFF
			-DGDAL_USE_IDB=OFF
			-DGDAL_USE_JXL=OFF
			-DGDAL_USE_KDU=OFF
			-DGDAL_USE_KEA=OFF
			-DGDAL_USE_LIBKML=OFF
			-DGDAL_USE_LIBQB3=OFF
			-DGDAL_USE_LURATECH=OFF
			-DGDAL_USE_MONGOCXX=OFF
			-DGDAL_USE_MRSID=OFF
			-DGDAL_USE_MSSQL_NCLI=OFF
			-DGDAL_USE_MSSQL_ODBC=OFF
			-DGDAL_USE_MYSQL=OFF
			-DGDAL_USE_NETCDF=OFF
			-DGDAL_USE_ODBC=OFF
			-DGDAL_USE_ODBCCPP=OFF
			-DGDAL_USE_OGDI=OFF
			-DGDAL_USE_OPENCL=OFF
			-DGDAL_USE_OPENSSL=OFF
			-DGDAL_USE_ORACLE=OFF
			-DGDAL_USE_PARQUET=OFF
			-DGDAL_USE_PDFIUM=OFF
			-DGDAL_USE_POPPLER=OFF
			-DGDAL_USE_POSTGRESQL=OFF
			-DGDAL_USE_RASTERLITE2=OFF
			-DGDAL_USE_RDB=OFF
			-DGDAL_USE_SPATIALITE=OFF
			-DGDAL_USE_SFCGAL=OFF
			-DGDAL_USE_TEIGHA=OFF
			-DGDAL_USE_TILEDB=OFF
			-DGDAL_USE_XERCESC=OFF
			-DBUILD_PYTHON_BINDINGS=OFF

post-install:
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/gdal[^-]*
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/gnm*
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/[nos]*
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/lib/libgdal.so

[FILE:644:descriptions/desc.primary]
GDAL - Geospatial Data Abstraction Library

GDAL/OGR is a translator library for raster and vector geospatial data
formats that is released under an Open Source license. As a library, it
presents a single abstract data model to the calling application for all
supported formats.

Current translators provide read (and sometimes write) access to a
variety of formats including ESRI Shapefiles, S-57, SDTS, PostGIS,
Oracle Spatial, Mapinfo mid/mif and TAB, GeoTIFF, Erdas Imagine,
ESRI .BIL, .aux labelled raw, DTED, SDTS DEM, JPEG, PNG and Arc/Info
Binary/ASCII Grid.

A full list of supported data formats is available on the official
website.


[FILE:57:descriptions/desc.tools]
This package contains geospatial data abstraction tools.


[FILE:96:distinfo]
af4b26a6b6b3509ae9ccf1fcc5104f7fe015ef2110f5ba13220816398365adce      8604724 gdal-3.7.0.tar.xz


[FILE:65:manifests/plist.primary]
lib/
 libgdal.so.%%GDAL_SOMAJOR%%
 libgdal.so.%%GDAL_SOVERSION%%


[FILE:4261:manifests/plist.tools]
bin/
 gdal_contour
 gdal_create
 gdal_grid
 gdal_rasterize
 gdal_translate
 gdal_viewshed
 gdaladdo
 gdalbuildvrt
 gdaldem
 gdalenhance
 gdalinfo
 gdallocationinfo
 gdalmanage
 gdalmdiminfo
 gdalmdimtranslate
 gdalsrsinfo
 gdaltindex
 gdaltransform
 gdalwarp
 gnmanalyse
 gnmmanage
 nearblack
 ogr2ogr
 ogrinfo
 ogrlineref
 ogrtindex
 sozip
lib/gdalplugins/drivers.ini
share/bash-completion/completions/
 gdal-config
 gdal2tiles.py
 gdal2xyz.py
 gdal_calc.py
 gdal_contour
 gdal_create
 gdal_edit.py
 gdal_fillnodata.py
 gdal_grid
 gdal_merge.py
 gdal_polygonize.py
 gdal_proximity.py
 gdal_rasterize
 gdal_retile.py
 gdal_sieve.py
 gdal_translate
 gdal_viewshed
 gdaladdo
 gdalbuildvrt
 gdalchksum.py
 gdalcompare.py
 gdaldem
 gdalenhance
 gdalident.py
 gdalimport.py
 gdalinfo
 gdallocationinfo
 gdalmanage
 gdalmove.py
 gdalsrsinfo
 gdaltindex
 gdaltransform
 gdalwarp
 ogr2ogr
 ogrinfo
 ogrlineref
 ogrmerge.py
 ogrtindex
share/gdal/
 GDALLogoBW.svg
 GDALLogoColor.svg
 GDALLogoGS.svg
 LICENSE.TXT
 bag_template.xml
 cubewerx_extra.wkt
 default.rsc
 ecw_cs.wkt
 eedaconf.json
 epsg.wkt
 esri_StatePlane_extra.wkt
 gdalicon.png
 gdalinfo_output.schema.json
 gdalmdiminfo_output.schema.json
 gdalvrt.xsd
 gml_registry.xml
 gmlasconf.xml
 gmlasconf.xsd
 grib2_center.csv
 grib2_process.csv
 grib2_subcenter.csv
 grib2_table_4_2_0_0.csv
 grib2_table_4_2_0_1.csv
 grib2_table_4_2_0_13.csv
 grib2_table_4_2_0_14.csv
 grib2_table_4_2_0_15.csv
 grib2_table_4_2_0_16.csv
 grib2_table_4_2_0_17.csv
 grib2_table_4_2_0_18.csv
 grib2_table_4_2_0_19.csv
 grib2_table_4_2_0_190.csv
 grib2_table_4_2_0_191.csv
 grib2_table_4_2_0_2.csv
 grib2_table_4_2_0_20.csv
 grib2_table_4_2_0_21.csv
 grib2_table_4_2_0_3.csv
 grib2_table_4_2_0_4.csv
 grib2_table_4_2_0_5.csv
 grib2_table_4_2_0_6.csv
 grib2_table_4_2_0_7.csv
 grib2_table_4_2_10_0.csv
 grib2_table_4_2_10_1.csv
 grib2_table_4_2_10_191.csv
 grib2_table_4_2_10_2.csv
 grib2_table_4_2_10_3.csv
 grib2_table_4_2_10_4.csv
 grib2_table_4_2_1_0.csv
 grib2_table_4_2_1_1.csv
 grib2_table_4_2_1_2.csv
 grib2_table_4_2_20_0.csv
 grib2_table_4_2_20_1.csv
 grib2_table_4_2_20_2.csv
 grib2_table_4_2_2_0.csv
 grib2_table_4_2_2_3.csv
 grib2_table_4_2_2_4.csv
 grib2_table_4_2_2_5.csv
 grib2_table_4_2_2_6.csv
 grib2_table_4_2_3_0.csv
 grib2_table_4_2_3_1.csv
 grib2_table_4_2_3_2.csv
 grib2_table_4_2_3_3.csv
 grib2_table_4_2_3_4.csv
 grib2_table_4_2_3_5.csv
 grib2_table_4_2_3_6.csv
 grib2_table_4_2_4_0.csv
 grib2_table_4_2_4_1.csv
 grib2_table_4_2_4_10.csv
 grib2_table_4_2_4_2.csv
 grib2_table_4_2_4_3.csv
 grib2_table_4_2_4_4.csv
 grib2_table_4_2_4_5.csv
 grib2_table_4_2_4_6.csv
 grib2_table_4_2_4_7.csv
 grib2_table_4_2_4_8.csv
 grib2_table_4_2_4_9.csv
 grib2_table_4_2_local_Canada.csv
 grib2_table_4_2_local_HPC.csv
 grib2_table_4_2_local_MRMS.csv
 grib2_table_4_2_local_NCEP.csv
 grib2_table_4_2_local_NDFD.csv
 grib2_table_4_2_local_index.csv
 grib2_table_4_5.csv
 grib2_table_versions.csv
 gt_datum.csv
 gt_ellips.csv
 header.dxf
 inspire_cp_BasicPropertyUnit.gfs
 inspire_cp_CadastralBoundary.gfs
 inspire_cp_CadastralParcel.gfs
 inspire_cp_CadastralZoning.gfs
 jpfgdgml_AdmArea.gfs
 jpfgdgml_AdmBdry.gfs
 jpfgdgml_AdmPt.gfs
 jpfgdgml_BldA.gfs
 jpfgdgml_BldL.gfs
 jpfgdgml_Cntr.gfs
 jpfgdgml_CommBdry.gfs
 jpfgdgml_CommPt.gfs
 jpfgdgml_Cstline.gfs
 jpfgdgml_ElevPt.gfs
 jpfgdgml_GCP.gfs
 jpfgdgml_LeveeEdge.gfs
 jpfgdgml_RailCL.gfs
 jpfgdgml_RdASL.gfs
 jpfgdgml_RdArea.gfs
 jpfgdgml_RdCompt.gfs
 jpfgdgml_RdEdg.gfs
 jpfgdgml_RdMgtBdry.gfs
 jpfgdgml_RdSgmtA.gfs
 jpfgdgml_RvrMgtBdry.gfs
 jpfgdgml_SBAPt.gfs
 jpfgdgml_SBArea.gfs
 jpfgdgml_SBBdry.gfs
 jpfgdgml_WA.gfs
 jpfgdgml_WL.gfs
 jpfgdgml_WStrA.gfs
 jpfgdgml_WStrL.gfs
 netcdf_config.xsd
 nitf_spec.xml
 nitf_spec.xsd
 ogrinfo_output.schema.json
 ogrvrt.xsd
 osmconf.ini
 ozi_datum.csv
 ozi_ellips.csv
 pci_datum.txt
 pci_ellips.txt
 pdfcomposition.xsd
 pds4_template.xml
 plscenesconf.json
 ruian_vf_ob_v1.gfs
 ruian_vf_st_uvoh_v1.gfs
 ruian_vf_st_v1.gfs
 ruian_vf_v1.gfs
 s57agencies.csv
 s57attributes.csv
 s57expectedinput.csv
 s57objectclasses.csv
 seed_2d.dgn
 seed_3d.dgn
 stateplane.csv
 template_tiles.mapml
 tms_LINZAntarticaMapTileGrid.json
 tms_MapML_APSTILE.json
 tms_MapML_CBMTILE.json
 tms_NZTM2000.json
 trailer.dxf
 vdv452.xml
 vdv452.xsd
 vicar.json


[FILE:1207:manifests/plist.dev]
bin/gdal-config
include/
 cpl_atomic_ops.h
 cpl_auto_close.h
 cpl_compressor.h
 cpl_config.h
 cpl_config_extras.h
 cpl_conv.h
 cpl_csv.h
 cpl_error.h
 cpl_hash_set.h
 cpl_http.h
 cpl_json.h
 cpl_list.h
 cpl_minixml.h
 cpl_minizip_ioapi.h
 cpl_minizip_unzip.h
 cpl_minizip_zip.h
 cpl_multiproc.h
 cpl_port.h
 cpl_progress.h
 cpl_quad_tree.h
 cpl_spawn.h
 cpl_string.h
 cpl_time.h
 cpl_virtualmem.h
 cpl_vsi.h
 cpl_vsi_error.h
 cpl_vsi_virtual.h
 cplkeywordparser.h
 gdal.h
 gdal_alg.h
 gdal_alg_priv.h
 gdal_csv.h
 gdal_frmts.h
 gdal_mdreader.h
 gdal_pam.h
 gdal_priv.h
 gdal_proxy.h
 gdal_rat.h
 gdal_simplesurf.h
 gdal_utils.h
 gdal_version.h
 gdal_vrt.h
 gdalcachedpixelaccessor.h
 gdalgeorefpamdataset.h
 gdalgrid.h
 gdalgrid_priv.h
 gdaljp2abstractdataset.h
 gdaljp2metadata.h
 gdalpansharpen.h
 gdalwarper.h
 gnm.h
 gnm_api.h
 gnmgraph.h
 memdataset.h
 ogr_api.h
 ogr_core.h
 ogr_feature.h
 ogr_featurestyle.h
 ogr_geocoding.h
 ogr_geometry.h
 ogr_p.h
 ogr_recordbatch.h
 ogr_spatialref.h
 ogr_srs_api.h
 ogr_swq.h
 ogrsf_frmts.h
 rawdataset.h
 vrtdataset.h
lib/libgdal.so
lib/cmake/gdal/
 GDAL-targets-release.cmake
 GDAL-targets.cmake
 GDALConfig.cmake
 GDALConfigVersion.cmake
lib/pkgconfig/gdal.pc


[FILE:775:manifests/plist.man]
share/man/man1/
 gdal-config.1.gz
 gdal2tiles.1.gz
 gdal_calc.1.gz
 gdal_contour.1.gz
 gdal_create.1.gz
 gdal_edit.1.gz
 gdal_fillnodata.1.gz
 gdal_grid.1.gz
 gdal_merge.1.gz
 gdal_pansharpen.1.gz
 gdal_polygonize.1.gz
 gdal_proximity.1.gz
 gdal_rasterize.1.gz
 gdal_retile.1.gz
 gdal_sieve.1.gz
 gdal_translate.1.gz
 gdal_viewshed.1.gz
 gdaladdo.1.gz
 gdalbuildvrt.1.gz
 gdalcompare.1.gz
 gdaldem.1.gz
 gdalinfo.1.gz
 gdallocationinfo.1.gz
 gdalmanage.1.gz
 gdalmdiminfo.1.gz
 gdalmdimtranslate.1.gz
 gdalmove.1.gz
 gdalsrsinfo.1.gz
 gdaltindex.1.gz
 gdaltransform.1.gz
 gdalwarp.1.gz
 gnmanalyse.1.gz
 gnmmanage.1.gz
 nearblack.1.gz
 ogr2ogr.1.gz
 ogr_layer_algebra.1.gz
 ogrinfo.1.gz
 ogrlineref.1.gz
 ogrmerge.1.gz
 ogrtindex.1.gz
 pct2rgb.1.gz
 rgb2pct.1.gz
 sozip.1.gz


[FILE:664:patches/patch-gdal.cmake]
--- gdal.cmake.orig	2023-05-02 13:47:12 UTC
+++ gdal.cmake
@@ -280,7 +280,7 @@ endif ()
 if (CMAKE_CXX_COMPILER_ID MATCHES "Clang" OR CMAKE_CXX_COMPILER_ID STREQUAL "GNU")
   include(CheckLinkerFlag)
   check_linker_flag(C "-Wl,--no-undefined" HAS_NO_UNDEFINED)
-  if (HAS_NO_UNDEFINED AND (NOT "${CMAKE_CXX_FLAGS}" MATCHES "-fsanitize") AND NOT CMAKE_SYSTEM_NAME MATCHES "OpenBSD")
+  if (HAS_NO_UNDEFINED AND (NOT "${CMAKE_CXX_FLAGS}" MATCHES "-fsanitize") AND NOT CMAKE_SYSTEM_NAME MATCHES "OpenBSD|MidnightBSD")
     string(APPEND CMAKE_SHARED_LINKER_FLAGS " -Wl,--no-undefined")
     string(APPEND CMAKE_MODULE_LINKER_FLAGS " -Wl,--no-undefined")
   endif ()


[FILE:292:patches/patch-port_cpl__conv.cpp]
Avoid visibility define that masks usage that is apparently beyond XOPEN or C99.

--- port/cpl_conv.cpp.orig	2023-05-02 13:47:12 UTC
+++ port/cpl_conv.cpp
@@ -48,8 +48,6 @@
 #endif
 #endif
 
-// For atoll (at least for NetBSD)
-#define _ISOC99_SOURCE
 
 #ifdef MSVC_USE_VLD
 #include <vld.h>


[FILE:403:patches/patch-port_cpl__multiproc.cpp]
--- port/cpl_multiproc.cpp.orig	2023-05-02 13:47:12 UTC
+++ port/cpl_multiproc.cpp
@@ -1423,7 +1423,11 @@ int CPLGetNumCPUs()
     nCPUs = 1;
 #endif
 
-#ifdef HAVE_SCHED_GETAFFINITY
+#if defined(HAVE_SCHED_GETAFFINITY) \
+ && defined(CPU_ALLOC) \
+ && defined(CPU_ALLOC_SIZE) \
+ && defined(CPU_ZERO_S) \
+ && defined(CPU_COUNT_S)
     if (nCPUs > 1)
     {
         cpu_set_t *set = CPU_ALLOC(nCPUs);


[FILE:410:patches/patch-port_cpl__port.h]
--- port/cpl_port.h.orig	2023-05-02 13:47:12 UTC
+++ port/cpl_port.h
@@ -675,7 +675,7 @@ extern "C++"
 }
 #else
 #define CPLIsNan(x) isnan(x)
-#if defined(isinf) || defined(__FreeBSD__)
+#if defined(isinf) || defined(__FreeBSD__) || defined(__DragonFly__)
 /** Return whether a floating-pointer number is +/- infinity */
 #define CPLIsInf(x) isinf(x)
 /** Return whether a floating-pointer number is finite */


[FILE:321:patches/patch-port_cpl__spawn.cpp]
--- port/cpl_spawn.cpp.orig	2023-05-02 13:47:12 UTC
+++ port/cpl_spawn.cpp
@@ -57,7 +57,7 @@
 #include <crt_externs.h>
 #define environ (*_NSGetEnviron())
 #else
-#if defined(__FreeBSD__)
+#if defined(__FreeBSD__) || defined(__DragonFly__)
 extern __attribute__((__weak__)) char **environ;
 #else
 extern char **environ;

