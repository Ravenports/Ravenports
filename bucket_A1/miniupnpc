# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		miniupnpc
VERSION=		2.2.5
KEYWORDS=		net
VARIANTS=		standard
SDESC[standard]=	UPnP client library for Internet Gateway Devices
HOMEPAGE=		http://miniupnp.free.fr/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		http://miniupnp.free.fr/files/
DISTFILE[1]=		miniupnpc-2.2.5.tar.gz:main
DF_INDEX=		1
SPKGS[standard]=	complete
			primary
			dev
			man

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

USES=			cmake

LICENSE=		BSD3CLAUSE:primary
LICENSE_FILE=		BSD3CLAUSE:{{WRKSRC}}/LICENSE
LICENSE_SCHEME=		solo

FPC_EQUIVALENT=		net/miniupnpc

SOVERSION=		2.2.5
PLIST_SUB=		SOMAJOR=17
RC_SUBR=		miniupnpc:primary

[FILE:274:descriptions/desc.primary]
UPnP IGD client lightweight library

The usage of the miniUPnP client library is useful whenever an application
needs to listen for incoming connections.

Examples : P2P applications, FTP clients for active mode, IRC (for DCC)
or IM applications, network games, any server.


[FILE:101:distinfo]
38acd5f4602f7cf8bcdc1ec30b2d58db2e9912e5d9f5350dd99b06bfdffb517c       103654 miniupnpc-2.2.5.tar.gz


[FILE:127:manifests/plist.primary]
bin/
 external-ip.sh
 listdevices
 upnpc-shared
 upnpc-static
lib/
 libminiupnpc.so.%%SOMAJOR%%
 libminiupnpc.so.%%SOVERSION%%


[FILE:440:manifests/plist.dev]
include/miniupnpc/
 igd_desc_parse.h
 miniupnpc.h
 miniupnpc_declspec.h
 miniupnpctypes.h
 miniwget.h
 portlistingparse.h
 upnpcommands.h
 upnpdev.h
 upnperrors.h
 upnpreplyparse.h
lib/
 libminiupnpc.a
 libminiupnpc.so
lib/cmake/miniupnpc/
 libminiupnpc-shared-release.cmake
 libminiupnpc-shared.cmake
 libminiupnpc-static-release.cmake
 libminiupnpc-static.cmake
 miniupnpc-config.cmake
 miniupnpc-private.cmake
lib/pkgconfig/miniupnpc.pc


[FILE:30:manifests/plist.man]
share/man/man3/miniupnpc.3.gz


[FILE:563:patches/patch-CMakeLists.txt]
--- CMakeLists.txt.orig	2022-10-21 21:11:12 UTC
+++ CMakeLists.txt
@@ -32,7 +32,7 @@ if (NOT WIN32)
   target_compile_definitions(miniupnpc-private INTERFACE
     MINIUPNPC_SET_SOCKET_TIMEOUT
     _BSD_SOURCE _DEFAULT_SOURCE)
-  if (NOT APPLE AND NOT CMAKE_SYSTEM_NAME MATCHES ".*BSD" AND NOT CMAKE_SYSTEM_NAME STREQUAL "SunOS")
+  if (NOT CMAKE_SYSTEM_NAME MATCHES "(Darwin|FreeBSD|SunOS|DragonFly|NetBSD|MidnightBSD)")
     # add_definitions (-D_POSIX_C_SOURCE=200112L)
     target_compile_definitions(miniupnpc-private INTERFACE _XOPEN_SOURCE=600)
   endif ()


[FILE:391:patches/patch-setup.py]
--- setup.py.orig	2021-09-28 21:11:31 UTC
+++ setup.py
@@ -30,6 +30,6 @@ setup(name="miniupnpc",
       cmdclass={'build_ext': make_then_build_ext},
       ext_modules=[
          Extension(name="miniupnpc", sources=["src/miniupnpcmodule.c"],
-                   include_dirs=['include'], extra_objects=EXT)
+                   include_dirs=['include'], libraries=["miniupnpc"])
       ])
 


[FILE:691:files/miniupnpc.in]
#!/bin/sh
# PROVIDE: miniupnpc
# REQUIRE: NETWORKING SERVERS DAEMON ldconfig resolv
# KEYWORD: shutdown

. /etc/rc.subr

# Add the following lines to /etc/rc.conf to enable miniupnpc
# miniupnpc_enable="YES"
# miniupnpc_config="port protocol [port2 protocol2] [...]"

name="miniupnpc"
rcvar=miniupnpc_enable

load_rc_config $name

miniupnpc_enable=${miniupnpc_enable:-"NO"}

command="%%PREFIX%%/bin/upnpc"
start_cmd="miniupnpc_start"
stop_cmd="miniupnpc_stop"

miniupnpc_start() {
	eval "${command} -r ${miniupnpc_config} | grep duration"
}

miniupnpc_stop() {
	echo "Remove redirections" ${miniupnpc_config}
	eval ${command} -d ${miniupnpc_config} > /dev/null
}

run_rc_command "$1"

# eof

