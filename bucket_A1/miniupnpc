# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		miniupnpc
VERSION=		2.2.3
KEYWORDS=		net
VARIANTS=		standard
SDESC[standard]=	UPnP client library for Internet Gateway Devices
HOMEPAGE=		http://miniupnp.free.fr/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		http://miniupnp.free.fr/files/
DISTFILE[1]=		miniupnpc-2.2.3.tar.gz:main
DF_INDEX=		1
SPKGS[standard]=	single

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

USES=			cmake

LICENSE=		BSD3CLAUSE:single
LICENSE_FILE=		BSD3CLAUSE:{{WRKSRC}}/LICENSE
LICENSE_SCHEME=		solo

FPC_EQUIVALENT=		net/miniupnpc

RC_SUBR=		miniupnpc:single

[FILE:274:descriptions/desc.single]
UPnP IGD client lightweight library

The usage of the miniUPnP client library is useful whenever an application
needs to listen for incoming connections.

Examples : P2P applications, FTP clients for active mode, IRC (for DCC)
or IM applications, network games, any server.


[FILE:101:distinfo]
dce41b4a4f08521c53a0ab163ad2007d18b5e1aa173ea5803bd47a1be3159c24       101360 miniupnpc-2.2.3.tar.gz


[FILE:456:manifests/plist.single]
include/miniupnpc/
 igd_desc_parse.h
 miniupnpc.h
 miniupnpc_declspec.h
 miniupnpctypes.h
 miniwget.h
 portlistingparse.h
 upnpcommands.h
 upnpdev.h
 upnperrors.h
 upnpreplyparse.h
lib/
 libminiupnpc.a
 libminiupnpc.so
 libminiupnpc.so.17
 libminiupnpc.so.2.2.3
lib/cmake/miniupnpc/
 libminiupnpc-shared-release.cmake
 libminiupnpc-shared.cmake
 libminiupnpc-static-release.cmake
 libminiupnpc-static.cmake
 miniupnpc-config.cmake
 miniupnpc-private.cmake


[FILE:1291:patches/patch-CMakeLists.txt]
--- CMakeLists.txt.orig	2021-09-28 21:41:25 UTC
+++ CMakeLists.txt
@@ -29,7 +29,7 @@ if (NOT WIN32)
   target_compile_definitions(miniupnpc-private INTERFACE
     MINIUPNPC_SET_SOCKET_TIMEOUT
     _BSD_SOURCE _DEFAULT_SOURCE)
-  if (NOT CMAKE_SYSTEM_NAME STREQUAL "Darwin" AND NOT CMAKE_SYSTEM_NAME STREQUAL "FreeBSD" AND NOT CMAKE_SYSTEM_NAME STREQUAL "SunOS")
+  if (NOT CMAKE_SYSTEM_NAME STREQUAL "Darwin" AND NOT CMAKE_SYSTEM_NAME STREQUAL "FreeBSD" AND NOT CMAKE_SYSTEM_NAME STREQUAL "SunOS" AND NOT CMAKE_SYSTEM_NAME STREQUAL "DragonFly")
     # add_definitions (-D_POSIX_C_SOURCE=200112L)
     target_compile_definitions(miniupnpc-private INTERFACE _XOPEN_SOURCE=600)
   endif ()
@@ -221,16 +221,16 @@ endif ()
 
 if (NOT UPNPC_NO_INSTALL)
   install (FILES
-    miniupnpc.h
-    miniwget.h
-    upnpcommands.h
-    igd_desc_parse.h
-    upnpreplyparse.h
-    upnperrors.h
-    upnpdev.h
-    miniupnpctypes.h
-    portlistingparse.h
-    miniupnpc_declspec.h
+    include/miniupnpc.h
+    include/miniwget.h
+    include/upnpcommands.h
+    include/igd_desc_parse.h
+    include/upnpreplyparse.h
+    include/upnperrors.h
+    include/upnpdev.h
+    include/miniupnpctypes.h
+    include/portlistingparse.h
+    include/miniupnpc_declspec.h
     DESTINATION include/miniupnpc
   )
 


[FILE:391:patches/patch-setup.py]
--- setup.py.orig	2021-09-28 21:11:31 UTC
+++ setup.py
@@ -30,6 +30,6 @@ setup(name="miniupnpc",
       cmdclass={'build_ext': make_then_build_ext},
       ext_modules=[
          Extension(name="miniupnpc", sources=["src/miniupnpcmodule.c"],
-                   include_dirs=['include'], extra_objects=EXT)
+                   include_dirs=['include'], libraries=["miniupnpc"])
       ])
 


[FILE:691:files/miniupnpc.in]
#!/bin/sh
# PROVIDE: miniupnpc
# REQUIRE: NETWORKING SERVERS DAEMON ldconfig resolv
# KEYWORD: shutdown

. /etc/rc.subr

# Add the following lines to /etc/rc.conf to enable miniupnpc
# miniupnpc_enable="YES"
# miniupnpc_config="port protocol [port2 protocol2] [...]"

name="miniupnpc"
rcvar=miniupnpc_enable

load_rc_config $name

miniupnpc_enable=${miniupnpc_enable:-"NO"}

command="%%PREFIX%%/bin/upnpc"
start_cmd="miniupnpc_start"
stop_cmd="miniupnpc_stop"

miniupnpc_start() {
	eval "${command} -r ${miniupnpc_config} | grep duration"
}

miniupnpc_stop() {
	echo "Remove redirections" ${miniupnpc_config}
	eval ${command} -d ${miniupnpc_config} > /dev/null
}

run_rc_command "$1"

# eof

