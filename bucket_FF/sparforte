# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		sparforte
VERSION=		2.6.3
KEYWORDS=		shells lang
VARIANTS=		std
SDESC[std]=		Shell and scripting for mission-critical projects
HOMEPAGE=		http://www.sparforte.com
CONTACT=		John_Marino[draco@marino.st]

DOWNLOAD_GROUPS=	main
SITES[main]=		GITHUB/kburtch:SparForte:v2.6.3
DISTFILE[1]=		generated:main
DF_INDEX=		1
SPKGS[std]=		set
			primary
			man
			examples
			docs

OPTIONS_AVAILABLE=	CGI OPENGL SOUND MYSQL PGSQL PCRE L10N SDL
OPTIONS_STANDARD=	CGI OPENGL SOUND MYSQL PGSQL PCRE L10N SDL
OPTGROUP_RESTRICTED=	DBASE
OPTDESCR[DBASE]=	Databases supported
OPTGROUP[DBASE]=	MYSQL PGSQL
OPT_ON[all]=		MYSQL PGSQL SOUND PCRE L10N

BROKEN[aarch64]=	fails to compile: gnat1: error: unknown value aarch64 for -march

USES=			bdb gettext gmake pkgconfig readline execinfo ssl
			zstd

LICENSE=		GPLv2+:primary
LICENSE_TERMS=		primary:{{WRKDIR}}/TERMS
LICENSE_FILE=		GPLv2+:{{WRKSRC}}/COPYING
LICENSE_AWK=		TERMS:"^$$"
LICENSE_SOURCE=		TERMS:{{WRKSRC}}/src/spar.adb
LICENSE_SCHEME=		solo

MUST_CONFIGURE=		yes
CONFIGURE_SCRIPT=	new_configure

MAKE_ARGS=		RPM_BUILD_ROOT=1
SINGLE_JOB=		yes

VAR_OPSYS[freebsd]=	MAKEFILE_LINE=SF_CFLAGSTYPE=-DFREEBSD
			MAKEFILE_LINE=OSBIND=os_bindings/spar_freebsd
VAR_OPSYS[linux]=	MAKEFILE_LINE=SF_CFLAGSTYPE=-DLINUX
			MAKEFILE_LINE=OSBIND=os_bindings/spar_linux
VAR_OPSYS[netbsd]=	MAKEFILE_LINE=SF_CFLAGSTYPE=-DFREEBSD
			MAKEFILE_LINE=OSBIND=os_bindings/spar_freebsd
VAR_OPSYS[dragonfly]=	MAKEFILE_LINE=SF_CFLAGSTYPE=-DFREEBSD
			MAKEFILE_LINE=OSBIND=os_bindings/spar_freebsd
VAR_OPSYS[midnightbsd]=	MAKEFILE_LINE=SF_CFLAGSTYPE=-DFREEBSD
			MAKEFILE_LINE=OSBIND=os_bindings/spar_freebsd
VAR_ARCH[aarch64]=	MAKEFILE_LINE=CPU_SDL=spar_os-sdl-64bit
VAR_ARCH[x86_64]=	MAKEFILE_LINE=CPU_SDL=spar_os-sdl-64bit
VAR_ARCH[i386]=		MAKEFILE_LINE=CPU_SDL=spar_os-sdl-32bit

[L10N].DESCRIPTION=			Build with localization support
[L10N].MAKEFILE_OFF=			SFARG+=-DL10N=false
[L10N].MAKEFILE_ON=			SETL10N=ON
					SFARG+=-DL10N=true

[PCRE].DESCRIPTION=			Build with PCRE regular expression support
[PCRE].MAKEFILE_OFF=			SFARG+=-DPCRE=false
[PCRE].MAKEFILE_ON=			SETPCRE=ON
					SFARG+=-DPCRE=true
[PCRE].USES_ON=				pcre

[OPENGL].BUILDRUN_DEPENDS_ON=		libglvnd:primary:std
[OPENGL].BUILD_DEPENDS_ON=		libglvnd:dev:std
					libGLU:dev:std
[OPENGL].MAKEFILE_OFF=			SFARG+=-DOPENGL=false
[OPENGL].MAKEFILE_ON=			SETGL=ON
					SFARG+=-DOPENGL=true

[MYSQL].MAKEFILE_OFF=			SFARG+=-DMYSQL=false
[MYSQL].MAKEFILE_ON=			SETMYSQL=ON
					SFARG+=-DMYSQL=true
[MYSQL].USES_ON=			mysql:client

[SOUND].BUILDRUN_DEPENDS_ON=		gstreamer1:primary:std
[SOUND].BUILD_DEPENDS_ON=		gstreamer1:dev:std
[SOUND].GNOME_COMPONENTS_ON=		glib
					libxml2
[SOUND].MAKEFILE_OFF=			SFARG+=-DSOUND=false
[SOUND].MAKEFILE_ON=			SETSOUND=ON
					SFARG+=-DSOUND=true

[PGSQL].MAKEFILE_OFF=			SFARG+=-DPOSTGRES=false
[PGSQL].MAKEFILE_ON=			SETPGSQL=ON
					SFARG+=-DPOSTGRES=true
[PGSQL].USES_ON=			pgsql:client

[CGI].DESCRIPTION=			Common Gateway Interface (breaks other features)
[CGI].MAKEFILE_OFF=			SFARG+=-DGCGI=false
[CGI].MAKEFILE_ON=			SFARG+=-DGCGI=true

[SDL].DESCRIPTION=			Add support for Simple DirectMedia Layer
[SDL].BROKEN_ON=			GNAT BUG DETECTED gnat_to_gnu_entity, parser_pen.adb
[SDL].BUILDRUN_DEPENDS_ON=		sdl1:primary:std
					sdl1_image:primary:std
[SDL].BUILD_DEPENDS_ON=			sdl1:dev:std
					sdl1_image:dev:std
[SDL].IMPLIES_ON=			OPENGL
[SDL].MAKEFILE_OFF=			SFARG+=-DSDL=false
[SDL].MAKEFILE_ON=			SETSDL=ON
					SFARG+=-DSDL=true

post-patch-linux:
	${REINPLACE_CMD} -e "s| -lintl||" ${WRKSRC}/new_configure

pre-configure-SDL-ON:
	${CP} ${WRKSRC}/src/${CPU_SDL}.ads ${WRKSRC}/src/spar_os-sdl.ads
	${MV} ${WRKSRC}/src/spar_os_sdl.adb ${WRKSRC}/src/spar_os-sdl.adb

post-install:
	${MKDIR} ${STAGEDIR}${STD_DOCDIR}
	${MKDIR} ${STAGEDIR}${STD_EXAMPLESDIR}
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/spar
	(cd ${WRKSRC}/doc && ${COPYTREE_SHARE} \* ${STAGEDIR}${STD_DOCDIR})
	${MV} ${WRKSRC}/examples/incomplete ${WRKDIR}/
	(cd ${WRKSRC}/examples && \
		${COPYTREE_SHARE} \* ${STAGEDIR}${STD_EXAMPLESDIR})

pre-configure:
	# move new 4 lines from post-extract to allow patching
	${CP} ${WRKSRC}/src/scanner-calendar-latest.ads ${WRKSRC}/src/scanner-calendar.ads
	${CP} ${WRKSRC}/src/scanner-calendar-latest.adb ${WRKSRC}/src/scanner-calendar.adb
	${CP} ${WRKSRC}/src/${OSBIND}.ads ${WRKSRC}/src/spar_os.ads
	# Use the gcc compiler associated with the ada frontend.
	# Without this substitution, the base compiler is used instead.
	${REINPLACE_CMD} \
		-e "s|cc |gcc |" \
		-e "s| -fstack-protector||" \
		-e "s| -Werror||" \
		${WRKSRC}/src/pegasock/Makefile
	# Avoid use of malloc.h
	${REINPLACE_CMD} -e "s|<malloc.h>|<stdlib.h>|" \
		${WRKSRC}/src/bdb/c_bdb.c
	# Use db.h from db5 and link to it
	# Fix multi-job support
	# On gcc11, avoids prefix of "Overlaps_Storage" attribute must be object
	${REINPLACE_CMD} \
		-e "s|db: db.adb|db: bdb_constants.ads db.adb|" \
		-e "s| -fstack-protector||" \
		-e "s| -gnateEeAeEeF||" \
		${WRKSRC}/src/bdb/GNUmakefile.orig
	# shebang fix
	${REINPLACE_CMD} -e "s|#|#!/bin/sh|" \
		${WRKSRC}/src/apq-2.1/mysql_incl
	${REINPLACE_CMD} -e "s|\.\/mysql_x|/bin/sh ./mysql_x|" \
		${WRKSRC}/src/apq-2.1/Makefile
	# stack-protector broken on several platforms, fix template
	${REINPLACE_CMD} \
		-e "s| -fstack-protector||" \
		-e "s| -Werror||" \
		${WRKSRC}/src/GNUmakefile.orig

post-configure:
	for f in ${PREPFILES}; do \
	    echo "gnatprep $$f" ;\
	    (cd ${WRKSRC}/src && ${SETENV} ${MAKE_ENV} \
		gnatprep ${SFARG} $$f.orig $$f) ;\
	done

post-extract:
	# Create a compact configure script for ports collection
	${SED} -e "s|@CPU_FLAG@|${SF_CPU_FLAG}|" \
		-e "s|@ARCH@|${SF_ARCH}|" \
		-e "s|@MAKECMD@|${MAKE_CMD}|" \
		-e "s|@CFLAGSTYPE@|${SF_CFLAGSTYPE}|" \
		-e "s|@PREFIX@|${PREFIX}|" \
		-e "s|@SETAPQ@|${SETAPQ}|" \
		-e "s|@SETMYSQL@|${SETMYSQL}|" \
		-e "s|@SETPGSQL@|${SETPGSQL}|" \
		-e "s|@SETSOUND@|${SETSOUND}|" \
		-e "s|@SETGL@|${SETGL}|" \
		-e "s|@SETPCRE@|${SETPCRE}|" \
		-e "s|@SETL10N@|${SETL10N}|" \
		-e "s|@SETSDL@|${SETSDL}|" \
		-e "s|@SED@|${SED}|" \
		-e "s|@OPENSSLLIB@|${OPENSSLLIB}|g" \
		-e "s|@JOBSSUB@|${MAKE_JOBS_NUMBER}|g" \
		${FILESDIR}/new_configure.in > ${WRKSRC}/new_configure
	${CHMOD} 755 ${WRKSRC}/new_configure

[FILE:1013:descriptions/desc.primary]
SPARforte is an open source programming language for high-integrity tasks,
efficient development over the project lifecycle and assuming best practices.

Language characteristics:
* Paradigm: imperative/ procedural, scripting, shell, limited reflexive
* Typing Disciplines: strong typing, type safety, nominative static with
  optional limited weak and duck typing
* Appeared: 2001 (Ken O. Burtch)
* Source Code: GCC Ada, GCC C, Bourne-Again Shell, GCC Make
* Influenced by: Ada 95, Bourne Shell, SQL, and minorly BASIC, PHP, Python
* Usual File Extensions: .sp, .bush

The computer language that the SparForte shell understands is called
AdaScript. Unlike JavaScript, which has no relation to Java, AdaScript is a
small subset of the Ada programming language, with additional features
related to shell commands and databases.

AdaScript is intended to be "upward compatible" with Ada. AdaScript scripts
should run with little difficulty under Ada, but Ada programs may require
large changes run under SparForte.


[FILE:109:distinfo]
fb7d1104ab51c58a060536db261d033f048bb8a299816e23793b95184d7fef99      3227127 kburtch-SparForte-2.6.3.tar.gz


[FILE:9:manifests/plist.primary]
bin/spar


[FILE:22:manifests/plist.man]
share/man/man1/spar.1


[FILE:4006:manifests/plist.examples]
share/examples/sparforte/
 8ball.html
 8ball.sp
 add_ramdisk.html
 add_ramdisk.sp
 add_swap.html
 add_swap.sp
 aligncols.html
 aligncols.sp
 aplusb.html
 aplusb.sp
 archive.html
 archive.sp
 arraycat.html
 arraycat.sp
 arraycat_unstructured.sp
 arrayloop.html
 arrayloop.sp
 arraysum.html
 arraysum.sp
 arraysum_unstructured.sp
 arrow.wav
 attention.html
 attention.sp
 audio.html
 audio.sp
 bases.html
 bases.sp
 bats.wav
 best_shuffle.html
 best_shuffle.sp
 bitarith.html
 bitarith.sp
 bjack.html
 bjack.sp
 bottles.html
 bottles.sp
 caesar.html
 caesar.sp
 calcrms.html
 calcrms.sp
 camel.html
 camel.sp
 cecho.html
 cecho.sp
 charcode.html
 charcode.sp
 chessboard.html
 chessboard.png
 chessboard.sp
 chomp.html
 chomp.sp
 chomp2.html
 chomp2.sp
 clap.wav
 combinations.html
 combinations.sp
 contracts.html
 contracts.sp
 count_statements.html
 count_statements.sp
 database.gif
 database.html
 database.sp
 dateformat.html
 dateformat.sp
 de_RPM.html
 de_RPM.sp
 design_example.html
 design_example.sp
 dispatch.html
 dispatch.sp
 distance.html
 distance.sp
 doors.html
 doors.sp
 dotproduct.html
 dotproduct.sp
 draco_ii.html
 draco_ii.sp
 draco_score.txt
 drawline.html
 drawline.sp
 dynamic_css.html
 dynamic_css.sp
 dynamic_css2.html
 dynamic_css2.sp
 eliza.data
 eliza.html
 eliza.sp
 env.cgi
 env.html
 env.tmpl
 factorial.html
 factorial.sp
 fibonacci.html
 fibonacci.sp
 file_creation.html
 file_creation.sp
 filecopy.html
 filecopy.sp
 files.html
 fizzbuzz.html
 fizzbuzz.sp
 game.html
 game.sp
 game_24.html
 game_24.sp
 gen_env_data.html
 gen_env_data.sp
 geometry.sp
 get_env_data.gif
 git_prompt_script.html
 git_prompt_script.sp
 graph_series.html
 graph_series.png
 graph_series.sp
 gray.html
 gray.sp
 gss.html
 gss.sp
 hanoi.html
 hanoi.sp
 hello.html
 hello.sp
 incstr.html
 incstr.sp
 index.html
 int_sort.html
 int_sort.sp
 introsp.html
 introsp.sp
 ipv4.html
 ipv4.sp
 isxwindows.html
 isxwindows.sp
 json_health_check.cgi
 json_health_check.html
 linear_reg.html
 linear_reg.sp
 loopsbreak.html
 loopsbreak.sp
 luhn.html
 luhn.sp
 main.html
 mandel.html
 mandel.png
 mandel.sp
 mapping.html
 mapping.sp
 menu.html
 menu.sp
 menu2.html
 menu2.sp
 minimal.sp
 minimal_cgi.html
 minimal_cgi.sp
 minsort.html
 minsort.sp
 moire.html
 moire.png
 moire.sp
 monte.html
 monte.sp
 monty.html
 monty.sp
 neartime.html
 neartime.sp
 nonsquares.html
 nonsquares.sp
 opengl_first.html
 opengl_first.png
 opengl_first.sp
 opengl_fourth.html
 opengl_fourth.png
 opengl_fourth.sp
 opengl_second.html
 opengl_second.png
 opengl_second.sp
 opengl_third.html
 opengl_third.png
 opengl_third.sp
 pack.html
 pack.sp
 palindrome.html
 palindrome.sp
 perfect.html
 perfect.sp
 pit.wav
 poetry.html
 poetry.sp
 postgres_csv.html
 postgres_csv.sp
 prime.html
 prime.sp
 primes_asc.html
 primes_asc.sp
 printargs.html
 printargs.sp
 quest.html
 quest.sp
 radices.html
 radices.sp
 ramcache.html
 ramcache.sp
 randdist.html
 randdist.sp
 random.cgi
 random.html
 random.tmpl
 rest_api.sp
 rle.html
 rle.sp
 rm_ramdisk.html
 rm_ramdisk.sp
 rm_swap.html
 rm_swap.sp
 rock.html
 rock.sp
 roman_numerals.html
 roman_numerals.sp
 rot13.html
 rot13.sp
 run.wav
 scheduler.html
 scheduler.sp
 scream.wav
 scripting.c
 shuffle.html
 shuffle.sp
 side_effects.html
 side_effects.sp
 sieve.html
 sieve.sp
 sleep.html
 sleep.sp
 string_prepend.html
 string_prepend.sp
 stringcase.html
 stringcase.sp
 stripcomment.html
 stripcomment.sp
 sumseries.html
 sumseries.sp
 sumsq.html
 sumsq.sp
 ternary_logic.html
 ternary_logic.sp
 time_function.html
 time_function.sp
 timestamp.html
 timestamp.sp
 title.html
 title.sp
 tmpfile.html
 tmpfile.sp
 trig.html
 trig.sp
 twelve_days.html
 twelve_days.sp
 user_input.html
 user_input.sp
 user_input_unstructured.sp
 validate_name.html
 validate_name.sp
 weave.html
 weave.png
 weave.sp
 web_summary.html
 web_summary.sp
 whattime.html
 whattime.sp
 write_ownership.html
 write_ownership.sp
 wumpus.gif
 wumpus.html
 wumpus.sp
 yorn.html
 yorn.sp
 yuletide.html
 yuletide.sp


[FILE:742:patches/patch-src_GNUmakefile.template]
--- src/GNUmakefile.orig.orig	2024-07-01 16:16:15 UTC
+++ src/GNUmakefile.orig
@@ -113,7 +113,7 @@ endif
 	@echo
 	# Use the following line for aggressive linting
 	# $(GNATMAKE) -j4 -c -i -O1 $(CPU_FLAG)=$(CPU) -we -gnat12 -gnatfaoN -gnatVaep -gnatw.eDHM.Y -gnateEeEeF -gnatybdh -fstack-protector -c $(INCLUDE) spar
-	$(GNATMAKE) -j$(GMAKEJOBS) -c -i -O1 $(CPU_FLAG)=$(CPU) -we -gnat12 -gnatfaoN -gnatVaep -gnateEeEeF -fstack-protector -c $(INCLUDE) spar
+	$(GNATMAKE) -j$(GMAKEJOBS) -c -i -O1 $(CPU_FLAG)=$(CPU) -we -gnat12 -gnatd.E -gnatfaoN -gnatVaep -gnateEeEeF -fstack-protector -c $(INCLUDE) spar
 	gnatbind -x $(INCLUDE_BIND) spar.ali
 	gnatlink spar.ali $(GSTREAMERLIBS) $(GSTREAMEROBJ) $(PCREOBJ) c_os.o c_scanner.o $(LIBS)
 	@echo


[FILE:6328:patches/patch-src_c__l10n.c]
--- src/c_l10n.c.orig	2024-07-01 16:16:15 UTC
+++ src/c_l10n.c
@@ -485,7 +485,7 @@ char *langinfo_abmon_12() {
  */
 
 char *langinfo_decimal_point() {
-#if defined(__APPLE__) || defined(__FreeBSD__)
+#if defined(__APPLE__) || defined(__FreeBSD__) || defined(__DragonFly__) || defined(__NetBSD__) || defined(__linux__)
    return undefined;
 #elif !defined(__USE_GNU)
    return undefined;
@@ -501,7 +501,7 @@ char *langinfo_decimal_point() {
  */
 
 char *langinfo_thousands_sep() {
-#if defined(__APPLE__) || defined(__FreeBSD__)
+#if defined(__APPLE__) || defined(__FreeBSD__) || defined(__DragonFly__) || defined(__NetBSD__) || defined(__linux__)
    return undefined;
 #elif !defined(__USE_GNU)
    return undefined;
@@ -537,7 +537,7 @@ char *langinfo_noexpr() {
  */
 
 char *langinfo_currency_symbol() {
-#if defined(__APPLE__) || defined(__FreeBSD__)
+#if defined(__APPLE__) || defined(__FreeBSD__) || defined(__DragonFly__) || defined(__NetBSD__) || defined(__linux__)
    return undefined;
 #elif !defined(__USE_GNU)
    return undefined;
@@ -583,7 +583,7 @@ char *langinfo_t_fmt_ampm() {
  */
 
 char *langinfo_positive_sign() {
-#if defined(__APPLE__) || defined(__FreeBSD__)
+#if defined(__APPLE__) || defined(__FreeBSD__) || defined(__DragonFly__) || defined(__NetBSD__) || defined(__linux__)
    return undefined;
 #elif !defined(__USE_GNU)
    return undefined;
@@ -599,7 +599,7 @@ char *langinfo_positive_sign() {
  */
 
 char *langinfo_negative_sign() {
-#if defined(__APPLE__) || defined(__FreeBSD__)
+#if defined(__APPLE__) || defined(__FreeBSD__) || defined(__DragonFly__) || defined(__NetBSD__) || defined(__linux__)
    return undefined;
 #elif !defined(__USE_GNU)
    return undefined;
@@ -615,7 +615,7 @@ char *langinfo_negative_sign() {
  */
 
 char *langinfo_int_curr_symbol() {
-#if defined(__APPLE__) || defined(__FreeBSD__)
+#if defined(__APPLE__) || defined(__FreeBSD__) || defined(__DragonFly__) || defined(__NetBSD__) || defined(__linux__)
    return undefined;
 #elif !defined(__USE_GNU)
    return undefined;
@@ -631,7 +631,7 @@ char *langinfo_int_curr_symbol() {
  */
 
 char *langinfo_grouping() {
-#if defined(__APPLE__) || defined(__FreeBSD__)
+#if defined(__APPLE__) || defined(__FreeBSD__) || defined(__DragonFly__) || defined(__NetBSD__) || defined(__linux__)
    return "\0";
 #elif !defined(__USE_GNU)
    return "\0";
@@ -646,7 +646,7 @@ char *langinfo_grouping() {
  */
 
 char *langinfo_frac_digits() {
-#if defined(__APPLE__) || defined(__FreeBSD__)
+#if defined(__APPLE__) || defined(__FreeBSD__) || defined(__DragonFly__) || defined(__NetBSD__) || defined(__linux__)
    return undefined;
 #elif !defined(__USE_GNU)
    return undefined;
@@ -661,7 +661,7 @@ char *langinfo_frac_digits() {
  */
 
 char *langinfo_int_frac_digits() {
-#if defined(__APPLE__) || defined(__FreeBSD__)
+#if defined(__APPLE__) || defined(__FreeBSD__) || defined(__DragonFly__) || defined(__NetBSD__) || defined(__linux__)
    return undefined;
 #elif !defined(__USE_GNU)
    return undefined;
@@ -676,7 +676,7 @@ char *langinfo_int_frac_digits() {
  */
 
 char *langinfo_p_cs_precedes() {
-#if defined(__APPLE__) || defined(__FreeBSD__)
+#if defined(__APPLE__) || defined(__FreeBSD__) || defined(__DragonFly__) || defined(__NetBSD__) || defined(__linux__)
    return undefined;
 #elif !defined(__USE_GNU)
    return undefined;
@@ -691,7 +691,7 @@ char *langinfo_p_cs_precedes() {
  */
 
 char *langinfo_p_sep_by_space() {
-#if defined(__APPLE__) || defined(__FreeBSD__)
+#if defined(__APPLE__) || defined(__FreeBSD__) || defined(__DragonFly__) || defined(__NetBSD__) || defined(__linux__)
    return undefined;
 #elif !defined(__USE_GNU)
    return undefined;
@@ -706,7 +706,7 @@ char *langinfo_p_sep_by_space() {
  */
 
 char *langinfo_p_sign_posn() {
-#if defined(__APPLE__) || defined(__FreeBSD__)
+#if defined(__APPLE__) || defined(__FreeBSD__) || defined(__DragonFly__) || defined(__NetBSD__) || defined(__linux__)
    return undefined;
 #elif !defined(__USE_GNU)
    return undefined;
@@ -721,7 +721,7 @@ char *langinfo_p_sign_posn() {
  */
 
 char *langinfo_n_cs_precedes() {
-#if defined(__APPLE__) || defined(__FreeBSD__)
+#if defined(__APPLE__) || defined(__FreeBSD__) || defined(__DragonFly__) || defined(__NetBSD__) || defined(__linux__)
    return undefined;
 #elif !defined(__USE_GNU)
    return undefined;
@@ -736,7 +736,7 @@ char *langinfo_n_cs_precedes() {
  */
 
 char *langinfo_n_sep_by_space() {
-#if defined(__APPLE__) || defined(__FreeBSD__)
+#if defined(__APPLE__) || defined(__FreeBSD__) || defined(__DragonFly__) || defined(__NetBSD__) || defined(__linux__)
    return undefined;
 #elif !defined(__USE_GNU)
    return undefined;
@@ -751,7 +751,7 @@ char *langinfo_n_sep_by_space() {
  */
 
 char *langinfo_n_sign_posn() {
-#if defined(__APPLE__) || defined(__FreeBSD__)
+#if defined(__APPLE__) || defined(__FreeBSD__) || defined(__DragonFly__) || defined(__NetBSD__) || defined(__linux__)
    return undefined;
 #elif !defined(__USE_GNU)
    return undefined;
@@ -766,7 +766,7 @@ char *langinfo_n_sign_posn() {
  */
 
 char *langinfo_mon_decimal_point() {
-#if defined(__APPLE__) || defined(__FreeBSD__)
+#if defined(__APPLE__) || defined(__FreeBSD__) || defined(__DragonFly__) || defined(__NetBSD__) || defined(__linux__)
    return undefined;
 #elif !defined(__USE_GNU)
    return undefined;
@@ -782,7 +782,7 @@ char *langinfo_mon_decimal_point() {
  */
 
 char *langinfo_mon_thousands_sep() {
-#if defined(__APPLE__) || defined(__FreeBSD__)
+#if defined(__APPLE__) || defined(__FreeBSD__) || defined(__DragonFly__) || defined(__NetBSD__) || defined(__linux__)
    return undefined;
 #elif !defined(__USE_GNU)
    return undefined;
@@ -797,7 +797,7 @@ char *langinfo_mon_thousands_sep() {
  */
 
 char *langinfo_mon_grouping() {
-#if defined(__APPLE__) || defined(__FreeBSD__)
+#if defined(__APPLE__) || defined(__FreeBSD__) || defined(__DragonFly__) || defined(__NetBSD__) || defined(__linux__)
    return "\0";
 #elif !defined(__USE_GNU)
    return "\0";
@@ -822,7 +822,7 @@ char *langinfo_era() {
  */
 
 char *langinfo_era_year() {
-#if defined(__APPLE__) || defined(__FreeBSD__)
+#if defined(__APPLE__) || defined(__FreeBSD__) || defined(__DragonFly__) || defined(__NetBSD__) || defined(__linux__)
    return undefined;
 #elif !defined(__USE_GNU)
    return undefined;


[FILE:375:patches/patch-src_c__os.c]
--- src/c_os.c.orig	2024-07-01 16:16:15 UTC
+++ src/c_os.c
@@ -27,7 +27,7 @@
 
 /* group_member() for BSD-based systems */
 
-#if defined(__APPLE__) || defined(__FreeBSD__) || defined(__DragonFly__)
+#if defined(__APPLE__) || defined(__FreeBSD__) || defined(__DragonFly__) || defined(__NetBSD__)
 int group_member(gid_t gid) {
   int ngroups, i, ret;
 #if defined(__APPLE__)


[FILE:4257:files/new_configure.in]
#!/bin/sh
# Configure script tailored for FreeBSD ports collection

SETAPQ=@SETAPQ@
SETMYSQL=@SETMYSQL@
SETPGSQL=@SETPGSQL@
SETSOUND=@SETSOUND@
SETPCRE=@SETPCRE@
SETGL=@SETGL@
SETL10N=@SETL10N@
SETSDL=@SETSDL@

CCTYPE=ada
CPUTYPE="@ARCH@"
CPUFLAG="@CPU_FLAG@"
GMAKETYPE="@MAKECMD@"
PREFIXSUB="@PREFIX@"
MANPREFIXSUB="@PREFIX@/share/man"
CFLAGSTYPE="@CFLAGSTYPE@"
BDBBASELIBSSUB="-L@PREFIX@/db5/lib -ldb"
BDBBASEINCLSUB="-I@PREFIX@/db5/include -I./bdb/"
BDBINCLSUB="-I@PREFIX@/db5/include -I./bdb/"
BDBSUB="-L@PREFIX@/db5/lib -ldb bdb/c_bdb.o"
RLINCLSUB="-I./areadline/"
RLLIBSSUB="-L@PREFIX@/lib -lreadline -lhistory c_rl.o"
RLFLAG="-DREADLINE"
JOBSSUB="@JOBSSUB@"

# Blank defaults
GSTREAMERLIBSSUB=
GSTREAMERFLAGSUB=
GSTREAMEROBJSUB=
MESAINCLSUB=
MESALIBSSUB=
MYSQLLIBSSUB=
PGLIBSSUB=
APQLIBSSUB=
APQINCLSSUB=
PCRELIBSSUB=
PCREOBJSUB=
SDLINCLSSUB=
FASTCGISUB=
PCREFLAG=
L10NLIBS=
L10NFLAG=

if [ "${SETAPQ}" = "ON" ]; then
  APQ="apq-2.1"
  APQMAKESUB="\$(MAKE) -C ${APQ}"
  APQLIBSSUB="-L./${APQ} "
  APQINCLSSUB="-I./${APQ} "
  if [ "${SETMYSQL}" = "ON" ]; then
     MYSQLLIBSSUB="-L@PREFIX@/lib/mysql -lmysqlclient -pthread -lm"
     APQLIBSSUB="${APQLIBSSUB} ./${APQ}/c_mysql.o"
     if [ "${SETPGSQL}" != "ON" ]; then
        echo "Executing APQ's configure (skipping PostgreSQL)"
        (cd src/${APQ} && /usr/bin/env HAVE_MY=1 HAVE_PG=0 /bin/sh ./configure)
     fi
  fi
  if [ "${SETPGSQL}" = "ON" ]; then
     PGLIBSSUB="-L@PREFIX@/lib -lintl -L@OPENSSLLIB@ -lssl -lcrypto -Wl,-rpath,@OPENSSLLIB@"
     if [ "${SETMYSQL}" = "ON" ]; then
        echo "Executing APQ's configure"
        (cd src/${APQ} && /usr/bin/env HAVE_MY=1 HAVE_PG=1 /bin/sh ./configure)
     else
        echo "Executing APQ's configure (skipping MySQL)"
        (cd src/${APQ} && /usr/bin/env HAVE_MY=0 HAVE_PG=1 /bin/sh ./configure)
     fi
  fi
else
  APQMAKESUB="@echo disabled"
fi

if [ "${SETSOUND}" = "ON" ]; then
   GSTREAMERLIBSSUB=$(@PREFIX@/bin/pkgconf --cflags --libs gstreamer-1.0)
   GSTREAMEROBJSUB="c_gstreamer.o"
   GSTREAMERFLAGSUB="-DGSTREAMER"
fi

if [ "${SETGL}" = "ON" ]; then
   MESAINCLSUB=$(@PREFIX@/bin/pkgconf --cflags gl glu)
   MESALIBSSUB=$(@PREFIX@/bin/pkgconf --libs gl glu)
fi

if [ "${SETSDL}" = "ON" ]; then
   SDLLIBSTYPE=$(@PREFIX@/bin/pkgconf --libs SDL_image)
   SDLINCLTYPE=$(@PREFIX@/bin/pkgconf --cflags SDL_image)
fi

if [ "${SETPCRE}" = "ON" ]; then
   PCRELIBSSUB="-lpcre"
   PCREOBJSUB="c_pcre.o"
fi

if [ "${SETL10N}" = "ON" ]; then
   L10NLIBS="c_l10n.o"
   L10NFLAG=1
fi

echo "Creating GNUmakefile"
@SED@ -e "s|CPUFLAG|${CPUFLAG}|g" \
 -e "s|CCTYPE|${CCTYPE}|g" \
 -e "s|CPUTYPE|${CPUTYPE}|g" \
 -e "s|GMAKETYPE|${GMAKETYPE}|g" \
 -e "s|CFLAGSTYPE|${CFLAGSTYPE}|g" \
 -e "s|MANPREFIXSUB|${MANPREFIXSUB}|g" \
 -e "s|PREFIXSUB|${PREFIXSUB}|g" \
 GNUmakefile.orig > Makefile

echo "Creating src/GNUmakefile"
@SED@ -e "s|CPUFLAG|${CPUFLAG}|g" \
 -e "s|CCTYPE|${CCTYPE}|g" \
 -e "s|CPUTYPE|${CPUTYPE}|g" \
 -e "s|GMAKETYPE|${GMAKETYPE}|g" \
 -e "s|CFLAGSTYPE|${CFLAGSTYPE}|g" \
 -e "s|MANPREFIXSUB|${MANPREFIXSUB}|g" \
 -e "s|PREFIXSUB|${PREFIXSUB}|g" \
 -e "s|SDLLIBSTYPE|${SDLLIBSTYPE}|g" \
 -e "s|SDLINCLTYPE|${SDLINCLTYPE}|g" \
 -e "s|PGLIBSSUB|${PGLIBSSUB}|g" \
 -e "s|MYSQLLIBSSUB|${MYSQLLIBSSUB}|g" \
 -e "s|APQLIBSSUB|${APQLIBSSUB}|g" \
 -e "s|APQINCLSSUB|${APQINCLSSUB}|g" \
 -e "s|SDLINCLSSUB|${SDLINCLSSUB}|g" \
 -e "s|APQMAKESUB|${APQMAKESUB}|g" \
 -e "s|FASTCGISUB|${FASTCGISUB}|g" \
 -e "s|GSTREAMERLIBSSUB|${GSTREAMERLIBSSUB}|g" \
 -e "s|GSTREAMERFLAGSUB|${GSTREAMERFLAGSUB}|g" \
 -e "s|GSTREAMEROBJSUB|${GSTREAMEROBJSUB}|g" \
 -e "s|MESAINCLSUB|${MESAINCLSUB}|g" \
 -e "s|MESALIBSSUB|${MESALIBSSUB}|g" \
 -e "s|BDBSUB|${BDBSUB}|g" \
 -e "s|BDBINCLSUB|${BDBINCLSUB}|g" \
 -e "s|RLINCLSUB|${RLINCLSUB}|g" \
 -e "s|RLLIBSSUB|${RLLIBSSUB}|g" \
 -e "s|RLFLAGSUB|${RLFLAG}|g" \
 -e "s|PCRELIBSSUB|${PCRELIBSSUB}|g" \
 -e "s|PCREOBJSUB|${PCREOBJSUB}|g" \
 -e "s|PCREFLAG|${PCREFLAG}|g" \
 -e "s|L10NFLAGSUB|${L10NFLAG}|g" \
 -e "s|L10NLIBSSUB|${L10NLIBS}|g" \
 -e "s|GMAKEJOBSSUB|${JOBSSUB}|g" \
 src/GNUmakefile.orig > src/GNUmakefile

echo "Creating src/bdb/GNUmakefile"
@SED@ \
 -e "s|BDBBASEINCLSUB|${BDBBASEINCLSUB}|g" \
 -e "s|BDBBASELIBSSUB|${BDBBASELIBSSUB}|g" \
  src/bdb/GNUmakefile.orig > src/bdb/GNUmakefile


[FILE:760:files/special.mk]
PREPFILES= \
	builtins.adb \
	parser_bdb.adb \
	parser_btree_io.adb \
	parser_db.adb \
	parser_dbm.adb \
	parser_gnat_cgi.adb \
	parser_hash_io.adb \
	parser_l10n.adb \
	parser_mysql.adb \
	parser_mysqlm.adb \
	parser_pen.adb \
	parser_sound.adb \
	parser_strings_pcre.adb \
	pegasoft-user_io-getline.adb \
	scanner_res.adb \
	scanner_res.ads \
	world.ads

.if ${SETMYSQL} == "ON" || ${SETPGSQL} == "ON"
SFARG+=		-DAPQ=true
SETAPQ=		ON
.else
SFARG+=		-DAPQ=false
.endif

BUILDDATE!=	date "+%y%m%d"
SFARG+=		-DREADLINE=true
SFARG+=		-DBDB=true
SFARG+=		-DconfigbuildDate=\"${BUILDDATE}\"
SFARG+=		-Dconfigreleased=true

# Currently Ada is only available for x86, so we can assume the following
SF_ARCH=		${ARCH_STANDARD:S/x86_64/athlon64/}
SF_CPU_FLAG=		-march

