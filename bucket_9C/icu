# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		icu
VERSION=		73.1
KEYWORDS=		devel
VARIANTS=		standard
SDESC[standard]=	International Components for Unicode (from IBM)
HOMEPAGE=		https://icu.unicode.org/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		https://github.com/unicode-org/icu/releases/download/release-73-1/
DISTFILE[1]=		icu4c-73_1-src.tgz:main
DF_INDEX=		1
SPKGS[standard]=	complete
			primary
			tools
			dev
			man

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

USES=			cpe gmake c++:primary python:build

DISTNAME=		icu/source

LICENSE=		CUSTOM1:primary
LICENSE_NAME=		CUSTOM1:"ICU License"
LICENSE_FILE=		CUSTOM1:{{WRKDIR}}/icu/LICENSE
LICENSE_SCHEME=		solo

CPE_PRODUCT=		international_components_for_unicode
CPE_TARGET_SW=		c\/c\+\+
CPE_VENDOR=		icu-project
FPC_EQUIVALENT=		devel/icu

MUST_CONFIGURE=		gnu
CONFIGURE_ARGS=		--enable-static
			--with-data-packaging=archive
			--disable-renaming
			--disable-samples
			--disable-layoutex

MAKE_ARGS=		VERBOSE=1

PLIST_SUB=		ICUMAJOR=73
			ICUVER=73.1
			ENDIAN="l"

CPPFLAGS=		-DICU_NO_USER_DATA_OVERRIDE
TEST_TARGET=		check

post-patch-darwin:
	${REINPLACE_CMD} -e 's/apple-darwin/raven-darwin/' ${WRKSRC}/configure

post-install:
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/g* \
		${STAGEDIR}${PREFIX}/bin/*conv \
		${STAGEDIR}${PREFIX}/bin/icuinfo \
		${STAGEDIR}${PREFIX}/bin/derb \
		${STAGEDIR}${PREFIX}/bin/pkgdata \
		${STAGEDIR}${PREFIX}/sbin/*
	${RM} ${STAGEDIR}${PREFIX}/share/icu/73.1/LICENSE

[FILE:292:descriptions/desc.primary]
The International Components for Unicode (ICU) is a mature, widely used
set of C/C++ and Java libraries providing Unicode and Globalization
support for software applications. ICU is widely portable and gives
applications the same results on all platforms and between C/C++ and
Java software.


[FILE:33:descriptions/desc.tools]
This package contains ICU tools.


[FILE:97:distinfo]
a457431de164b4aa7eca00ed134d00dfbf88a77c6986a10ae7774fc076bb8c45     26512935 icu4c-73_1-src.tgz


[FILE:317:manifests/plist.primary]
lib/
 libicudata.so.%%ICUMAJOR%%
 libicudata.so.%%ICUVER%%
 libicui18n.so.%%ICUMAJOR%%
 libicui18n.so.%%ICUVER%%
 libicuio.so.%%ICUMAJOR%%
 libicuio.so.%%ICUVER%%
 libicutest.so.%%ICUMAJOR%%
 libicutest.so.%%ICUVER%%
 libicutu.so.%%ICUMAJOR%%
 libicutu.so.%%ICUVER%%
 libicuuc.so.%%ICUMAJOR%%
 libicuuc.so.%%ICUVER%%


[FILE:166:manifests/plist.tools]
bin/
 derb
 genbrk
 gencfu
 gencnval
 gendict
 genrb
 icuexportdata
 icuinfo
 makeconv
 pkgdata
 uconv
sbin/
 escapesrc
 genccode
 gencmn
 gennorm2
 gensprep
 icupkg


[FILE:3200:manifests/plist.dev]
%%ONLY-DARWIN%%share/icu/%%ICUVER%%/config/mh-darwin
%%ONLY-DRAGONFLY%%share/icu/%%ICUVER%%/config/mh-bsd-gcc
%%ONLY-FREEBSD%%share/icu/%%ICUVER%%/config/mh-bsd-gcc
%%ONLY-LINUX%%share/icu/%%ICUVER%%/config/mh-linux
%%ONLY-MIDNIGHTBSD%%share/icu/%%ICUVER%%/config/mh-bsd-gcc
%%ONLY-NETBSD%%share/icu/%%ICUVER%%/config/mh-bsd-gcc
%%ONLY-SUNOS%%share/icu/%%ICUVER%%/config/mh-solaris-gcc
bin/icu-config
include/unicode/
 alphaindex.h
 appendable.h
 basictz.h
 brkiter.h
 bytestream.h
 bytestrie.h
 bytestriebuilder.h
 calendar.h
 caniter.h
 casemap.h
 char16ptr.h
 chariter.h
 choicfmt.h
 coleitr.h
 coll.h
 compactdecimalformat.h
 curramt.h
 currpinf.h
 currunit.h
 datefmt.h
 dbbi.h
 dcfmtsym.h
 decimfmt.h
 displayoptions.h
 docmain.h
 dtfmtsym.h
 dtintrv.h
 dtitvfmt.h
 dtitvinf.h
 dtptngen.h
 dtrule.h
 edits.h
 enumset.h
 errorcode.h
 fieldpos.h
 filteredbrk.h
 fmtable.h
 format.h
 formattednumber.h
 formattedvalue.h
 fpositer.h
 gender.h
 gregocal.h
 icudataver.h
 icuplug.h
 idna.h
 listformatter.h
 localebuilder.h
 localematcher.h
 localpointer.h
 locdspnm.h
 locid.h
 measfmt.h
 measunit.h
 measure.h
 messagepattern.h
 msgfmt.h
 normalizer2.h
 normlzr.h
 nounit.h
 numberformatter.h
 numberrangeformatter.h
 numfmt.h
 numsys.h
 parseerr.h
 parsepos.h
 platform.h
 plurfmt.h
 plurrule.h
 ptypes.h
 putil.h
 rbbi.h
 rbnf.h
 rbtz.h
 regex.h
 region.h
 reldatefmt.h
 rep.h
 resbund.h
 schriter.h
 scientificnumberformatter.h
 search.h
 selfmt.h
 simpleformatter.h
 simplenumberformatter.h
 simpletz.h
 smpdtfmt.h
 sortkey.h
 std_string.h
 strenum.h
 stringoptions.h
 stringpiece.h
 stringtriebuilder.h
 stsearch.h
 symtable.h
 tblcoll.h
 timezone.h
 tmunit.h
 tmutamt.h
 tmutfmt.h
 translit.h
 tzfmt.h
 tznames.h
 tzrule.h
 tztrans.h
 ubidi.h
 ubiditransform.h
 ubrk.h
 ucal.h
 ucasemap.h
 ucat.h
 uchar.h
 ucharstrie.h
 ucharstriebuilder.h
 uchriter.h
 uclean.h
 ucnv.h
 ucnv_cb.h
 ucnv_err.h
 ucnvsel.h
 ucol.h
 ucoleitr.h
 uconfig.h
 ucpmap.h
 ucptrie.h
 ucsdet.h
 ucurr.h
 udat.h
 udata.h
 udateintervalformat.h
 udatpg.h
 udisplaycontext.h
 udisplayoptions.h
 uenum.h
 ufieldpositer.h
 uformattable.h
 uformattednumber.h
 uformattedvalue.h
 ugender.h
 uidna.h
 uiter.h
 uldnames.h
 ulistformatter.h
 uloc.h
 ulocdata.h
 umachine.h
 umisc.h
 umsg.h
 umutablecptrie.h
 unifilt.h
 unifunct.h
 unimatch.h
 unirepl.h
 uniset.h
 unistr.h
 unorm.h
 unorm2.h
 unum.h
 unumberformatter.h
 unumberoptions.h
 unumberrangeformatter.h
 unumsys.h
 uobject.h
 upluralrules.h
 uregex.h
 uregion.h
 ureldatefmt.h
 urename.h
 urep.h
 ures.h
 uscript.h
 usearch.h
 uset.h
 usetiter.h
 ushape.h
 usimplenumberformatter.h
 uspoof.h
 usprep.h
 ustdio.h
 ustream.h
 ustring.h
 ustringtrie.h
 utext.h
 utf.h
 utf16.h
 utf32.h
 utf8.h
 utf_old.h
 utmscale.h
 utrace.h
 utrans.h
 utypes.h
 uvernum.h
 uversion.h
 vtzone.h
lib/
 libicudata.a
 libicudata.so
 libicui18n.a
 libicui18n.so
 libicuio.a
 libicuio.so
 libicutest.a
 libicutest.so
 libicutu.a
 libicutu.so
 libicuuc.a
 libicuuc.so
lib/icu/
 Makefile.inc
 current
 pkgdata.inc
lib/icu/%%ICUVER%%/
 Makefile.inc
 pkgdata.inc
lib/pkgconfig/
 icu-i18n.pc
 icu-io.pc
 icu-uc.pc
share/icu/%%ICUVER%%/
 icudt%%ICUMAJOR%%%%ENDIAN%%.dat
 install-sh
 mkinstalldirs


[FILE:244:manifests/plist.man]
share/man/man1/
 derb.1.gz
 genbrk.1.gz
 gencfu.1.gz
 gencnval.1.gz
 gendict.1.gz
 genrb.1.gz
 icu-config.1.gz
 icuexportdata.1.gz
 makeconv.1.gz
 pkgdata.1.gz
 uconv.1.gz
share/man/man8/
 genccode.8.gz
 gencmn.8.gz
 gensprep.8.gz
 icupkg.8.gz


[FILE:417:patches/patch-common_Makefile.in]
--- common/Makefile.in.orig	2023-04-13 21:41:15 UTC
+++ common/Makefile.in
@@ -119,7 +119,7 @@ install-local: install-headers install-l
 install-library: all-local
 	$(MKINSTALLDIRS) $(DESTDIR)$(libdir)
 ifneq ($(ENABLE_STATIC),)
-	$(INSTALL-L) $(TARGET) $(DESTDIR)$(libdir)
+	$(INSTALL_DATA) $(TARGET) $(DESTDIR)$(libdir)
 endif
 ifneq ($(ENABLE_SHARED),)
 # For MinGW, do we want the DLL to go in the bin location?


[FILE:1068:patches/patch-common_putil.cpp]
--- common/putil.cpp.orig	2023-04-13 21:41:15 UTC
+++ common/putil.cpp
@@ -2023,11 +2023,6 @@ remapPlatformDependentCodepage(const cha
          */
         name = "UTF-8";
     }
-#elif U_PLATFORM == U_PF_BSD
-    if (uprv_strcmp(name, "CP949") == 0) {
-        /* Remap CP949 to a similar codepage to avoid issues with backslash and won symbol. */
-        name = "EUC-KR";
-    }
 #elif U_PLATFORM == U_PF_HPUX
     if (locale != nullptr && uprv_strcmp(locale, "zh_HK") == 0 && uprv_strcmp(name, "big5") == 0) {
         /* HP decided to extend big5 as hkbig5 even though it's not compatible :-( */
@@ -2183,7 +2178,7 @@ int_getDefaultCodepage()
        nl_langinfo may use the same buffer as setlocale. */
     {
         const char *codeset = nl_langinfo(U_NL_LANGINFO_CODESET);
-#if U_PLATFORM_IS_DARWIN_BASED || U_PLATFORM_IS_LINUX_BASED
+#if U_PLATFORM_IS_DARWIN_BASED || U_PLATFORM_IS_LINUX_BASED || U_PLATFORM == U_PF_BSD
         /*
          * On Linux and MacOSX, ensure that default codepage for non C/POSIX locale is UTF-8
          * instead of ASCII.


[FILE:457:patches/patch-common_ubidiimp.h]
$NetBSD: patch-common_ubidiimp.h,v 1.1 2019/04/08 21:39:43 jperkin Exp $

Avoid sys/regset.h pollution on SunOS.

--- common/ubidiimp.h.orig	2023-04-13 21:41:15 UTC
+++ common/ubidiimp.h
@@ -24,6 +24,11 @@
 #include "unicode/uchar.h"
 #include "ubidi_props.h"
 
+#ifdef __sun
+#undef CS
+#undef ES
+#endif
+
 /* miscellaneous definitions ---------------------------------------------- */
 
 // ICU-20853=ICU-20935 Solaris #defines CS and ES in sys/regset.h


[FILE:881:patches/patch-common_unicode_platform.h]
--- common/unicode/platform.h.orig	2023-04-13 21:41:15 UTC
+++ common/unicode/platform.h
@@ -178,6 +178,9 @@
 #       include <sys/endian.h>
 #   endif
 #   define U_PLATFORM U_PF_BSD
+#elif defined(__DragonFly__)
+# include <sys/endian.h>
+# define U_PLATFORM U_PF_BSD
 #elif defined(sun) || defined(__sun)
     /* Check defined(__SVR4) || defined(__svr4__) to distinguish Solaris from SunOS? */
 #   define U_PLATFORM U_PF_SOLARIS
@@ -374,8 +377,8 @@
  */
 #ifdef U_IS_BIG_ENDIAN
     /* Use the predefined value. */
-#elif defined(BYTE_ORDER) && defined(BIG_ENDIAN)
-#   define U_IS_BIG_ENDIAN (BYTE_ORDER == BIG_ENDIAN)
+#elif defined(_BYTE_ORDER) && defined(_BIG_ENDIAN)
+#   define U_IS_BIG_ENDIAN (_BYTE_ORDER == _BIG_ENDIAN)
 #elif defined(__BYTE_ORDER__) && defined(__ORDER_BIG_ENDIAN__)
     /* gcc */
 #   define U_IS_BIG_ENDIAN (__BYTE_ORDER__ == __ORDER_BIG_ENDIAN__)


[FILE:227:patches/patch-common_unicode_uconfig.h]
--- common/unicode/uconfig.h.orig	2023-04-13 21:41:15 UTC
+++ common/unicode/uconfig.h
@@ -89,7 +89,7 @@
  * @internal
  */
 #ifndef U_DISABLE_RENAMING
-#define U_DISABLE_RENAMING 0
+#define U_DISABLE_RENAMING 1
 #endif
 
 /**


[FILE:900:patches/patch-common_uposixdefs.h]
$NetBSD: patch-common_uposixdefs.h,v 1.6 2018/07/26 22:37:48 abs Exp $

C99 and related define overrides.
Do not play _XOPEN_SOURCE games on NetBSD, as it breaks at least gcc 6.4 on NetBSD-8.0

--- common/uposixdefs.h.orig	2023-04-13 21:41:15 UTC
+++ common/uposixdefs.h
@@ -44,8 +44,10 @@
      * and define _XOPEN_SOURCE to different values depending on __STDC_VERSION__.
      * In C++ source code (e.g., putil.cpp), __STDC_VERSION__ is not defined at all.
      */
+#if !defined(_SCO_DS) && !defined(__NetBSD__)
 #   define _XOPEN_SOURCE 600
 #endif
+#endif
 
 /*
  * Make sure things like realpath and such functions work.
@@ -54,9 +56,11 @@
  *
  * z/OS needs this definition for timeval and to get usleep.
  */
+#if !defined(__sun) && !defined(_SCO_DS)
 #if !defined(_XOPEN_SOURCE_EXTENDED) && defined(__TOS_MVS__)
 #   define _XOPEN_SOURCE_EXTENDED 1
 #endif
+#endif
 
 /**
  * Solaris says:


[FILE:413:patches/patch-i18n_Makefile.in]
--- i18n/Makefile.in.orig	2023-04-13 21:41:15 UTC
+++ i18n/Makefile.in
@@ -101,7 +101,7 @@ install-local: install-headers install-l
 install-library: all-local
 	$(MKINSTALLDIRS) $(DESTDIR)$(libdir)
 ifneq ($(ENABLE_STATIC),)
-	$(INSTALL-L) $(TARGET) $(DESTDIR)$(libdir)
+	$(INSTALL_DATA) $(TARGET) $(DESTDIR)$(libdir)
 endif
 ifneq ($(ENABLE_SHARED),)
 # For MinGW, do we want the DLL to go in the bin location?


[FILE:407:patches/patch-io_Makefile.in]
--- io/Makefile.in.orig	2023-04-13 21:41:15 UTC
+++ io/Makefile.in
@@ -97,7 +97,7 @@ install-local: install-headers install-l
 install-library: all-local
 	$(MKINSTALLDIRS) $(DESTDIR)$(libdir)
 ifneq ($(ENABLE_STATIC),)
-	$(INSTALL-L) $(TARGET) $(DESTDIR)$(libdir)
+	$(INSTALL_DATA) $(TARGET) $(DESTDIR)$(libdir)
 endif
 ifneq ($(ENABLE_SHARED),)
 # For MinGW, do we want the DLL to go in the bin location?


[FILE:386:patches/patch-layoutex_Makefile.in]
--- layoutex/Makefile.in.orig	2023-04-13 21:41:15 UTC
+++ layoutex/Makefile.in
@@ -108,7 +108,7 @@ endif
 install-library: all-local
 	$(MKINSTALLDIRS) $(DESTDIR)$(libdir)
 ifneq ($(ENABLE_STATIC),)
-	$(INSTALL-L) $(TARGET) $(DESTDIR)$(libdir)
+	$(INSTALL_DATA) $(TARGET) $(DESTDIR)$(libdir)
 endif
 ifneq ($(ENABLE_SHARED),)
 # For MinGW, do we want the DLL to go in the bin location?


[FILE:366:patches/patch-runConfigureICU]
$NetBSD: patch-af,v 1.12 2012/11/07 20:59:51 adam Exp $

--- runConfigureICU.orig	2023-04-13 21:41:15 UTC
+++ runConfigureICU
@@ -343,7 +343,7 @@ case $platform in
         DEBUG_CXXFLAGS='-FS -Zi -MDd'
         DEBUG_LDFLAGS='-DEBUG'
         ;;
-    *BSD)
+    *BSD | DragonFly)
         THE_OS="BSD"
         THE_COMP="the GNU C++"
         DEBUG_CFLAGS='-g -O0'


[FILE:409:patches/patch-stubdata_Makefile.in]
--- stubdata/Makefile.in.orig	2023-04-13 21:41:15 UTC
+++ stubdata/Makefile.in
@@ -85,7 +85,7 @@ install-local: install-library
 install-library: all-local
 	$(MKINSTALLDIRS) $(DESTDIR)$(libdir)
 ifneq ($(ENABLE_STATIC),)
-	$(INSTALL-L) $(TARGET) $(DESTDIR)$(libdir)
+	$(INSTALL_DATA) $(TARGET) $(DESTDIR)$(libdir)
 endif
 ifneq ($(ENABLE_SHARED),)
 # For MinGW, do we want the DLL to go in the bin location?


[FILE:419:patches/patch-tools_ctestfw_Makefile.in]
--- tools/ctestfw/Makefile.in.orig	2023-04-13 21:41:15 UTC
+++ tools/ctestfw/Makefile.in
@@ -81,7 +81,7 @@ install-local: install-library
 install-library: all-local
 	$(MKINSTALLDIRS) $(DESTDIR)$(libdir)
 ifneq ($(ENABLE_STATIC),)
-	$(INSTALL-L) $(TARGET) $(DESTDIR)$(libdir)
+	$(INSTALL_DATA) $(TARGET) $(DESTDIR)$(libdir)
 endif
 ifneq ($(ENABLE_SHARED),)
 # For MinGW, do we want the DLL to go in the bin location?


[FILE:421:patches/patch-tools_toolutil_Makefile.in]
--- tools/toolutil/Makefile.in.orig	2023-04-13 21:41:15 UTC
+++ tools/toolutil/Makefile.in
@@ -87,7 +87,7 @@ install-local: install-library
 install-library: all-local
 	$(MKINSTALLDIRS) $(DESTDIR)$(libdir)
 ifneq ($(ENABLE_STATIC),)
-	$(INSTALL-L) $(TARGET) $(DESTDIR)$(libdir)
+	$(INSTALL_DATA) $(TARGET) $(DESTDIR)$(libdir)
 endif
 ifneq ($(ENABLE_SHARED),)
 # For MinGW, do we want the DLL to go in the bin location?

