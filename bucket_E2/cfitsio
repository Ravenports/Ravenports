# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		cfitsio
VERSION=		3.430
KEYWORDS=		astro
VARIANTS=		standard
SDESC[standard]=	NASA FITS data format library
HOMEPAGE=		https://heasarc.gsfc.nasa.gov/docs/software/fitsio/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		http://heasarc.gsfc.nasa.gov/FTP/software/fitsio/c/
			http://heasarc.gsfc.nasa.gov/FTP/software/fitsio/c/oldvers/
			ftp://heasarc.gsfc.nasa.gov/software/fitsio/c/
			ftp://heasarc.gsfc.nasa.gov/software/fitsio/c/oldvers/
DISTFILE[1]=		cfitsio3430.tar.gz:main
DIST_SUBDIR=		cfitsio-20180324
DF_INDEX=		1
SPKGS[standard]=	complete
			primary
			docs

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

USES=			pkgconfig zlib

DISTNAME=		cfitsio

FPC_EQUIVALENT=		astro/cfitsio

MUST_CONFIGURE=		gnu

BUILD_TARGET=		libcfitsio.a shared
MAKE_ARGS=		ZLIB_SOURCES="zlib/zcompress.c zlib/zuncompress.c"

SOVERSION=		5.3.43

post-patch:
	${GREP} -l "<malloc.h>" ${WRKSRC}/*.[chl] ${WRKSRC}/zlib/*.h |\
		${XARGS} ${REINPLACE_CMD} -e 's|<malloc.h>|<stdlib.h>|'
	${REINPLACE_CMD} -e "/SHLIB_LD}/ s|$$| -L${LOCALBASE}/lib -Wl,-rpath,${LOCALBASE}/lib -lz|g" \
		${WRKSRC}/Makefile.in

do-install:
	@${MKDIR} \
		${STAGEDIR}${PREFIX}/lib/pkgconfig \
		${STAGEDIR}${STD_DOCDIR}
	(cd ${WRKSRC}/ && \
		${INSTALL_DATA} drvrsmem.h fitsio.h fitsio2.h longnam.h \
		${STAGEDIR}${PREFIX}/include/)
	${INSTALL_DATA} ${WRKSRC}/libcfitsio.a ${STAGEDIR}${PREFIX}/lib/
	${INSTALL_LIB} ${WRKSRC}/libcfitsio.so.5.3.43 \
		${STAGEDIR}${PREFIX}/lib/
	${INSTALL_DATA} ${WRKSRC}/cfitsio.pc ${STAGEDIR}${PREFIX}/lib/pkgconfig
	${LN} -fs libcfitsio.so.5.3.43 \
		${STAGEDIR}${PREFIX}/lib/libcfitsio.so.5
	${LN} -fs libcfitsio.so.5.3.43 \
		${STAGEDIR}${PREFIX}/lib/libcfitsio.so
	${INSTALL_DATA} ${WRKSRC}/docs/*.doc ${STAGEDIR}${STD_DOCDIR}

[FILE:406:descriptions/desc.primary]
CFITSIO is a library of C and Fortran subroutines for reading and writing
data files in FITS (Flexible Image Transport System) data format. CFITSIO
provides simple high-level routines for reading and writing FITS files
that insulate the programmer from the internal complexities of the FITS
format. CFITSIO also provides many advanced features for manipulating and
filtering the information in FITS files.


[FILE:114:distinfo]
14905b6f91ef64a34c90ec771d21a8f6da81d8ce083680c7c41651576087cf1d      4696821 cfitsio-20180324/cfitsio3430.tar.gz


[FILE:168:manifests/plist.primary]
include/
 drvrsmem.h
 fitsio.h
 fitsio2.h
 longnam.h
lib/
 libcfitsio.a
 libcfitsio.so
 libcfitsio.so.%%SOMAJOR%%
 libcfitsio.so.%%SOVERSION%%
lib/pkgconfig/cfitsio.pc


[FILE:217:patches/patch-configure]
--- configure.orig	2016-11-28 21:29:35 UTC
+++ configure
@@ -3540,7 +3540,7 @@ case $host in
 	ARCH=`uname -p`
 	EXT="darwin"
 	;;
-    *freebsd*)
+    *dragonfly*|*freebsd*|*solaris*)
 	ARCH="linux"
 	EXT="lnx"
 	;;

