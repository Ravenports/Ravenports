# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		rdesktop
VERSION=		1.9.0
REVISION=		6
KEYWORDS=		net comms
VARIANTS=		std
SDESC[std]=		RDP client - Windows NT/2000/2003 Terminal Server
HOMEPAGE=		https://github.com/rdesktop/rdesktop
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		https://github.com/rdesktop/rdesktop/releases/download/v1.9.0/
DISTFILE[1]=		rdesktop-1.9.0.tar.gz:main
DF_INDEX=		1
SPKGS[std]=		set
			primary
			docs
			man

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILD_DEPENDS=		gmp:dev:std
			gnutls:dev:std
			libao:dev:std
			nettle3:dev:std
			nettle3:primary:std
			pcsc-lite:dev:std
BUILDRUN_DEPENDS=	gnutls:primary:std
			libao:primary:std
			libsamplerate:primary:std
			libtasn1:primary:std
			pcsc-lite:primary:std

USES=			autoreconf cpe gmake iconv pkgconfig ssl zlib
XORG_COMPONENTS=	x11 xcursor xrandr

LICENSE=		GPLv3+:primary
LICENSE_TERMS=		primary:{{WRKDIR}}/TERMS
LICENSE_FILE=		GPLv3+:{{WRKSRC}}/COPYING
LICENSE_AWK=		TERMS:"^\#include"
LICENSE_SOURCE=		TERMS:{{WRKSRC}}/rdesktop.h
LICENSE_SCHEME=		solo

FPC_EQUIVALENT=		net/rdesktop

MUST_CONFIGURE=		gnu
CONFIGURE_ARGS=		--disable-credssp
			--with-ipv6
			--with-sound=libao
			--with-openssl={{OPENSSLBASE}}
			{{ICONV_CONFIGURE_ARG}}

LDFLAGS=		-pthread

do-install:
	${MKDIR} ${STAGEDIR}${PREFIX}/share/rdesktop/keymaps
	${MKDIR} ${STAGEDIR}${STD_DOCDIR}
	${INSTALL_PROGRAM} ${WRKSRC}/rdesktop ${STAGEDIR}${PREFIX}/bin
	${INSTALL_MAN} ${WRKSRC}/doc/rdesktop.1 \
		${STAGEDIR}${MAN1PREFIX}/man/man1
	${INSTALL_DATA} ${WRKSRC}/keymaps/* \
		${STAGEDIR}${PREFIX}/share/rdesktop/keymaps
	(cd ${WRKSRC} && ${INSTALL_DATA} doc/AUTHORS doc/TODO doc/*.txt \
		${STAGEDIR}${STD_DOCDIR})

[FILE:242:descriptions/desc.primary]
Rdesktop is an open source client for Windows NT/2000/2003 Terminal Server,
capable of natively speaking its Remote Desktop Protocol (RDP) in
order to present the user's Windows desktop.  Unlike Citrix ICA, no server
extensions are required.


[FILE:100:distinfo]
473c2f312391379960efe41caad37852c59312bc8f100f9b5f26609ab5704288       368980 rdesktop-1.9.0.tar.gz


[FILE:269:manifests/plist.primary]
bin/rdesktop
share/rdesktop/keymaps/
 ar
 common
 convert-map
 cs
 da
 de
 de-ch
 en-dv
 en-gb
 en-us
 en-us-intl
 es
 et
 fi
 fo
 fr
 fr-be
 fr-bepo
 fr-ca
 fr-ch
 he
 hr
 hu
 is
 it
 ja
 ko
 lt
 lv
 mk
 modifiers
 nl
 nl-be
 no
 pl
 pt
 pt-br
 ru
 sk
 sl
 sv
 th
 tr


[FILE:124:manifests/plist.docs]
share/doc/rdesktop/
 AUTHORS
 TODO
 ipv6.txt
 keymap-names.txt
 keymapping.txt
 licensing.txt
 patches.txt
 redirection.txt


[FILE:26:manifests/plist.man]
share/man/man1/rdesktop.1


[FILE:286:patches/patch-configure]
--- configure.orig	2019-09-20 06:39:32 UTC
+++ configure
@@ -3188,7 +3188,7 @@ if test "$ac_test_CFLAGS" = set; then
   CFLAGS=$ac_save_CFLAGS
 elif test $ac_cv_prog_cc_g = yes; then
   if test "$GCC" = yes; then
-    CFLAGS="-g -O2"
+    NOFLAGS="no-op"
   else
     CFLAGS="-g"
   fi


[FILE:440:patches/patch-ssl.c]
--- ssl.c.orig	2019-09-19 10:34:03 UTC
+++ ssl.c
@@ -307,10 +307,10 @@ rdssl_rkey_get_exp_mod(RDSSL_RKEY * rkey
 {
 	size_t outlen;
 
-	outlen = (mpz_sizeinbase(modulus, 2) + 7) / 8;
+	outlen = (mpz_sizeinbase((mpz_srcptr)modulus, 2) + 7) / 8;
 	if (outlen > max_mod_len)
 		return 1;
-	outlen = (mpz_sizeinbase(exponent, 2) + 7) / 8;
+	outlen = (mpz_sizeinbase((mpz_srcptr)exponent, 2) + 7) / 8;
 	if (outlen > max_exp_len)
 		return 1;
 


[FILE:477:patches/patch-xwin.c]
--- xwin.c.orig	2019-06-13 12:10:15 UTC
+++ xwin.c
@@ -48,7 +48,7 @@
 #define HOST_NAME_MAX MAXHOSTNAMELEN
 #endif
 
-#ifdef __FreeBSD__
+#if defined __FreeBSD__ || defined __DragonFly__ || defined __NetBSD__
 #define HOST_NAME_MAX _POSIX_HOST_NAME_MAX
 #endif
 
@@ -2167,6 +2167,8 @@ get_sizehints(XSizeHints * sizehints, ui
 		sizehints->min_width = sizehints->max_width = width;
 		sizehints->min_height = sizehints->max_height = height;
 	}
+
+	ui_reset_clip();
 }
 
 void

