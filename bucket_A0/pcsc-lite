# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		pcsc-lite
VERSION=		2.0.0
REVISION=		1
KEYWORDS=		devel security
VARIANTS=		standard
SDESC[standard]=	Smartcard development library
HOMEPAGE=		https://pcsclite.apdu.fr/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		https://pcsclite.apdu.fr/files/
DISTFILE[1]=		pcsc-lite-2.0.0.tar.bz2:main
DF_INDEX=		1
SPKGS[standard]=	complete
			primary
			tools
			dev
			man
			docs

OPTIONS_AVAILABLE=	FILTER
OPTIONS_STANDARD=	FILTER

B_DEPS[sunos]=		libusb:dev:standard
B_DEPS[linux]=		libusb:dev:standard
BR_DEPS[sunos]=		libusb:primary:standard
BR_DEPS[linux]=		libusb:primary:standard
EXRUN[tools]=		primary

USES=			cpe libtool perl:build pkgconfig shebangfix python

LICENSE=		BSD3CLAUSE:primary
LICENSE_FILE=		BSD3CLAUSE:{{WRKSRC}}/COPYING
LICENSE_SCHEME=		solo

CPE_VENDOR=		muscle
FPC_EQUIVALENT=		devel/pcsc-lite
SHEBANG_FILES=		src/spy/pcsc-spy

MUST_CONFIGURE=		gnu
CONFIGURE_ARGS=		--enable-usbdropdir={{PREFIX}}/lib/pcsc/drivers/
			--disable-libsystemd

INSTALL_TARGET=		install-strip
RC_SUBR=		pcscd:primary
SUB_FILES=		pkg-message-primary

VAR_OPSYS[netbsd]=	CONFIGURE_ARGS=--disable-usb

[FILTER].DESCRIPTION=			Control reader names reported by PCSC
[FILTER].CONFIGURE_ENABLE_BOTH=		filter

post-patch:
	${REINPLACE_CMD} -e "s,^datadir,#datadir,; s,^data_DATA,#data_DATA," \
		${WRKSRC}/doc/Makefile.in
	${REINPLACE_CMD} -e "s,libusb-1.0/libusb.h,libusb.h,; \
		s,libusb_strerror(ret),ret," ${WRKSRC}/configure \
			${WRKSRC}/src/hotplug_libusb.c

post-install:
	${MKDIR} ${STAGEDIR}${PREFIX}/lib/pcsc/drivers
	${MKDIR} ${STAGEDIR}${PREFIX}/lib/pcsc/services

[FILE:224:descriptions/desc.primary]
This is a port of the MUSCLE PC/SC-Lite architecture.
Allows easy porting of Windows smartcard software to other
operating systems.  Supports many types of serial, PCMCIA,
and USB smartcard readers and cryptographic tokens.


[FILE:499:descriptions/desc.tools]
On branch master
Your branch is up to date with 'origin/master'.

Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git restore <file>..." to discard changes in working directory)
	modified:   ../../../bucket_ED/veracrypt/distinfo
	modified:   ../../../bucket_ED/veracrypt/specification

Untracked files:
  (use "git add <file>..." to include in what will be committed)
	desc.tools

no changes added to commit (use "git add" and/or "git commit -a")


[FILE:102:distinfo]
d6c3e2b64510e5ed6fcd3323febf2cc2a8e5fda5a6588c7671f2d77f9f189356       799011 pcsc-lite-2.0.0.tar.bz2


[FILE:83:manifests/plist.primary]
lib/
 libpcsclite.so.1
 libpcsclite.so.1.0.0
 libpcscspy.so.0
 libpcscspy.so.0.0.0


[FILE:69:manifests/plist.tools]
bin/pcsc-spy
sbin/pcscd
@dir lib/pcsc/drivers
@dir lib/pcsc/services


[FILE:151:manifests/plist.dev]
include/PCSC/
 debuglog.h
 ifdhandler.h
 pcsclite.h
 reader.h
 winscard.h
 wintypes.h
lib/
 libpcsclite.so
 libpcscspy.so
lib/pkgconfig/libpcsclite.pc


[FILE:87:manifests/plist.man]
share/man/man1/pcsc-spy.1.gz
share/man/man5/reader.conf.5.gz
share/man/man8/pcscd.8.gz


[FILE:70:manifests/plist.docs]
share/doc/pcsc-lite/
 README.polkit
 install_spy.sh
 uninstall_spy.sh


[FILE:310:files/pcscd.in]
#!/bin/sh
#
# PROVIDE:	pcscd
# REQUIRE:	LOGIN
# Add the following lines to /etc/rc.conf.local or /etc/rc.conf
# to enable this service:
#
# pcscd_enable="YES"

. /etc/rc.subr

name="pcscd"
rcvar=pcscd_enable

command="%%PREFIX%%/sbin/pcscd"

load_rc_config "$name"

: ${pcscd_enable="NO"}

run_rc_command "$1"


[FILE:694:files/pkg-message-primary.in]
------------------------------------------------------------------------

PC/SC-Lite has been installed.
You need to install a driver for your smartcard reader e.g.
devel/libccid
security/ifd-slb_rf60

For cardreaders connected to the serial port: After installing the driver,
please update the pcscd configuration file
%%PREFIX%%/etc/reader.conf

For USB cardreaders add the following lines to /etc/devd.conf to enable
hotplugging.

attach 100 {
        device-name "ugen[0-9]+";
        action "%%PREFIX%%/sbin/pcscd -H";
};

detach 100 {
        device-name "ugen[0-9]+";
        action "%%PREFIX%%/sbin/pcscd -H";
};
------------------------------------------------------------------------

