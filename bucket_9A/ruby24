# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		ruby24
VERSION=		2.4.5
KEYWORDS=		lang ruby
VARIANTS=		standard
SDESC[standard]=	Object-oriented interpreted scripting language
HOMEPAGE=		http://www.ruby-lang.org/en/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		RUBY/2.4
DISTFILE[1]=		ruby-2.4.5.tar.xz:main
DIST_SUBDIR=		ruby
DF_INDEX=		1
SPKGS[standard]=	complete
			primary
			rdoc
			docs
			examples

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

BUILDRUN_DEPENDS=	libyaml:single:standard
			libffi:single:standard
			gdbm:single:standard
			gmp:complete:standard
RUN_DEPENDS=		autoselect-ruby:single:standard

USES=			autoreconf cpe execinfo readline ssl ruby:v24,interp
			zlib

DISTNAME=		ruby-2.4.5

LICENSE=		BSD2CLAUSE:primary RUBY:primary
LICENSE_FILE=		RUBY:{{WRKSRC}}/COPYING
			BSD2CLAUSE:{{WRKSRC}}/BSDL
LICENSE_SCHEME=		dual

CPE_UPDATE=		p0
CPE_VENDOR=		ruby-lang
CPE_VERSION=		2.4.5
FPC_EQUIVALENT=		lang/ruby24

MUST_CONFIGURE=		gnu
CONFIGURE_ARGS=		--enable-pthread
			--enable-shared
			--enable-install-static-library
			--with-ruby-version=minor
			--with-sitedir="{{PREFIX}}/lib/ruby/site_ruby"
			--with-vendordir="{{PREFIX}}/lib/ruby/vendor_ruby"
			--disable-libedit
			--disable-dtrace
			--with-readline-dir={{LOCALBASE}}
			--with-gmp
			{{RUBY_CONFIGURE_ARGS}}
CONFIGURE_ENV=		debugflags=
			ac_cv_build={{CONFIGURE_TARGET}}
			stack_protector=no

INSTALL_REQ_TOOLCHAIN=	yes
PLIST_SUB=		XY={{RUBY_SUFFIX}}
			XDOTY={{RUBY_VER}}

CFLAGS=			-Wno-attributes
VAR_OPSYS[darwin]=	CONFIGURE_ENV=ac_cv_func_backtrace=no

post-patch:
	${FIND} ${WRKSRC}/ -name "*.orig" -delete
	# We install these from other ports
.for d in bin/rake doc/rake lib/rake test/rake man/rake.1 lib/rake.rb ext/win32ole bin/gem
	${RM} -r ${BUILD_WRKSRC}/${d}
.endfor

pre-install:
	${MKDIR} ${STAGEDIR}${RUBY_DOCDIR}/readline \
		${STAGEDIR}${RUBY_DOCDIR}/ripper \
		${STAGEDIR}${RUBY_DOCDIR}/stringio \
		${STAGEDIR}${RUBY_DOCDIR}/syslog \
		${STAGEDIR}${RUBY_EXAMPLESDIR}/bigdecimal \
		${STAGEDIR}${RUBY_RIDIR}

post-patch-linux:
	# <sys/vnode.h> does not exist on linux
	${REINPLACE_CMD} -e '/vnode\.h/d' ${WRKSRC}/dir.c

post-install:
	# strip ruby binaries
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/bin/${RUBY_NAME}
	${STRIP_CMD} ${STAGEDIR}${PREFIX}/lib/libruby${RUBY_SHLIBVER}.${LIBEXT}
	${FIND} ${STAGEDIR}${RUBY_ARCHLIBDIR} -type f -name '*\.${LIBEXT}' -exec ${STRIP_CMD} {} \;
	# install docs
	(cd ${WRKSRC}/doc/ && ${COPYTREE_SHARE} . ${STAGEDIR}${RUBY_DOCDIR}/)
	${INSTALL_DATA} ${WRKSRC}/ext/readline/README ${STAGEDIR}${RUBY_DOCDIR}/readline/
	${INSTALL_DATA} ${WRKSRC}/ext/ripper/README ${STAGEDIR}${RUBY_DOCDIR}/ripper/
	${INSTALL_DATA} ${WRKSRC}/ext/stringio/README.md ${STAGEDIR}${RUBY_DOCDIR}/stringio/
	${INSTALL_DATA} ${WRKSRC}/ext/syslog/syslog.txt ${STAGEDIR}${RUBY_DOCDIR}/syslog/
	# remove docs
	${RM} ${STAGEDIR}${STD_DOCDIR}/NEWS-*
	${RM} ${STAGEDIR}${STD_DOCDIR}/ChangeLog-*
	${RM} ${STAGEDIR}${STD_DOCDIR}/.document
	# install examples
	(cd ${WRKSRC}/sample/ && ${COPYTREE_SHARE} . ${STAGEDIR}${RUBY_EXAMPLESDIR}/)
	${INSTALL_DATA} ${WRKSRC}/ext/bigdecimal/sample/*.rb \
		${STAGEDIR}${RUBY_EXAMPLESDIR}/bigdecimal/

post-build:
	# Hack to allow modules to be installed into separate PREFIX and/or under
	# user privilegies
	${RB_SET_CONF_VAR} "prefix" "ENV['PREFIX'] || \3"
	${RB_SET_CONF_VAR} "INSTALL" "'/usr/bin/install -c'"
	${RB_SET_CONF_VAR} "INSTALL_PROGRAM" "ENV['RB_USER_INSTALL'] ? '${INSTALL} ${COPY} ${STRIP} -m ${BINMODE}' : '${INSTALL_PROGRAM}'"
	${RB_SET_CONF_VAR} "INSTALL_SCRIPT" "ENV['RB_USER_INSTALL'] ? '${INSTALL} ${COPY} -m ${BINMODE}' : '${INSTALL_SCRIPT}'"
	${RB_SET_CONF_VAR} "INSTALL_DATA" "ENV['RB_USER_INSTALL'] ? '${INSTALL} ${COPY} -m ${SHAREMODE}' : '${INSTALL_DATA}'"

[FILE:665:descriptions/desc.primary]
Ruby is the interpreted scripting language for quick and
easy object-oriented programming.  It has many features to
process text files and to do system management tasks (as in
Perl).  It is simple, straight-forward, and extensible.

Features of Ruby are shown below.

  + Simple Syntax
  + *Normal* Object-Oriented features(ex. class, method calls)
  + *Advanced* Object-Oriented features(ex. Mix-in, Singleton-method)
  + Operator Overloading
  + Exception Handling
  + Iterators and Closures
  + Garbage Collection
  + Dynamic Loading of Object files(on some architecture)
  + Highly Portable(works on many UNIX machines, and on DOS,
    Windows, Mac, BeOS etc.)


[FILE:64:descriptions/desc.rdoc]
This package contains the Ruby Documentation System for Ruby24.


[FILE:101:distinfo]
2f0cdcce9989f63ef7c2939bdb17b1ef244c4f384d85b8531d60e73d8cc31eeb     10064712 ruby/ruby-2.4.5.tar.xz


[FILE:16704:manifests/plist.primary]
%%ONLY-LINUX%%lib/libruby%%XY%%.so.%%RUBY_VERSION%%
bin/
 erb%%XY%%
 irb%%XY%%
 rdoc%%XY%%
 ri%%XY%%
 ruby%%XY%%
include/ruby-%%XDOTY%%/ruby.h
include/ruby-%%XDOTY%%/%%RUBY_ARCH%%/ruby/config.h
include/ruby-%%XDOTY%%/ruby/
 backward.h
 debug.h
 defines.h
 digest.h
 encoding.h
 intern.h
 io.h
 missing.h
 onigmo.h
 oniguruma.h
 re.h
 regex.h
 ruby.h
 st.h
 subst.h
 thread.h
 thread_native.h
 util.h
 version.h
 vm.h
include/ruby-%%XDOTY%%/ruby/backward/
 classext.h
 rubyio.h
 rubysig.h
 st.h
 util.h
lib/
 libruby%%XY%%-static.a
 libruby%%XY%%.so
 libruby%%XY%%.so.%%RUBY_SHLIBVER%%
lib/pkgconfig/ruby-%%XDOTY%%.pc
lib/ruby/%%XDOTY%%/
 English.rb
 abbrev.rb
 base64.rb
 benchmark.rb
 cgi.rb
 cmath.rb
 csv.rb
 date.rb
 debug.rb
 delegate.rb
 digest.rb
 drb.rb
 e2mmap.rb
 erb.rb
 expect.rb
 fiddle.rb
 fileutils.rb
 find.rb
 forwardable.rb
 getoptlong.rb
 ipaddr.rb
 irb.rb
 json.rb
 kconv.rb
 logger.rb
 mathn.rb
 matrix.rb
 mkmf.rb
 monitor.rb
 mutex_m.rb
 observer.rb
 open-uri.rb
 open3.rb
 openssl.rb
 optionparser.rb
 optparse.rb
 ostruct.rb
 pathname.rb
 pp.rb
 prettyprint.rb
 prime.rb
 profile.rb
 profiler.rb
 pstore.rb
 psych.rb
 rdoc.rb
 resolv-replace.rb
 resolv.rb
 ripper.rb
 rss.rb
 rubygems.rb
 scanf.rb
 securerandom.rb
 set.rb
 shell.rb
 shellwords.rb
 singleton.rb
 socket.rb
 sync.rb
 tempfile.rb
 thwait.rb
 time.rb
 timeout.rb
 tmpdir.rb
 tracer.rb
 tsort.rb
 ubygems.rb
 un.rb
 unicode_normalize.rb
 uri.rb
 weakref.rb
 webrick.rb
 yaml.rb
lib/ruby/%%XDOTY%%/%%RUBY_ARCH%%/
 bigdecimal.%%MODULE%%
 continuation.%%MODULE%%
 coverage.%%MODULE%%
 date_core.%%MODULE%%
 dbm.%%MODULE%%
 digest.%%MODULE%%
 etc.%%MODULE%%
 fcntl.%%MODULE%%
 fiber.%%MODULE%%
 fiddle.%%MODULE%%
 gdbm.%%MODULE%%
 nkf.%%MODULE%%
 objspace.%%MODULE%%
 openssl.%%MODULE%%
 pathname.%%MODULE%%
 psych.%%MODULE%%
 pty.%%MODULE%%
 rbconfig.rb
 readline.%%MODULE%%
 ripper.%%MODULE%%
 sdbm.%%MODULE%%
 socket.%%MODULE%%
 stringio.%%MODULE%%
 strscan.%%MODULE%%
 syslog.%%MODULE%%
 zlib.%%MODULE%%
lib/ruby/%%XDOTY%%/%%RUBY_ARCH%%/cgi/escape.%%MODULE%%
lib/ruby/%%XDOTY%%/%%RUBY_ARCH%%/digest/
 bubblebabble.%%MODULE%%
 md5.%%MODULE%%
 rmd160.%%MODULE%%
 sha1.%%MODULE%%
 sha2.%%MODULE%%
lib/ruby/%%XDOTY%%/%%RUBY_ARCH%%/enc/
 big5.%%MODULE%%
 cp949.%%MODULE%%
 emacs_mule.%%MODULE%%
 encdb.%%MODULE%%
 euc_jp.%%MODULE%%
 euc_kr.%%MODULE%%
 euc_tw.%%MODULE%%
 gb18030.%%MODULE%%
 gb2312.%%MODULE%%
 gbk.%%MODULE%%
 iso_8859_1.%%MODULE%%
 iso_8859_10.%%MODULE%%
 iso_8859_11.%%MODULE%%
 iso_8859_13.%%MODULE%%
 iso_8859_14.%%MODULE%%
 iso_8859_15.%%MODULE%%
 iso_8859_16.%%MODULE%%
 iso_8859_2.%%MODULE%%
 iso_8859_3.%%MODULE%%
 iso_8859_4.%%MODULE%%
 iso_8859_5.%%MODULE%%
 iso_8859_6.%%MODULE%%
 iso_8859_7.%%MODULE%%
 iso_8859_8.%%MODULE%%
 iso_8859_9.%%MODULE%%
 koi8_r.%%MODULE%%
 koi8_u.%%MODULE%%
 shift_jis.%%MODULE%%
 utf_16be.%%MODULE%%
 utf_16le.%%MODULE%%
 utf_32be.%%MODULE%%
 utf_32le.%%MODULE%%
 windows_1250.%%MODULE%%
 windows_1251.%%MODULE%%
 windows_1252.%%MODULE%%
 windows_1253.%%MODULE%%
 windows_1254.%%MODULE%%
 windows_1257.%%MODULE%%
 windows_31j.%%MODULE%%
lib/ruby/%%XDOTY%%/%%RUBY_ARCH%%/enc/trans/
 big5.%%MODULE%%
 chinese.%%MODULE%%
 ebcdic.%%MODULE%%
 emoji.%%MODULE%%
 emoji_iso2022_kddi.%%MODULE%%
 emoji_sjis_docomo.%%MODULE%%
 emoji_sjis_kddi.%%MODULE%%
 emoji_sjis_softbank.%%MODULE%%
 escape.%%MODULE%%
 gb18030.%%MODULE%%
 gbk.%%MODULE%%
 iso2022.%%MODULE%%
 japanese.%%MODULE%%
 japanese_euc.%%MODULE%%
 japanese_sjis.%%MODULE%%
 korean.%%MODULE%%
 single_byte.%%MODULE%%
 transdb.%%MODULE%%
 utf8_mac.%%MODULE%%
 utf_16_32.%%MODULE%%
lib/ruby/%%XDOTY%%/%%RUBY_ARCH%%/io/
 console.%%MODULE%%
 nonblock.%%MODULE%%
 wait.%%MODULE%%
lib/ruby/%%XDOTY%%/%%RUBY_ARCH%%/json/ext/
 generator.%%MODULE%%
 parser.%%MODULE%%
lib/ruby/%%XDOTY%%/%%RUBY_ARCH%%/mathn/
 complex.%%MODULE%%
 rational.%%MODULE%%
lib/ruby/%%XDOTY%%/%%RUBY_ARCH%%/racc/cparse.%%MODULE%%
lib/ruby/%%XDOTY%%/%%RUBY_ARCH%%/rbconfig/sizeof.%%MODULE%%
lib/ruby/%%XDOTY%%/bigdecimal/
 jacobian.rb
 ludcmp.rb
 math.rb
 newton.rb
 util.rb
lib/ruby/%%XDOTY%%/cgi/
 cookie.rb
 core.rb
 html.rb
 session.rb
 util.rb
lib/ruby/%%XDOTY%%/cgi/session/pstore.rb
lib/ruby/%%XDOTY%%/digest/sha2.rb
lib/ruby/%%XDOTY%%/drb/
 acl.rb
 drb.rb
 eq.rb
 extserv.rb
 extservm.rb
 gw.rb
 invokemethod.rb
 observer.rb
 ssl.rb
 timeridconv.rb
 unix.rb
lib/ruby/%%XDOTY%%/fiddle/
 closure.rb
 cparser.rb
 function.rb
 import.rb
 pack.rb
 struct.rb
 types.rb
 value.rb
lib/ruby/%%XDOTY%%/forwardable/impl.rb
lib/ruby/%%XDOTY%%/io/console/size.rb
lib/ruby/%%XDOTY%%/irb/
 completion.rb
 context.rb
 extend-command.rb
 frame.rb
 help.rb
 init.rb
 input-method.rb
 inspector.rb
 locale.rb
 magic-file.rb
 notifier.rb
 output-method.rb
 ruby-lex.rb
 ruby-token.rb
 slex.rb
 src_encoding.rb
 version.rb
 workspace.rb
 ws-for-case-2.rb
 xmp.rb
lib/ruby/%%XDOTY%%/irb/cmd/
 chws.rb
 fork.rb
 help.rb
 load.rb
 nop.rb
 pushws.rb
 subirb.rb
lib/ruby/%%XDOTY%%/irb/ext/
 change-ws.rb
 history.rb
 loader.rb
 math-mode.rb
 multi-irb.rb
 save-history.rb
 tracer.rb
 use-loader.rb
 workspaces.rb
lib/ruby/%%XDOTY%%/irb/lc/
 error.rb
 help-message
lib/ruby/%%XDOTY%%/irb/lc/ja/
 encoding_aliases.rb
 error.rb
 help-message
lib/ruby/%%XDOTY%%/json/
 common.rb
 ext.rb
 generic_object.rb
 version.rb
lib/ruby/%%XDOTY%%/json/add/
 bigdecimal.rb
 complex.rb
 core.rb
 date.rb
 date_time.rb
 exception.rb
 ostruct.rb
 range.rb
 rational.rb
 regexp.rb
 struct.rb
 symbol.rb
 time.rb
lib/ruby/%%XDOTY%%/matrix/
 eigenvalue_decomposition.rb
 lup_decomposition.rb
lib/ruby/%%XDOTY%%/net/
 ftp.rb
 http.rb
 https.rb
 imap.rb
 pop.rb
 protocol.rb
 smtp.rb
lib/ruby/%%XDOTY%%/net/http/
 backward.rb
 exceptions.rb
 generic_request.rb
 header.rb
 proxy_delta.rb
 request.rb
 requests.rb
 response.rb
 responses.rb
lib/ruby/%%XDOTY%%/openssl/
 bn.rb
 buffering.rb
 cipher.rb
 config.rb
 digest.rb
 pkey.rb
 ssl.rb
 x509.rb
lib/ruby/%%XDOTY%%/optparse/
 ac.rb
 date.rb
 kwargs.rb
 shellwords.rb
 time.rb
 uri.rb
 version.rb
lib/ruby/%%XDOTY%%/psych/
 class_loader.rb
 coder.rb
 core_ext.rb
 deprecated.rb
 exception.rb
 handler.rb
 nodes.rb
 omap.rb
 parser.rb
 scalar_scanner.rb
 set.rb
 stream.rb
 streaming.rb
 syntax_error.rb
 tree_builder.rb
 versions.rb
 visitors.rb
 y.rb
lib/ruby/%%XDOTY%%/psych/handlers/
 document_stream.rb
 recorder.rb
lib/ruby/%%XDOTY%%/psych/json/
 ruby_events.rb
 stream.rb
 tree_builder.rb
 yaml_events.rb
lib/ruby/%%XDOTY%%/psych/nodes/
 alias.rb
 document.rb
 mapping.rb
 node.rb
 scalar.rb
 sequence.rb
 stream.rb
lib/ruby/%%XDOTY%%/psych/visitors/
 depth_first.rb
 emitter.rb
 json_tree.rb
 to_ruby.rb
 visitor.rb
 yaml_tree.rb
lib/ruby/%%XDOTY%%/racc/parser.rb
lib/ruby/%%XDOTY%%/rbconfig/datadir.rb
lib/ruby/%%XDOTY%%/rdoc/
 alias.rb
 anon_class.rb
 any_method.rb
 attr.rb
 class_module.rb
 code_object.rb
 code_objects.rb
 comment.rb
 constant.rb
 context.rb
 cross_reference.rb
 encoding.rb
 erb_partial.rb
 erbio.rb
 extend.rb
 generator.rb
 ghost_method.rb
 i18n.rb
 include.rb
 known_classes.rb
 markdown.rb
 markup.rb
 meta_method.rb
 method_attr.rb
 mixin.rb
 normal_class.rb
 normal_module.rb
 options.rb
 parser.rb
 rd.rb
 rdoc.rb
 require.rb
 ri.rb
 ruby_lex.rb
 ruby_token.rb
 rubygems_hook.rb
 servlet.rb
 single_class.rb
 stats.rb
 store.rb
 task.rb
 test_case.rb
 text.rb
 token_stream.rb
 tom_doc.rb
 top_level.rb
lib/ruby/%%XDOTY%%/rdoc/context/section.rb
lib/ruby/%%XDOTY%%/rdoc/generator/
 darkfish.rb
 json_index.rb
 markup.rb
 pot.rb
 ri.rb
lib/ruby/%%XDOTY%%/rdoc/generator/pot/
 message_extractor.rb
 po.rb
 po_entry.rb
lib/ruby/%%XDOTY%%/rdoc/generator/template/darkfish/
 _footer.rhtml
 _head.rhtml
 _sidebar_VCS_info.rhtml
 _sidebar_classes.rhtml
 _sidebar_extends.rhtml
 _sidebar_in_files.rhtml
 _sidebar_includes.rhtml
 _sidebar_installed.rhtml
 _sidebar_methods.rhtml
 _sidebar_navigation.rhtml
 _sidebar_pages.rhtml
 _sidebar_parent.rhtml
 _sidebar_search.rhtml
 _sidebar_sections.rhtml
 _sidebar_table_of_contents.rhtml
 class.rhtml
 index.rhtml
 page.rhtml
 servlet_not_found.rhtml
 servlet_root.rhtml
 table_of_contents.rhtml
lib/ruby/%%XDOTY%%/rdoc/generator/template/darkfish/css/
 fonts.css
 rdoc.css
lib/ruby/%%XDOTY%%/rdoc/generator/template/darkfish/fonts/
 Lato-Light.ttf
 Lato-LightItalic.ttf
 Lato-Regular.ttf
 Lato-RegularItalic.ttf
 SourceCodePro-Bold.ttf
 SourceCodePro-Regular.ttf
lib/ruby/%%XDOTY%%/rdoc/generator/template/darkfish/images/
 add.png
 arrow_up.png
 brick.png
 brick_link.png
 bug.png
 bullet_black.png
 bullet_toggle_minus.png
 bullet_toggle_plus.png
 date.png
 delete.png
 find.png
 loadingAnimation.gif
 macFFBgHack.png
 package.png
 page_green.png
 page_white_text.png
 page_white_width.png
 plugin.png
 ruby.png
 tag_blue.png
 tag_green.png
 transparent.png
 wrench.png
 wrench_orange.png
 zoom.png
lib/ruby/%%XDOTY%%/rdoc/generator/template/darkfish/js/
 darkfish.js
 jquery.js
 search.js
lib/ruby/%%XDOTY%%/rdoc/generator/template/json_index/js/
 navigation.js
 searcher.js
lib/ruby/%%XDOTY%%/rdoc/i18n/
 locale.rb
 text.rb
lib/ruby/%%XDOTY%%/rdoc/markdown/
 entities.rb
 literals.rb
lib/ruby/%%XDOTY%%/rdoc/markup/
 attr_changer.rb
 attr_span.rb
 attribute_manager.rb
 attributes.rb
 blank_line.rb
 block_quote.rb
 document.rb
 formatter.rb
 formatter_test_case.rb
 hard_break.rb
 heading.rb
 include.rb
 indented_paragraph.rb
 inline.rb
 list.rb
 list_item.rb
 paragraph.rb
 parser.rb
 pre_process.rb
 raw.rb
 rule.rb
 special.rb
 text_formatter_test_case.rb
 to_ansi.rb
 to_bs.rb
 to_html.rb
 to_html_crossref.rb
 to_html_snippet.rb
 to_joined_paragraph.rb
 to_label.rb
 to_markdown.rb
 to_rdoc.rb
 to_table_of_contents.rb
 to_test.rb
 to_tt_only.rb
 verbatim.rb
lib/ruby/%%XDOTY%%/rdoc/parser/
 c.rb
 changelog.rb
 markdown.rb
 rd.rb
 ruby.rb
 ruby_tools.rb
 simple.rb
 text.rb
lib/ruby/%%XDOTY%%/rdoc/rd/
 block_parser.rb
 inline.rb
 inline_parser.rb
lib/ruby/%%XDOTY%%/rdoc/ri/
 driver.rb
 formatter.rb
 paths.rb
 store.rb
 task.rb
lib/ruby/%%XDOTY%%/rdoc/stats/
 normal.rb
 quiet.rb
 verbose.rb
lib/ruby/%%XDOTY%%/rexml/
 attlistdecl.rb
 attribute.rb
 cdata.rb
 child.rb
 comment.rb
 doctype.rb
 document.rb
 element.rb
 encoding.rb
 entity.rb
 functions.rb
 instruction.rb
 namespace.rb
 node.rb
 output.rb
 parent.rb
 parseexception.rb
 quickpath.rb
 rexml.rb
 sax2listener.rb
 security.rb
 source.rb
 streamlistener.rb
 syncenumerator.rb
 text.rb
 undefinednamespaceexception.rb
 xmldecl.rb
 xmltokens.rb
 xpath.rb
 xpath_parser.rb
lib/ruby/%%XDOTY%%/rexml/dtd/
 attlistdecl.rb
 dtd.rb
 elementdecl.rb
 entitydecl.rb
 notationdecl.rb
lib/ruby/%%XDOTY%%/rexml/formatters/
 default.rb
 pretty.rb
 transitive.rb
lib/ruby/%%XDOTY%%/rexml/light/node.rb
lib/ruby/%%XDOTY%%/rexml/parsers/
 baseparser.rb
 lightparser.rb
 pullparser.rb
 sax2parser.rb
 streamparser.rb
 treeparser.rb
 ultralightparser.rb
 xpathparser.rb
lib/ruby/%%XDOTY%%/rexml/validation/
 relaxng.rb
 validation.rb
 validationexception.rb
lib/ruby/%%XDOTY%%/rinda/
 rinda.rb
 ring.rb
 tuplespace.rb
lib/ruby/%%XDOTY%%/ripper/
 core.rb
 filter.rb
 lexer.rb
 sexp.rb
lib/ruby/%%XDOTY%%/rss/
 0.9.rb
 1.0.rb
 2.0.rb
 atom.rb
 content.rb
 converter.rb
 dublincore.rb
 image.rb
 itunes.rb
 maker.rb
 parser.rb
 rexmlparser.rb
 rss.rb
 slash.rb
 syndication.rb
 taxonomy.rb
 trackback.rb
 utils.rb
 xml-stylesheet.rb
 xml.rb
 xmlparser.rb
 xmlscanner.rb
lib/ruby/%%XDOTY%%/rss/content/
 1.0.rb
 2.0.rb
lib/ruby/%%XDOTY%%/rss/dublincore/
 1.0.rb
 2.0.rb
 atom.rb
lib/ruby/%%XDOTY%%/rss/maker/
 0.9.rb
 1.0.rb
 2.0.rb
 atom.rb
 base.rb
 content.rb
 dublincore.rb
 entry.rb
 feed.rb
 image.rb
 itunes.rb
 slash.rb
 syndication.rb
 taxonomy.rb
 trackback.rb
lib/ruby/%%XDOTY%%/rubygems/
 available_set.rb
 basic_specification.rb
 command.rb
 command_manager.rb
 compatibility.rb
 config_file.rb
 defaults.rb
 dependency.rb
 dependency_installer.rb
 dependency_list.rb
 deprecate.rb
 doctor.rb
 errors.rb
 exceptions.rb
 ext.rb
 gem_runner.rb
 gemcutter_utilities.rb
 indexer.rb
 install_default_message.rb
 install_message.rb
 install_update_options.rb
 installer.rb
 installer_test_case.rb
 local_remote_options.rb
 mock_gem_ui.rb
 name_tuple.rb
 package.rb
 package_task.rb
 path_support.rb
 platform.rb
 psych_additions.rb
 psych_tree.rb
 rdoc.rb
 remote_fetcher.rb
 request.rb
 request_set.rb
 requirement.rb
 resolver.rb
 safe_yaml.rb
 security.rb
 server.rb
 source.rb
 source_list.rb
 source_local.rb
 source_specific_file.rb
 spec_fetcher.rb
 specification.rb
 stub_specification.rb
 syck_hack.rb
 test_case.rb
 test_utilities.rb
 text.rb
 uninstaller.rb
 uri_formatter.rb
 user_interaction.rb
 util.rb
 validator.rb
 version.rb
 version_option.rb
lib/ruby/%%XDOTY%%/rubygems/commands/
 build_command.rb
 cert_command.rb
 check_command.rb
 cleanup_command.rb
 contents_command.rb
 dependency_command.rb
 environment_command.rb
 fetch_command.rb
 generate_index_command.rb
 help_command.rb
 install_command.rb
 list_command.rb
 lock_command.rb
 mirror_command.rb
 open_command.rb
 outdated_command.rb
 owner_command.rb
 pristine_command.rb
 push_command.rb
 query_command.rb
 rdoc_command.rb
 search_command.rb
 server_command.rb
 setup_command.rb
 sources_command.rb
 specification_command.rb
 stale_command.rb
 uninstall_command.rb
 unpack_command.rb
 update_command.rb
 which_command.rb
 yank_command.rb
lib/ruby/%%XDOTY%%/rubygems/core_ext/
 kernel_gem.rb
 kernel_require.rb
lib/ruby/%%XDOTY%%/rubygems/ext/
 build_error.rb
 builder.rb
 cmake_builder.rb
 configure_builder.rb
 ext_conf_builder.rb
 rake_builder.rb
lib/ruby/%%XDOTY%%/rubygems/package/
 digest_io.rb
 file_source.rb
 io_source.rb
 old.rb
 source.rb
 tar_header.rb
 tar_reader.rb
 tar_test_case.rb
 tar_writer.rb
lib/ruby/%%XDOTY%%/rubygems/package/tar_reader/entry.rb
lib/ruby/%%XDOTY%%/rubygems/request/
 connection_pools.rb
 http_pool.rb
 https_pool.rb
lib/ruby/%%XDOTY%%/rubygems/request_set/
 gem_dependency_api.rb
 lockfile.rb
lib/ruby/%%XDOTY%%/rubygems/request_set/lockfile/
 parser.rb
 tokenizer.rb
lib/ruby/%%XDOTY%%/rubygems/resolver/
 activation_request.rb
 api_set.rb
 api_specification.rb
 best_set.rb
 composed_set.rb
 conflict.rb
 current_set.rb
 dependency_request.rb
 git_set.rb
 git_specification.rb
 index_set.rb
 index_specification.rb
 installed_specification.rb
 installer_set.rb
 local_specification.rb
 lock_set.rb
 lock_specification.rb
 molinillo.rb
 requirement_list.rb
 set.rb
 source_set.rb
 spec_specification.rb
 specification.rb
 stats.rb
 vendor_set.rb
 vendor_specification.rb
lib/ruby/%%XDOTY%%/rubygems/resolver/molinillo/lib/molinillo.rb
lib/ruby/%%XDOTY%%/rubygems/resolver/molinillo/lib/molinillo/
 dependency_graph.rb
 errors.rb
 gem_metadata.rb
 resolution.rb
 resolver.rb
 state.rb
lib/ruby/%%XDOTY%%/rubygems/resolver/molinillo/lib/molinillo/delegates/
 resolution_state.rb
 specification_provider.rb
lib/ruby/%%XDOTY%%/rubygems/resolver/molinillo/lib/molinillo/dependency_graph/
 action.rb
 add_edge_no_circular.rb
 add_vertex.rb
 delete_edge.rb
 detach_vertex_named.rb
 log.rb
 set_payload.rb
 tag.rb
 vertex.rb
lib/ruby/%%XDOTY%%/rubygems/resolver/molinillo/lib/molinillo/modules/
 specification_provider.rb
 ui.rb
lib/ruby/%%XDOTY%%/rubygems/security/
 policies.rb
 policy.rb
 signer.rb
 trust_dir.rb
lib/ruby/%%XDOTY%%/rubygems/source/
 git.rb
 installed.rb
 local.rb
 lock.rb
 specific_file.rb
 vendor.rb
lib/ruby/%%XDOTY%%/rubygems/ssl_certs/index.rubygems.org/GlobalSignRootCA.pem
lib/ruby/%%XDOTY%%/rubygems/ssl_certs/rubygems.global.ssl.fastly.net/DigiCertHighAssuranceEVRootCA.pem
lib/ruby/%%XDOTY%%/rubygems/ssl_certs/rubygems.org/AddTrustExternalCARoot.pem
lib/ruby/%%XDOTY%%/rubygems/util/
 licenses.rb
 list.rb
lib/ruby/%%XDOTY%%/shell/
 builtin-command.rb
 command-processor.rb
 error.rb
 filter.rb
 process-controller.rb
 system-command.rb
 version.rb
lib/ruby/%%XDOTY%%/syslog/logger.rb
lib/ruby/%%XDOTY%%/unicode_normalize/
 normalize.rb
 tables.rb
lib/ruby/%%XDOTY%%/uri/
 common.rb
 ftp.rb
 generic.rb
 http.rb
 https.rb
 ldap.rb
 ldaps.rb
 mailto.rb
 rfc2396_parser.rb
 rfc3986_parser.rb
lib/ruby/%%XDOTY%%/webrick/
 accesslog.rb
 cgi.rb
 compat.rb
 config.rb
 cookie.rb
 htmlutils.rb
 httpauth.rb
 httpproxy.rb
 httprequest.rb
 httpresponse.rb
 https.rb
 httpserver.rb
 httpservlet.rb
 httpstatus.rb
 httputils.rb
 httpversion.rb
 log.rb
 server.rb
 ssl.rb
 utils.rb
 version.rb
lib/ruby/%%XDOTY%%/webrick/httpauth/
 authenticator.rb
 basicauth.rb
 digestauth.rb
 htdigest.rb
 htgroup.rb
 htpasswd.rb
 userdb.rb
lib/ruby/%%XDOTY%%/webrick/httpservlet/
 abstract.rb
 cgi_runner.rb
 cgihandler.rb
 erbhandler.rb
 filehandler.rb
 prochandler.rb
lib/ruby/%%XDOTY%%/yaml/
 dbm.rb
 store.rb
share/man/man1/
 erb%%XY%%.1.gz
 irb%%XY%%.1.gz
 ri%%XY%%.1.gz
 ruby%%XY%%.1.gz
@dir %%RUBY_SITEARCHLIBDIR%%
@dir %%RUBY_VENDORARCHLIBDIR%%
@dir lib/ruby/%%XDOTY%%/racc/rdoc


[FILE:813:manifests/plist.docs]
share/doc/ruby%%XY%%/
 contributing.rdoc
 contributors.rdoc
 dtrace_probes.rdoc
 etc.rd.ja
 extension.ja.rdoc
 extension.rdoc
 forwardable.rd.ja
 globals.rdoc
 keywords.rdoc
 maintainers.rdoc
 marshal.rdoc
 regexp.rdoc
 security.rdoc
 shell.rd.ja
 standard_library.rdoc
 syntax.rdoc
share/doc/ruby%%XY%%/images/boottime-classes.png
share/doc/ruby%%XY%%/irb/
 irb-tools.rd.ja
 irb.rd.ja
share/doc/ruby%%XY%%/pty/
 README.expect.ja
 README.ja
share/doc/ruby%%XY%%/readline/README
share/doc/ruby%%XY%%/ripper/README
share/doc/ruby%%XY%%/stringio/README.md
share/doc/ruby%%XY%%/syntax/
 assignment.rdoc
 calling_methods.rdoc
 control_expressions.rdoc
 exceptions.rdoc
 literals.rdoc
 methods.rdoc
 miscellaneous.rdoc
 modules_and_classes.rdoc
 precedence.rdoc
 refinements.rdoc
share/doc/ruby%%XY%%/syslog/syslog.txt


[FILE:3132:manifests/plist.examples]
share/examples/ruby%%XY%%/
 README
 benchmark.rb
 biorhythm.rb
 cal.rb
 cbreak.rb
 cgi-session-pstore.rb
 clnt.rb
 coverage.rb
 delegate.rb
 dir.rb
 dualstack-fetch.rb
 dualstack-httpd.rb
 eval.rb
 export.rb
 exyacc.rb
 fact.rb
 fib.awk
 fib.pl
 fib.py
 fib.rb
 fib.scm
 freq.rb
 from.rb
 fullpath.rb
 iseq_loader.rb
 less.rb
 list.rb
 list2.rb
 list3.rb
 mine.rb
 mkproto.rb
 mpart.rb
 net-imap.rb
 observ.rb
 occur.pl
 occur.rb
 occur2.rb
 open3.rb
 philos.rb
 pi.rb
 pstore.rb
 rcs.awk
 rcs.dat
 rcs.rb
 rinda-ring.rb
 sieve.rb
 simple-bench.rb
 svr.rb
 tempfile.rb
 test.rb
 time.rb
 timeout.rb
 trojan.rb
 tsvr.rb
 uumerge.rb
 weakref.rb
share/examples/ruby%%XY%%/bigdecimal/
 linear.rb
 nlsolve.rb
 pi.rb
share/examples/ruby%%XY%%/drb/
 README.ja.rdoc
 README.rdoc
 acl.rb
 darray.rb
 darrayc.rb
 dbiff.rb
 dcdbiff.rb
 dchatc.rb
 dchats.rb
 dhasen.rb
 dhasenc.rb
 dlogc.rb
 dlogd.rb
 dqin.rb
 dqlib.rb
 dqout.rb
 dqueue.rb
 drbc.rb
 drbch.rb
 drbm.rb
 drbmc.rb
 drbs-acl.rb
 drbs.rb
 drbssl_c.rb
 drbssl_s.rb
 extserv_test.rb
 gw_ct.rb
 gw_cu.rb
 gw_s.rb
 holderc.rb
 holders.rb
 http0.rb
 http0serv.rb
 name.rb
 namec.rb
 old_tuplespace.rb
 rinda_ts.rb
 rindac.rb
 rindas.rb
 ring_echo.rb
 ring_inspect.rb
 ring_place.rb
 simpletuple.rb
 speedc.rb
 speeds.rb
share/examples/ruby%%XY%%/logger/
 app.rb
 log.rb
 shifting.rb
share/examples/ruby%%XY%%/openssl/
 c_rehash.rb
 cert2text.rb
 certstore.rb
 cipher.rb
 crlstore.rb
 echo_cli.rb
 echo_svr.rb
 gen_csr.rb
 smime_read.rb
 smime_write.rb
 wget.rb
share/examples/ruby%%XY%%/optparse/
 opttest.rb
 subcommand.rb
share/examples/ruby%%XY%%/pty/
 expect_sample.rb
 script.rb
 shl.rb
share/examples/ruby%%XY%%/rdoc/markup/
 rdoc2latex.rb
 sample.rb
share/examples/ruby%%XY%%/ripper/
 ruby2html.rb
 strip-comment.rb
share/examples/ruby%%XY%%/rss/
 blend.rb
 convert.rb
 list_description.rb
 re_read.rb
 rss_recent.rb
share/examples/ruby%%XY%%/testunit/
 adder.rb
 subtracter.rb
 tc_adder.rb
 tc_subtracter.rb
 ts_examples.rb
share/examples/ruby%%XY%%/trick2013/README.md
share/examples/ruby%%XY%%/trick2013/kinaba/
 authors.markdown
 entry.rb
 remarks.markdown
share/examples/ruby%%XY%%/trick2013/mame/
 authors.markdown
 entry.rb
 music-box.mp4
 remarks.markdown
share/examples/ruby%%XY%%/trick2013/shinh/
 authors.markdown
 entry.rb
 remarks.markdown
share/examples/ruby%%XY%%/trick2013/yhara/
 authors.markdown
 entry.rb
 remarks.en.markdown
 remarks.markdown
share/examples/ruby%%XY%%/trick2015/README.md
share/examples/ruby%%XY%%/trick2015/eregon/
 authors.markdown
 entry.rb
 remarks.markdown
share/examples/ruby%%XY%%/trick2015/kinaba/
 authors.markdown
 entry.rb
 remarks.markdown
share/examples/ruby%%XY%%/trick2015/ksk_1/
 authors.markdown
 entry.rb
 remarks.markdown
share/examples/ruby%%XY%%/trick2015/ksk_2/
 abnormal.cnf
 authors.markdown
 entry.rb
 quinn.cnf
 remarks.markdown
 sample.cnf
 uf20-01.cnf
 unsat.cnf
share/examples/ruby%%XY%%/trick2015/monae/
 authors.markdown
 entry.rb
 remarks.markdown
share/examples/ruby%%XY%%/webrick/
 demo-app.rb
 demo-multipart.cgi
 demo-servlet.rb
 demo-urlencoded.cgi
 hello.cgi
 hello.rb
 httpd.rb
 httpproxy.rb
 httpsd.rb


[FILE:2179:patches/patch-configure.in]
--- configure.in.orig	2018-10-17 08:30:28 UTC
+++ configure.in
@@ -1112,7 +1112,7 @@ AS_CASE(["$target_os"],
 [nextstep*], [	],
 [openstep*], [	],
 [rhapsody*], [	],
-[darwin*], [	RUBY_PREPEND_OPTION(LIBS, -lobjc)
+[darwin*], [
 		RUBY_APPEND_OPTIONS(CPPFLAGS, -D_XOPEN_SOURCE -D_DARWIN_C_SOURCE -D_DARWIN_UNLIMITED_SELECT -D_REENTRANT)
 		AC_MSG_CHECKING(whether Mac OS X 10.5 or later)
 		AC_TRY_CPP([#include <AvailabilityMacros.h>
@@ -3885,21 +3885,17 @@ AS_CASE("$enable_shared", [yes], [
 	LIBRUBY_ALIASES='lib$(RUBY_SO_NAME).so.$(MAJOR).$(MINOR) lib$(RUBY_SO_NAME).so'
 	],
     [linux* | gnu* | k*bsd*-gnu | atheos* | kopensolaris*-gnu | haiku*], [
-	RUBY_APPEND_OPTIONS(LIBRUBY_DLDFLAGS, ['-Wl,-soname,lib$(RUBY_SO_NAME).so.$(MAJOR).$(MINOR)' "$LDFLAGS_OPTDIR"])
-	LIBRUBY_ALIASES='lib$(RUBY_SO_NAME).so.$(MAJOR).$(MINOR) lib$(RUBY_SO_NAME).so'
+	RUBY_APPEND_OPTIONS(LIBRUBY_DLDFLAGS, ['-Wl,-soname,lib$(RUBY_SO_NAME).so.$(MAJOR)$(MINOR)' "$LDFLAGS_OPTDIR"])
+	LIBRUBY_ALIASES='lib$(RUBY_SO_NAME).so.$(MAJOR)$(MINOR) lib$(RUBY_SO_NAME).so'
 	if test "$load_relative" = yes; then
 	    libprefix="'\$\${ORIGIN}/../${libdir_basename}'"
 	    LIBRUBY_RPATHFLAGS="-Wl,-rpath,${libprefix}"
 	    LIBRUBY_RELATIVE=yes
 	fi
 	],
-    [freebsd*|dragonfly*], [
+    [freebsd*|dragonfly*|solaris*], [
 	SOLIBS='$(LIBS)'
 	LIBRUBY_SO='lib$(RUBY_SO_NAME).so.$(MAJOR)$(MINOR)'
-	if test "$rb_cv_binary_elf" != "yes" ; then
-	    LIBRUBY_SO="$LIBRUBY_SO.\$(TEENY)"
-	    LIBRUBY_ALIASES=''
-	fi
 	],
     [netbsd*], [
 	SOLIBS='$(LIBS)'
@@ -3937,7 +3933,6 @@ AS_CASE("$enable_shared", [yes], [
 	SOLIBS='-lm -lc'
 	],
     [darwin*], [
-	RUBY_SO_NAME="$RUBY_SO_NAME"'.$(RUBY_PROGRAM_VERSION)'
 	LIBRUBY_LDSHARED='$(CC) -dynamiclib'
 	if test "$load_relative" = yes; then
 	    libprefix="@executable_path/../${libdir_basename}"
@@ -3953,7 +3948,7 @@ AS_CASE("$enable_shared", [yes], [
 	fi
 	LIBRUBY_DLDFLAGS="$LIBRUBY_DLDFLAGS "' $(XLDFLAGS)'
 	LIBRUBY_SO='lib$(RUBY_SO_NAME).dylib'
-	LIBRUBY_ALIASES='lib$(RUBY_BASE_NAME).$(MAJOR).$(MINOR).dylib lib$(RUBY_INSTALL_NAME).dylib'
+	LIBRUBY_ALIASES='lib$(RUBY_SO_NAME).$(MAJOR)$(MINOR).dylib'
 	SOLIBS='$(LIBS)'
 	],
     [interix*], [


[FILE:744:patches/patch-dir.c]
--- dir.c.orig	2018-03-28 11:16:19 UTC
+++ dir.c
@@ -100,16 +100,16 @@ char *strchr(char*,char);
 # define USE_NAME_ON_FS 0
 #endif
 
-#ifdef __APPLE__
+#if 0
 # define NORMALIZE_UTF8PATH 1
 #else
 # define NORMALIZE_UTF8PATH 0
 #endif
 
+#include <sys/vnode.h>
 #if NORMALIZE_UTF8PATH
 #include <sys/param.h>
 #include <sys/mount.h>
-#include <sys/vnode.h>
 
 # if defined HAVE_FGETATTRLIST || !defined HAVE_GETATTRLIST
 #   define need_normalization(dirp, path) need_normalization(dirp)
@@ -1047,7 +1047,7 @@ rb_dir_getwd(void)
 
     if (fsenc == ENCINDEX_US_ASCII) fsenc = ENCINDEX_ASCII;
     path = my_getcwd();
-#ifdef __APPLE__
+#if NORMALIZE_UTF8PATH
     cwd = rb_str_normalize_ospath(path, strlen(path));
     OBJ_TAINT(cwd);
 #else


[FILE:640:patches/patch-file.c]
--- file.c.orig	2018-06-30 13:06:35 UTC
+++ file.c
@@ -19,9 +19,6 @@
 #include <sys/cygwin.h>
 #include <wchar.h>
 #endif
-#ifdef __APPLE__
-#include <CoreFoundation/CFString.h>
-#endif
 
 #include "internal.h"
 #include "ruby/io.h"
@@ -238,7 +235,7 @@ rb_str_encode_ospath(VALUE path)
     return path;
 }
 
-#ifdef __APPLE__
+#if 0
 # define NORMALIZE_UTF8PATH 1
 static VALUE
 rb_str_append_normalized_ospath(VALUE str, const char *ptr, long len)
@@ -3503,7 +3500,7 @@ rb_file_expand_path_internal(VALUE fname
 	    b = ++s;
 	    break;
 	  default:
-#ifdef __APPLE__
+#if 0
 	    {
 		int n = ignored_char_p(s, fend, enc);
 		if (n) {


[FILE:469:patches/patch-lib_mkmf.rb]
--- lib/mkmf.rb.orig	2018-10-17 09:22:24 UTC
+++ lib/mkmf.rb
@@ -235,7 +235,7 @@ module MakeMakefile
   end
   $extmk ||= false
   if not $extmk and File.exist?(($hdrdir = RbConfig::CONFIG["rubyhdrdir"]) + "/ruby/ruby.h")
-    $topdir = $hdrdir
+    $topdir = $hdrdir + "/" + "#{CONFIG['arch']}/ruby/"
     $top_srcdir = $hdrdir
     $arch_hdrdir = RbConfig::CONFIG["rubyarchhdrdir"]
   elsif File.exist?(($hdrdir = ($top_srcdir ||= topdir) + "/include")  + "/ruby.h")


[FILE:555:patches/patch-tool_mkconfig.rb]
--- tool/mkconfig.rb.orig	2016-11-17 07:19:49 UTC
+++ tool/mkconfig.rb
@@ -159,8 +159,9 @@ def vars.expand(val, config = self)
   val.replace(newval) unless newval == val
   val
 end
-prefix = vars.expand(vars["prefix"] ||= "")
-rubyarchdir = vars.expand(vars["rubyarchdir"] ||= "")
+prefix = vars.expand(vars["rubyarchdir"])
+major, minor, *rest = RUBY_VERSION.split('.')
+rubyarchdir = "/lib/ruby/#{major}.#{minor}/#{arch}"
 relative_archdir = rubyarchdir.rindex(prefix, 0) ? rubyarchdir[prefix.size..-1] : rubyarchdir
 puts %[\
 # encoding: ascii-8bit


[FILE:4060:patches/patch-tool_rbinstall.rb]
--- tool/rbinstall.rb.orig	2017-03-12 08:02:52 UTC
+++ tool/rbinstall.rb
@@ -694,110 +694,6 @@ end
 
 # :startdoc:
 
-install?(:ext, :comm, :gem) do
-  gem_dir = Gem.default_dir
-  directories = Gem.ensure_gem_subdirectories(gem_dir, :mode => $dir_mode)
-  prepare "default gems", gem_dir, directories
-
-  spec_dir = File.join(gem_dir, directories.grep(/^spec/)[0])
-  default_spec_dir = "#{spec_dir}/default"
-  makedirs(default_spec_dir)
-
-  gems = Dir.glob(srcdir+"/{lib,ext}/**/*.gemspec").map {|src|
-    spec = Gem::Specification.load(src) || raise("invalid spec in #{src}")
-    file_collector = RbInstall::Specs::FileCollector.new(File.dirname(src))
-    files = file_collector.collect
-    next if files.empty?
-    spec.files = files
-    spec
-  }
-  gems.compact.sort_by(&:name).each do |gemspec|
-    full_name = "#{gemspec.name}-#{gemspec.version}"
-
-    puts "#{" "*30}#{gemspec.name} #{gemspec.version}"
-    gemspec_path = File.join(default_spec_dir, "#{full_name}.gemspec")
-    open_for_install(gemspec_path, $data_mode) do
-      gemspec.to_ruby
-    end
-
-    unless gemspec.executables.empty? then
-      bin_dir = File.join(gem_dir, 'gems', full_name, gemspec.bindir)
-      makedirs(bin_dir)
-
-      execs = gemspec.executables.map {|exec| File.join(srcdir, 'bin', exec)}
-      install(execs, bin_dir, :mode => $script_mode)
-    end
-  end
-end
-
-install?(:ext, :comm, :gem) do
-  gem_dir = Gem.default_dir
-  directories = Gem.ensure_gem_subdirectories(gem_dir, :mode => $dir_mode)
-  prepare "bundle gems", gem_dir, directories
-  install_dir = with_destdir(gem_dir)
-  installed_gems = {}
-  options = {
-    :install_dir => install_dir,
-    :bin_dir => with_destdir(bindir),
-    :domain => :local,
-    :ignore_dependencies => true,
-    :dir_mode => $dir_mode,
-    :data_mode => $data_mode,
-    :prog_mode => $prog_mode,
-    :wrappers => true,
-    :format_executable => true,
-  }
-  gem_ext_dir = "#$extout/gems/#{CONFIG['arch']}"
-  extensions_dir = Gem::StubSpecification.gemspec_stub("", gem_dir, gem_dir).extensions_dir
-  Gem::Specification.each_gemspec([srcdir+'/gems/*']) do |path|
-    dir = File.dirname(path)
-    spec = Dir.chdir(dir) {
-      Gem::Specification.load(File.basename(path))
-    }
-    next unless spec.platform == Gem::Platform::RUBY
-    next unless spec.full_name == path[srcdir.size..-1][/\A\/gems\/([^\/]+)/, 1]
-    spec.extension_dir = "#{extensions_dir}/#{spec.full_name}"
-    if File.directory?(ext = "#{gem_ext_dir}/#{spec.full_name}")
-      spec.extensions[0] ||= "-"
-    end
-    ins = RbInstall::UnpackedInstaller.new(spec, options)
-    puts "#{" "*30}#{spec.name} #{spec.version}"
-    ins.install
-    File.chmod($data_mode, File.join(install_dir, "specifications", "#{spec.full_name}.gemspec"))
-    unless spec.extensions.empty?
-      install_recursive(ext, spec.extension_dir)
-    end
-    installed_gems[spec.full_name] = true
-  end
-  installed_gems, gems = Dir.glob(srcdir+'/gems/*.gem').partition {|gem| installed_gems.key?(File.basename(gem, '.gem'))}
-  unless installed_gems.empty?
-    install installed_gems, gem_dir+"/cache"
-  end
-  next if gems.empty?
-  if defined?(Zlib)
-    Gem.instance_variable_set(:@ruby, with_destdir(File.join(bindir, ruby_install_name)))
-    silent = Gem::SilentUI.new
-    gems.each do |gem|
-      inst = Gem::Installer.new(gem, options)
-      inst.spec.extension_dir = with_destdir(inst.spec.extension_dir)
-      begin
-        Gem::DefaultUserInteraction.use_ui(silent) {inst.install}
-      rescue Gem::InstallError => e
-        next
-      end
-      gemname = File.basename(gem)
-      puts "#{" "*30}#{gemname}"
-    end
-    # fix directory permissions
-    # TODO: Gem.install should accept :dir_mode option or something
-    File.chmod($dir_mode, *Dir.glob(install_dir+"/**/"))
-    # fix .gemspec permissions
-    File.chmod($data_mode, *Dir.glob(install_dir+"/specifications/*.gemspec"))
-  else
-    puts "skip installing bundle gems because of lacking zlib"
-  end
-end
-
 parse_args()
 
 include FileUtils


[FILE:467:files/special.mk]
# Macros to change variables in rbconfig.rb
RB_SET_CONF_VAR=${SH} -c '${REINPLACE_CMD} -E -e "s,(CONFIG\[\"$$0\"\][[:space:]]*=[[:space:]]*)(\(?)(.*)(\)?),\1\2$$1\4," ${WRKSRC}/rbconfig.rb' --

POST_PLIST_TARGET=	rdoc-autolist

.if "${OPSYS}" == "Darwin"
PLIST_SUB+=	MODULE=bundle
.else
PLIST_SUB+=	MODULE=so
.endif

rdoc-autolist:
	@(cd ${STAGEDIR}${PREFIX} && ${FIND} share/ri \
	\( -type f -o -type l \) 2>/dev/null | ${SORT}) \
	>> ${WRKDIR}/.manifest.rdoc.mktmp

