# Buildsheet autogenerated by ravenadm tool -- Do not edit.

NAMEBASE=		html2text
VERSION=		1.3.2a
KEYWORDS=		textproc
VARIANTS=		standard
SDESC[standard]=	Converts HTML documents into plain text
HOMEPAGE=		http://www.mbayer.de/html2text/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		http://www.mbayer.de/html2text/downloads/
DISTFILE[1]=		html2text-1.3.2a.tar.gz:main
DF_INDEX=		1
SPKGS[standard]=	single

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

USES=			c++:single

LICENSE=		GPLv2+:single
LICENSE_TERMS=		single:{{WRKDIR}}/TERMS
LICENSE_FILE=		GPLv2+:{{WRKSRC}}/COPYING
LICENSE_AWK=		TERMS:"^\#include"
LICENSE_SOURCE=		TERMS:{{WRKSRC}}/html2text.C
LICENSE_SCHEME=		solo

FPC_EQUIVALENT=		textproc/html2text

MUST_CONFIGURE=		yes

CXXFLAGS=		-Wno-write-strings
			-Wno-deprecated-declarations

post-patch:
	${REINPLACE_CMD} -e '/echo=/s/ -e//' ${WRKSRC}/configure
.for fle in Makefile.in libstd/Makefile.in
	${REINPLACE_CMD} -e '/^DEBUG/s/^/#/; \
		 /^CXXFLAGS/s/=/+=/' ${WRKSRC}/${fle}
.endfor
.for fle in Area.h HTMLControl.h Properties.h format.h
	${REINPLACE_CMD} -e 's/<istream>/<iostream>/' ${WRKSRC}/${fle}
.endfor

do-install:
	${INSTALL_PROGRAM} ${WRKSRC}/html2text ${STAGEDIR}${PREFIX}/bin
	${INSTALL_MAN} ${WRKSRC}/html2text.1.gz ${STAGEDIR}${MANPREFIX}/man/man1
	${INSTALL_MAN} ${WRKSRC}/html2textrc.5.gz ${STAGEDIR}${MANPREFIX}/man/man5

[FILE:674:descriptions/desc.single]
html2text is a command line utility, written in C++, that converts
HTML documents (HTML 3.2) into plain text (ISO 8859-1).

Each HTML document is loaded from a location indicated by an URI or read
from standard input, and formatted into a stream of plain text characters
that is written to standard output or into an output-file. The input-URI
may specify a remote site, from that the documents are loaded with the
Hypertext Transfer Protocol (HTTP). The program is even able to preserve
the original positions of table fields and accepts also syntactically
incorrect input, attempting to interpret it "reasonably". The rendering
is largely customisable through an RC file.


[FILE:102:distinfo]
000b39d5d910b867ff7e087177b470a1e26e2819920dcffd5991c33f6d480392       130088 html2text-1.3.2a.tar.gz


[FILE:76:manifests/plist.single]
bin/html2text
share/man/man1/html2text.1.gz
share/man/man5/html2textrc.5.gz


[FILE:902:patches/patch-configure]
--- configure.orig	2004-01-12 15:47:18 UTC
+++ configure
@@ -38,8 +38,7 @@ int main(int, char **) {
   return 0;
 }
 EOF
-CXX=unknown;
-for i in "CC" "g++" "cc" "$CC"; do
+for i in "$CXX" "c++"; do
   if $i -c $tmp_file.C 2>/dev/null; then
     CXX="$i";
     break;
@@ -205,12 +204,19 @@ cat <<EOF >$tmp_file.C;
 #include <new>
 #include <vector>
 using namespace std;
-void func() { map<string, string> x; }
+int main(void) {
+  map<string, string> x;
+  return 0;
+}
 EOF
-if $CXX -c $tmp_file.C 2>/dev/null; then
+if $CXX $tmp_file.C 2>/dev/null; then
   LIBSTDCXX_INCLUDES="";
   LIBSTDCXX_LIBS="";
   $echo 'works; no need to make "./libstd"';
+elif $CXX $tmp_file.C -lstdc++ 2>/dev/null; then
+  LIBSTDCXX_INCLUDES="";
+  LIBSTDCXX_LIBS="-lstdc++";
+  $echo 'works with libstdc++; no need to make "./libstd"';
 else
   LIBSTDCXX_INCLUDES='-Ilibstd/include';
   LIBSTDCXX_LIBS='libstd/libstd.a';

